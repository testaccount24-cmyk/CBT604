POP       OPSYN
PUSH      OPSYN
                                                SPACE
          MACRO
&LOC      LHERE
&LOC      EQU      *
          MEND     LHERE
                                                SPACE
          MACRO
&LOC      SPEC     &A,&F,&V,&O,&L
          CNOP     0,8
&LOC      DC       A(&L)
          DC       A(&O)
          DC       A(&A)
          DC       AL1(&F)
          DC       AL1(0)
          DC       AL2(&V)
          MEND     SPEC
                                                SPACE
          MACRO
&LOC      DESCR    &A,&F,&V
          CNOP     0,8
&LOC      DC       A(&A)
          DC       AL1(&F)
          DC       AL1(0)
          DC       AL2(&V)
          MEND     DESCR
                                                SPACE
          MACRO
&LOC      STRING   &TEXT
          LCLA     &N
          LCLC     &STRING
          LCLC     &S4
&STRING   SETC     'STRING'
&S4       SETC     'S4'
&N        SETA     K'&TEXT-2
          CNOP     0,8
&LOC      DC       A(&N)
          DC       A(0)
          DC       A(U&SYSNDX)
          DC       A(0)
&STRING   CSECT
U&SYSNDX  DC       C&TEXT
&S4       CSECT
          MEND     STRING
                                                SPACE
          MACRO
&LOC      FORMAT   &STRING
&LOC      DC       C&STRING
          MEND     FORMAT
                                                SPACE
          MACRO
&LOC      BUFFER   &N
&LOC      DC       (&N)C' '
          MEND     BUFFER
                                                SPACE
          MACRO
&LOC      ARRAY    &N
          DS       0D
&LOC      DC       (2*&N)F'0'
          MEND     ARRAY
                                                SPACE
         MACRO
&LOC     SELBRA    &CL,&LOCS
         GBLB      &ERRTYP
&ERRTYP  SETB      0
         LCLA      &N
         LCLA      &M
         AIF       ('&LOC' EQ 'FTERBR').CACHE
&LOC     L         1,&CL
         SLA       1,2
         B         *+0(1)
         AGO       .A
.CACHE   ANOP
&LOC     ST        11,&CL
         SLA       11,2
         B         *+0(11)
.A       ANOP
&N       SETA      &N+1
         AIF       (T'&LOCS(&N) EQ 'O').B
         B         &LOCS(&N)
         AGO       .C
.B       B         A&SYSNDX
&M       SETA      &M+1
.C       AIF       (&N LT N'&LOCS).A
         AIF       (&M EQ 0).D
A&SYSNDX EQU       *
.D       MEND      SELBRA
                                                SPACE
         MACRO
&LOC1    BRANCH    &LOC2,&LOC3
         AIF       (T'&LOC3 NE 'O').A
&LOC1    B         &LOC2
         MEXIT
.A       ANOP
&LOC1    L         11,=A(&LOC2)
         BR        11
         MEND      BRANCH
                                                SPACE
         MACRO
&LOC     SETAC     &CL,&V
         GBLB      &ERRTYP
         AIF       ('&LOC' NE 'COMP3').N1
&ERRTYP  SETB      1
.N1      AIF       (NOT &ERRTYP OR '&CL' NE 'SCERCL').N2
&LOC     LA        11,&V
         ST        11,&CL
         MEXIT
.N2      ANOP
         AIF       ('&V' EQ '0').A
         AIF       (T'&V EQ 'N').B
&LOC     L         1,=A(&V)
.C       ANOP
         AIF       (&ERRTYP).DONE
         ST        1,&CL
         MEXIT
.B       ANOP
&LOC     LA        1,&V
         AGO       .C
.A       ANOP
&LOC     ST        0,&CL
.DONE    MEND      SETAC
                                                SPACE
         MACRO
&LOC     INCRA     &CL,&N
&LOC     L         1,&CL
         AIF       ('&N' EQ 'DESCR').A
         LA        1,&N.(1)
         AGO       .C
.A       AR        1,8
         AGO       .C
.C       ANOP
         ST        1,&CL
         MEND      INCRA
                                                SPACE
         MACRO
&LOC     DECRA     &CL,&N
         GBLB      &ERRTYP
         LCLA      &R
&R       SETA      1+&ERRTYP
         AIF      ('&CL' NE 'ERRLCL').NLCL
&R       SETA      1
.NLCL    ANOP
&LOC     L         &R,&CL
         AIF       ('&N' EQ '1').A
         AIF       ('&N' EQ 'DESCR').C
         AIF       ('&N' EQ '2*DESCR').D
         AIF       ('&N' EQ 'SPEC').D
         S         &R,=A(&N)
         AGO       .B
.A       BCTR      &R,0
         AGO       .B
.C       SR        &R,8
         AGO       .B
.D       SR        &R,8
         SR        &R,8
.B       ANOP
         ST        &R,&CL
         MEND      DECRA
                                                SPACE
         MACRO
&LOC     GETD      &CL1,&CL2,&OFFSET
         LCLC      &L
&L       SETC     '&LOC'
         AIF       ('&OFFSET' EQ '').C
&L       L         1,&OFFSET
&L       SETC      ''
.C       ANOP
&L       L         2,&CL2
         LD        0,0(1,2)
         STD       0,&CL1
         MEND      GETD
                                                SPACE
         MACRO
&LOC     ACOMPC    &CL,&N,&LOC1,&LOC2,&LOC3
.* DANGLING ERRTYP, CODE IN TERMINATION.
         GBLB      &ERRTYP
         LCLC      &L
         AIF       ('&LOC' NE 'FTERST').NC
&LOC     ST        1,ERRTYP
         L         2,&CL
         CR        2,0
         BNH       &LOC3
         MEXIT
.NC      ANOP
.*
         AIF       ('&N' NE '0').A
&LOC     C         0,&CL
         AGO       .B
.A       ANOP
&LOC     LA        1,&N
         C         1,&CL
.B       ANOP
         AIF       ('&LOC1' NE '&LOC2').NOT12
         AIF       ('&LOC1' NE '').K1
         BH        &LOC3
         MEXIT
.K1      BNH       &LOC1
         AIF       ('&LOC3' EQ '').DONE
         BH        &LOC3
         MEXIT
.NOT12   AIF       ('&LOC2' NE '&LOC3').NOT23
         AIF       ('&LOC2' NE '').K2
         BL        &LOC1
         MEXIT
.K2      BNL       &LOC2
         AIF       ('&LOC1' EQ '').DONE
         BL        &LOC1
         MEXIT
.NOT23   AIF       ('&LOC1' NE '&LOC3').NOT13
         AIF       ('&LOC3' NE '').K3
         BE        &LOC2
         MEXIT
.K3      BNE       &LOC1
         AIF       ('&LOC2' EQ '').DONE
         BE        &LOC2
         MEXIT
.NOT13   AIF       ('&LOC1' EQ '').N1
         BL        &LOC1
.N1      AIF       ('&LOC2' EQ '').N2
         BE        &LOC2
.N2      AIF       ('&LOC3' EQ '').DONE
         BH        &LOC3
.DONE    MEND      ACOMPC
                                                SPACE
         MACRO
&LOC     LOCAPT    &PTR1,&PTR2,&CL,&FLOC,&SLOC
         LCLA      &M
&LOC     L         15,&PTR2
         AIF       (T'&FLOC EQ 'O').A
&M       SETA      &M+1
.A       L         5,4(15)
         LA        5,0(5,15)
         LR        4,8
         SR        5,4
         AR        4,8
C&SYSNDX CLC       8(8,15),&CL
         BE        D&SYSNDX
         BXLE      15,4,C&SYSNDX
         AIF       (&M EQ 0).C
         B         &FLOC
         AGO       .D
.C       B         A&SYSNDX
.D       ANOP
D&SYSNDX STM       15,0,&PTR1
         AIF       (T'&SLOC EQ 'O').M
         B         &SLOC
         AIF       (&M NE 0).M
A&SYSNDX EQU       *
.M       MEND      LOCAPT
                                                SPACE
         MACRO
&LOC     PUSH      &CL
         LCLA      &NO,&N,&K
         GBLB      &ERRTYP
         AIF       (&ERRTYP AND '&CL' EQ 'SCERCL').NOOP
&N       SETA      1
&NO      SETA      N'&CL
&K       SETA      &NO
         AIF       ('&LOC' EQ '').A
&LOC     EQU       *
.A       AIF       (&NO EQ 0).DONE
         LD        0,&CL(&N)
         STD       0,12*8+8*&N.(12)
&NO      SETA      &NO-1
&N       SETA      &N+1
         AGO       .A
.DONE    AIF       (&K EQ 1).DONI
         LA        12,8*&K.(12)
         AGO       .DONA
.DONI    AR        12,8
         AGO       .DONA
.DONA    C         12,=A(STACK-12*8+STSIZE*8)
         BH        OVER
.NOOP    MEND      PUSH
                                                SPACE
         MACRO
&LOC     POP       &CL
         LCLA      &NO,&N,&K
         GBLB      &ERRTYP
         AIF       (&ERRTYP AND '&CL' EQ 'SCERCL').NOOP
&NO      SETA      N'&CL
&K       SETA      &NO
         AIF       ('&LOC' EQ '').A
&LOC     EQU       *
.A       AIF       (&NO EQ 0).DONE
&N       SETA      &N+1
         LD        0,13*8-&N*8(12)
         STD       0,&CL(&N)
&NO      SETA      &NO-1
         AGO       .A
.DONE    AIF       (&K EQ 1).DONI
         AIF       (&K EQ 2).DONK
         S         12,=A(&K*8)
         MEXIT
.DONI    SR        12,8
         MEXIT
.NOOP    LA        0,0
         MEXIT
.DONK    SR        12,8
         SR        12,8
         MEND      POP
                                                SPACE
         MACRO
&LOC     RCALL     &CL,&PROC,&ARGLIST,&LOCS
         LCLA      &K,&L,&N,&M,&NO
&NO      SETA      N'&ARGLIST
&N       SETA      1
&K       SETA      &NO
&LOC     LA        14,U&SYSNDX
         STM       11,14,13*8(12)
         LR        13,12
.A       AIF       (&NO EQ 0).DONE
         MOVD      &ARGLIST(&N),14*8+&NO*8(12)
*        LD        0,&ARGLIST(&N)
*        STD       0,14*8+&NO*8(12)
&NO      SETA      &NO-1
&N       SETA      &N+1
         AGO       .A
.DONE    LA        12,16+&K*8(12)
         C         12,=A(STACK-12*8+STSIZE*8)
         BH        OVER
         L         11,=A(&PROC)
         BR        11
         AIF       ('&CL' EQ '').C
U&SYSNDX STD       0,&CL
         AGO       .D
.C       ANOP
U&SYSNDX SR        0,0
         SR        0,0
.D       AIF       ('&LOCS' EQ '').M
&K       SETA      0
.H       ANOP
&L       SETA      &L+1
         AIF       (T'&LOCS(&L) EQ 'O').F
         B         &LOCS(&L)
         AGO       .G
.F       B         V&SYSNDX
&K       SETA      &K+1
.G       AIF       (&L LT N'&LOCS).H
         AIF       (&K EQ 0).M
V&SYSNDX EQU       *
.M       MEND      RCALL
                                                SPACE
         MACRO
&LOC     MOVD      &CL1,&CL2
&LOC     LD        0,&CL2
         STD       0,&CL1
         MEND      MOVD
                                                SPACE
         MACRO
&LOC     TESTF     &PTR,&F,&FLOC,&SLOC
&LOC     TM        &PTR+4,&F
         AIF       (T'&FLOC EQ 'O').A
         BNO       &FLOC
.A       AIF       (T'&SLOC EQ 'O').M
         BO        &SLOC
.M       MEND      TESTF
                                                SPACE
         MACRO
&LOC     TESTFI    &PTR,&F,&FLOC,&SLOC
&LOC     L         1,&PTR
         TM        4(1),&F
         AIF       (T'&FLOC EQ 'O').A
         BNO       &FLOC
.A       AIF       (T'&SLOC EQ 'O').M
         BO        &SLOC
.M       MEND      TESTFI
                                                SPACE
         MACRO
&LOC     SETFI     &PTR,&F
&LOC     L         1,&PTR
         OI        4(1),&F
         MEND      SETFI
                                                SPACE
         MACRO
&LOC     SETF      &PTR,&F
&LOC     OI        &PTR+4,&F
         MEND      SETF
                                                SPACE
         MACRO
&LOC     RESETF    &PTR,&FLAG
&LOC     NI        &PTR+4,&FLAG.@
         MEND      RESETF
                                                SPACE
         MACRO
&LOC     RSETFI    &CL,&FLAG
&LOC     L         1,&CL
         NI        4(1),&FLAG.@
         MEND      RSETFI
                                                SPACE
         MACRO
&LOC     GETDC     &CL1,&CL2,&N
&LOC     L         1,&CL2
         LD        0,&N.(1)
         STD       0,&CL1
         MEND      GETDC
                                                SPACE
         MACRO
&LOC     AEQLC     &CL1,&N,&LOC1,&LOC2
         AIF       ('&N' EQ '0').C
&LOC     LA        6,&N
         C         6,&CL1
         AGO       .D
.C       ANOP
&LOC     C         0,&CL1
.D       AIF       (T'&LOC1 EQ 'O').A
         BNE       &LOC1
.A       AIF       (T'&LOC2 EQ 'O').B
         BE        &LOC2
.B       MEND      AEQLC
       TITLE   'SNOBOL4 3.5 resurrection'
*
*      This file is part of a resurrected source code for the SIL based
*      SNOBOL V3.5 interpreter for IBM 360 recovered many yaers ago
*      by Jan Jaeger.
*
*      SNOBOL4 was distributed in 2 forms, the source in SIL macros
*      and after a postprocessing action on the assembly. The
*      postprocessor is lost (but one can imagine some of the
*      functionality, in particular to optimize away unnecessary
*      cell acces.
*
*      There exit many documents from the University
*      of Arizona concerning this implentation for IBM 360 machines
*      and the logic of SIL.
*
*      Another problem is that the obtained load module has some
*      patches on the binary level.
*
*      The source code produced here is based on Gerhard postpischl's
*      disassembler togther with an augentation/decoration tool
*      written in SNOBOL4 (what else).
*
*      The section 'Data' uses SIL macros.
*      As a result, the source can be read and understood.
*
*      To a large degree, this work is "just" an academic effort,
*      for practical purposes there is SPITBOL, either also
*      available on the CBTTAPE or the SYSCPK.
*
*      This source creates an identical TXT part as in the original
*      load module.
*
*      Have fun
*      Peter Sylvester
*
*      TITLE   'SNOBOL4  Table of Contents'
*
*
*
*              E32 (DECEMBER 18, 1969)
*              UPDATED TO VERSION 3.5,  FEB 10, 1971            V3.5
*
*
*
*      1.   Linkage and Equivalences
*              Linkage
*              Machine Dependent Parameters
*              Constants
*              Equivalences
*              Data Type Codes
*      2.   Program Initialization
*      3.   Compilation and Interpreter Invocation
*      4.   Support Procedures
*              AUGATL
*              CODSKP
*              DTREP
*              FINDEX
*      5.   Storage Allocation and Regeneration Procedures
*              BLOCK
*              GENVAR
*              GNVARI
*              CONVAR
*              GNVARS
*              GC
*              GCM
*              SPLIT
*      6.   Compilation Procedures
*              BINOP
*              CMPILE
*              ELEMNT
*              EXPR
*              FORWRD
*              NEWCRD
*              TREPUB
*              UNOP
*      7.   Interpreter Executive and Control Procedures
*              BASE
*              GOTG
*              GOTL
*              GOTO
*              INIT
*              INTERP
*              INVOKE
*      8.   Argument Evaluation Procedures
*              ARGVAL
*              EXPVAL
*              EXPEVL
*              EVAL
*              INTVAL
*              PATVAL
*              VARVAL
*              XYARGS
*      9.   Arithmetic Operations, Predicates and Functions
*              ADD
*              DIV
*              EXP
*              MPY
*              SUB
*              EQ
*              GE
*              GT
*              LE
*              LT
*              NE
*              REMDR
*              INTGER
*              MNS
*              PLS
*      10.   Pattern-Valued Functions and Operations
*              ANY
*              BREAK
*              NOTANY
*              SPAN
*              LEN
*              POS
*              RPOS
*              RTAB
*              TAB
*              ARBNO
*              ATOP (Cursor Position)
*              NAM (Value Assignment)
*              OR
*      11.  Pattern Matching Procedures
*              SCAN
*              SJSR (Scan and Replace)
*              SCNR (Basic Scanner)
*              ANYC
*              BRKC
*              NNYC
*              SPNC
*              LNTH
*              POSI
*              RPSI
*              RTB
*              TB
*              ARBN (ARBNO)
*              FARB (ARB Backup)
*              ATP (Cursor Position)
*              BAL
*              CHAR
*              STAR (Unevaluated Expression)
*              DSAR
*              FNCE
*              NME (Value Assignment)
*              ENME
*              DNME
*              ENMI (Immediate Value Assignment)
*              SUCE (SUCCEED)
*      12.  Defined Functions
*              DEFINE
*              DEFFNC (Invoke Defined Function)
*      13.  External Functions
*              LOAD
*              UNLOAD
*              LNKFNC (Link to External Function)
*      14.  Arrays, Tables, and Defined Data Objects
*              ARRAY
*              ASSOC (TABLE)
*              DATDEF (DATA)
*              PROTO
*              ITEM (Array and Table References)
*              DEFDAT (Create Data Object)
*              FIELD
*      15.  Input and Output
*              READ (INPUT)
*              PRINT (OUTPUT)
*              BKSPCE
*              ENFILE
*              REWIND
*              DETACH
*              PUTIN
*              PUTOUT
*      16.  Tracing Procedures and Functions
*              TRACE
*              STOPTR
*              FENTR (Call Tracing)
*              FENTR2
*              KEYTR
*              TRPHND (Trace Handler)
*              VALTR
*              FNEXT2
*      17.  Other Operations
*              ASGN (=)
*              CON (Concatenation)
*              IND (Indirect Reference)
*              KEYWRD
*              LIT
*              NAME
*              NMD (Value Assignment)
*              STR (Unevaluated Expression)
*      18.  Other Predicates
*              DIFFER
*              IDENT
*              LGT
*              NEG
*              QUES (?)
*      19.  Other Functions
*              APPLY
*              ARG
*              LOCAL
*              FIELDS
*              CLEAR
*              COLECT
*              COPY
*              CNVRT
*              DATE
*              DT
*              DMP
*              DUMP
*              DUPL
*              OPSYN
*              RPLACE
*              SIZE
*              TIME
*              TRIM
*      20.  Common Code
*      21.  Termination
*              END
*              FTLEND
*              SYSCUT
*      22.  Error Handling
*      23.  Data
*              Pair Lists
*              Data Type Pairs
*              Switches
*              Constants
*              Pointers to Patterns
*              Function Descriptors
*              Miscellaneous Data
*              Program Pointers
*              Pointers to Specifiers
*              Permanent Pair List Pointers
*              Specifiers for Compilation
*              Strings and Specifiers
*              Character Buffers
*              Pointers to Pair Lists
*              Scratch Descriptors
*              System Descriptors
*              Compiler Descriptors
*              Data Pointers
*              Specifiers
*              Allocator Data
*              Machine Dependent Data
*              Function Table
*              Function Pair List
*              Function Initialization Data
*              Pointers to Initialization Data
*              System Arrays
*              String Storage Bin List
*              Pattern-Matching History List
*              System Stack
*              Primitive Patterns
*              Code Skeleton for TRACE
*              Fatal Error Message Pointers
*              Fatal Error Messages
*              Compiler Error Messages
*              Formats
*
       TITLE   'Linkage and Equivalences'
ALPHSZ   EQU       256
FNC      EQU       B'00000100'
FNC@     EQU       B'11111011'
MARK     EQU       B'00001000'
MARK@    EQU       B'11110111'
PTR      EQU       B'00010000'
PTR@     EQU       B'11101111'
STTL     EQU       B'00000010'
STTL@    EQU       B'11111101'
TTL      EQU       B'00000001'
TTL@     EQU       B'11111110'
AWDTH    EQU       8
DWDTH    EQU       8
DESCR    EQU       8
SWDTH    EQU       16
SPEC     EQU       16
CPA      EQU       1
MEMLEV   EQU       10000
MEMMIN   EQU       4400
MEMMAX   EQU       25000
*CARDSZ   EQU       80
*SEQSIZ   EQU       8
*STNOSZ   EQU       8
*OBSIZ    EQU       256
SIZLIM   EQU       16777215
UNITI    EQU       5
UNITO    EQU       6
UNITP    EQU       7
*
*
*      Constants
*
ATTRIB EQU     2*DESCR             Offset of label in string structure
LNKFLD EQU     3*DESCR             Offset of link in string structure
BCDFLD EQU     4*DESCR             Offset of string in string structure
FATHER EQU     DESCR               Offset of father in code node
LSON   EQU     2*DESCR             Offset of left son in code node
RSIB   EQU     3*DESCR             Offset of right sibling in code node
CODE   EQU     4*DESCR             Offset of code in code node
ESASIZ EQU     50                  Limit on number of syntactic errors
FBLKSZ EQU     10*DESCR            Size of function descriptor block
ARRLEN EQU     20                  Limit on length of array mrint image
CARDSZ EQU     80                  Width of compiler input
SEQSIZ EQU     8                   Width of sequence field
STNOSZ EQU     8                   Length of statement number field
DSTSZ  EQU     2*STNOSZ            Space for left and right numbering
CNODSZ EQU     4*DESCR             Size of code node
DATSIZ EQU     1000                Limit on number of defined data type
EXTSIZ EQU     10                  Default allocation for tables
NAMLSZ EQU     20                  Growth quantum for name list
NODESZ EQU     3*DESCR             Size of pattern node
OBSIZ  EQU     256                 Number of bin headers
OBARY  EQU     OBSIZ+3             Total number for bins
OCASIZ EQU     1500                Descriptors of initial object code
SPDLSZ EQU     1000                Descriptors of pattern stack
STSIZE EQU     1000                Descriptors of interpreter stack
SPDR   EQU     SPEC+DESCR          Descriptor plus specifier
OBOFF  EQU     OBSIZ-2             Offset length in bins
SPDLDR EQU     SPDLSZ*DESCR        Size of pattern stack
*
*
*      Equivalences
*
ARYTYP EQU     7                   Array reference
CLNTYP EQU     5                   Goto field
CMATYP EQU     2                   Comma
CMTTYP EQU     2                   Comment card
CNTTYP EQU     4                   Continue card
CTLTYP EQU     3                   Control card
DIMTYP EQU     1                   Dimension separator
EOSTYP EQU     6                   End of statement
EQTYP  EQU     4                   Equal sign
FGOTYP EQU     3                   Failure goto
FTOTYP EQU     6                   Failure direct goto
FLITYP EQU     6                   Literal real
FNCTYP EQU     5                   Function call
ILITYP EQU     2                   Literal integer
LPTYP  EQU     1                   Left parenthesis
NBTYP  EQU     1                   Nonbreak character
NEWTYP EQU     1                   New statement
NSTTYP EQU     4                   Parenthesized expression
QLITYP EQU     1                   Quoted literal
RBTYP  EQU     7                   Right bracket
RPTYP  EQU     3                   Right parenthesis
SGOTYP EQU     2                   Success goto
STOTYP EQU     5                   Success direct goto
UGOTYP EQU     1                   Unconditional goto
UTOTYP EQU     4                   Unconditional direct goto
VARTYP EQU     3                   Variable
*
*
*      Data type Codes
*
A      EQU     4                   ARRAY
B      EQU     2                   BLOCK (internal)
C      EQU     8                   CODE
E      EQU     11                  EXPRESSION
I      EQU     6                   INTEGER
K      EQU     10                  KEYWORD (NAME)
L      EQU     12                  LINKED STRING (internal)
N      EQU     9                   NAME
P      EQU     3                   PATTERN
R      EQU     7                   REAL
S      EQU     1                   STRING
T      EQU     5                   TABLE
                                                                SPACE
*---------------------------------------------------------------------*
S4 TITLE 'SPTS disassembly of S4  8/06/24'
S4       CSECT                           . 000000
         ENTRY ADDFN                     . 00E910
         EXTRN ALPHA                     .
         EXTRN APDSP                     .
         ENTRY AROWFN                    . 00EA78
         ENTRY ATFN                      . 00EA88
         ENTRY BARFN                     . 00EA98
         EXTRN BDSPEC                    .
         ENTRY BIAMFN                    . 00E928
         ENTRY BIATFN                    . 00E940
         ENTRY BINGFN                    . 00E958
         EXTRN BIOPTB                    .
         ENTRY BIPDFN                    . 00E970
         ENTRY BIPRFN                    . 00E988
         ENTRY BIQSFN                    . 00E9A0
         EXTRN CARDTB                    .
         EXTRN COMPLG                    .
         EXTRN COPL                      .
         ENTRY DATA                      . 00C650
         EXTRN DATER                     .
         EXTRN DECBIN                    .
         ENTRY DIVFN                     . 00E9D0
         ENTRY DOLFN                     . 00E9E8
         ENTRY DOTFN                     . 00EAA8
         EXTRN ELEMTB                    .
         EXTRN EOSTB                     .
         ENTRY EXPFN                     . 00EA00
         EXTRN EXREAL                    .
         EXTRN FINIS                     .
         ENTRY FRSGPT                    . 00DD78
         EXTRN FRWDTB                    .
         EXTRN GBAL                      .
         EXTRN GOTOTB                    .
         ENTRY HDSGPT                    . 00DD80
         EXTRN IBCOM#                    .
         EXTRN IBLKTB                    .
         ENTRY INDFN                     . 00EAB8
         ENTRY INTR10                    . 00CBFC
         ENTRY KEYFN                     . 00EAC8
         EXTRN LBLTB                     .
         EXTRN LBLXTB                    .
         EXTRN LINKER                    .
         EXTRN LOADER                    .
         EXTRN LVAL                      .
         ENTRY MNSFN                     . 00EAD8
         EXTRN MOVTST                    .
         ENTRY MPYFN                     . 00EA18
         ENTRY NAMFN                     . 00EA30
         ENTRY NEGFN                     . 00EAE8
         EXTRN NUMBTB                    .
         ENTRY OBLIST                    . 00F3F0
         ENTRY ORFN                      . 00EA48
         ENTRY PDFN                      . 00EAF8
         ENTRY PLSFN                     . 00EB08
         ENTRY PRFN                      . 00EB18
         ENTRY QUESFN                    . 00EB28
         EXTRN REALST                    .
         ENTRY RETCOD                    . 00CEF8
         EXTRN RPLCE                     .
         ENTRY SAVESAVE                  . 00DE08
         ENTRY SAVE13                    . 00DE50
         ENTRY SLHFN                     . 00EB38
         EXTRN SNABTB                    .
         EXTRN SPECEQ                    .
         EXTRN SPIECUT                   .
         EXTRN SPIECUTF                  .
         EXTRN SPREAL                    .
         EXTRN STINT                     .
         EXTRN STPRNT                    .
         EXTRN STREAD                    .
         EXTRN STREAM                    .
         ENTRY STRFN                     . 00EB48
*        EXTRN STRING *** SUPPRESSED
         ENTRY STYPE                     . 00D558
         ENTRY SUBFN                     . 00EA60
         ENTRY SYSCUT                    . 00CBA4
         ENTRY TLSGP1                    . 00DD88
         EXTRN UNLOADER                  .
         EXTRN UNOPTB                    .
         EXTRN VARATB                    .
         USING S4,15                     .
       TITLE   'Program Initialization'
*ATAD650 EQU   PROG+4096
                                                             SPACE
* BEGIN INIT   ,                   Initialize system
*      ISTACK  ,                   Initialize stack
*      OUTPUT  OUTPUT,TITLEF       Title listing
*      OUTPUT  OUTPUT,SOURCF       Print attribution
*      MSTIME  TIMECL              Time in compiler
*      RCALL   SCBSCL,BLOCK,OCALIM Allocate block for object code
*      MOVD    OCSVCL,SCBSCL       Save object code pointer
*      RESETF  SCBSCL,PTR          Clear pointer flag
*      GETSIZ  YCL,INITLS          Get size of initialization list
                                                             SPACE
BEGIN    B     S4$0000C                  . 000000 47F0 F00C
         DC    X'07'                     . 000004 07
         DC    C'SNOBOL4'                . 000005 E2D5D6C2D6D3F4
         DROP  15                        .
S4$0000C STM   14,12,12(13)              . 00000C 90EC D00C
         BALR  11,0                           BASE                     *
                                         . 000010 05B0
         USING *,11                      .
         B     S4$00020                  . 000012 47F0 B00E
         DC    X'0000'                   . 000016 0000
DATA0018 DC    A(S4$0)                   . 000018 0000C650
         DC    A(DATAD650)               . 00001C 0000D650
S4$00020 LM    9,10,DATA0018             . 000020 989A B006
         USING S4+50768,9                .
         USING S4+54864,10               .
         ST    13,SAVE13                 . 000024 50D0 A800
         L     4,@@SAVSAV                . 000028 5840 A810
         ST    13,4(4)                   . 00002C 50D4 0004
         ST    4,8(13)                   . 000030 504D 0008
         L     15,@@IBCOM#               . 000034 58F0 A814
         BAL   14,64(15)                      CALL                     *
                                         . 000038 45EF 0040
         L     15,@@STINT                . 00003C 58F0 A818
         BALR  14,15                          CALL                     *
                                         . 000040 05EF
         L     13,@@SAVSAV               . 000042 58D0 A810
         LA    1,S4$00052                . 000046 4110 B040
         BALR  1,1                            CALL                     *
                                         . 00004A 0511
         DC    X'0F'                     . 00004C 0F
         DC    AL3(SPIECUT)              . 00004D 000000
         DC    X'7FFF'                   . 000050 7FFF
S4$00052 SVC   14                             SPIE                     *
                                         . 000052 0A0E
         L     3,SIGRESET                . 000054 5830 A754
         SPM   3                         . 000058 0430
         LA    1,MAXTIM                  . 00005A 4110 A750
         SR    0,0                       . 00005E 1B00
         SVC   47                             STIMER                   *
                                         . 000060 0A2F
         LA    0,0                       . 000062 4100 0000
         LA    8,8                       . 000066 4180 0008
         L     12,@@STACKB               . 00006A 58C0 A81C
         LR    13,0                      . 00006E 18D0
         STM   13,1,AISAVE               . 000070 90D1 A770
         L     13,@@SAVSAV               . 000074 58D0 A810
         L     15,@@IBCOM#               . 000078 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00007C 45EF 0004
         DC    X'01'                     . 000080 01
         DC    AL3(OUTPUT)               . 000081 00D068
         DC    X'01'                     . 000084 01
         DC    AL3(TITLEF)               . 000085 014458
         BAL   14,16(15)                      CALL                     *
                                         . 000088 45EF 0010
         LM    13,1,AISAVE               . 00008C 98D1 A770
         L     13,@@SAVSAV               . 000090 58D0 A810
         L     15,@@IBCOM#               . 000094 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 000098 45EF 0004
         DC    X'01'                     . 00009C 01
         DC    AL3(OUTPUT)               . 00009D 00D068
         DC    X'01'                     . 0000A0 01
         DC    AL3(SOURCF)               . 0000A1 014315
         BAL   14,16(15)                      CALL                     *
                                         . 0000A4 45EF 0010
         L     13,@@SAVSAV               . 0000A8 58D0 A810
         SR    1,1                       . 0000AC 1B11
         SVC   46                             TIMER                    *
                                         . 0000AE 0A2E
         L     3,MAXTIM                  . 0000B0 5830 A750
         SR    3,0                       . 0000B4 1B30
         M     2,@@F26                   . 0000B6 5C20 A820
         D     2,@@F1000                 . 0000BA 5D20 A824
         ST    3,TIMECL                  . 0000BE 5030 9B90
         LM    13,1,AISAVE               . 0000C2 98D1 A770
         ST    0,TIMECL$4                . 0000C6 5000 9B94
         LA    14,S4$000EE               . 0000CA 41E0 B0DC
         STM   11,14,104(12)             . 0000CE 90BE C068
         LR    13,12                     . 0000D2 18DC
         LD    0,OCALIM                  . 0000D4 6800 9C60
         STD   0,120(12)                 . 0000D8 600C 0078
         LA    12,24(12)                 . 0000DC 41CC 0018
         C     12,@@STACKT               . 0000E0 59C0 A828
         BH    OVER                      . 0000E4 4720 9664
         L     11,@@BLOCK                . 0000E8 58B0 A82C
         BR    11                        . 0000EC 07FB
S4$000EE STD   0,SCBSCL                  . 0000EE 6000 A490
         STD   0,OCSVCL                  . 0000F2 6000 A480
         NI    SCBSCL$4,X'EF'            . 0000F6 94EF A494
         L     15,INITLS                 . 0000FA 58F0 AE38
         L     15,4(15)                  . 0000FE 58FF 0004
         LA    15,0(15)                  . 000102 41FF 0000
         STM   15,0,YCL                  . 000106 90F0 A420
                                                             SPACE
* SPCNVT GETD  XPTR,INITLS,YCL     Get pointer to list
*      GETSIZ  XCL,XPTR            Get size of list
                                                             SPACE
SPCNVT   L     1,YCL                     . 00010A 5810 A420
         L     2,INITLS                  . 00010E 5820 AE38
         LD    0,0(1,2)                  . 000112 6801 2000
         STD   0,XPTR                    . 000116 6000 A410
         L     15,XPTR                   . 00011A 58F0 A410
         L     15,4(15)                  . 00011E 58FF 0004
         LA    15,0(15)                  . 000122 41FF 0000
         STM   15,0,XCL                  . 000126 90F0 A408
                                                             SPACE
* SPCNV1 GETD  ZPTR,XPTR,XCL       Get pointer to specifier
*      AEQLC   ZPTR,0,,SPCNV2      Skip dummy zero entries
*      RCALL   ZPTR,GENVAR,ZPTR    Convert specifier to structure
*      PUTD    XPTR,XCL,ZPTR       Replace pointer to specifier
                                                             SPACE
SPCNV1   L     1,XCL                     . 00012A 5810 A408
         L     2,XPTR                    . 00012E 5820 A410
         LD    0,0(1,2)                  . 000132 6801 2000
         STD   0,ZPTR                    . 000136 6000 A440
         C     0,ZPTR                    . 00013A 5900 A440
         BE    SPCNV2                    . 00013E 4780 B160
         LA    14,S4$00162               . 000142 41E0 B150
         STM   11,14,104(12)             . 000146 90BE C068
         LR    13,12                     . 00014A 18DC
         STD   0,120(12)                 . 00014C 600C 0078
         LA    12,24(12)                 . 000150 41CC 0018
         C     12,@@STACKT               . 000154 59C0 A828
         BH    OVER                      . 000158 4720 9664
         L     11,@@GENVAR               . 00015C 58B0 A830
         BR    11                        . 000160 07FB
S4$00162 STD   0,ZPTR                    . 000162 6000 A440
         L     1,XCL                     . 000166 5810 A408
         L     2,XPTR                    . 00016A 5820 A410
         STD   0,0(1,2)                  . 00016E 6001 2000
                                                             SPACE
* SPCNV2 DECRA XCL,2*DESCR         Decrement to next pair
*      ACOMPC  XCL,0,SPCNV1        Continue if one remains
*      DECRA   YCL,DESCR           Decrement to next list
*      ACOMPC  YCL,0,SPCNVT        Continue if one remains
                                                             SPACE
SPCNV2   L     1,XCL                     . 000172 5810 A408
         SR    1,8                       . 000176 1B18
         SR    1,8                       . 000178 1B18
         ST    1,XCL                     . 00017A 5010 A408
         CR    0,1                       . 00017E 1901
         BL    SPCNV1                    . 000180 4740 B118
         L     1,YCL                     . 000184 5810 A420
         SR    1,8                       . 000188 1B18
         ST    1,YCL                     . 00018A 5010 A420
         CR    0,1                       . 00018E 1901
         BL    SPCNVT                    . 000190 4740 B0F8
                                                             SPACE
* INITD1 GETDC XPTR,INITB,0        Get specifier to convert
*      RCALL   YPTR,GENVAR,(XPTR)  Convert it to string structure
*      GETDC   ZPTR,INITB,DESCR    Get location to put it
*      PUTDC   ZPTR,0,YPTR         Place pointer to string structure
*      INCRA   INITB,2*DESCR       Decrement to next pair
*      ACOMP   INITB,INITE,,,INITD1
*                                  Compare with end
*
*      PUTDC   ABRTKY,DESCR,ABOPAT Initial value of ABORT
*      PUTDC   ARBKY,DESCR,ARBPAT  Initial value of ARB
*      PUTDC   BALKY,DESCR,BALPAT  Initial value of BAL
*      PUTDC   FAILKY,DESCR,FALPAT Initial value of FAIL
*      PUTDC   FNCEKY,DESCR,FNCPAT Initial value of FENCE
*      PUTDC   REMKY,DESCR,REMPAT  Initial value of REM
*      PUTDC   SUCCKY,DESCR,SUCPAT Initial value of SUCCEED
*
*      SETAC   VARSYM,0            Set count of variables to zero
*      RCALL   NBSPTR,BLOCK,NMOVER Allocate block for value assignment
*      MOVD    CMBSCL,SCBSCL       Set up pointer for compiler
*      MOVD    UNIT,INPUT          Set up input unit
*      MOVD    OCBSCL,CMBSCL       Project base for interpreter
*      SUM     OCLIM,CMBSCL,OCALIM Compute end of code block
*      DECRA   OCLIM,5*DESCR       Leave room for overflow
*      SETAC   INICOM,1            SIGNAL COMPLETION            E3.10.6
*      BRANCH  XLATRN
INITD1   L     1,INITB                   . 000194 5810 9DF0
         LD    0,0(1)                    . 000198 6801 0000
         STD   0,XPTR                    . 00019C 6000 A410
         LA    14,S4$001C0               . 0001A0 41E0 B1AE
         STM   11,14,104(12)             . 0001A4 90BE C068
         LR    13,12                     . 0001A8 18DC
         STD   0,120(12)                 . 0001AA 600C 0078
         LA    12,24(12)                 . 0001AE 41CC 0018
         C     12,@@STACKT               . 0001B2 59C0 A828
         BH    OVER                      . 0001B6 4720 9664
         L     11,@@GENVAR               . 0001BA 58B0 A830
         BR    11                        . 0001BE 07FB
S4$001C0 STD   0,YPTR                    . 0001C0 6000 A428
         L     1,INITB                   . 0001C4 5810 9DF0
         LM    1,2,8(1)                  . 0001C8 9812 1008
         STM   1,2,ZPTR                  . 0001CC 9012 A440
         STD   0,0(1)                    . 0001D0 6001 0000
         L     1,INITB                   . 0001D4 5810 9DF0
         LA    1,16(1)                   . 0001D8 4111 0010
         ST    1,INITB                   . 0001DC 5010 9DF0
         C     1,INITE                   . 0001E0 5910 9DF8
         BL    INITD1                    . 0001E4 4740 B182
         L     1,ABRTKY                  . 0001E8 5810 9928
         LD    0,ABOPAT                  . 0001EC 6800 9920
         STD   0,8(1)                    . 0001F0 6001 0008
         L     1,ARBKY                   . 0001F4 5810 98F8
         LD    0,ARBPAT                  . 0001F8 6800 98F0
         STD   0,8(1)                    . 0001FC 6001 0008
         L     1,BALKY                   . 000200 5810 9908
         LD    0,BALPAT                  . 000204 6800 9900
         STD   0,8(1)                    . 000208 6001 0008
         L     1,FAILKY                  . 00020C 5810 9938
         LD    0,FALPAT                  . 000210 6800 9930
         STD   0,8(1)                    . 000214 6001 0008
         L     1,FNCEKY                  . 000218 5810 9918
         LD    0,FNCPAT                  . 00021C 6800 9910
         STD   0,8(1)                    . 000220 6001 0008
         L     1,REMKY                   . 000224 5810 9948
         LD    0,REMPAT                  . 000228 6800 9940
         STD   0,8(1)                    . 00022C 6001 0008
         L     1,SUCCKY                  . 000230 5810 9958
         LD    0,SUCPAT                  . 000234 6800 9950
         STD   0,8(1)                    . 000238 6001 0008
         ST    0,VARSYM                  . 00023C 5000 9F20
         LA    14,S4$00264               . 000240 41E0 B252
         STM   11,14,104(12)             . 000244 90BE C068
         LR    13,12                     . 000248 18DC
         LD    0,NMOVER                  . 00024A 6800 9EC8
         STD   0,120(12)                 . 00024E 600C 0078
         LA    12,24(12)                 . 000252 41CC 0018
         C     12,@@STACKT               . 000256 59C0 A828
         BH    OVER                      . 00025A 4720 9664
         L     11,@@BLOCK                . 00025E 58B0 A82C
         BR    11                        . 000262 07FB
S4$00264 STD   0,NBSPTR                  . 000264 6000 A460
         LD    0,SCBSCL                  . 000268 6800 A490
         STD   0,CMBSCL                  . 00026C 6000 A458
         STD   0,OCBSCL                  . 000270 6000 A470
         LD    0,INPUT                   . 000274 6800 9A40
         STD   0,UNIT                    . 000278 6000 9F18
         LM    1,2,CMBSCL                . 00027C 9812 A458
         A     1,OCALIM                  . 000280 5A10 9C60
         S     1,@@5MDESC                . 000284 5B10 A834
         STM   1,2,OCLIM                 . 000288 9012 A478
         B     XLATRN                    . 00028C 47F0 B298
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Compilation and Interpreter Invocation'
* XLATRD AEQLC LISTCL,0,,XLATRN    Skip print if list is off
*      STPRNT  IOKEY,OUTBLK,LNBFSP Print line image
                                                             SPACE
XLATRD   C     0,LISTCL                  . 000290 5900 9BC8
         BE    XLATRN                    . 000294 4780 B298
         L     15,@@STPRNT               . 000298 58F0 A838
         LA    1,IOKEY                   . 00029C 4110 9EA0
         LA    2,OUTBLK                  . 0002A0 4120 9C70
         LA    3,LNBFSP                  . 0002A4 4130 9FC8
         BALR  14,15                          CALL                     *
                                         . 0002A8 05EF
                                                             SPACE
* XLATRN STREAD INBFSP,UNIT,XLATRN,COMP5
*      SETSP   TEXTSP,NEXTSP       Read card and set up line
*      STREAM  XSP,TEXTSP,CARDTB,COMP3,COMP3
*                                  Determine type of card
*      RCALL   ,NEWCRD,,(XLATRD,,) Process card type
                                                             SPACE
XLATRN   L     15,@@STREAD               . 0002AA 58F0 A83C
         LA    1,INBFSP                  . 0002AE 4110 9FB8
         LA    2,UNIT                    . 0002B2 4120 9F18
         BALR  14,15                          CALL                     *
                                         . 0002B6 05EF
         B     XLATRN                    . 0002B8 47F0 B298
         B     COMP5                     . 0002BC 47F0 95B4
         LM    1,4,NEXTSP                . 0002C0 9814 9FD8
         STM   1,4,TEXTSP                . 0002C4 9014 A590
         L     15,@@STREAM               . 0002C8 58F0 A840
         LA    1,XSP                     . 0002CC 4110 A5D0
         LA    2,TEXTSP                  . 0002D0 4120 A590
         L     3,@@CARDTB                . 0002D4 5830 A844
         BALR  14,15                          CALL                     *
                                         . 0002D8 05EF
         B     S4$010                    . 0002DA 47F0 95AC
         B     S4$010                    . 0002DE 47F0 95AC
         LA    14,S4$002FE               . 0002E2 41E0 B2EC
         STM   11,14,104(12)             . 0002E6 90BE C068
         LR    13,12                     . 0002EA 18DC
         LA    12,16(12)                 . 0002EC 41CC 0010
         C     12,@@STACKT               . 0002F0 59C0 A828
         BH    OVER                      . 0002F4 4720 9664
         L     11,@@NEWCRD               . 0002F8 58B0 A848
         BR    11                        . 0002FC 07FB
S4$002FE SR    0,0                       . 0002FE 1B00
         SR    0,0                       . 000300 1B00
         B     XLATRD                    . 000302 47F0 B27E
         B     XLATNX                    . 000306 47F0 B2FC
         B     XLATNX                    . 00030A 47F0 B2FC
                                                             SPACE
* XLATNX RCALL ,CMPILE,,(COMP3,,XLATNX)
*                                  Compile statement
*      INCRA   CMOFCL,DESCR        Increment offset
*      PUTD    CMBSCL,CMOFCL,ENDCL Insert END function
*      AEQLC   LISTCL,0,,XLATP     Skip print if list is off
*      STPRNT  IOKEY,OUTBLK,LNBFSP Print last line image
                                                             SPACE
XLATNX   LA    14,S4$0032A               . 00030E 41E0 B318
         STM   11,14,104(12)             . 000312 90BE C068
         LR    13,12                     . 000316 18DC
         LA    12,16(12)                 . 000318 41CC 0010
         C     12,@@STACKT               . 00031C 59C0 A828
         BH    OVER                      . 000320 4720 9664
         L     11,@@CMPILE               . 000324 58B0 A84C
         BR    11                        . 000328 07FB
S4$0032A SR    0,0                       . 00032A 1B00
         SR    0,0                       . 00032C 1B00
         B     S4$010                    . 00032E 47F0 95AC
         B     S4$0033A                  . 000332 47F0 B328
         B     XLATNX                    . 000336 47F0 B2FC
S4$0033A L     1,CMOFCL                  . 00033A 5810 9E28
         AR    1,8                       . 00033E 1A18
         ST    1,CMOFCL                  . 000340 5010 9E28
         L     2,CMBSCL                  . 000344 5820 A458
         LD    0,ENDCL                   . 000348 6800 9D20
         STD   0,0(1,2)                  . 00034C 6001 2000
         C     0,LISTCL                  . 000350 5900 9BC8
         BE    XLATP                     . 000354 4780 B358
         L     15,@@STPRNT               . 000358 58F0 A838
         LA    1,IOKEY                   . 00035C 4110 9EA0
         LA    2,OUTBLK                  . 000360 4120 9C70
         LA    3,LNBFSP                  . 000364 4130 9FC8
         BALR  14,15                          CALL                     *
                                         . 000368 05EF
                                                             SPACE
* XLATP AEQLC  STYPE,EOSTYP,,XLAEND
*                                  Finish on end of statement
*      STREAM  XSP,TEXTSP,IBLKTB,COMP3,XLAEND
*                                  Analyze END card
*      AEQLC   STYPE,EOSTYP,,XLAEND
*                                  Finish on end of statement
*      AEQLC   STYPE,NBTYP,COMP7   Error if break character
*      STREAM  XSP,TEXTSP,LBLTB,COMP7,COMP7
*                                  Analyze END label
*      RCALL   XPTR,GENVAR,(XSPPTR)
*                                  Generate variable for label
*      GETDC   OCBSCL,XPTR,ATTRIB  Get start for interpreter
*      AEQLC   OCBSCL,0,,COMP7     Error if not attribute
*      AEQLC   STYPE,EOSTYP,,XLAEND
*                                  Finish on end of statement
*      STREAM  XSP,TEXTSP,IBLKTB,COMP7,,COMP7
*                                  Analyze remainder of card
                                                             SPACE
XLATP    LA    6,6                       . 00036A 4160 0006
         C     6,STYPE                   . 00036E 5960 9F08
         BE    XLAEND                    . 000372 4780 B416
         L     15,@@STREAM               . 000376 58F0 A840
         LA    1,XSP                     . 00037A 4110 A5D0
         LA    2,TEXTSP                  . 00037E 4120 A590
         L     3,@@IBLKTB                . 000382 5830 A850
         BALR  14,15                          CALL                     *
                                         . 000386 05EF
         B     S4$010                    . 000388 47F0 95AC
         B     XLAEND                    . 00038C 47F0 B416
         LA    6,6                       . 000390 4160 0006
         C     6,STYPE                   . 000394 5960 9F08
         BE    XLAEND                    . 000398 4780 B416
         LA    6,1                       . 00039C 4160 0001
         C     6,STYPE                   . 0003A0 5960 9F08
         BNE   COMP7                     . 0003A4 4770 95BC
         L     15,@@STREAM               . 0003A8 58F0 A840
         LA    1,XSP                     . 0003AC 4110 A5D0
         LA    2,TEXTSP                  . 0003B0 4120 A590
         L     3,@@LBLTB                 . 0003B4 5830 A854
         BALR  14,15                          CALL                     *
                                         . 0003B8 05EF
         B     COMP7                     . 0003BA 47F0 95BC
         B     COMP7                     . 0003BE 47F0 95BC
         LA    14,S4$003E6               . 0003C2 41E0 B3D4
         STM   11,14,104(12)             . 0003C6 90BE C068
         LR    13,12                     . 0003CA 18DC
         LD    0,XSPPTR                  . 0003CC 6800 9F60
         STD   0,120(12)                 . 0003D0 600C 0078
         LA    12,24(12)                 . 0003D4 41CC 0018
         C     12,@@STACKT               . 0003D8 59C0 A828
         BH    OVER                      . 0003DC 4720 9664
         L     11,@@GENVAR               . 0003E0 58B0 A830
         BR    11                        . 0003E4 07FB
S4$003E6 STD   0,XPTR                    . 0003E6 6000 A410
         L     1,XPTR                    . 0003EA 5810 A410
         LD    0,16(1)                   . 0003EE 6801 0010
         STD   0,OCBSCL                  . 0003F2 6000 A470
         C     0,OCBSCL                  . 0003F6 5900 A470
         BE    COMP7                     . 0003FA 4780 95BC
         LA    6,6                       . 0003FE 4160 0006
         C     6,STYPE                   . 000402 5960 9F08
         BE    XLAEND                    . 000406 4780 B416
         L     15,@@STREAM               . 00040A 58F0 A840
         LA    1,XSP                     . 00040E 4110 A5D0
         LA    2,TEXTSP                  . 000412 4120 A590
         L     3,@@IBLKTB                . 000416 5830 A850
         BALR  14,15                          CALL                     *
                                         . 00041A 05EF
         B     COMP7                     . 00041C 47F0 95BC
         B     XLAEND                    . 000420 47F0 B416
         B     COMP7                     . 000424 47F0 95BC
                                                             SPACE
* XLAEND AEQLC ESAICL,0,,XLATSC    Were there any compilation errors?
*      OUTPUT  OUTPUT,ERRCF        Print message of errors
*      BRANCH  XLATND
                                                             SPACE
XLAEND   C     0,ESAICL                  . 000428 5900 9E60
         BE    XLATSC                    . 00042C 4780 B442
         STM   13,1,AISAVE               . 000430 90D1 A770
         L     13,@@SAVSAV               . 000434 58D0 A810
         L     15,@@IBCOM#               . 000438 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00043C 45EF 0004
         DC    X'01'                     . 000440 01
         DC    AL3(OUTPUT)               . 000441 00D068
         DC    X'01'                     . 000444 01
         DC    AL3(ERRCF)                . 000445 01413C
         BAL   14,16(15)                      CALL                     *
                                         . 000448 45EF 0010
         LM    13,1,AISAVE               . 00044C 98D1 A770
         B     XLATND                    . 000450 47F0 B462
                                                             SPACE
* XLATSC OUTPUT OUTPUT,SUCCF       Print message of no errors
                                                             SPACE
XLATSC   STM   13,1,AISAVE               . 000454 90D1 A770
         L     13,@@SAVSAV               . 000458 58D0 A810
         L     15,@@IBCOM#               . 00045C 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 000460 45EF 0004
         DC    X'01'                     . 000464 01
         DC    AL3(OUTPUT)               . 000465 00D068
         DC    X'01'                     . 000468 01
         DC    AL3(SUCCF)                . 000469 0143C2
         BAL   14,16(15)                      CALL                     *
                                         . 00046C 45EF 0010
         LM    13,1,AISAVE               . 000470 98D1 A770
                                                             SPACE
* XLATND SETAC UNIT,0              Reset input unit
*      SETAC   LPTR,0              Reset last label pointer
*      SETAC   OCLIM,0             Reset limit on object code
*      ZERBLK  COMREG,COMDCT       Clear compiler descriptors
*      SUM     XCL,CMBSCL,CMOFCL   Compute end of object code
*      RCALL   ,SPLIT,(XCL)        Split of unused part of block
*      SETAC   LISTCL,0            Turn off listing switch
*      MSTIME  ETMCL               Time out compiler
*      SUBTRT  TIMECL,ETMCL,TIMECL Compute elapsed time
*      SETAC   CNSLCL,1            Permit label redefinition
*      RCALL   ,INTERP,,(MAIN1,MAIN1,MAIN1)
*                                  Call interpreter
XLATND   ST    0,UNIT                    . 000474 5000 9F18
         ST    0,LPTR                    . 000478 5000 A3A0
         ST    0,OCLIM                   . 00047C 5000 A478
         L     1,COMREG                  . 000480 5810 9CA8
         L     5,COMDCT                  . 000484 5850 9CA0
         LR    4,8                       . 000488 1848
         LR    3,0                       . 00048A 1830
         LD    0,@@D0                    . 00048C 6800 A808
S4$00490 STD   0,0(3,1)                  . 000490 6003 1000
         BXLE  3,4,S4$00490              . 000494 8734 B47E
         LM    1,2,CMBSCL                . 000498 9812 A458
         A     1,CMOFCL                  . 00049C 5A10 9E28
         STM   1,2,XCL                   . 0004A0 9012 A408
         LA    14,S4$004C4               . 0004A4 41E0 B4B2
         STM   11,14,104(12)             . 0004A8 90BE C068
         LR    13,12                     . 0004AC 18DC
         STM   1,2,120(12)               . 0004AE 9012 C078
         LA    12,24(12)                 . 0004B2 41CC 0018
         C     12,@@STACKT               . 0004B6 59C0 A828
         BH    OVER                      . 0004BA 4720 9664
         L     11,@@SPLIT                . 0004BE 58B0 A858
         BR    11                        . 0004C2 07FB
S4$004C4 SR    0,0                       . 0004C4 1B00
         SR    0,0                       . 0004C6 1B00
         ST    0,LISTCL                  . 0004C8 5000 9BC8
         STM   13,1,AISAVE               . 0004CC 90D1 A770
         L     13,@@SAVSAV               . 0004D0 58D0 A810
         SR    1,1                       . 0004D4 1B11
         SVC   46                             TIMER                    *
                                         . 0004D6 0A2E
         L     3,MAXTIM                  . 0004D8 5830 A750
         SR    3,0                       . 0004DC 1B30
         M     2,@@F26                   . 0004DE 5C20 A820
         D     2,@@F1000                 . 0004E2 5D20 A824
         ST    3,ETMCL                   . 0004E6 5030 9E68
         LM    13,1,AISAVE               . 0004EA 98D1 A770
         ST    0,ETMCL$4                 . 0004EE 5000 9E6C
         LM    1,2,ETMCL                 . 0004F2 9812 9E68
         S     1,TIMECL                  . 0004F6 5B10 9B90
         STM   1,2,TIMECL                . 0004FA 9012 9B90
         LA    1,1                       . 0004FE 4110 0001
         ST    1,CUTNO                   . 000502 5010 9BA8
         LA    14,S4$00522               . 000506 41E0 B510
         STM   11,14,104(12)             . 00050A 90BE C068
         LR    13,12                     . 00050E 18DC
         LA    12,16(12)                 . 000510 41CC 0010
         C     12,@@STACKT               . 000514 59C0 A828
         BH    OVER                      . 000518 4720 9664
         L     11,@@INTERP               . 00051C 58B0 A85C
         BR    11                        . 000520 07FB
S4$00522 SR    0,0                       . 000522 1B00
         SR    0,0                       . 000524 1B00
         B     MAIN1                     . 000526 47F0 9644
         B     MAIN1                     . 00052A 47F0 9644
         B     MAIN1                     . 00052E 47F0 9644
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Support Procedures'
*
*      Augmentation of Pair Lists
*
                                                             SPACE
* AUGATL PROC  ,                   Procedure to augment pair lists
*      POP     (A1PTR,A2PTR,A3PTR) List, type and value
*      LOCAPT  A4PTR,A1PTR,ZEROCL,AUG1
*                                  Look for hole in list
*      PUTDC   A4PTR,DESCR,A2PTR   Insert type descriptor
*      PUTDC   A4PTR,2*DESCR,A3PTR Insert value descriptor
*      MOVD    A5PTR,A1PTR         Set up return pointer
*      BRANCH  A5RTN               Return pair list
                                                             SPACE
         USING AUGATL,11                 .
AUGATL   LD    0,96(12)                  . 000532 680C 0060
         STD   0,A1PTR                   . 000536 6000 A360
         LD    0,88(12)                  . 00053A 680C 0058
         STD   0,A2PTR                   . 00053E 6000 A368
         LD    0,80(12)                  . 000542 680C 0050
         STD   0,A3PTR                   . 000546 6000 A370
         S     12,@@3MDESC               . 00054A 5BC0 A860
         L     15,A1PTR                  . 00054E 58F0 A360
         L     5,4(15)                   . 000552 585F 0004
         LA    5,0(5,15)                 . 000556 4155 F000
         LR    4,8                       . 00055A 1848
         SR    5,4                       . 00055C 1B54
         AR    4,8                       . 00055E 1A48
S4$00560 CLC   8(8,15),ZEROCL            . 000560 D507 F008 9C90
         BE    S4$00572                  . 000566 4780 B040
         BXLE  15,4,S4$00560             . 00056A 87F4 B02E
         B     AUG1                      . 00056E 47F0 B05C
S4$00572 LD    0,A2PTR                   . 000572 6800 A368
         STD   0,8(15)                   . 000576 600F 0008
         LD    0,A3PTR                   . 00057A 6800 A370
         STD   0,16(15)                  . 00057E 600F 0010
         LD    0,A1PTR                   . 000582 6800 A360
         STD   0,A5PTR                   . 000586 6000 9E08
         B     A5RTN                     . 00058A 47F0 9084
                                                             SPACE
* AUG1 GETSIZ  A4PTR,A1PTR         Get size of present list
*      INCRA   A4PTR,2*DESCR       Add two more descriptors
*      SETVC   A4PTR,B             Insert BLOCK data type
*      RCALL   A5PTR,BLOCK,A4PTR   Allocate new block
*      PUTD    A5PTR,A4PTR,A3PTR   Insert value descriptor at end
*      DECRA   A4PTR,DESCR         Decrement
*      PUTD    A5PTR,A4PTR,A2PTR   Insert type descriptor above
                                                             SPACE
AUG1     L     15,A1PTR                  . 00058E 58F0 A360
         L     15,4(15)                  . 000592 58FF 0004
         LA    15,0(15)                  . 000596 41FF 0000
         STM   15,0,A4PTR                . 00059A 90F0 9E00
         LA    1,16(15)                  . 00059E 411F 0010
         ST    1,A4PTR                   . 0005A2 5010 9E00
         MVC   A4PTR$5(3),@@B            . 0005A6 D202 9E05 AA6C
         LA    14,S4$005D0               . 0005AC 41E0 B09E
         STM   11,14,104(12)             . 0005B0 90BE C068
         LR    13,12                     . 0005B4 18DC
         LD    0,A4PTR                   . 0005B6 6800 9E00
         STD   0,120(12)                 . 0005BA 600C 0078
         LA    12,24(12)                 . 0005BE 41CC 0018
         C     12,@@STACKT               . 0005C2 59C0 A828
         BH    OVER                      . 0005C6 4720 9664
         L     11,@@BLOCK                . 0005CA 58B0 A82C
         BR    11                        . 0005CE 07FB
S4$005D0 STD   0,A5PTR                   . 0005D0 6000 9E08
         L     1,A4PTR                   . 0005D4 5810 9E00
         L     2,A5PTR                   . 0005D8 5820 9E08
         LD    0,A3PTR                   . 0005DC 6800 A370
         STD   0,0(1,2)                  . 0005E0 6001 2000
         SR    1,8                       . 0005E4 1B18
         ST    1,A4PTR                   . 0005E6 5010 9E00
         LD    0,A2PTR                   . 0005EA 6800 A368
         STD   0,0(1,2)                  . 0005EE 6001 2000
                                                             SPACE
* AUGMOV DECRA A4PTR,DESCR         Adjust size
*      MOVBLK  A5PTR,A1PTR,A4PTR   Copy old list at top
*      BRANCH  A5RTN               Return new list
AUGMOV   L     1,A4PTR                   . 0005F2 5810 9E00
         SR    1,8                       . 0005F6 1B18
         ST    1,A4PTR                   . 0005F8 5010 9E00
         L     6,A5PTR                   . 0005FC 5860 9E08
         L     4,A1PTR                   . 000600 5840 A360
         AR    4,8                       . 000604 1A48
         AR    6,8                       . 000606 1A68
         LR    3,1                       . 000608 1831
         L     15,@@MOVTST               . 00060A 58F0 A864
         BALR  14,15                          CALL                     *
                                         . 00060E 05EF
         B     A5RTN                     . 000610 47F0 9084
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Code Skipping Procedure
*
                                                             SPACE
* CODSKP PROC  ,                   Procedure to skip object code
*      POP     YCL                 Restore number of items to skip
                                                             SPACE
         USING CODSKP,11                 .
CODSKP   LD    0,96(12)                  . 000614 680C 0060
         STD   0,YCL                     . 000618 6000 A420
         SR    12,8                      . 00061C 1BC8
                                                             SPACE
* CODCNT INCRA OCICL,DESCR         Increment offset
*      GETD    XCL,OCBSCL,OCICL    Get object code descriptor
*      TESTF   XCL,FNC,,CODFNC     Check for function
                                                             SPACE
CODCNT   L     1,OCICL                   . 00061E 5810 9ED8
         AR    1,8                       . 000622 1A18
         ST    1,OCICL                   . 000624 5010 9ED8
         L     2,OCBSCL                  . 000628 5820 A470
         LD    0,0(1,2)                  . 00062C 6801 2000
         STD   0,XCL                     . 000630 6000 A408
         TM    XCL$4,X'04'               . 000634 9104 A40C
         BO    CODFNC                    . 000638 4710 B040
                                                             SPACE
* CODECR DECRA YCL,1               Count down
*      ACOMPC  YCL,0,CODCNT,RTN1,INTR10
*                                  Check for end
                                                             SPACE
CODECR   L     1,YCL                     . 00063C 5810 A420
         BCTR  1,0                            DECREMENT                *
                                         . 000640 0610
         ST    1,YCL                     . 000642 5010 A420
         CR    0,1                       . 000646 1901
         BL    CODCNT                    . 000648 4740 B00A
         BE    FAIL                      . 00064C 4780 9010
         BH    S4$010                    . 000650 4720 95AC
                                                             SPACE
* CODFNC PUSH  YCL                 Save number to skip
*      SETAV   YCL,XCL             Get arguments to skip
*      RCALL   ,CODSKP,(YCL)       Call self recursively
*      POP     YCL                 Restore number to skip
*      BRANCH  CODECR              Go around again
CODFNC   LD    0,YCL                     . 000654 6800 A420
         STD   0,104(12)                 . 000658 600C 0068
         AR    12,8                      . 00065C 1AC8
         C     12,@@STACKT               . 00065E 59C0 A828
         BH    OVER                      . 000662 4720 9664
         L     15,XCL$4                  . 000666 58F0 A40C
         LA    15,0(15)                  . 00066A 41FF 0000
         STM   15,0,YCL                  . 00066E 90F0 A420
         LA    14,S4$00696               . 000672 41E0 B082
         STM   11,14,104(12)             . 000676 90BE C068
         LR    13,12                     . 00067A 18DC
         LD    0,YCL                     . 00067C 6800 A420
         STD   0,120(12)                 . 000680 600C 0078
         LA    12,24(12)                 . 000684 41CC 0018
         C     12,@@STACKT               . 000688 59C0 A828
         BH    OVER                      . 00068C 4720 9664
         L     11,@@CODSKP               . 000690 58B0 A868
         BR    11                        . 000694 07FB
S4$00696 SR    0,0                       . 000696 1B00
         SR    0,0                       . 000698 1B00
         LD    0,96(12)                  . 00069A 680C 0060
         STD   0,YCL                     . 00069E 6000 A420
         SR    12,8                      . 0006A2 1BC8
         B     CODECR                    . 0006A4 47F0 B028
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Data Type Representation
*
                                                             SPACE
* DTREP PROC   ,                   Procedure to represent data type
*      POP     A2PTR               Restore object
*      VEQLC   A2PTR,A,,DTARRY     Is is ARRAY?
*      VEQLC   A2PTR,T,,DTABLE     Is it TABLE?
*      VEQLC   A2PTR,R,DTREP1      Is it REAL?
*      REALST  DPSP,A2PTR          Convert REAL to STRING
*      BRANCH  DTREPR              Join end processing
                                                             SPACE
         USING DTREP,11                  .
DTREP    LD    0,96(12)                  . 0006A8 680C 0060
         STD   0,A2PTR                   . 0006AC 6000 A368
         SR    12,8                      . 0006B0 1BC8
         CLC   A2PTR$5(3),@@A            . 0006B2 D502 A36D AA6F
         BE    DTARRY                    . 0006B8 4780 B03A
         CLC   A2PTR$5(3),@@T            . 0006BC D502 A36D AA72
         BE    DTABLE                    . 0006C2 4780 B0C4
         CLC   A2PTR$5(3),@@R            . 0006C6 D502 A36D AA75
         BNE   DTREP1                    . 0006CC 4770 B158
         L     15,@@REALST               . 0006D0 58F0 A86C
         LA    5,DPSP                    . 0006D4 4150 A550
         LE    2,A2PTR                   . 0006D8 7820 A368
         BALR  14,15                          CALL                     *
                                         . 0006DC 05EF
         B     DTREPR                    . 0006DE 47F0 B1A8
                                                             SPACE
* DTARRY GETDC A3PTR,A2PTR,DESCR   Get prototype
*      LOCSP   ZSP,A3PTR           Get specifier
*      GETLG   A3PTR,ZSP           Get length
*      ACOMPC  A3PTR,ARRLEN,DTREP1 Check for excessive length
*      SETLC   DTARSP,0            Clear specifier
*      APDSP   DTARSP,ARRSP        Append ARRAY
*      APDSP   DTARSP,LPRNSP       Append '('
*      APDSP   DTARSP,QTSP         Append quote
*      APDSP   DTARSP,ZSP          Append prototype
*      APDSP   DTARSP,QTSP         Append quote
                                                             SPACE
DTARRY   L     1,A2PTR                   . 0006E2 5810 A368
         LM    3,4,8(1)                  . 0006E6 9834 1008
         STM   3,4,A3PTR                 . 0006EA 9034 A370
         CR    0,3                       . 0006EE 1903
         BNE   S4$006FC                  . 0006F0 4770 B054
         ST    0,ZSP                     . 0006F4 5000 A5F0
         B     S4$0070C                  . 0006F8 47F0 B064
S4$006FC L     1,4(3)                    . 0006FC 5813 0004
         LA    1,0(1)                    . 000700 4111 0000
         LA    2,32                      . 000704 4120 0020
         STM   1,4,ZSP                   . 000708 9014 A5F0
S4$0070C L     15,ZSP                    . 00070C 58F0 A5F0
         STM   15,0,A3PTR                . 000710 90F0 A370
         LA    1,20                      . 000714 4110 0014
         CR    1,15                      . 000718 191F
         BL    DTREP1                    . 00071A 4740 B158
         ST    0,DTARSP                  . 00071E 5000 A058
         L     15,@@APDSP                . 000722 58F0 A870
         LA    2,DTARSP                  . 000726 4120 A058
         LM    3,5,ARRSP                 . 00072A 9835 A0A8
         BALR  14,15                          CALL                     *
                                         . 00072E 05EF
         LA    2,DTARSP                  . 000730 4120 A058
         LM    3,5,LPRNSP                . 000734 9835 A158
         BALR  14,15                          CALL                     *
                                         . 000738 05EF
         LA    2,DTARSP                  . 00073A 4120 A058
         LM    3,5,QTSP                  . 00073E 9835 A078
         BALR  14,15                          CALL                     *
                                         . 000742 05EF
         LA    2,DTARSP                  . 000744 4120 A058
         LM    3,5,ZSP                   . 000748 9835 A5F0
         BALR  14,15                          CALL                     *
                                         . 00074C 05EF
         LA    2,DTARSP                  . 00074E 4120 A058
         LM    3,5,QTSP                  . 000752 9835 A078
         BALR  14,15                          CALL                     *
                                         . 000756 05EF
                                                             SPACE
* DTARTB APDSP DTARSP,RPRNSP       Append ')'
*      SETSP   DPSP,DTARSP         Move specifier
*      BRANCH  DTREPR              Return
                                                             SPACE
DTARTB   LA    2,DTARSP                  . 000758 4120 A058
         LM    3,5,RPRNSP                . 00075C 9835 A178
         BALR  14,15                          CALL                     *
                                         . 000760 05EF
         MVC   DPSP(16),DTARSP           . 000762 D20F A550 A058
         B     DTREPR                    . 000768 47F0 B1A8
                                                             SPACE
* DTABLE GETSIZ A3PTR,A2PTR                                     E3.2.3
*      GETD    A1PTR,A2PTR,A3PTR                                E3.2.3
*      DECRA   A3PTR,DESCR                                      E3.2.3
*      GETD    A2PTR,A2PTR,A3PTR                                E3.2.3
                                                             SPACE
DTABLE   L     2,A2PTR                   . 00076C 5820 A368
         L     3,4(2)                    . 000770 5832 0004
         LA    3,0(3)                    . 000774 4133 0000
         L     1,0(2,3)                  . 000778 5812 3000
         SR    2,8                       . 00077C 1B28
         L     2,0(2,3)                  . 00077E 5822 3000
                                                             SPACE
* DTABL1 AEQLC A1PTR,1,,DTABL2                                  E3.2.3
*      SUM     A3PTR,A3PTR,A2PTR                                E3.2.3
*      DECRA   A3PTR,2*DESCR                                    E3.2.3
*      GETD    A1PTR,A1PTR,A2PTR                                E3.2.3
*      BRANCH  DTABL1                                           E3.2.3
                                                             SPACE
DTABL1   C     1,@@F1                    . 000782 5910 A940
P@F1     BE    DTABL2                    . 000786 4780 B0F0
         AR    3,2                       . 00078A 1A32
         SR    3,8                       . 00078C 1B38
         SR    3,8                       . 00078E 1B38
         L     1,0(1,2)                  . 000790 5811 2000
         B     DTABL1                    . 000794 47F0 B0DA
                                                             SPACE
* DTABL2 DECRA A3PTR,DESCR                                      E3.2.3
*      DECRA   A2PTR,2*DESCR                                    E3.2.3
*      DIVIDE  A3PTR,A3PTR,DSCRTW  Divide to get item count
*      INTSPC  ZSP,A3PTR           Convert to string
*      SETLC   DTARSP,0            Clear specifier
*      APDSP   DTARSP,ASSCSP       Append TABLE
*      APDSP   DTARSP,LPRNSP       Append '('
*      APDSP   DTARSP,ZSP          Append size
*      APDSP   DTARSP,CMASP        Append comma
*      DIVIDE  A2PTR,A2PTR,DSCRTW                               E3.2.3
*      INTSPC  ZSP,A2PTR                                        E3.2.3
*      APDSP   DTARSP,ZSP          Append extent
*      BRANCH  DTARTB              Join common processing
                                                             SPACE
DTABL2   SR    3,8                       . 000798 1B38
         SR    2,8                       . 00079A 1B28
         SR    2,8                       . 00079C 1B28
         SRDA  2,4                       . 00079E 8E20 0004
         STM   2,3,VARSYM                . 0007A2 9023 9F20
         L     15,@@BDSPEC               . 0007A6 58F0 A874
         LA    2,VARSYM$4                . 0007AA 4120 9F24
         LA    1,ZSP                     . 0007AE 4110 A5F0
         BALR  14,15                          CALL                     *
                                         . 0007B2 05EF
         ST    0,DTARSP                  . 0007B4 5000 A058
         L     15,@@APDSP                . 0007B8 58F0 A870
         LA    1,DTARSP                  . 0007BC 4110 A058
         LR    2,1                       . 0007C0 1821
         LM    3,5,ASSCSP                . 0007C2 9835 A0B8
         BALR  14,15                          CALL                     *
                                         . 0007C6 05EF
         LR    2,1                       . 0007C8 1821
         LM    3,5,LPRNSP                . 0007CA 9835 A158
         BALR  14,15                          CALL                     *
                                         . 0007CE 05EF
         LR    2,1                       . 0007D0 1821
         LM    3,5,ZSP                   . 0007D2 9835 A5F0
         BALR  14,15                          CALL                     *
                                         . 0007D6 05EF
         LR    2,1                       . 0007D8 1821
         LM    3,5,CMASP                 . 0007DA 9835 A0E8
         BALR  14,15                          CALL                     *
                                         . 0007DE 05EF
         L     15,@@BDSPEC               . 0007E0 58F0 A874
         LA    2,VARSYM                  . 0007E4 4120 9F20
         LA    1,ZSP                     . 0007E8 4110 A5F0
         BALR  14,15                          CALL                     *
                                         . 0007EC 05EF
         L     15,@@APDSP                . 0007EE 58F0 A870
         LA    2,DTARSP                  . 0007F2 4120 A058
         LM    3,5,ZSP                   . 0007F6 9835 A5F0
         BALR  14,15                          CALL                     *
                                         . 0007FA 05EF
         B     DTARTB                    . 0007FC 47F0 B0B0
                                                             SPACE
* DTREP1 MOVV  DT1CL,A2PTR         Insert data type
*      LOCAPT  A3PTR,DTATL,DT1CL,DTREPE
*                                  Look for data type name
*      GETDC   A3PTR,A3PTR,2*DESCR Get data type name
*      LOCSP   DPSP,A3PTR          Get specifier
                                                             SPACE
DTREP1   MVC   DT1CL$5(3),A2PTR$5        . 000800 D202 9E4D A36D
         L     15,DTATL                  . 000806 58F0 A2F0
         L     5,4(15)                   . 00080A 585F 0004
         LA    5,0(5,15)                 . 00080E 4155 F000
         LR    4,8                       . 000812 1848
         SR    5,4                       . 000814 1B54
         AR    4,8                       . 000816 1A48
S4$00818 CLC   8(8,15),DT1CL             . 000818 D507 F008 9E48
         BE    S4$0082A                  . 00081E 4780 B182
         BXLE  15,4,S4$00818             . 000822 87F4 B170
         B     DTREPE                    . 000826 47F0 B1B8
S4$0082A LM    3,4,16(15)                . 00082A 9834 F010
         STM   3,4,A3PTR                 . 00082E 9034 A370
         CR    0,3                       . 000832 1903
         BNE   S4$00840                  . 000834 4770 B198
         ST    0,DPSP                    . 000838 5000 A550
         B     DTREPR                    . 00083C 47F0 B1A8
S4$00840 L     1,4(3)                    . 000840 5813 0004
         LA    1,0(1)                    . 000844 4111 0000
         LA    2,32                      . 000848 4120 0020
         STM   1,4,DPSP                  . 00084C 9014 A550
                                                             SPACE
* DTREPR RRTURN DPSPTR,1           Return pointer to specifier
                                                             SPACE
DTREPR   LD    0,DPSPTR                  . 000850 6800 9F58
         LM    11,14,104(13)             . 000854 98BE D068
         EX    0,0(14)                   . 000858 440E 0000
         B     4(14)                     . 00085C 47FE 0004
                                                             SPACE
* DTREPE SETSP DPSP,EXDTSP         Set up EXTERNAL specifier
*      BRANCH  DTREPR              Return
DTREPE   LM    1,4,EXDTSP                . 000860 9814 A128
         STM   1,4,DPSP                  . 000864 9014 A550
         B     DTREPR                    . 000868 47F0 B1A8
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Location of Function Descriptor
*
                                                             SPACE
* FINDEX PROC  ,                   Procedure to get function descriptor
*      POP     F1PTR               Restore name
*      LOCAPV  F2PTR,FNCPL,F1PTR,FATNF
*                                  Look for function pair
*      GETDC   F2PTR,F2PTR,DESCR   Get function descriptor
                                                             SPACE
         USING FINDEX,11                 .
FINDEX   LD    0,96(12)                  . 00086C 680C 0060
         STD   0,F1PTR                   . 000870 6000 A380
         SR    12,8                      . 000874 1BC8
         L     15,FNCPL                  . 000876 58F0 A2F8
         L     5,4(15)                   . 00087A 585F 0004
         LA    5,0(5,15)                 . 00087E 4155 F000
         LR    4,8                       . 000882 1848
         SR    5,4                       . 000884 1B54
         AR    4,8                       . 000886 1A48
S4$00888 CLC   16(8,15),F1PTR            . 000888 D507 F010 A380
         BE    S4$0089A                  . 00088E 4780 B02E
         BXLE  15,4,S4$00888             . 000892 87F4 B01C
         B     FATNF                     . 000896 47F0 B046
S4$0089A LD    0,8(15)                   . 00089A 680F 0008
         STD   0,F2PTR                   . 00089E 6000 A388
                                                             SPACE
* FATBAK RRTURN F2PTR,1            Return
                                                             SPACE
FATBAK   LD    0,F2PTR                   . 0008A2 6800 A388
         LM    11,14,104(13)             . 0008A6 98BE D068
         EX    0,0(14)                   . 0008AA 440E 0000
         B     4(14)                     . 0008AE 47FE 0004
                                                             SPACE
* FATNF INCRA  NEXFCL,2*DESCR      Increment function block offset
*      ACOMPC  NEXFCL,FBLKSZ,FATBLK
*                                  Check for end
                                                             SPACE
FATNF    L     1,NEXFCL                  . 0008B2 5810 9E80
         LA    1,16(1)                   . 0008B6 4111 0010
         ST    1,NEXFCL                  . 0008BA 5010 9E80
         LA    1,80                      . 0008BE 4110 0050
         C     1,NEXFCL                  . 0008C2 5910 9E80
         BL    FATBLK                    . 0008C6 4740 B0B6
                                                             SPACE
* FATNXT SUM   F2PTR,FBLOCK,NEXFCL Compute position
*      RCALL   FNCPL,AUGATL,(FNCPL,F2PTR,F1PTR)
*                                  Augment function pair list
*      PUTDC   F2PTR,0,UNDFCL      Insert undefined function
*      PUTDC   F2PTR,DESCR,F1PTR   Insert name
*      BRANCH  FATBAK              Join return
                                                             SPACE
FATNXT   LM    1,2,FBLOCK                . 0008CA 9812 A468
         A     1,NEXFCL                  . 0008CE 5A10 9E80
         STM   1,2,F2PTR                 . 0008D2 9012 A388
         LA    14,S4$00906               . 0008D6 41E0 B09A
         STM   11,14,104(12)             . 0008DA 90BE C068
         LR    13,12                     . 0008DE 18DC
         LD    0,FNCPL                   . 0008E0 6800 A2F8
         STD   0,136(12)                 . 0008E4 600C 0088
         STM   1,2,128(12)               . 0008E8 9012 C080
         LD    0,F1PTR                   . 0008EC 6800 A380
         STD   0,120(12)                 . 0008F0 600C 0078
         LA    12,40(12)                 . 0008F4 41CC 0028
         C     12,@@STACKT               . 0008F8 59C0 A828
         BH    OVER                      . 0008FC 4720 9664
         L     11,@@AUGATL               . 000900 58B0 A878
         BR    11                        . 000904 07FB
S4$00906 STD   0,FNCPL                   . 000906 6000 A2F8
         L     1,F2PTR                   . 00090A 5810 A388
         LD    0,UNDFCL                  . 00090E 6800 9F50
         STD   0,0(1)                    . 000912 6001 0000
         LD    0,F1PTR                   . 000916 6800 A380
         STD   0,8(1)                    . 00091A 6001 0008
         B     FATBAK                    . 00091E 47F0 B036
                                                             SPACE
* FATBLK RCALL FBLOCK,BLOCK,FBLKRQ Allocate new function block
*      SETF    FBLOCK,FNC          Insert function flag
*      SETVC   FBLOCK,0            Clear data type
*      SETAC   NEXFCL,DESCR        Initialize offset
*      BRANCH  FATNXT              Join processing
FATBLK   LA    14,S4$00946               . 000922 41E0 B0DA
         STM   11,14,104(12)             . 000926 90BE C068
         LR    13,12                     . 00092A 18DC
         LD    0,FBLKRQ                  . 00092C 6800 9C28
         STD   0,120(12)                 . 000930 600C 0078
         LA    12,24(12)                 . 000934 41CC 0018
         C     12,@@STACKT               . 000938 59C0 A828
         BH    OVER                      . 00093C 4720 9664
         L     11,@@BLOCK                . 000940 58B0 A82C
         BR    11                        . 000944 07FB
S4$00946 STD   0,FBLOCK                  . 000946 6000 A468
         OI    FBLOCK$4,X'04'            . 00094A 9604 A46C
         MVC   FBLOCK$5(3),@@0           . 00094E D202 A46D AA78
         L     1,@@DESCR                 . 000954 5810 A87C
         ST    1,NEXFCL                  . 000958 5010 9E80
         B     FATNXT                    . 00095C 47F0 B05E
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Storage Allocation and Regeneration Procedures'
*
*      Allocation of Block
*
                                                             SPACE
* BLOCK PROC   ,                   Procedure to allocate blocks
*      POP     ARG1CL              Restore size to allocate
*      ACOMP   ARG1CL,SIZLMT,SIZERR,SIZERR
*                                  Check against size limit
                                                             SPACE
         USING BLOCK,11                  .
BLOCK    LD    0,96(12)                  . 000960 680C 0060
         STD   0,ARG1CL                  . 000964 6000 A600
         SR    12,8                      . 000968 1BC8
         L     1,ARG1CL                  . 00096A 5810 A600
         C     1,SIZLMT                  . 00096E 5910 9C78
         BNL   SIZERR                    . 000972 47B0 9694
                                                             SPACE
* BLOCK1 MOVD  BLOCL,FRSGPT        Position pointer to title
*      MOVV    BLOCL,ARG1CL        Move data type
*      INCRA   FRSGPT,DESCR        Leave room for title
*      SUM     FRSGPT,FRSGPT,ARG1CL
*                                  Move position pointer past end
*      ACOMP   TLSGP1,FRSGPT,,,BLOGC
*                                  Check for end of region
*      ZERBLK  BLOCL,ARG1CL        Clear block
*      PUTAC   BLOCL,0,BLOCL       Set up self-pointer in title
*      SETFI   BLOCL,TTL           Insert title flag
*      SETSIZ  BLOCL,ARG1CL        Insert block size
*      RRTURN  BLOCL,1             Return pointer to block
                                                             SPACE
BLOCK1   LM    1,2,FRSGPT                . 000976 9812 A728
         STM   1,2,BLOCL                 . 00097A 9012 A668
         MVC   BLOCL$5(3),ARG1CL$5       . 00097E D202 A66D A605
         AR    1,8                       . 000984 1A18
         A     1,ARG1CL                  . 000986 5A10 A600
         ST    1,FRSGPT                  . 00098A 5010 A728
         C     1,TLSGP1                  . 00098E 5910 A738
         BNL   S4$009D6                  . 000992 47B0 B076
         L     1,BLOCL                   . 000996 5810 A668
         L     5,ARG1CL                  . 00099A 5850 A600
         LR    4,8                       . 00099E 1848
         LR    3,0                       . 0009A0 1830
         LD    0,@@D0                    . 0009A2 6800 A808
S4$009A6 STD   0,0(3,1)                  . 0009A6 6003 1000
         BXLE  3,4,S4$009A6              . 0009AA 8734 B046
         L     1,BLOCL                   . 0009AE 5810 A668
         LR    2,1                       . 0009B2 1821
         ST    2,0(1)                    . 0009B4 5021 0000
         OI    4(1),X'01'                . 0009B8 9601 1004
         L     1,BLOCL                   . 0009BC 5810 A668
         MVC   5(3,1),ARG1CL$1           . 0009C0 D202 1005 A601
         LD    0,BLOCL                   . 0009C6 6800 A668
         LM    11,14,104(13)             . 0009CA 98BE D068
         EX    0,0(14)                   . 0009CE 440E 0000
         B     4(14)                     . 0009D2 47FE 0004
S4$009D6 L     1,BLOCL                   . 0009D6 5810 A668
         ST    1,FRSGPT                  . 0009DA 5010 A728
         LA    14,BLOGC                  . 0009DE 41E0 B0A2
         STM   11,14,104(12)             . 0009E2 90BE C068
         LR    13,12                     . 0009E6 18DC
         LD    0,ARG1CL                  . 0009E8 6800 A600
         STD   0,120(12)                 . 0009EC 600C 0078
         LA    12,24(12)                 . 0009F0 41CC 0018
         C     12,@@STACKT               . 0009F4 59C0 A828
         BH    OVER                      . 0009F8 4720 9664
         L     11,@@GC                   . 0009FC 58B0 A880
         BR    11                        . 000A00 07FB
                                                             SPACE
* BLOGC MOVA   FRSGPT,BLOCL        Restore position pointer
*      RCALL   ,GC,(ARG1CL),(ALOC2,BLOCK1)
*                                  Regenerate storage
BLOGC    SR    0,0                       . 000A02 1B00
         SR    0,0                       . 000A04 1B00
         B     ALOC2                     . 000A06 47F0 9594
         B     BLOCK1                    . 000A0A 47F0 B016
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Generation of Natural Variables
*
                                                             SPACE
* GENVAR PROC  ,                   Procedure to generate variable
*      SETAC   CONVSW,0            Note GENVAR entry
*      POP     AXPTR               Resotre pointer to specifier
*      GETSPC  SPECR1,AXPTR,0      Get specifier
*      LEQLC   SPECR1,0,,RT1NUL    Avoid null string
                                                             SPACE
         USING GENVAR,11                 .
GENVAR   ST    0,CONVSW                  . 000A0E 5000 A670
         LD    0,96(12)                  . 000A12 680C 0060
         STD   0,AXPTR                   . 000A16 6000 A618
         SR    12,8                      . 000A1A 1BC8
         L     1,AXPTR                   . 000A1C 5810 A618
         LM    1,4,0(1)                  . 000A20 9814 1000
         STM   1,4,SPECR1                . 000A24 9014 A620
         C     0,SPECR1                  . 000A28 5900 A620
         BE    S4$0                      . 000A2C 4780 9000
                                                             SPACE
* LOCA1 VARID  EQUVCL,SPECR1       Compute bin and ascension numbers
*      SUM     BUKPTR,OBPTR,EQUVCL Find bin
                                                             SPACE
LOCA1    LA    1,EQUVCL                  . 000A30 4110 A688
         LR    6,1                       . 000A34 1861
         LM    2,4,SPECR1                . 000A36 9824 A620
         LR    7,2                       . 000A3A 1872
         LA    4,0(3,4)                  . 000A3C 4143 4000
         C     7,@@F4                    . 000A40 5970 A884
         BH    S4$00A70                  . 000A44 4720 B062
         ST    0,4(6)                    . 000A48 5006 0004
         LR    2,6                       . 000A4C 1826
         SR    2,7                       . 000A4E 1B27
         BCTR  7,0                            DECREMENT                *
                                         . 000A50 0670
         EX    7,S4$00A5E                . 000A52 4470 B050
         L     5,4(6)                    . 000A56 5856 0004
         B     S4$00AAE                  . 000A5A 47F0 B0A0
S4$00A5E MVC   8(1,2),0(4)               . 000A5E D200 2008 4000
S4$00A64 TRT   0(1,4),0(2)               . 000A64 DD00 4000 2000
         MVC   0(1,6),0(1)               . 000A6A D200 6000 1000
S4$00A70 CR    7,8                       . 000A70 1978
         BH    S4$00A92                  . 000A72 4720 B084
         LA    2,0(7,4)                  . 000A76 4127 4000
         S     2,@@F4                    . 000A7A 5B20 A884
         MVC   4(4,6),0(2)               . 000A7E D203 6004 2000
         MVC   0(4,6),0(4)               . 000A84 D203 6000 4000
         L     5,0(6)                    . 000A8A 5856 0000
         B     S4$00AAE                  . 000A8E 47F0 B0A0
S4$00A92 S     7,@@8P1                   . 000A92 5B70 A888
         LR    1,4                       . 000A96 1814
         L     2,@@FRWDTB                . 000A98 5820 A88C
         EX    7,S4$00A64                . 000A9C 4470 B056
         MVC   0(8,6),0(1)               . 000AA0 D207 6000 1000
         L     5,0(6)                    . 000AA6 5856 0000
         IC    5,8(4,7)                  . 000AAA 4354 7008
S4$00AAE LR    4,5                       . 000AAE 1845
         SRDL  4,19                      . 000AB0 8C40 0013
         M     4,4(6)                    . 000AB4 5C46 0004
         SLDL  4,11                      . 000AB8 8D40 000B
         SLL   7,24                      . 000ABC 8970 0018
         ALR   5,7                       . 000AC0 1E57
         SRL   5,24                      . 000AC2 8850 0018
         SLL   5,3                       . 000AC6 8950 0003
         ST    5,0(6)                    . 000ACA 5056 0000
         ST    4,4(6)                    . 000ACE 5046 0004
         LM    1,2,OBPTR                 . 000AD2 9812 A6D8
         A     1,EQUVCL                  . 000AD6 5A10 A688
         STM   1,2,BUKPTR                . 000ADA 9012 A608
                                                             SPACE
* LOCA2 MOVD   LSTPTR,BUKPTR       Save working copy
*      GETAC   BUKPTR,BUKPTR,LNKFLD
*                                  Get link descriptor
*      AEQLC   BUKPTR,0,,LOCA5     Check for end of chain
*      VCMPIC  BUKPTR,LNKFLD,EQUVCL,LOCA5,,LOCA2
*                                  Compare ascension numbers
*      LOCSP   SPECR2,BUKPTR       Get specifier to string in storage
*      LEXCMP  SPECR1,SPECR2,LOCA2,,LOCA2
*                                  Compare strings
*      MOVD    LCPTR,BUKPTR        Return string in storage
*      BRANCH  LOCRET
                                                             SPACE
LOCA2    L     1,BUKPTR                  . 000ADE 5810 A608
S4$00AE2 ST    1,LSTPTR                  . 000AE2 5010 A610
         L     1,24(1)                   . 000AE6 5811 0018
         CR    0,1                       . 000AEA 1901
         BE    LOCA5                     . 000AEC 4780 B126
         L     6,28(1)                   . 000AF0 5861 001C
         C     6,EQUVCL$4                . 000AF4 5960 A68C
         BH    LOCA5                     . 000AF8 4720 B126
         BL    S4$00AE2                  . 000AFC 4740 B0D4
         L     5,4(1)                    . 000B00 5851 0004
         LA    5,0(5)                    . 000B04 4155 0000
         C     5,SPECR1                  . 000B08 5950 A620
         BNE   S4$00AE2                  . 000B0C 4770 B0D4
         LA    6,32                      . 000B10 4160 0020
         LR    7,1                       . 000B14 1871
         LM    2,4,SPECR1                . 000B16 9824 A620
         ST    1,BUKPTR                  . 000B1A 5010 A608
         L     15,@@SPECEQ               . 000B1E 58F0 A890
         BALR  14,15                          CALL                     *
                                         . 000B22 05EF
         B     LOCA2                     . 000B24 47F0 B0D0
         LD    0,BUKPTR                  . 000B28 6800 A608
         STD   0,LCPTR                   . 000B2C 6000 A6C0
         B     LOCRET                    . 000B30 47F0 B1F2
                                                             SPACE
* LOCA5 GETLG  AXPTR,SPECR1        Get length of string
*      GETLTH  BKLTCL,AXPTR        Compute space required
*      ACOMP   BKLTCL,SIZLMT,SIZERR
*                                  Check against size limit
                                                             SPACE
LOCA5    ST    1,BUKPTR                  . 000B34 5010 A608
         L     15,SPECR1                 . 000B38 58F0 A620
         STM   15,0,AXPTR                . 000B3C 90F0 A618
         L     15,AXPTR                  . 000B40 58F0 A618
         LA    15,31(15)                 . 000B44 41FF 001F
         SRL   15,3                      . 000B48 88F0 0003
         SLA   15,3                      . 000B4C 8BF0 0003
         STM   15,0,BKLTCL               . 000B50 90F0 A658
         C     15,SIZLMT                 . 000B54 59F0 9C78
         BH    SIZERR                    . 000B58 4720 9694
                                                             SPACE
* LOCA7 MOVD   LCPTR,FRSGPT        Point to position in storage
*      SETVC   LCPTR,S             Set data type to STRING
*      INCRA   FRSGPT,DESCR        Leave space for title
*      SUM     FRSGPT,FRSGPT,BKLTCL
*                                  Skip required space
*      ACOMP   TLSGP1,FRSGPT,,,LOCA4
*                                  Check for end of region
*      PUTDC   LCPTR,0,ZEROCL      Clear title
*      PUTAC   LCPTR,0,LCPTR       Point title to self
*      SETFI   LCPTR,TTL+STTL      Set string and title flags
*      SETSIZ  LCPTR,AXPTR         Insert size of string
*      AEQLC   CONVSW,0,LOCA6      Check for GENVAR entry
*      PUTDC   LCPTR,DESCR,NULVCL  Set value to null string
*      PUTDC   LCPTR,ATTRIB,ZEROCL Set label attribute to zero
*      LOCSP   SPECR2,LCPTR        Get specifier to string structure
*      SETLC   SPECR2,0            Clear length
*      APDSP   SPECR2,SPECR1       Move new string in
                                                             SPACE
LOCA7    LD    0,FRSGPT                  . 000B5C 6800 A728
         STD   0,LCPTR                   . 000B60 6000 A6C0
         MVC   LCPTR$5(3),@@S            . 000B64 D202 A6C5 AA7B
         L     1,FRSGPT                  . 000B6A 5810 A728
         AR    1,8                       . 000B6E 1A18
         A     1,BKLTCL                  . 000B70 5A10 A658
         ST    1,FRSGPT                  . 000B74 5010 A728
         C     1,TLSGP1                  . 000B78 5910 A738
         BNL   LOCA4                     . 000B7C 47B0 B202
         L     1,LCPTR                   . 000B80 5810 A6C0
         LD    0,ZEROCL                  . 000B84 6800 9C90
         STD   0,0(1)                    . 000B88 6001 0000
         ST    1,0(1)                    . 000B8C 5011 0000
         OI    4(1),X'03'                . 000B90 9603 1004
         MVC   5(3,1),AXPTR$1            . 000B94 D202 1005 A619
         C     0,CONVSW                  . 000B9A 5900 A670
         BNE   LOCA6                     . 000B9E 4770 B1CE
         LD    0,NULVCL                  . 000BA2 6800 9ED0
         STD   0,8(1)                    . 000BA6 6001 0008
         L     1,LCPTR                   . 000BAA 5810 A6C0
         LD    0,ZEROCL                  . 000BAE 6800 9C90
         STD   0,16(1)                   . 000BB2 6001 0010
         LM    3,4,LCPTR                 . 000BB6 9834 A6C0
         L     1,4(3)                    . 000BBA 5813 0004
         LA    1,0(1)                    . 000BBE 4111 0000
         LA    2,32                      . 000BC2 4120 0020
         STM   1,4,SPECR2                . 000BC6 9014 A630
         ST    0,SPECR2                  . 000BCA 5000 A630
         L     15,@@APDSP                . 000BCE 58F0 A870
         LA    2,SPECR2                  . 000BD2 4120 A630
         LM    3,5,SPECR1                . 000BD6 9835 A620
         BALR  14,15                          CALL                     *
                                         . 000BDA 05EF
                                                             SPACE
* LOCA6 PUTVC  LCPTR,LNKFLD,EQUVCL Insert ascension number
*      PUTAC   LCPTR,LNKFLD,BUKPTR Insert link pointer
*      PUTAC   LSTPTR,LNKFLD,LCPTR Link to last structure
*      INCRA   VARSYM,1            Increment count of new variables
                                                             SPACE
LOCA6    L     1,LCPTR                   . 000BDC 5810 A6C0
         L     2,EQUVCL$4                . 000BE0 5820 A68C
         ST    2,28(1)                   . 000BE4 5021 001C
         L     1,LCPTR                   . 000BE8 5810 A6C0
         L     2,BUKPTR                  . 000BEC 5820 A608
         ST    2,24(1)                   . 000BF0 5021 0018
         L     1,LSTPTR                  . 000BF4 5810 A610
         L     2,LCPTR                   . 000BF8 5820 A6C0
         ST    2,24(1)                   . 000BFC 5021 0018
                                                             SPACE
* LOCRET RRTURN LCPTR,1            Return pointer to structure
                                                             SPACE
LOCRET   LD    0,LCPTR                   . 000C00 6800 A6C0
         LM    11,14,104(13)             . 000C04 98BE D068
         EX    0,0(14)                   . 000C08 440E 0000
         B     4(14)                     . 000C0C 47FE 0004
                                                             SPACE
* LOCA4 MOVA   FRSGPT,LCPTR        Restore position pointer
*      RCALL   ,GC,(BKLTCL),(ALOC2,LOCA7)
*                                  Regenerate storage
LOCA4    L     1,LCPTR                   . 000C10 5810 A6C0
         ST    1,FRSGPT                  . 000C14 5010 A728
         LA    14,S4$00C3C               . 000C18 41E0 B22E
         STM   11,14,104(12)             . 000C1C 90BE C068
         LR    13,12                     . 000C20 18DC
         LD    0,BKLTCL                  . 000C22 6800 A658
         STD   0,120(12)                 . 000C26 600C 0078
         LA    12,24(12)                 . 000C2A 41CC 0018
         C     12,@@STACKT               . 000C2E 59C0 A828
         BH    OVER                      . 000C32 4720 9664
         L     11,@@GC                   . 000C36 58B0 A880
         BR    11                        . 000C3A 07FB
S4$00C3C SR    0,0                       . 000C3C 1B00
         SR    0,0                       . 000C3E 1B00
         B     ALOC2                     . 000C40 47F0 9594
         B     LOCA7                     . 000C44 47F0 B14E
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Generation of Variable from Integer
*
                                                             SPACE
* GNVARI PROC  GENVAR              Procedure to generate string
*      SETAC   CONVSW,0            Note GENVAR entry
*      POP     AXPTR               Restore integer
*      INTSPC  SPECR1,AXPTR        Convert to string
*      BRANCH  LOCA1               Join processing
GNVARI   L     11,@@GENVAR               . 000C48 58B0 A830
         ST    0,CONVSW                  . 000C4C 5000 A670
         LD    0,96(12)                  . 000C50 680C 0060
         STD   0,AXPTR                   . 000C54 6000 A618
         SR    12,8                      . 000C58 1BC8
         L     15,@@BDSPEC               . 000C5A 58F0 A874
         LA    1,SPECR1                  . 000C5E 4110 A620
         LA    2,AXPTR                   . 000C62 4120 A618
         BALR  14,15                          CALL                     *
                                         . 000C66 05EF
         B     LOCA1                     . 000C68 47F0 B022
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Allocation of Space for Variable
*
                                                             SPACE
* CONVAR PROC  GENVAR              Procedure to get space for variable
*      POP     AXPTR               Restore length
*      AEQLC   AXPTR,0,,RT1NUL     Avoid null string
*      SETAC   CONVSW,1            Note CONVAR entry
*      GETLTH  BKLTCL,AXPTR        Get space required
*      ACOMP   BKLTCL,SIZLMT,SIZERR
*                                  Check against size limit
*      SUM     TEMPCL,FRSGPT,BKLTCL
*                                  Skip required space
*      INCRA   TEMPCL,DESCR        Save space for title
*      ACOMP   TLSGP1,TEMPCL,,,CONVR4
*                                  Check for end of region
                                                             SPACE
CONVAR   L     11,@@GENVAR               . 000C6C 58B0 A830
         LD    0,96(12)                  . 000C70 680C 0060
         STD   0,AXPTR                   . 000C74 6000 A618
         SR    12,8                      . 000C78 1BC8
         C     0,AXPTR                   . 000C7A 5900 A618
         BE    S4$0                      . 000C7E 4780 9000
         LA    1,1                       . 000C82 4110 0001
         ST    1,CONVSW                  . 000C86 5010 A670
         L     15,AXPTR                  . 000C8A 58F0 A618
         LA    15,31(15)                 . 000C8E 41FF 001F
         SRL   15,3                      . 000C92 88F0 0003
         SLA   15,3                      . 000C96 8BF0 0003
         STM   15,0,BKLTCL               . 000C9A 90F0 A658
         C     15,SIZLMT                 . 000C9E 59F0 9C78
         BH    SIZERR                    . 000CA2 4720 9694
         LM    1,2,FRSGPT                . 000CA6 9812 A728
         A     1,BKLTCL                  . 000CAA 5A10 A658
         AR    1,8                       . 000CAE 1A18
         STM   1,2,TEMPCL                . 000CB0 9012 A708
         C     1,TLSGP1                  . 000CB4 5910 A738
         BNL   CONVR4                    . 000CB8 47B0 B2EE
                                                             SPACE
* CONVR5 PUTDC FRSGPT,0,ZEROCL     Clear title
*      PUTAC   FRSGPT,0,FRSGPT     Set up self pointer
*      SETFI   FRSGPT,TTL+STTL     Set string and title flags
*      SETSIZ  FRSGPT,AXPTR        Insert tentative size of string
*      PUTDC   FRSGPT,DESCR,NULVCL Insert null string as value
*      PUTDC   FRSGPT,ATTRIB,ZEROCL
*                                  Set label to zero
*      MOVA    BKLTCL,FRSGPT                                    E3.3.2
*      RRTURN  BKLTCL,1                                         E3.3.2
                                                             SPACE
CONVR5   L     1,FRSGPT                  . 000CBC 5810 A728
         LD    0,ZEROCL                  . 000CC0 6800 9C90
         STD   0,0(1)                    . 000CC4 6001 0000
         LR    2,1                       . 000CC8 1821
         ST    2,0(1)                    . 000CCA 5021 0000
         OI    4(1),X'03'                . 000CCE 9603 1004
         L     1,FRSGPT                  . 000CD2 5810 A728
         MVC   5(3,1),AXPTR$1            . 000CD6 D202 1005 A619
         ST    1,BKLTCL                  . 000CDC 5010 A658
         MVC   8(8,1),NULVCL             . 000CE0 D207 1008 9ED0
         MVC   16(8,1),ZEROCL            . 000CE6 D207 1010 9C90
         LD    0,BKLTCL                  . 000CEC 6800 A658
         LM    11,14,104(13)             . 000CF0 98BE D068
         EX    0,0(14)                   . 000CF4 440E 0000
         B     4(14)                     . 000CF8 47FE 0004
                                                             SPACE
* CONVR4 RCALL ,GC,BKLTCL,(ALOC2,CONVR5)
*                                  Regenerate storage
CONVR4   LA    14,S4$00D20               . 000CFC 41E0 B312
         STM   11,14,104(12)             . 000D00 90BE C068
         LR    13,12                     . 000D04 18DC
         LD    0,BKLTCL                  . 000D06 6800 A658
         STD   0,120(12)                 . 000D0A 600C 0078
         LA    12,24(12)                 . 000D0E 41CC 0018
         C     12,@@STACKT               . 000D12 59C0 A828
         BH    OVER                      . 000D16 4720 9664
         L     11,@@GC                   . 000D1A 58B0 A880
         BR    11                        . 000D1E 07FB
S4$00D20 SR    0,0                       . 000D20 1B00
         SR    0,0                       . 000D22 1B00
         B     ALOC2                     . 000D24 47F0 9594
         B     CONVR5                    . 000D28 47F0 B2AE
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Generation of Variable in Place
*
                                                             SPACE
* GNVARS PROC  GENVAR              Procedure to entry string
*      POP     AXPTR               Restore length
*      AEQLC   AXPTR,0,,RT1NUL     Avoid null string
*      LOCSP   SPECR1,FRSGPT       Get specifier to position
*      PUTLG   SPECR1,AXPTR        Insert final length
*      SETSIZ  FRSGPT,AXPTR        Insert size in title
*      BRANCH  LOCA1               Join processing
GNVARS   L     11,@@GENVAR               . 000D2C 58B0 A830
         LD    0,96(12)                  . 000D30 680C 0060
         STD   0,AXPTR                   . 000D34 6000 A618
         SR    12,8                      . 000D38 1BC8
         C     0,AXPTR                   . 000D3A 5900 A618
         BE    S4$0                      . 000D3E 4780 9000
         LM    3,4,FRSGPT                . 000D42 9834 A728
         L     1,4(3)                    . 000D46 5813 0004
         LA    1,0(1)                    . 000D4A 4111 0000
         LA    2,32                      . 000D4E 4120 0020
         STM   1,4,SPECR1                . 000D52 9014 A620
         L     1,AXPTR                   . 000D56 5810 A618
         ST    1,SPECR1                  . 000D5A 5010 A620
         L     1,FRSGPT                  . 000D5E 5810 A728
         MVC   5(3,1),AXPTR$1            . 000D62 D202 1005 A619
         B     LOCA1                     . 000D68 47F0 B022
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Storage Regeneration
*
                                                             SPACE
* GC   PROC    ,                   Storage regeneration procedure
*      POP     GCREQ               Restore space required
*      PSTACK  BLOCL               Post stack position
*      SUBTRT  BLOCL,BLOCL,STKPTR  Compute stack length used
*      SETSIZ  STKPTR,BLOCL        Set stack size
*      MOVD    BKDXU,PRMDX         Number of resident blocks
                                                             SPACE
         USING GC,11                     .
GC       LD    0,96(12)                  . 000D6C 680C 0060
         STD   0,GCREQ                   . 000D70 6000 A6B0
         SR    12,8                      . 000D74 1BC8
         LA    15,88(12)                 . 000D76 41FC 0058
         STM   15,0,BLOCL                . 000D7A 90F0 A668
         LR    1,15                      . 000D7E 181F
         S     1,STKPTR                  . 000D80 5B10 9F00
         ST    1,BLOCL                   . 000D84 5010 A668
         L     1,STKPTR                  . 000D88 5810 9F00
         MVC   5(3,1),BLOCL$1            . 000D8C D202 1005 A669
         LD    0,PRMDX                   . 000D92 6800 A6E8
         STD   0,BKDXU                   . 000D96 6000 A650
                                                             SPACE
* GCT  GETD    GCMPTR,PRMPTR,BKDXU Get next resident block
*      AEQLC   GCMPTR,0,,GCTDWN    Skip nonpointers
*      RCALL   ,GCM,(GCMPTR)       Scan resident block
                                                             SPACE
GCT      L     1,BKDXU                   . 000D9A 5810 A650
         L     2,PRMPTR                  . 000D9E 5820 A6F0
         LD    0,0(1,2)                  . 000DA2 6801 2000
         STD   0,GCMPTR                  . 000DA6 6000 A6A8
         C     0,GCMPTR                  . 000DAA 5900 A6A8
         BE    GCTDWN                    . 000DAE 4780 B06E
         LA    14,S4$00DD6               . 000DB2 41E0 B06A
         STM   11,14,104(12)             . 000DB6 90BE C068
         LR    13,12                     . 000DBA 18DC
         LD    0,GCMPTR                  . 000DBC 6800 A6A8
         STD   0,120(12)                 . 000DC0 600C 0078
         LA    12,24(12)                 . 000DC4 41CC 0018
         C     12,@@STACKT               . 000DC8 59C0 A828
         BH    OVER                      . 000DCC 4720 9664
         L     11,@@GCM                  . 000DD0 58B0 A894
         BR    11                        . 000DD4 07FB
S4$00DD6 SR    0,0                       . 000DD6 1B00
         SR    0,0                       . 000DD8 1B00
                                                             SPACE
* GCTDWN DECRA BKDXU,DESCR         Decrement block count
*      AEQLC   BKDXU,0,GCT         Test for end of loop
*      SETAC   BKPTR,OBLIST-DESCR  Set up pointer to bins
                                                             SPACE
GCTDWN   L     1,BKDXU                   . 000DDA 5810 A650
         SR    1,8                       . 000DDE 1B18
         ST    1,BKDXU                   . 000DE0 5010 A650
         CR    0,1                       . 000DE4 1901
         BNE   GCT                       . 000DE6 4770 B02E
         L     1,@@OBLOCK                . 000DEA 5810 A898
         ST    1,BKPTR                   . 000DEE 5010 A660
                                                             SPACE
* GCBA1 ACOMP  BKPTR,OBEND,GCLAD   Check for end of bins
*      INCRA   BKPTR,DESCR         Increment bin pointer
*      MOVD    ST1PTR,BKPTR        Get working copy
                                                             SPACE
GCBA1    LM    1,2,BKPTR                 . 000DF2 9812 A660
         C     1,OBEND                   . 000DF6 5910 9C58
         BH    GCLAD                     . 000DFA 4720 B110
         AR    1,8                       . 000DFE 1A18
         ST    1,BKPTR                   . 000E00 5010 A660
         STM   1,2,ST1PTR                . 000E04 9012 A6F8
                                                             SPACE
* GCBA2 GETAC  ST1PTR,ST1PTR,LNKFLD
*                                  Get link pointer
*      AEQLC   ST1PTR,0,,GCBA1     Test for end of chain
*      TESTFI  ST1PTR,MARK,,GCBA2  Test for marked structure
*      GETDC   ST2PTR,ST1PTR,DESCR Get value descriptor
*      DEQL    ST2PTR,NULVCL,GCBA4 Mark if nonnull
*      AEQLIC  ST1PTR,ATTRIB,0,,GCBA2
*                                  Test attribute also
                                                             SPACE
GCBA2    L     1,ST1PTR                  . 000E08 5810 A6F8
         L     1,24(1)                   . 000E0C 5811 0018
         ST    1,ST1PTR                  . 000E10 5010 A6F8
         CR    0,1                       . 000E14 1901
         BE    GCBA1                     . 000E16 4780 B086
         TM    4(1),X'08'                . 000E1A 9108 1004
         BO    GCBA2                     . 000E1E 4710 B09C
         L     1,ST1PTR                  . 000E22 5810 A6F8
         LD    0,8(1)                    . 000E26 6801 0008
         STD   0,ST2PTR                  . 000E2A 6000 A700
         CLC   ST2PTR(8),NULVCL          . 000E2E D507 A700 9ED0
         BNE   GCBA4                     . 000E34 4770 B0D8
         L     1,ST1PTR                  . 000E38 5810 A6F8
         C     0,16(1)                   . 000E3C 5901 0010
         BE    GCBA2                     . 000E40 4780 B09C
                                                             SPACE
* GCBA4 PUTDC  GCBLK,DESCR,ST1PTR  Set up pseudoblock
*      RCALL   ,GCM,(GCBLK),GCBA2  Mark string structure
                                                             SPACE
GCBA4    L     1,GCBLK                   . 000E44 5810 A698
         LD    0,ST1PTR                  . 000E48 6800 A6F8
         STD   0,8(1)                    . 000E4C 6001 0008
         LA    14,S4$00E74               . 000E50 41E0 B108
         STM   11,14,104(12)             . 000E54 90BE C068
         LR    13,12                     . 000E58 18DC
         LD    0,GCBLK                   . 000E5A 6800 A698
         STD   0,120(12)                 . 000E5E 600C 0078
         LA    12,24(12)                 . 000E62 41CC 0018
         C     12,@@STACKT               . 000E66 59C0 A828
         BH    OVER                      . 000E6A 4720 9664
         L     11,@@GCM                  . 000E6E 58B0 A894
         BR    11                        . 000E72 07FB
S4$00E74 SR    0,0                       . 000E74 1B00
         SR    0,0                       . 000E76 1B00
         B     GCBA2                     . 000E78 47F0 B09C
                                                             SPACE
* GCLAD MOVD   CPYCL,HDSGPT        Initialize target pointer
*      MOVD    TTLCL,HDSGPT        Initialize block pointer
                                                             SPACE
GCLAD    LD    0,HDSGPT                  . 000E7C 6800 A730
         STD   0,CPYCL                   . 000E80 6000 A678
         STD   0,TTLCL                   . 000E84 6000 A718
                                                             SPACE
* GCLAD0 BKSIZE BKDX,TTLCL         Get size of block
*      TESTFI  TTLCL,MARK,GCLAD7   Is the block marked?
*      SUM     CPYCL,CPYCL,BKDX    Is block marked?
*      SUM     TTLCL,TTLCL,BKDX    Update block pointer
*      AEQL    TTLCL,FRSGPT,GCLAD0,GCBB1
*                                  Check for end of region
                                                             SPACE
GCLAD0   L     1,TTLCL                   . 000E88 5810 A718
         L     15,4(1)                   . 000E8C 58F1 0004
         LA    15,0(15)                  . 000E90 41FF 0000
         TM    4(1),X'02'                . 000E94 9102 1004
         BNO   S4$00EA8                  . 000E98 47E0 B13C
         LA    15,31(15)                 . 000E9C 41FF 001F
         SRL   15,3                      . 000EA0 88F0 0003
         SLA   15,3                      . 000EA4 8BF0 0003
S4$00EA8 AR    15,8                      . 000EA8 1AF8
         STM   15,0,BKDX                 . 000EAA 90F0 A648
         L     1,TTLCL                   . 000EAE 5810 A718
         TM    4(1),X'08'                . 000EB2 9108 1004
         BNO   GCLAD7                    . 000EB6 47E0 B16E
         L     1,CPYCL                   . 000EBA 5810 A678
         AR    1,15                      . 000EBE 1A1F
         ST    1,CPYCL                   . 000EC0 5010 A678
         L     1,TTLCL                   . 000EC4 5810 A718
         AR    1,15                      . 000EC8 1A1F
         ST    1,TTLCL                   . 000ECA 5010 A718
         C     1,FRSGPT                  . 000ECE 5910 A728
         BNE   GCLAD0                    . 000ED2 4770 B11C
         BE    GCBB1                     . 000ED6 4780 B1CA
                                                             SPACE
* GCLAD7 MOVD  MVSGPT,TTLCL        Update compression barrier
                                                             SPACE
GCLAD7   LD    0,TTLCL                   . 000EDA 6800 A718
         STD   0,MVSGPT                  . 000EDE 6000 A6C8
                                                             SPACE
* GCLAD4 SUM   TTLCL,TTLCL,BKDX    Update block pointer
*      AEQL    TTLCL,FRSGPT,,GCBB1 Check for end of region
*      BKSIZE  BKDX,TTLCL          Get size of block
*      TESTFI  TTLCL,MARK,GCLAD4   Is block marked?
*      PUTAC   TTLCL,0,CPYCL       Point title to target
*      SUM     CPYCL,CPYCL,BKDX    Update target pointer
*      BRANCH  GCLAD4              Continue
                                                             SPACE
GCLAD4   L     1,TTLCL                   . 000EE2 5810 A718
         A     1,BKDX                    . 000EE6 5A10 A648
         ST    1,TTLCL                   . 000EEA 5010 A718
         C     1,FRSGPT                  . 000EEE 5910 A728
         BE    GCBB1                     . 000EF2 4780 B1CA
         L     15,4(1)                   . 000EF6 58F1 0004
         LA    15,0(15)                  . 000EFA 41FF 0000
         TM    4(1),X'02'                . 000EFE 9102 1004
         BNO   S4$00F12                  . 000F02 47E0 B1A6
         LA    15,31(15)                 . 000F06 41FF 001F
         SRL   15,3                      . 000F0A 88F0 0003
         SLA   15,3                      . 000F0E 8BF0 0003
S4$00F12 AR    15,8                      . 000F12 1AF8
         STM   15,0,BKDX                 . 000F14 90F0 A648
         L     1,TTLCL                   . 000F18 5810 A718
         TM    4(1),X'08'                . 000F1C 9108 1004
         BNO   GCLAD4                    . 000F20 47E0 B176
         L     2,CPYCL                   . 000F24 5820 A678
         ST    2,0(1)                    . 000F28 5021 0000
         AR    2,15                      . 000F2C 1A2F
         ST    2,CPYCL                   . 000F2E 5020 A678
         B     GCLAD4                    . 000F32 47F0 B176
                                                             SPACE
* GCBB1 SETAC  BKPTR,OBLIST-DESCR  Set up pointer to bins
*      SETAC   NODPCL,1            No dump while reorganizing
                                                             SPACE
GCBB1    L     1,@@OBLOCK                . 000F36 5810 A898
         ST    1,BKPTR                   . 000F3A 5010 A660
         LA    1,1                       . 000F3E 4110 0001
         ST    1,NODPCL                  . 000F42 5010 A6D0
                                                             SPACE
* GCBB2 ACOMP  BKPTR,OBEND,GCLAP   Check for end of bins
*      INCRA   BKPTR,DESCR         Increment bin pointer
*      MOVD    ST1PTR,BKPTR        Get work copy
                                                             SPACE
GCBB2    LM    1,2,BKPTR                 . 000F46 9812 A660
         C     1,OBEND                   . 000F4A 5910 9C58
         BH    GCLAP                     . 000F4E 4720 B236
         AR    1,8                       . 000F52 1A18
         ST    1,BKPTR                   . 000F54 5010 A660
         STM   1,2,ST1PTR                . 000F58 9012 A6F8
                                                             SPACE
* GCBB3 MOVD   ST2PTR,ST1PTR       Save pointer to be linked
                                                             SPACE
GCBB3    LD    0,ST1PTR                  . 000F5C 6800 A6F8
         STD   0,ST2PTR                  . 000F60 6000 A700
                                                             SPACE
* GCBB4 GETAC  ST1PTR,ST1PTR,LNKFLD
*                                  Get link pointer
*      AEQLC   ST1PTR,0,,GCBB5     Check for end of chain
*      TESTFI  ST1PTR,MARK,GCBB4   Is string marked?
*      GETAC   BLOCL,ST1PTR,0      Get target address
*      PUTAC   ST2PTR,LNKFLD,BLOCL Set link to target
*      BRANCH  GCBB3               Continue
                                                             SPACE
GCBB4    L     1,ST1PTR                  . 000F64 5810 A6F8
         L     1,24(1)                   . 000F68 5811 0018
         ST    1,ST1PTR                  . 000F6C 5010 A6F8
         CR    0,1                       . 000F70 1901
         BE    GCBB5                     . 000F72 4780 B22A
         TM    4(1),X'08'                . 000F76 9108 1004
         BNO   GCBB4                     . 000F7A 47E0 B1F8
         L     1,0(1)                    . 000F7E 5811 0000
         ST    1,BLOCL                   . 000F82 5010 A668
         L     1,ST2PTR                  . 000F86 5810 A700
         L     2,BLOCL                   . 000F8A 5820 A668
         ST    2,24(1)                   . 000F8E 5021 0018
         B     GCBB3                     . 000F92 47F0 B1F0
                                                             SPACE
* GCBB5 PUTAC  ST2PTR,LNKFLD,ZEROCL
*                                  Set last link to zero
*      BRANCH  GCBB2               Continue
                                                             SPACE
GCBB5    L     1,ST2PTR                  . 000F96 5810 A700
         ST    0,24(1)                   . 000F9A 5001 0018
         B     GCBB2                     . 000F9E 47F0 B1DA
                                                             SPACE
* GCLAP MOVD   TTLCL,HDSGPT        Initialize target pointer
                                                             SPACE
GCLAP    LD    0,HDSGPT                  . 000FA2 6800 A730
         STD   0,TTLCL                   . 000FA6 6000 A718
                                                             SPACE
* GCLAP0 BKSIZE BKDXU,TTLCL        Get size of block
*      TESTFI  TTLCL,STTL,,GCLAP1  Check for string
*      MOVD    BKDX,BKDXU          Working copy of block size
*      BRANCH  GCLAP2
                                                             SPACE
GCLAP0   L     1,TTLCL                   . 000FAA 5810 A718
         L     15,4(1)                   . 000FAE 58F1 0004
         LA    15,0(15)                  . 000FB2 41FF 0000
         TM    4(1),X'02'                . 000FB6 9102 1004
         BNO   S4$00FCA                  . 000FBA 47E0 B25E
         LA    15,31(15)                 . 000FBE 41FF 001F
         SRL   15,3                      . 000FC2 88F0 0003
         SLA   15,3                      . 000FC6 8BF0 0003
S4$00FCA AR    15,8                      . 000FCA 1AF8
         STM   15,0,BKDXU                . 000FCC 90F0 A650
         L     1,TTLCL                   . 000FD0 5810 A718
         TM    4(1),X'02'                . 000FD4 9102 1004
         BO    GCLAP1                    . 000FD8 4710 B27C
         LD    0,BKDXU                   . 000FDC 6800 A650
         STD   0,BKDX                    . 000FE0 6000 A648
         B     GCLAP2                    . 000FE4 47F0 B284
                                                             SPACE
* GCLAP1 SETAC BKDX,3*DESCR        Three descriptors for string
                                                             SPACE
GCLAP1   L     1,@@3YDESC                . 000FE8 5810 A89C
         ST    1,BKDX                    . 000FEC 5010 A648
                                                             SPACE
* GCLAP2 TESTFI TTLCL,MARK,GCLAP5  Is block marked?
*      DECRA   BKDX,DESCR          Decrement offset
                                                             SPACE
GCLAP2   L     1,TTLCL                   . 000FF0 5810 A718
         TM    4(1),X'08'                . 000FF4 9108 1004
         BNO   GCLAP5                    . 000FF8 47E0 B308
         L     1,BKDX                    . 000FFC 5810 A648
         SR    1,8                       . 001000 1B18
         ST    1,BKDX                    . 001002 5010 A648
                                                             SPACE
* GCLAP3 GETD  DESCL,TTLCL,BKDX    Get next descriptor in block
*      TESTF   DESCL,PTR,GCLAP4    Is it a pointer?
*      ACOMP   DESCL,MVSGPT,,,GCLAP4
*                                  Is it above compression barrier?
*      TOP     TOPCL,OFSET,DESCL   Compute offset to target
*      ADJUST  DESCL,TOPCL,OFSET   Adjust pointer to target
*      PUTD    TTLCL,BKDX,DESCL    Put descriptor back in block
                                                             SPACE
GCLAP3   L     1,BKDX                    . 001006 5810 A648
         L     2,TTLCL                   . 00100A 5820 A718
         LD    0,0(1,2)                  . 00100E 6801 2000
         STD   0,DESCL                   . 001012 6000 A680
         TM    DESCL$4,X'10'             . 001016 9110 A684
         BNO   GCLAP4                    . 00101A 47E0 B2F8
         L     1,DESCL                   . 00101E 5810 A680
         C     1,MVSGPT                  . 001022 5910 A6C8
         BL    GCLAP4                    . 001026 4740 B2F8
         LR    6,0                       . 00102A 1860
         LM    1,2,DESCL                 . 00102C 9812 A680
S4$01030 TM    4(1),X'01'                . 001030 9101 1004
         BO    S4$01040                  . 001034 4710 B2D4
         SR    1,8                       . 001038 1B18
         AR    6,8                       . 00103A 1A68
         B     S4$01030                  . 00103C 47F0 B2C4
S4$01040 ST    6,OFSET                   . 001040 5060 A6E0
         STM   1,2,TOPCL                 . 001044 9012 A710
         L     1,0(1)                    . 001048 5811 0000
         A     1,OFSET                   . 00104C 5A10 A6E0
         ST    1,DESCL                   . 001050 5010 A680
         L     1,BKDX                    . 001054 5810 A648
         L     2,TTLCL                   . 001058 5820 A718
         LD    0,DESCL                   . 00105C 6800 A680
         STD   0,0(1,2)                  . 001060 6001 2000
                                                             SPACE
* GCLAP4 DECRA BKDX,DESCR          Decrement offset
*      AEQLC   BKDX,0,GCLAP3       Check for end of block
                                                             SPACE
GCLAP4   L     1,BKDX                    . 001064 5810 A648
         SR    1,8                       . 001068 1B18
         ST    1,BKDX                    . 00106A 5010 A648
         CR    0,1                       . 00106E 1901
         BNE   GCLAP3                    . 001070 4770 B29A
                                                             SPACE
* GCLAP5 SUM   TTLCL,TTLCL,BKDXU   Move to next block
*      AEQL    TTLCL,FRSGPT,GCLAP0 Check for end of region
*      MOVD    BKDXU,PRMDX         Number of resident blocks
                                                             SPACE
GCLAP5   L     1,TTLCL                   . 001074 5810 A718
         A     1,BKDXU                   . 001078 5A10 A650
         ST    1,TTLCL                   . 00107C 5010 A718
         C     1,FRSGPT                  . 001080 5910 A728
         BNE   GCLAP0                    . 001084 4770 B23E
         LD    0,PRMDX                   . 001088 6800 A6E8
         STD   0,BKDXU                   . 00108C 6000 A650
                                                             SPACE
* GCLAT1 GETD  TTLCL,PRMPTR,BKDXU  Get next resident block
*      AEQLC   TTLCL,0,,GCLAT4     Skip nonpointer
*      GETSIZ  BKDX,TTLCL          Get size of block
                                                             SPACE
GCLAT1   L     1,BKDXU                   . 001090 5810 A650
         L     2,PRMPTR                  . 001094 5820 A6F0
         LD    0,0(1,2)                  . 001098 6801 2000
         STD   0,TTLCL                   . 00109C 6000 A718
         C     0,TTLCL                   . 0010A0 5900 A718
         BE    GCLAT4                    . 0010A4 4780 B3BA
         L     15,TTLCL                  . 0010A8 58F0 A718
         L     15,4(15)                  . 0010AC 58FF 0004
         LA    15,0(15)                  . 0010B0 41FF 0000
         STM   15,0,BKDX                 . 0010B4 90F0 A648
                                                             SPACE
* GCLAT2 GETD  DESCL,TTLCL,BKDX    Get descriptor from block
*      TESTF   DESCL,PTR,GCLAT3    Is it a pointer?
*      ACOMP   DESCL,MVSGPT,,,GCLAT3
*                                  Is it above compression barrier?
*      TOP     TOPCL,OFSET,DESCL   Compute offset to target
*      ADJUST  DESCL,TOPCL,OFSET   Adjust pointer to target
*      PUTD    TTLCL,BKDX,DESCL    Put descriptor back in block
                                                             SPACE
GCLAT2   L     1,BKDX                    . 0010B8 5810 A648
         L     2,TTLCL                   . 0010BC 5820 A718
         LD    0,0(1,2)                  . 0010C0 6801 2000
         STD   0,DESCL                   . 0010C4 6000 A680
         TM    DESCL$4,X'10'             . 0010C8 9110 A684
         BNO   GCLAT3                    . 0010CC 47E0 B3AA
         L     1,DESCL                   . 0010D0 5810 A680
         C     1,MVSGPT                  . 0010D4 5910 A6C8
         BL    GCLAT3                    . 0010D8 4740 B3AA
         LR    6,0                       . 0010DC 1860
         LM    1,2,DESCL                 . 0010DE 9812 A680
S4$010E2 TM    4(1),X'01'                . 0010E2 9101 1004
         BO    S4$010F2                  . 0010E6 4710 B386
         SR    1,8                       . 0010EA 1B18
         AR    6,8                       . 0010EC 1A68
         B     S4$010E2                  . 0010EE 47F0 B376
S4$010F2 ST    6,OFSET                   . 0010F2 5060 A6E0
         STM   1,2,TOPCL                 . 0010F6 9012 A710
         L     1,0(1)                    . 0010FA 5811 0000
         A     1,OFSET                   . 0010FE 5A10 A6E0
         ST    1,DESCL                   . 001102 5010 A680
         L     1,BKDX                    . 001106 5810 A648
         L     2,TTLCL                   . 00110A 5820 A718
         LD    0,DESCL                   . 00110E 6800 A680
         STD   0,0(1,2)                  . 001112 6001 2000
                                                             SPACE
* GCLAT3 DECRA BKDX,DESCR          Decrement offset
*      AEQLC   BKDX,0,GCLAT2       Check for end of block
                                                             SPACE
GCLAT3   L     1,BKDX                    . 001116 5810 A648
         SR    1,8                       . 00111A 1B18
         ST    1,BKDX                    . 00111C 5010 A648
         CR    0,1                       . 001120 1901
         BNE   GCLAT2                    . 001122 4770 B34C
                                                             SPACE
* GCLAT4 DECRA BKDXU,DESCR         Decrement count of resident blocks
*      AEQLC   BKDXU,0,GCLAT1      Check for end of resident blocks
*      MOVD    TTLCL,HDSGPT        Set up target pointer
                                                             SPACE
GCLAT4   L     1,BKDXU                   . 001126 5810 A650
         SR    1,8                       . 00112A 1B18
         ST    1,BKDXU                   . 00112C 5010 A650
         CR    0,1                       . 001130 1901
         BNE   GCLAT1                    . 001132 4770 B324
         LD    0,HDSGPT                  . 001136 6800 A730
         STD   0,TTLCL                   . 00113A 6000 A718
                                                             SPACE
* GCLAM0 BKSIZE BKDXU,TTLCL        Get size of block
*      ACOMP   TTLCL,MVSGPT,GCLAM5,GCLAM5
*                                  Has compression barrier been reached
*      GETAC   TOPCL,TTLCL,0       Get target position
*      MOVDIC  TOPCL,0,TTLCL,0     Move title to target position
*      RSETFI  TOPCL,MARK          Clear mark flag
*      BRANCH  GCLAM4              Continue
                                                             SPACE
GCLAM0   L     1,TTLCL                   . 00113E 5810 A718
         L     15,4(1)                   . 001142 58F1 0004
         LA    15,0(15)                  . 001146 41FF 0000
         TM    4(1),X'02'                . 00114A 9102 1004
         BNO   S4$0115E                  . 00114E 47E0 B3F2
         LA    15,31(15)                 . 001152 41FF 001F
         SRL   15,3                      . 001156 88F0 0003
         SLA   15,3                      . 00115A 8BF0 0003
S4$0115E AR    15,8                      . 00115E 1AF8
         STM   15,0,BKDXU                . 001160 90F0 A650
         L     1,TTLCL                   . 001164 5810 A718
         C     1,MVSGPT                  . 001168 5910 A6C8
         BNL   GCLAM5                    . 00116C 47B0 B420
         L     1,0(1)                    . 001170 5811 0000
         ST    1,TOPCL                   . 001174 5010 A710
         L     2,TTLCL                   . 001178 5820 A718
         LD    0,0(2)                    . 00117C 6802 0000
         STD   0,0(1)                    . 001180 6001 0000
         NI    4(1),X'F7'                . 001184 94F7 1004
         B     GCLAM4                    . 001188 47F0 B468
                                                             SPACE
* GCLAM5 MOVA  BKDX,BKDXU          Working copy of block size
*      DECRA   BKDX,DESCR          Size to be moved
*      TESTFI  TTLCL,MARK,GCLAM4   Is block marked?
*      GETAC   TOPCL,TTLCL,0       Get target position
*      MOVDIC  TOPCL,0,TTLCL,0     Move title
*      RSETFI  TOPCL,MARK          Clear mark flag
*      MOVBLK  TOPCL,TTLCL,BKDX    Move block itself
                                                             SPACE
GCLAM5   L     1,BKDXU                   . 00118C 5810 A650
         ST    1,BKDX                    . 001190 5010 A648
         SR    1,8                       . 001194 1B18
         ST    1,BKDX                    . 001196 5010 A648
         L     1,TTLCL                   . 00119A 5810 A718
         TM    4(1),X'08'                . 00119E 9108 1004
         BNO   GCLAM4                    . 0011A2 47E0 B468
         L     1,0(1)                    . 0011A6 5811 0000
         ST    1,TOPCL                   . 0011AA 5010 A710
         L     2,TTLCL                   . 0011AE 5820 A718
         LD    0,0(2)                    . 0011B2 6802 0000
         STD   0,0(1)                    . 0011B6 6001 0000
         NI    4(1),X'F7'                . 0011BA 94F7 1004
         L     6,TOPCL                   . 0011BE 5860 A710
         L     4,TTLCL                   . 0011C2 5840 A718
         AR    4,8                       . 0011C6 1A48
         AR    6,8                       . 0011C8 1A68
         L     3,BKDX                    . 0011CA 5830 A648
         L     15,@@MOVTST               . 0011CE 58F0 A864
         BALR  14,15                          CALL                     *
                                         . 0011D2 05EF
                                                             SPACE
* GCLAM4 SUM   TTLCL,TTLCL,BKDXU   Get to next block
*      AEQL    TTLCL,FRSGPT,GCLAM0 Check for end of region
*      INCRA   GCNO,1              Increment count of regenerations
*      SETAC   NODPCL,0            Permit dump
*      BKSIZE  BKDX,TOPCL          Get size of last block
*      SUM     FRSGPT,TOPCL,BKDX   Compute new allocation pointer
*      RESETF  FRSGPT,FNC          Clear possible function flag
*      SUBTRT  GCGOT,TLSGP1,FRSGPT Compute amount reclaimed
*      DECRA   GCGOT,DESCR
*      RESETF  GCGOT,PTR           Clear pointer flag
*      ACOMP   GCREQ,GCGOT,FAIL    Compare with amount required
*      RRTURN  GCGOT,2
GCLAM4   L     1,TTLCL                   . 0011D4 5810 A718
         A     1,BKDXU                   . 0011D8 5A10 A650
         ST    1,TTLCL                   . 0011DC 5010 A718
         C     1,FRSGPT                  . 0011E0 5910 A728
         BNE   GCLAM0                    . 0011E4 4770 B3D2
         L     1,GCNO                    . 0011E8 5810 A6A0
         LA    1,1(1)                    . 0011EC 4111 0001
         ST    1,GCNO                    . 0011F0 5010 A6A0
         ST    0,NODPCL                  . 0011F4 5000 A6D0
         L     1,TOPCL                   . 0011F8 5810 A710
         L     15,4(1)                   . 0011FC 58F1 0004
         LA    15,0(15)                  . 001200 41FF 0000
         TM    4(1),X'02'                . 001204 9102 1004
         BNO   S4$01218                  . 001208 47E0 B4AC
         LA    15,31(15)                 . 00120C 41FF 001F
         SRL   15,3                      . 001210 88F0 0003
         SLA   15,3                      . 001214 8BF0 0003
S4$01218 AR    15,8                      . 001218 1AF8
         STM   15,0,BKDX                 . 00121A 90F0 A648
         LM    1,2,TOPCL                 . 00121E 9812 A710
         AR    1,15                      . 001222 1A1F
         STM   1,2,FRSGPT                . 001224 9012 A728
         NI    FRSGPT$4,X'FB'            . 001228 94FB A72C
         LM    1,2,TLSGP1                . 00122C 9812 A738
         S     1,FRSGPT                  . 001230 5B10 A728
         STM   1,2,GCGOT                 . 001234 9012 A6B8
         L     1,GCGOT                   . 001238 5810 A6B8
         SR    1,8                       . 00123C 1B18
         ST    1,GCGOT                   . 00123E 5010 A6B8
         NI    GCGOT$4,X'EF'             . 001242 94EF A6BC
         L     1,GCREQ                   . 001246 5810 A6B0
         C     1,GCGOT                   . 00124A 5910 A6B8
         BH    FAIL                      . 00124E 4720 9010
         LD    0,GCGOT                   . 001252 6800 A6B8
         LM    11,14,104(13)             . 001256 98BE D068
         EX    0,0(14)                   . 00125A 440E 0000
         B     8(14)                     . 00125E 47FE 0008
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Block Marking
*
                                                             SPACE
* GCM  PROC    ,                   Procedure to mark blocks
*      POP     BK1CL               Restore block to mark from
*      PUSH    ZEROCL              Save end marker
                                                             SPACE
         USING GCM,11                    .
GCM      LD    0,96(12)                  . 001262 680C 0060
         STD   0,BK1CL                   . 001266 6000 A640
         SR    12,8                      . 00126A 1BC8
         LD    0,ZEROCL                  . 00126C 6800 9C90
         STD   0,104(12)                 . 001270 600C 0068
         AR    12,8                      . 001274 1AC8
         C     12,@@STACKT               . 001276 59C0 A828
         BH    OVER                      . 00127A 4720 9664
                                                             SPACE
* GCMA1 GETSIZ BKDX,BK1CL          Get size of block
                                                             SPACE
GCMA1    L     15,BK1CL                  . 00127E 58F0 A640
         L     15,4(15)                  . 001282 58FF 0004
         LA    15,0(15)                  . 001286 41FF 0000
         STM   15,0,BKDX                 . 00128A 90F0 A648
                                                             SPACE
* GCMA2 GETD   DESCL,BK1CL,BKDX    Get descriptor
*      TESTF   DESCL,PTR,GCMA3     Is it a pointer?
*      AEQLC   DESCL,0,,GCMA3      Is address zero?
*      TOP     TOPCL,OFSET,DESCL   Get to title of block pointed to
*      TESTFI  TOPCL,MARK,GCMA4    Is block marked?
                                                             SPACE
GCMA2    L     1,BKDX                    . 00128E 5810 A648
         L     2,BK1CL                   . 001292 5820 A640
         LD    0,0(1,2)                  . 001296 6801 2000
         STD   0,DESCL                   . 00129A 6000 A680
         TM    DESCL$4,X'10'             . 00129E 9110 A684
         BNO   GCMA3                     . 0012A2 47E0 B072
         C     0,DESCL                   . 0012A6 5900 A680
         BE    GCMA3                     . 0012AA 4780 B072
         LR    6,0                       . 0012AE 1860
         LM    1,2,DESCL                 . 0012B0 9812 A680
S4$012B4 TM    4(1),X'01'                . 0012B4 9101 1004
         BO    S4$012C4                  . 0012B8 4710 B062
         SR    1,8                       . 0012BC 1B18
         AR    6,8                       . 0012BE 1A68
         B     S4$012B4                  . 0012C0 47F0 B052
S4$012C4 ST    6,OFSET                   . 0012C4 5060 A6E0
         STM   1,2,TOPCL                 . 0012C8 9012 A710
         TM    4(1),X'08'                . 0012CC 9108 1004
         BNO   GCMA4                     . 0012D0 47E0 B0A4
                                                             SPACE
* GCMA3 DECRA  BKDX,DESCR          Decrement offset
*      AEQLC   BKDX,0,GCMA2        Check for end of block
*      POP     BK1CL               Restore block pushed
*      AEQLC   BK1CL,0,,RTN1       Check for end
*      SETAV   BKDX,BK1CL          Get size remaining
*      BRANCH  GCMA2               Continue processing
                                                             SPACE
GCMA3    L     1,BKDX                    . 0012D4 5810 A648
         SR    1,8                       . 0012D8 1B18
         ST    1,BKDX                    . 0012DA 5010 A648
         CR    0,1                       . 0012DE 1901
         BNE   GCMA2                     . 0012E0 4770 B02C
         LD    0,96(12)                  . 0012E4 680C 0060
         STD   0,BK1CL                   . 0012E8 6000 A640
         SR    12,8                      . 0012EC 1BC8
         C     0,BK1CL                   . 0012EE 5900 A640
         BE    FAIL                      . 0012F2 4780 9010
         L     15,BK1CL$4                . 0012F6 58F0 A644
         LA    15,0(15)                  . 0012FA 41FF 0000
         STM   15,0,BKDX                 . 0012FE 90F0 A648
         B     GCMA2                     . 001302 47F0 B02C
                                                             SPACE
* GCMA4 DECRA  BKDX,DESCR          Decrement offset
*      AEQLC   BKDX,0,,GCMA9       Check for end
*      SETVA   BK1CL,BKDX          Insert offset
*      PUSH    BK1CL               Save current block
                                                             SPACE
GCMA4    L     1,BKDX                    . 001306 5810 A648
         SR    1,8                       . 00130A 1B18
         ST    1,BKDX                    . 00130C 5010 A648
         CR    0,1                       . 001310 1901
         BE    GCMA9                     . 001312 4780 B0CC
         MVC   BK1CL$5(3),BKDX$1         . 001316 D202 A645 A649
         LD    0,BK1CL                   . 00131C 6800 A640
         STD   0,104(12)                 . 001320 600C 0068
         AR    12,8                      . 001324 1AC8
         C     12,@@STACKT               . 001326 59C0 A828
         BH    OVER                      . 00132A 4720 9664
                                                             SPACE
* GCMA9 MOVD   BK1CL,TOPCL         Set poiner to new block
*      SETFI   BK1CL,MARK          Mark block
*      TESTFI  BK1CL,STTL,GCMA1    Is it a string?
*      MOVD    BKDX,TWOCL          Set size of string to 2
*      BRANCH  GCMA2               Join processing
GCMA9    LM    1,2,TOPCL                 . 00132E 9812 A710
         STM   1,2,BK1CL                 . 001332 9012 A640
         OI    4(1),X'08'                . 001336 9608 1004
         L     1,BK1CL                   . 00133A 5810 A640
         TM    4(1),X'02'                . 00133E 9102 1004
         BNO   GCMA1                     . 001342 47E0 B01C
         LD    0,TWOCL                   . 001346 6800 A720
         STD   0,BKDX                    . 00134A 6000 A648
         B     GCMA2                     . 00134E 47F0 B02C
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Procedure to Split Blocks
                                                             SPACE
* SPLIT PROC   ,                   Procedure to split blocks
*      POP     A4PTR               Restore pointer to middle of block
*      TOP     A5PTR,A6PTR,A4PTR   Get title and offset
*      AEQLC   A6PTR,0,,RTN1       Avoid block of zero length
*      GETSIZ  A7PTR,A5PTR         Get present block size
*      SUBTRT  A7PTR,A7PTR,A6PTR   Subtract offset
*      DECRA   A7PTR,DESCR         Decrement for title
*      ACOMPC  A7PTR,0,,RTN1,RTN1  Avoid block of zero length
*      SETSIZ  A5PTR,A6PTR         Reset size of old block
*      INCRA   A4PTR,DESCR         Adjust pointer to middle
*      PUTDC   A4PTR,0,ZEROCL
*      PUTAC   A4PTR,0,A4PTR
*      SETFI   A4PTR,TTL           Insert title flag
*      SETSIZ  A4PTR,A7PTR         Insert size fo new block
*      BRANCH  RTN1                Return
         USING SPLIT,11                  .
SPLIT    LD    0,96(12)                  . 001352 680C 0060
         STD   0,A4PTR                   . 001356 6000 9E00
         SR    12,8                      . 00135A 1BC8
         LR    6,0                       . 00135C 1860
         LM    1,2,A4PTR                 . 00135E 9812 9E00
S4$01362 TM    4(1),X'01'                . 001362 9101 1004
         BO    S4$01372                  . 001366 4710 B020
         SR    1,8                       . 00136A 1B18
         AR    6,8                       . 00136C 1A68
         B     S4$01362                  . 00136E 47F0 B010
S4$01372 ST    6,A6PTR                   . 001372 5060 9E10
         STM   1,2,A5PTR                 . 001376 9012 9E08
         C     0,A6PTR                   . 00137A 5900 9E10
         BE    FAIL                      . 00137E 4780 9010
         LR    15,1                      . 001382 18F1
         L     15,4(15)                  . 001384 58FF 0004
         LA    15,0(15)                  . 001388 41FF 0000
         STM   15,0,A7PTR                . 00138C 90F0 9E18
         L     1,A7PTR                   . 001390 5810 9E18
         S     1,A6PTR                   . 001394 5B10 9E10
         SR    1,8                       . 001398 1B18
         ST    1,A7PTR                   . 00139A 5010 9E18
         CR    0,1                       . 00139E 1901
         BNL   FAIL                      . 0013A0 47B0 9010
         L     1,A5PTR                   . 0013A4 5810 9E08
         MVC   5(3,1),A6PTR$1            . 0013A8 D202 1005 9E11
         LM    1,2,A4PTR                 . 0013AE 9812 9E00
         AR    1,8                       . 0013B2 1A18
         ST    1,A4PTR                   . 0013B4 5010 9E00
         LR    15,1                      . 0013B8 18F1
         STM   15,0,0(1)                 . 0013BA 90F0 1000
         OI    4(1),X'01'                . 0013BE 9601 1004
         L     1,A4PTR                   . 0013C2 5810 9E00
         MVC   5(3,1),A7PTR$1            . 0013C6 D202 1005 9E19
         B     FAIL                      . 0013CC 47F0 9010
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Compilation Procedures'
*
*      Binary Operator Analysis
*
                                                             SPACE
* BINOP PROC   ,                   Compiler binary operator analysis
*      RCALL   ,FORBLK,,BINOP1     Test for initial blank
*      AEQLC   BRTYPE,NBTYP,RTN2   If so, fail on break
*      STREAM  XSP,TEXTSP,BIOPTB,BINCON
*      MOVD    ZPTR,STYPE          Move function descriptor
*      BRANCH  RTZPTR              Return function descriptor
                                                             SPACE
         USING BINOP,11                  .
BINOP    LA    14,S4$013EC               . 0013D0 41E0 B01C
         STM   11,14,104(12)             . 0013D4 90BE C068
         LR    13,12                     . 0013D8 18DC
         LA    12,16(12)                 . 0013DA 41CC 0010
         C     12,@@STACKT               . 0013DE 59C0 A828
         BH    OVER                      . 0013E2 4720 9664
         L     11,@@FORBLK               . 0013E6 58B0 A8A0
         BR    11                        . 0013EA 07FB
S4$013EC SR    0,0                       . 0013EC 1B00
         SR    0,0                       . 0013EE 1B00
         B     BINOP1                    . 0013F0 47F0 B056
         LA    6,1                       . 0013F4 4160 0001
         C     6,BRTYPE                  . 0013F8 5960 9E20
         BNE   RTN2                      . 0013FC 4770 9028
         L     15,@@STREAM               . 001400 58F0 A840
         LA    1,XSP                     . 001404 4110 A5D0
         LA    2,TEXTSP                  . 001408 4120 A590
         L     3,@@BIOPTB                . 00140C 5830 A8A4
         BALR  14,15                          CALL                     *
                                         . 001410 05EF
         B     BINCON                    . 001412 47F0 B0AE
         B     S4$0141A                  . 001416 47F0 B04A
S4$0141A LD    0,STYPE                   . 00141A 6800 9F08
         STD   0,ZPTR                    . 00141E 6000 A440
         B     RTZPTR                    . 001422 47F0 9074
                                                             SPACE
* BINOP1 RCALL ,FORWRD,,COMP3      If no blank, find character
*      SELBRA  BRTYPE,(,RTN2,RTN2,,,RTN2,RTN2)
                                                             SPACE
BINOP1   LA    14,S4$01442               . 001426 41E0 B072
         STM   11,14,104(12)             . 00142A 90BE C068
         LR    13,12                     . 00142E 18DC
         LA    12,16(12)                 . 001430 41CC 0010
         C     12,@@STACKT               . 001434 59C0 A828
         BH    OVER                      . 001438 4720 9664
         L     11,@@FORWRD               . 00143C 58B0 A8A8
         BR    11                        . 001440 07FB
S4$01442 SR    0,0                       . 001442 1B00
         SR    0,0                       . 001444 1B00
         B     S4$010                    . 001446 47F0 95AC
         L     1,BRTYPE                  . 00144A 5810 9E20
         SLA   1,2                       . 00144E 8B10 0002
S4$01452 B     S4$01452(1)               . 001452 47F1 B082
         B     BINERR                    . 001456 47F0 B0A2
         B     RTN2                      . 00145A 47F0 9028
         B     RTN2                      . 00145E 47F0 9028
         B     BINERR                    . 001462 47F0 B0A2
         B     BINERR                    . 001466 47F0 B0A2
         B     RTN2                      . 00146A 47F0 9028
         B     RTN2                      . 00146E 47F0 9028
                                                             SPACE
* BINERR SETAC EMSGCL,ILLBIN       Set up error message
*      BRANCH  RTN1                Take error return
                                                             SPACE
BINERR   L     1,@@ILLBIN                . 001472 5810 A8AC
         ST    1,EMSGCL                  . 001476 5010 9E50
         B     FAIL                      . 00147A 47F0 9010
                                                             SPACE
* BINCON MOVD  ZPTR,CONCL          No operator, concatenation
*      BRANCH  RTZPTR              Return function descriptor
                                                             SPACE
BINCON   LD    0,CONCL                   . 00147E 6800 9D00
         STD   0,ZPTR                    . 001482 6000 A440
         B     RTZPTR                    . 001486 47F0 9074
                                                             SPACE
* BINEOS SETAC EMSGCL,ILLEOS       Set up error message
*      BRANCH  RTN1                Error return
BINEOS   L     1,@@ILLEOS                . 00148A 5810 A8B0
         ST    1,EMSGCL                  . 00148E 5010 9E50
         B     FAIL                      . 001492 47F0 9010
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Statement Compilation
*
                                                             SPACE
* CMPILE PROC  ,                   Procedure to compile statement
*      SETAC   BRTYPE,0            Clear break indicator
*      MOVD    BOSCL,CMOFCL        Set statement beginning offset
*      INCRA   CSTNCL,1            Increment statement number
*      STREAM  XSP,TEXTSP,LBLTB,CERR1
*                                  Break out label
*      LEQLC   XSP,0,,CMPILA       Check for no label
*      INCRA   CMOFCL,DESCR        Increment offset
*      PUTD    CMBSCL,CMOFCL,BASECL
*                                  Insert BASE function
*      SUM     CMBSCL,CMBSCL,CMOFCL
*                                  Add offset to base
*      ACOMP   CMBSCL,OCLIM,,,CMPILO
*                                  Check for end of object code
*      RCALL   XCL,BLOCK,CODELT    Get block for more
*      PUTDC   CMBSCL,0,GOTGCL     Replace BASE with direct goto
*      PUTDC   CMBSCL,DESCR,LIT1CL                              E3.7.1
*      PUTDC   CMBSCL,2*DESCR,XCL  Aim at new block
*      MOVD    CMBSCL,XCL          Set up base of new region
*      SUM     OCLIM,CMBSCL,CODELT Compute end of new block
*      DECRA   OCLIM,5*DESCR       Leave safety factor
*      PUTDC   CMBSCL,DESCR,BASECL Set BASE function in new region
*      INCRA   CMBSCL,DESCR        Increment base
                                                             SPACE
         USING CMPILE,11                 .
CMPILE   ST    0,BRTYPE                  . 001496 5000 9E20
         LD    0,CMOFCL                  . 00149A 6800 9E28
         STD   0,BOSCL                   . 00149E 6000 A450
         L     1,CSTNCL                  . 0014A2 5810 9B70
         LA    1,1(1)                    . 0014A6 4111 0001
         ST    1,CSTNCL                  . 0014AA 5010 9B70
         L     15,@@STREAM               . 0014AE 58F0 A840
         LA    1,XSP                     . 0014B2 4110 A5D0
         LA    2,TEXTSP                  . 0014B6 4120 A590
         L     3,@@LBLTB                 . 0014BA 5830 A854
         BALR  14,15                          CALL                     *
                                         . 0014BE 05EF
         B     CERR1                     . 0014C0 47F0 B8EC
         B     S4$014C8                  . 0014C4 47F0 B032
S4$014C8 C     0,XSP                     . 0014C8 5900 A5D0
         BE    CMPILA                    . 0014CC 4780 B126
         L     1,CMOFCL                  . 0014D0 5810 9E28
         AR    1,8                       . 0014D4 1A18
         ST    1,CMOFCL                  . 0014D6 5010 9E28
         L     2,CMBSCL                  . 0014DA 5820 A458
         LD    0,BASECL                  . 0014DE 6800 9CE8
         STD   0,0(1,2)                  . 0014E2 6001 2000
         AR    2,1                       . 0014E6 1A21
         ST    2,CMBSCL                  . 0014E8 5020 A458
         C     2,OCLIM                   . 0014EC 5920 A478
         BL    CMPILO                    . 0014F0 4740 B0CC
         LA    14,S4$01518               . 0014F4 41E0 B082
         STM   11,14,104(12)             . 0014F8 90BE C068
         LR    13,12                     . 0014FC 18DC
         LD    0,CODELT                  . 0014FE 6800 9C00
         STD   0,120(12)                 . 001502 600C 0078
         LA    12,24(12)                 . 001506 41CC 0018
         C     12,@@STACKT               . 00150A 59C0 A828
         BH    OVER                      . 00150E 4720 9664
         L     11,@@BLOCK                . 001512 58B0 A82C
         BR    11                        . 001516 07FB
S4$01518 STD   0,XCL                     . 001518 6000 A408
         L     1,CMBSCL                  . 00151C 5810 A458
         LD    0,GOTGCL                  . 001520 6800 9D50
         STD   0,0(1)                    . 001524 6001 0000
         LD    0,DOTCL                   . 001528 6800 9D18
         STD   0,8(1)                    . 00152C 6001 0008
         LD    0,XCL                     . 001530 6800 A408
         STD   0,16(1)                   . 001534 6001 0010
         STD   0,CMBSCL                  . 001538 6000 A458
         LM    1,2,CMBSCL                . 00153C 9812 A458
         A     1,CODELT                  . 001540 5A10 9C00
         STM   1,2,OCLIM                 . 001544 9012 A478
         S     1,@@5MDESC                . 001548 5B10 A834
         ST    1,OCLIM                   . 00154C 5010 A478
         L     1,CMBSCL                  . 001550 5810 A458
         LD    0,BASECL                  . 001554 6800 9CE8
         STD   0,8(1)                    . 001558 6001 0008
         AR    1,8                       . 00155C 1A18
         ST    1,CMBSCL                  . 00155E 5010 A458
                                                             SPACE
* CMPILO SETAC CMOFCL,0            Zero offset
*      SETAC   BOSCL,0             Zero base offset
*      RCALL   LPTR,GENVAR,XSPPTR  Get variable for label
*      AEQLIC  LPTR,ATTRIB,0,,CMPILC
*                                  Check for previous definition
*      AEQLC   CNSLCL,0,,CERR2     Check for label redefinition
                                                             SPACE
CMPILO   ST    0,CMOFCL                  . 001562 5000 9E28
         ST    0,BOSCL                   . 001566 5000 A450
         LA    14,S4$0158E               . 00156A 41E0 B0F8
         STM   11,14,104(12)             . 00156E 90BE C068
         LR    13,12                     . 001572 18DC
         LD    0,XSPPTR                  . 001574 6800 9F60
         STD   0,120(12)                 . 001578 600C 0078
         LA    12,24(12)                 . 00157C 41CC 0018
         C     12,@@STACKT               . 001580 59C0 A828
         BH    OVER                      . 001584 4720 9664
         L     11,@@GENVAR               . 001588 58B0 A830
         BR    11                        . 00158C 07FB
S4$0158E STD   0,LPTR                    . 00158E 6000 A3A0
         L     1,LPTR                    . 001592 5810 A3A0
         C     0,16(1)                   . 001596 5901 0010
         BE    CMPILC                    . 00159A 4780 B110
         C     0,CUTNO                   . 00159E 5900 9BA8
         BE    CERR2                     . 0015A2 4780 B8F8
                                                             SPACE
* CMPILC PUTDC LPTR,ATTRIB,CMBSCL  Insert label attribute
*      DEQL    LPTR,ENDPTR,,RTN2   Check for END
                                                             SPACE
CMPILC   L     1,LPTR                    . 0015A6 5810 A3A0
         LD    0,CMBSCL                  . 0015AA 6800 A458
         STD   0,16(1)                   . 0015AE 6001 0010
         CLC   LPTR(8),ENDPTR            . 0015B2 D507 A3A0 A520
         BE    RTN2                      . 0015B8 4780 9028
                                                             SPACE
* CMPILA RCALL ,FORBLK,,CERR12     Get to next character
*      AEQLC   BRTYPE,EOSTYP,,RTN3 Was end of statement founc?
*      INCRA   CMOFCL,DESCR        Increment offset
*      PUTD    CMBSCL,CMOFCL,INITCL
*                                  Insert INIT function
*      INCRA   CMOFCL,DESCR        Increment offset
*      MOVD    FRNCL,CMOFCL        Save offset for failure position
*      AEQLC   BRTYPE,NBTYP,,CMPSUB
*                                  Check for nonbreak
*      AEQLC   BRTYPE,CLNTYP,CERR3,CMPGO
*                                  Check for goto field
                                                             SPACE
CMPILA   LA    14,S4$015D8               . 0015BC 41E0 B142
         STM   11,14,104(12)             . 0015C0 90BE C068
         LR    13,12                     . 0015C4 18DC
         LA    12,16(12)                 . 0015C6 41CC 0010
         C     12,@@STACKT               . 0015CA 59C0 A828
         BH    OVER                      . 0015CE 4720 9664
         L     11,@@FORBLK               . 0015D2 58B0 A8A0
         BR    11                        . 0015D6 07FB
S4$015D8 SR    0,0                       . 0015D8 1B00
         SR    0,0                       . 0015DA 1B00
         B     CERR12                    . 0015DC 47F0 B91C
         LA    6,6                       . 0015E0 4160 0006
         C     6,BRTYPE                  . 0015E4 5960 9E20
         BE    RTNUL3                    . 0015E8 4780 9030
         L     1,CMOFCL                  . 0015EC 5810 9E28
         AR    1,8                       . 0015F0 1A18
         L     2,CMBSCL                  . 0015F2 5820 A458
         LD    0,INITCL                  . 0015F6 6800 9D68
         STD   0,0(1,2)                  . 0015FA 6001 2000
         AR    1,8                       . 0015FE 1A18
         ST    1,CMOFCL                  . 001600 5010 9E28
         LD    0,CMOFCL                  . 001604 6800 9E28
         STD   0,FRNCL                   . 001608 6000 A4F0
         LA    6,1                       . 00160C 4160 0001
         C     6,BRTYPE                  . 001610 5960 9E20
         BE    CMPSUB                    . 001614 4780 B192
         LA    6,5                       . 001618 4160 0005
         C     6,BRTYPE                  . 00161C 5960 9E20
         BNE   CERR3                     . 001620 4770 B904
         BE    CMPGO                     . 001624 4780 B422
                                                             SPACE
* CMPSUB RCALL SUBJND,ELEMNT,,(CDIAG,COMP3)
*                                  Compiler subject
*      RCALL   ,FORBLK,,CERR5      Get to next character
*      AEQLC   BRTYPE,NBTYP,,CMPATN
*                                  Check for nonbreak
*      AEQLC   BRTYPE,EQTYP,,CMPFRM
*                                  Check for assignment
*      RCALL   ,TREPUB,(SUBJND)    Copy subject into object code
*      AEQLC   BRTYPE,CLNTYP,,CMPGO
*                                  Check for goto
*      AEQLC   BRTYPE,EOSTYP,CERR5,CMPNGO
*                                  Check for end of statement
                                                             SPACE
CMPSUB   LA    14,S4$01644               . 001628 41E0 B1AE
         STM   11,14,104(12)             . 00162C 90BE C068
         LR    13,12                     . 001630 18DC
         LA    12,16(12)                 . 001632 41CC 0010
         C     12,@@STACKT               . 001636 59C0 A828
         BH    OVER                      . 00163A 4720 9664
         L     11,@@ELEMNT               . 00163E 58B0 A8B4
         BR    11                        . 001642 07FB
S4$01644 STD   0,SUBJND                  . 001644 6000 A510
         B     CDIAG                     . 001648 47F0 B930
         B     S4$010                    . 00164C 47F0 95AC
         LA    14,S4$0166C               . 001650 41E0 B1D6
         STM   11,14,104(12)             . 001654 90BE C068
         LR    13,12                     . 001658 18DC
         LA    12,16(12)                 . 00165A 41CC 0010
         C     12,@@STACKT               . 00165E 59C0 A828
         BH    OVER                      . 001662 4720 9664
         L     11,@@FORBLK               . 001666 58B0 A8A0
         BR    11                        . 00166A 07FB
S4$0166C SR    0,0                       . 00166C 1B00
         SR    0,0                       . 00166E 1B00
         B     CERR5                     . 001670 47F0 B910
         LA    6,1                       . 001674 4160 0001
         C     6,BRTYPE                  . 001678 5960 9E20
         BE    CMPATN                    . 00167C 4780 B23A
         LA    6,4                       . 001680 4160 0004
         C     6,BRTYPE                  . 001684 5960 9E20
         BE    CMPFRM                    . 001688 4780 B2EC
         LA    14,S4$016B0               . 00168C 41E0 B21A
         STM   11,14,104(12)             . 001690 90BE C068
         LR    13,12                     . 001694 18DC
         LD    0,SUBJND                  . 001696 6800 A510
         STD   0,120(12)                 . 00169A 600C 0078
         LA    12,24(12)                 . 00169E 41CC 0018
         C     12,@@STACKT               . 0016A2 59C0 A828
         BH    OVER                      . 0016A6 4720 9664
         L     11,@@TREPUB               . 0016AA 58B0 A8B8
         BR    11                        . 0016AE 07FB
S4$016B0 SR    0,0                       . 0016B0 1B00
         SR    0,0                       . 0016B2 1B00
         LA    6,5                       . 0016B4 4160 0005
         C     6,BRTYPE                  . 0016B8 5960 9E20
         BE    CMPGO                     . 0016BC 4780 B422
         LA    6,6                       . 0016C0 4160 0006
         C     6,BRTYPE                  . 0016C4 5960 9E20
         BNE   CERR5                     . 0016C8 4770 B910
         BE    CMPNGO                    . 0016CC 4780 B408
                                                             SPACE
* CMPATN RCALL PATND,EXPR,,CDIAG   Compile pattern
*      AEQLC   BRTYPE,EQTYP,,CMPASP
*                                  Check for replacement
*      INCRA   CMOFCL,DESCR        Increment offset
*      PUTD    CMBSCL,CMOFCL,SCANCL
*                                  Insert SCAN function
*      RCALL   ,TREPUB,(SUBJND)    Copy subject into object code
*      RCALL   ,TREPUB,(PATND)     Copy pattern into object code
                                                             SPACE
CMPATN   LA    14,S4$016EC               . 0016D0 41E0 B256
         STM   11,14,104(12)             . 0016D4 90BE C068
         LR    13,12                     . 0016D8 18DC
         LA    12,16(12)                 . 0016DA 41CC 0010
         C     12,@@STACKT               . 0016DE 59C0 A828
         BH    OVER                      . 0016E2 4720 9664
         L     11,@@EXPR                 . 0016E6 58B0 A8BC
         BR    11                        . 0016EA 07FB
S4$016EC STD   0,PATND                   . 0016EC 6000 A500
         B     CDIAG                     . 0016F0 47F0 B930
         LA    6,4                       . 0016F4 4160 0004
         C     6,BRTYPE                  . 0016F8 5960 9E20
         BE    CMPASP                    . 0016FC 4780 B352
         L     1,CMOFCL                  . 001700 5810 9E28
         AR    1,8                       . 001704 1A18
         ST    1,CMOFCL                  . 001706 5010 9E28
         L     2,CMBSCL                  . 00170A 5820 A458
         LD    0,SCANCL                  . 00170E 6800 9DB0
         STD   0,0(1,2)                  . 001712 6001 2000
         LA    14,S4$0173A               . 001716 41E0 B2A4
         STM   11,14,104(12)             . 00171A 90BE C068
         LR    13,12                     . 00171E 18DC
         LD    0,SUBJND                  . 001720 6800 A510
         STD   0,120(12)                 . 001724 600C 0078
         LA    12,24(12)                 . 001728 41CC 0018
         C     12,@@STACKT               . 00172C 59C0 A828
         BH    OVER                      . 001730 4720 9664
         L     11,@@TREPUB               . 001734 58B0 A8B8
         BR    11                        . 001738 07FB
S4$0173A SR    0,0                       . 00173A 1B00
         SR    0,0                       . 00173C 1B00
         LA    14,S4$01762               . 00173E 41E0 B2CC
         STM   11,14,104(12)             . 001742 90BE C068
         LR    13,12                     . 001746 18DC
         LD    0,PATND                   . 001748 6800 A500
         STD   0,120(12)                 . 00174C 600C 0078
         LA    12,24(12)                 . 001750 41CC 0018
         C     12,@@STACKT               . 001754 59C0 A828
         BH    OVER                      . 001758 4720 9664
         L     11,@@TREPUB               . 00175C 58B0 A8B8
         BR    11                        . 001760 07FB
S4$01762 SR    0,0                       . 001762 1B00
         SR    0,0                       . 001764 1B00
                                                             SPACE
* CMPTGO AEQLC BRTYPE,EOSTYP,,CMPNGO
*                                  Check for end of statement
*      AEQLC   BRTYPE,CLNTYP,CERR5,CMPGO
*                                  Check for end of statement
                                                             SPACE
CMPTGO   LA    6,6                       . 001766 4160 0006
         C     6,BRTYPE                  . 00176A 5960 9E20
         BE    CMPNGO                    . 00176E 4780 B408
         LA    6,5                       . 001772 4160 0005
         C     6,BRTYPE                  . 001776 5960 9E20
         BNE   CERR5                     . 00177A 4770 B910
         BE    CMPGO                     . 00177E 4780 B422
                                                             SPACE
* CMPFRM RCALL FORMND,EXPR,,CDIAG  Compile object
*      INCRA   CMOFCL,DESCR        Increment offset
*      PUTD    CMBSCL,CMOFCL,ASGNCL
*                                  Insert ASGN function
*      RCALL   ,TREPUB,(SUBJND)    Copy subject into object code
*      BRANCH  CMPFT               Join object publication
                                                             SPACE
CMPFRM   LA    14,S4$0179E               . 001782 41E0 B308
         STM   11,14,104(12)             . 001786 90BE C068
         LR    13,12                     . 00178A 18DC
         LA    12,16(12)                 . 00178C 41CC 0010
         C     12,@@STACKT               . 001790 59C0 A828
         BH    OVER                      . 001794 4720 9664
         L     11,@@EXPR                 . 001798 58B0 A8BC
         BR    11                        . 00179C 07FB
S4$0179E STD   0,FORMND                  . 00179E 6000 A4E8
         B     CDIAG                     . 0017A2 47F0 B930
         L     1,CMOFCL                  . 0017A6 5810 9E28
         AR    1,8                       . 0017AA 1A18
         ST    1,CMOFCL                  . 0017AC 5010 9E28
         L     2,CMBSCL                  . 0017B0 5820 A458
         LD    0,ASGNCL                  . 0017B4 6800 9CD8
         STD   0,0(1,2)                  . 0017B8 6001 2000
         LA    14,S4$017E0               . 0017BC 41E0 B34A
         STM   11,14,104(12)             . 0017C0 90BE C068
         LR    13,12                     . 0017C4 18DC
         LD    0,SUBJND                  . 0017C6 6800 A510
         STD   0,120(12)                 . 0017CA 600C 0078
         LA    12,24(12)                 . 0017CE 41CC 0018
         C     12,@@STACKT               . 0017D2 59C0 A828
         BH    OVER                      . 0017D6 4720 9664
         L     11,@@TREPUB               . 0017DA 58B0 A8B8
         BR    11                        . 0017DE 07FB
S4$017E0 SR    0,0                       . 0017E0 1B00
         SR    0,0                       . 0017E2 1B00
         B     CMPFT                     . 0017E4 47F0 B3DC
                                                             SPACE
* CMPASP RCALL FORMND,EXPR,,CDIAG  Compile object
*      INCRA   CMOFCL,DESCR        Increment offset
*      PUTD    CMBSCL,CMOFCL,SJSRCL
*                                  Insert SJSR function
*      RCALL   ,TREPUB,(SUBJND)    Copy subject into object code
*      RCALL   ,TREPUB,(PATND)     Copy pattern into object code
                                                             SPACE
CMPASP   LA    14,S4$01804               . 0017E8 41E0 B36E
         STM   11,14,104(12)             . 0017EC 90BE C068
         LR    13,12                     . 0017F0 18DC
         LA    12,16(12)                 . 0017F2 41CC 0010
         C     12,@@STACKT               . 0017F6 59C0 A828
         BH    OVER                      . 0017FA 4720 9664
         L     11,@@EXPR                 . 0017FE 58B0 A8BC
         BR    11                        . 001802 07FB
S4$01804 STD   0,FORMND                  . 001804 6000 A4E8
         B     CDIAG                     . 001808 47F0 B930
         L     1,CMOFCL                  . 00180C 5810 9E28
         AR    1,8                       . 001810 1A18
         ST    1,CMOFCL                  . 001812 5010 9E28
         L     2,CMBSCL                  . 001816 5820 A458
         LD    0,SJSRCL                  . 00181A 6800 9DD0
         STD   0,0(1,2)                  . 00181E 6001 2000
         LA    14,S4$01846               . 001822 41E0 B3B0
         STM   11,14,104(12)             . 001826 90BE C068
         LR    13,12                     . 00182A 18DC
         LD    0,SUBJND                  . 00182C 6800 A510
         STD   0,120(12)                 . 001830 600C 0078
         LA    12,24(12)                 . 001834 41CC 0018
         C     12,@@STACKT               . 001838 59C0 A828
         BH    OVER                      . 00183C 4720 9664
         L     11,@@TREPUB               . 001840 58B0 A8B8
         BR    11                        . 001844 07FB
S4$01846 SR    0,0                       . 001846 1B00
         SR    0,0                       . 001848 1B00
         LA    14,S4$0186E               . 00184A 41E0 B3D8
         STM   11,14,104(12)             . 00184E 90BE C068
         LR    13,12                     . 001852 18DC
         LD    0,PATND                   . 001854 6800 A500
         STD   0,120(12)                 . 001858 600C 0078
         LA    12,24(12)                 . 00185C 41CC 0018
         C     12,@@STACKT               . 001860 59C0 A828
         BH    OVER                      . 001864 4720 9664
         L     11,@@TREPUB               . 001868 58B0 A8B8
         BR    11                        . 00186C 07FB
S4$0186E SR    0,0                       . 00186E 1B00
         SR    0,0                       . 001870 1B00
                                                             SPACE
* CMPFT RCALL  ,TREPUB,FORMND,CMPTGO
*                                  Copy object into object code
                                                             SPACE
CMPFT    LA    14,S4$01896               . 001872 41E0 B400
         STM   11,14,104(12)             . 001876 90BE C068
         LR    13,12                     . 00187A 18DC
         LD    0,FORMND                  . 00187C 6800 A4E8
         STD   0,120(12)                 . 001880 600C 0078
         LA    12,24(12)                 . 001884 41CC 0018
         C     12,@@STACKT               . 001888 59C0 A828
         BH    OVER                      . 00188C 4720 9664
         L     11,@@TREPUB               . 001890 58B0 A8B8
         BR    11                        . 001894 07FB
S4$01896 SR    0,0                       . 001896 1B00
         SR    0,0                       . 001898 1B00
         B     CMPTGO                    . 00189A 47F0 B2D0
                                                             SPACE
* CMPNGO SETVA CSTNCL,CMOFCL       Set up offset for failure
*      PUTD    CMBSCL,FRNCL,CSTNCL Insert argument of INIT
*      BRANCH  RTN3                Statement compilation is done
                                                             SPACE
CMPNGO   MVC   CSTNCL$5(3),CMOFCL$1      . 00189E D202 9B75 9E29
         L     1,FRNCL                   . 0018A4 5810 A4F0
         L     2,CMBSCL                  . 0018A8 5820 A458
         LD    0,CSTNCL                  . 0018AC 6800 9B70
         STD   0,0(1,2)                  . 0018B0 6001 2000
         B     RTNUL3                    . 0018B4 47F0 9030
                                                             SPACE
* CMPGO RCALL  ,FORWRD,,COMP3      Check for end of statement
*      AEQLC   BRTYPE,EOSTYP,,CMPNGO
*                                  Check for nonbreak
*      AEQLC   BRTYPE,NBTYP,CERR11
*      STREAM  XSP,TEXTSP,GOTOTB,CERR11,CERR12
*                                  Analyze goto field
*      MOVD    GOGOCL,GOTLCL       Predict GOTL
*      SETAC   GOBRCL,RPTYP        Set up predicted closing break
*      ACOMP   STYPE,GTOCL,,CMPGG,CMPGG
*                                  Check for direct goto
*      MOVD    GOGOCL,GOTGCL       Set up direct goto
*      SETAC   GOBRCL,RBTYP        Set up closing break
                                                             SPACE
CMPGO    LA    14,S4$018D4               . 0018B8 41E0 B43E
         STM   11,14,104(12)             . 0018BC 90BE C068
         LR    13,12                     . 0018C0 18DC
         LA    12,16(12)                 . 0018C2 41CC 0010
         C     12,@@STACKT               . 0018C6 59C0 A828
         BH    OVER                      . 0018CA 4720 9664
         L     11,@@FORWRD               . 0018CE 58B0 A8A8
         BR    11                        . 0018D2 07FB
S4$018D4 SR    0,0                       . 0018D4 1B00
         SR    0,0                       . 0018D6 1B00
         B     S4$010                    . 0018D8 47F0 95AC
         LA    6,6                       . 0018DC 4160 0006
         C     6,BRTYPE                  . 0018E0 5960 9E20
         BE    CMPNGO                    . 0018E4 4780 B408
         LA    6,1                       . 0018E8 4160 0001
         C     6,BRTYPE                  . 0018EC 5960 9E20
         BNE   CERR11                    . 0018F0 4770 B928
         L     15,@@STREAM               . 0018F4 58F0 A840
         LA    1,XSP                     . 0018F8 4110 A5D0
         LA    2,TEXTSP                  . 0018FC 4120 A590
         L     3,@@GOTOTB                . 001900 5830 A8C0
         BALR  14,15                          CALL                     *
                                         . 001904 05EF
         B     CERR11                    . 001906 47F0 B928
         B     CERR12                    . 00190A 47F0 B91C
         LD    0,GOTLCL                  . 00190E 6800 9D58
         STD   0,GOGOCL                  . 001912 6000 9E90
         L     1,@@F3                    . 001916 5810 A8C4
         ST    1,GOBRCL                  . 00191A 5010 9C30
         L     1,STYPE                   . 00191E 5810 9F08
         C     1,GTOCL                   . 001922 5910 9C38
         BNH   CMPGG                     . 001926 47D0 B4A4
         LD    0,GOTGCL                  . 00192A 6800 9D50
         STD   0,GOGOCL                  . 00192E 6000 9E90
         L     1,@@F7                    . 001932 5810 A8C8
         ST    1,GOBRCL                  . 001936 5010 9C30
                                                             SPACE
* CMPGG SELBRA STYPE,(,CMPSGO,CMPFGO,,CMPSGO,CMPFGO)
*                                  Branch on type
                                                             SPACE
CMPGG    L     1,STYPE                   . 00193A 5810 9F08
         SLA   1,2                       . 00193E 8B10 0002
S4$01942 B     S4$01942(1)               . 001942 47F1 B4AC
         B     CMPUGO                    . 001946 47F0 B4C8
         B     CMPSGO                    . 00194A 47F0 B580
         B     CMPFGO                    . 00194E 47F0 B69E
         B     CMPUGO                    . 001952 47F0 B4C8
         B     CMPSGO                    . 001956 47F0 B580
         B     CMPFGO                    . 00195A 47F0 B69E
                                                             SPACE
* CMPUGO SETVA CSTNCL,CMOFCL       Set up offset for failure
*      PUTD    CMBSCL,FRNCL,CSTNCL Insert argument of INIT
*      RCALL   GOTOND,EXPR,,CDIAG  Compile goto
*      AEQL    BRTYPE,GOBRCL,CERR11
*                                  Verify closing break
*      INCRA   CMOFCL,DESCR        Increment offset
*      PUTD    CMBSCL,CMOFCL,GOGOCL
*                                  Insert goto function
*      RCALL   ,TREPUB,(GOTOND)    Copy goto into object code
*      RCALL   ,FORWRD,,COMP3      Get to next character
*      AEQLC   BRTYPE,EOSTYP,CERR11,RTN3
*                                  Check for end of statement
                                                             SPACE
CMPUGO   MVC   CSTNCL$5(3),CMOFCL$1      . 00195E D202 9B75 9E29
         L     1,FRNCL                   . 001964 5810 A4F0
         L     2,CMBSCL                  . 001968 5820 A458
         LD    0,CSTNCL                  . 00196C 6800 9B70
         STD   0,0(1,2)                  . 001970 6001 2000
         LA    14,S4$01990               . 001974 41E0 B4FA
         STM   11,14,104(12)             . 001978 90BE C068
         LR    13,12                     . 00197C 18DC
         LA    12,16(12)                 . 00197E 41CC 0010
         C     12,@@STACKT               . 001982 59C0 A828
         BH    OVER                      . 001986 4720 9664
         L     11,@@EXPR                 . 00198A 58B0 A8BC
         BR    11                        . 00198E 07FB
S4$01990 STD   0,GOTOND                  . 001990 6000 A4F8
         B     CDIAG                     . 001994 47F0 B930
         L     1,BRTYPE                  . 001998 5810 9E20
         C     1,GOBRCL                  . 00199C 5910 9C30
         BNE   CERR11                    . 0019A0 4770 B928
         L     1,CMOFCL                  . 0019A4 5810 9E28
         AR    1,8                       . 0019A8 1A18
         ST    1,CMOFCL                  . 0019AA 5010 9E28
         L     2,CMBSCL                  . 0019AE 5820 A458
         LD    0,GOGOCL                  . 0019B2 6800 9E90
         STD   0,0(1,2)                  . 0019B6 6001 2000
         LA    14,S4$019DE               . 0019BA 41E0 B548
         STM   11,14,104(12)             . 0019BE 90BE C068
         LR    13,12                     . 0019C2 18DC
         LD    0,GOTOND                  . 0019C4 6800 A4F8
         STD   0,120(12)                 . 0019C8 600C 0078
         LA    12,24(12)                 . 0019CC 41CC 0018
         C     12,@@STACKT               . 0019D0 59C0 A828
         BH    OVER                      . 0019D4 4720 9664
         L     11,@@TREPUB               . 0019D8 58B0 A8B8
         BR    11                        . 0019DC 07FB
S4$019DE SR    0,0                       . 0019DE 1B00
         SR    0,0                       . 0019E0 1B00
         LA    14,S4$019FE               . 0019E2 41E0 B568
         STM   11,14,104(12)             . 0019E6 90BE C068
         LR    13,12                     . 0019EA 18DC
         LA    12,16(12)                 . 0019EC 41CC 0010
         C     12,@@STACKT               . 0019F0 59C0 A828
         BH    OVER                      . 0019F4 4720 9664
         L     11,@@FORWRD               . 0019F8 58B0 A8A8
         BR    11                        . 0019FC 07FB
S4$019FE SR    0,0                       . 0019FE 1B00
         SR    0,0                       . 001A00 1B00
         B     S4$010                    . 001A02 47F0 95AC
         LA    6,6                       . 001A06 4160 0006
         C     6,BRTYPE                  . 001A0A 5960 9E20
         BNE   CERR11                    . 001A0E 4770 B928
         BE    RTNUL3                    . 001A12 4780 9030
                                                             SPACE
* CMPSGO RCALL SGOND,EXPR,,CDIAG   Compile success goto
*      AEQL    BRTYPE,GOBRCL,CERR11
*                                  Verify break character
*      INCRA   CMOFCL,DESCR        Increment offset
*      PUTD    CMBSCL,CMOFCL,GOGOCL
*                                  Insert goto function
*      RCALL   ,TREPUB,(SGOND)     Copy goto into object code
*      RCALL   ,FORWRD,,COMP3      Get to next character
*      AEQLC   BRTYPE,EOSTYP,CMPILL
*                                  Check for end of statement
*      SETVA   CSTNCL,CMOFCL       Set up offset for failure
*      PUTD    CMBSCL,FRNCL,CSTNCL Insert argument of INIT
*      BRANCH  RTN3                Compilation is complete, return
                                                             SPACE
CMPSGO   LA    14,S4$01A32               . 001A16 41E0 B59C
         STM   11,14,104(12)             . 001A1A 90BE C068
         LR    13,12                     . 001A1E 18DC
         LA    12,16(12)                 . 001A20 41CC 0010
         C     12,@@STACKT               . 001A24 59C0 A828
         BH    OVER                      . 001A28 4720 9664
         L     11,@@EXPR                 . 001A2C 58B0 A8BC
         BR    11                        . 001A30 07FB
S4$01A32 STD   0,SGOND                   . 001A32 6000 A508
         B     CDIAG                     . 001A36 47F0 B930
         L     1,BRTYPE                  . 001A3A 5810 9E20
         C     1,GOBRCL                  . 001A3E 5910 9C30
         BNE   CERR11                    . 001A42 4770 B928
         L     1,CMOFCL                  . 001A46 5810 9E28
         AR    1,8                       . 001A4A 1A18
         ST    1,CMOFCL                  . 001A4C 5010 9E28
         L     2,CMBSCL                  . 001A50 5820 A458
         LD    0,GOGOCL                  . 001A54 6800 9E90
         STD   0,0(1,2)                  . 001A58 6001 2000
         LA    14,S4$01A80               . 001A5C 41E0 B5EA
         STM   11,14,104(12)             . 001A60 90BE C068
         LR    13,12                     . 001A64 18DC
         LD    0,SGOND                   . 001A66 6800 A508
         STD   0,120(12)                 . 001A6A 600C 0078
         LA    12,24(12)                 . 001A6E 41CC 0018
         C     12,@@STACKT               . 001A72 59C0 A828
         BH    OVER                      . 001A76 4720 9664
         L     11,@@TREPUB               . 001A7A 58B0 A8B8
         BR    11                        . 001A7E 07FB
S4$01A80 SR    0,0                       . 001A80 1B00
         SR    0,0                       . 001A82 1B00
         LA    14,S4$01AA0               . 001A84 41E0 B60A
         STM   11,14,104(12)             . 001A88 90BE C068
         LR    13,12                     . 001A8C 18DC
         LA    12,16(12)                 . 001A8E 41CC 0010
         C     12,@@STACKT               . 001A92 59C0 A828
         BH    OVER                      . 001A96 4720 9664
         L     11,@@FORWRD               . 001A9A 58B0 A8A8
         BR    11                        . 001A9E 07FB
S4$01AA0 SR    0,0                       . 001AA0 1B00
         SR    0,0                       . 001AA2 1B00
         B     S4$010                    . 001AA4 47F0 95AC
         LA    6,6                       . 001AA8 4160 0006
         C     6,BRTYPE                  . 001AAC 5960 9E20
         BNE   CMPILL                    . 001AB0 4770 B638
         MVC   CSTNCL$5(3),CMOFCL$1      . 001AB4 D202 9B75 9E29
         L     1,FRNCL                   . 001ABA 5810 A4F0
         L     2,CMBSCL                  . 001ABE 5820 A458
         LD    0,CSTNCL                  . 001AC2 6800 9B70
         STD   0,0(1,2)                  . 001AC6 6001 2000
         B     RTNUL3                    . 001ACA 47F0 9030
                                                             SPACE
* CMPILL AEQLC BRTYPE,NBTYP,CERR11 Check for nonbreak
*      STREAM  XSP,TEXTSP,GOTOTB,CERR11,CERR12
*                                  Analyze goto field
*      AEQLC   STYPE,FGOTYP,CMPFTC Check for failure goto
*      MOVD    GOGOCL,GOTLCL       Set up goto
*      SETAC   GOBRCL,RPTYP        Set up closing break
*      BRANCH  CMPUGO              Join processing
                                                             SPACE
CMPILL   LA    6,1                       . 001ACE 4160 0001
         C     6,BRTYPE                  . 001AD2 5960 9E20
         BNE   CERR11                    . 001AD6 4770 B928
         L     15,@@STREAM               . 001ADA 58F0 A840
         LA    1,XSP                     . 001ADE 4110 A5D0
         LA    2,TEXTSP                  . 001AE2 4120 A590
         L     3,@@GOTOTB                . 001AE6 5830 A8C0
         BALR  14,15                          CALL                     *
                                         . 001AEA 05EF
         B     CERR11                    . 001AEC 47F0 B928
         B     CERR12                    . 001AF0 47F0 B91C
         LA    6,3                       . 001AF4 4160 0003
         C     6,STYPE                   . 001AF8 5960 9F08
         BNE   CMPFTC                    . 001AFC 4770 B67E
         LD    0,GOTLCL                  . 001B00 6800 9D58
         STD   0,GOGOCL                  . 001B04 6000 9E90
         L     1,@@F3                    . 001B08 5810 A8C4
         ST    1,GOBRCL                  . 001B0C 5010 9C30
         B     CMPUGO                    . 001B10 47F0 B4C8
                                                             SPACE
* CMPFTC AEQLC STYPE,FTOTYP,CERR11 Verify failure goto
*      MOVD    GOGOCL,GOTGCL       Set up goto
*      SETAC   GOBRCL,RBTYP        Set up closing break
*      BRANCH  CMPUGO              Join processing
                                                             SPACE
CMPFTC   LA    6,6                       . 001B14 4160 0006
         C     6,STYPE                   . 001B18 5960 9F08
         BNE   CERR11                    . 001B1C 4770 B928
         LD    0,GOTGCL                  . 001B20 6800 9D50
         STD   0,GOGOCL                  . 001B24 6000 9E90
         L     1,@@F7                    . 001B28 5810 A8C8
         ST    1,GOBRCL                  . 001B2C 5010 9C30
         B     CMPUGO                    . 001B30 47F0 B4C8
                                                             SPACE
* CMPFGO RCALL FGOND,EXPR,,CDIAG   Compile failure goto
*      AEQL    BRTYPE,GOBRCL,CERR11
*                                  Verify failure goto
*      RCALL   ,FORWRD,,COMP3      Get to next character
*      AEQLC   BRTYPE,EOSTYP,CMPILM
*                                  Check for end of statement
*      INCRA   CMOFCL,DESCR        Increment offset
*      PUTD    CMBSCL,CMOFCL,GOTOCL
*                                  Insert goto function
*      INCRA   CMOFCL,DESCR        Increment offset
*      MOVD    SRNCL,CMOFCL        Save location for success
*      SETVA   CSTNCL,CMOFCL       Set up failure offset
*      PUTD    CMBSCL,FRNCL,CSTNCL Insert argument of INIT
*      INCRA   CMOFCL,DESCR        Increment offset
*      PUTD    CMBSCL,CMOFCL,GOGOCL
*                                  Insert goto function
*      RCALL   ,TREPUB,(FGOND)     Copy goto into object code
*      PUTD    CMBSCL,SRNCL,CMOFCL Insert success offset into code
*      BRANCH  RTN3                Compilation is complete, return
                                                             SPACE
CMPFGO   LA    14,S4$01B50               . 001B34 41E0 B6BA
         STM   11,14,104(12)             . 001B38 90BE C068
         LR    13,12                     . 001B3C 18DC
         LA    12,16(12)                 . 001B3E 41CC 0010
         C     12,@@STACKT               . 001B42 59C0 A828
         BH    OVER                      . 001B46 4720 9664
         L     11,@@EXPR                 . 001B4A 58B0 A8BC
         BR    11                        . 001B4E 07FB
S4$01B50 STD   0,FGOND                   . 001B50 6000 A4E0
         B     CDIAG                     . 001B54 47F0 B930
         L     1,BRTYPE                  . 001B58 5810 9E20
         C     1,GOBRCL                  . 001B5C 5910 9C30
         BNE   CERR11                    . 001B60 4770 B928
         LA    14,S4$01B80               . 001B64 41E0 B6EA
         STM   11,14,104(12)             . 001B68 90BE C068
         LR    13,12                     . 001B6C 18DC
         LA    12,16(12)                 . 001B6E 41CC 0010
         C     12,@@STACKT               . 001B72 59C0 A828
         BH    OVER                      . 001B76 4720 9664
         L     11,@@FORWRD               . 001B7A 58B0 A8A8
         BR    11                        . 001B7E 07FB
S4$01B80 SR    0,0                       . 001B80 1B00
         SR    0,0                       . 001B82 1B00
         B     S4$010                    . 001B84 47F0 95AC
         LA    6,6                       . 001B88 4160 0006
         C     6,BRTYPE                  . 001B8C 5960 9E20
         BNE   CMPILM                    . 001B90 4770 B77E
         L     1,CMOFCL                  . 001B94 5810 9E28
         AR    1,8                       . 001B98 1A18
         L     2,CMBSCL                  . 001B9A 5820 A458
         LD    0,GOTOCL                  . 001B9E 6800 9D60
         STD   0,0(1,2)                  . 001BA2 6001 2000
         AR    1,8                       . 001BA6 1A18
         ST    1,CMOFCL                  . 001BA8 5010 9E28
         LD    0,CMOFCL                  . 001BAC 6800 9E28
         STD   0,SRNCL                   . 001BB0 6000 A498
         MVC   CSTNCL$5(3),CMOFCL$1      . 001BB4 D202 9B75 9E29
         L     1,FRNCL                   . 001BBA 5810 A4F0
         LD    0,CSTNCL                  . 001BBE 6800 9B70
         STD   0,0(1,2)                  . 001BC2 6001 2000
         L     1,CMOFCL                  . 001BC6 5810 9E28
         AR    1,8                       . 001BCA 1A18
         ST    1,CMOFCL                  . 001BCC 5010 9E28
         LD    0,GOGOCL                  . 001BD0 6800 9E90
         STD   0,0(1,2)                  . 001BD4 6001 2000
         LA    14,S4$01BFC               . 001BD8 41E0 B766
         STM   11,14,104(12)             . 001BDC 90BE C068
         LR    13,12                     . 001BE0 18DC
         LD    0,FGOND                   . 001BE2 6800 A4E0
         STD   0,120(12)                 . 001BE6 600C 0078
         LA    12,24(12)                 . 001BEA 41CC 0018
         C     12,@@STACKT               . 001BEE 59C0 A828
         BH    OVER                      . 001BF2 4720 9664
         L     11,@@TREPUB               . 001BF6 58B0 A8B8
         BR    11                        . 001BFA 07FB
S4$01BFC SR    0,0                       . 001BFC 1B00
         SR    0,0                       . 001BFE 1B00
         L     1,SRNCL                   . 001C00 5810 A498
         L     2,CMBSCL                  . 001C04 5820 A458
         LD    0,CMOFCL                  . 001C08 6800 9E28
         STD   0,0(1,2)                  . 001C0C 6001 2000
         B     RTNUL3                    . 001C10 47F0 9030
                                                             SPACE
* CMPILM AEQLC BRTYPE,NBTYP,CERR11 Verify nonbreak
*      STREAM  XSP,TEXTSP,GOTOTB,CERR11,CERR12
*                                  Analyze goto field
*      AEQLC   STYPE,SGOTYP,CMPSTC Check for success goto
*      PUSH    GOTLCL              Save goto type
*      SETAC   GOBRCL,RPTYP        Set up closing break
*      BRANCH  CMPILN              Join processing
                                                             SPACE
CMPILM   LA    6,1                       . 001C14 4160 0001
         C     6,BRTYPE                  . 001C18 5960 9E20
         BNE   CERR11                    . 001C1C 4770 B928
         L     15,@@STREAM               . 001C20 58F0 A840
         LA    1,XSP                     . 001C24 4110 A5D0
         LA    2,TEXTSP                  . 001C28 4120 A590
         L     3,@@GOTOTB                . 001C2C 5830 A8C0
         BALR  14,15                          CALL                     *
                                         . 001C30 05EF
         B     CERR11                    . 001C32 47F0 B928
         B     CERR12                    . 001C36 47F0 B91C
         LA    6,2                       . 001C3A 4160 0002
         C     6,STYPE                   . 001C3E 5960 9F08
         BNE   CMPSTC                    . 001C42 4770 B7CE
         LD    0,GOTLCL                  . 001C46 6800 9D58
         STD   0,104(12)                 . 001C4A 600C 0068
         AR    12,8                      . 001C4E 1AC8
         C     12,@@STACKT               . 001C50 59C0 A828
         BH    OVER                      . 001C54 4720 9664
         L     1,@@F3                    . 001C58 5810 A8C4
         ST    1,GOBRCL                  . 001C5C 5010 9C30
         B     CMPILN                    . 001C60 47F0 B7F4
                                                             SPACE
* CMPSTC AEQLC STYPE,STOTYP,CERR11 Verify success goto
*      PUSH    GOTGCL              Save goto type
*      SETAC   GOBRCL,RBTYP        Set up closing break
                                                             SPACE
CMPSTC   LA    6,5                       . 001C64 4160 0005
         C     6,STYPE                   . 001C68 5960 9F08
         BNE   CERR11                    . 001C6C 4770 B928
         LD    0,GOTGCL                  . 001C70 6800 9D50
         STD   0,104(12)                 . 001C74 600C 0068
         AR    12,8                      . 001C78 1AC8
         C     12,@@STACKT               . 001C7A 59C0 A828
         BH    OVER                      . 001C7E 4720 9664
         L     1,@@F7                    . 001C82 5810 A8C8
         ST    1,GOBRCL                  . 001C86 5010 9C30
                                                             SPACE
* CMPILN RCALL SGOND,EXPR,,CDIAG   Compile success goto
*      AEQL    BRTYPE,GOBRCL,CERR11
*                                  Verify closing break
*      RCALL   ,FORWRD,,COMP3      Get to next character
*      AEQLC   BRTYPE,EOSTYP,CERR11
*                                  Verify end of statement
*      INCRA   CMOFCL,DESCR        Increment offset
*      POP     WCL                 Restore goto type
*      PUTD    CMBSCL,CMOFCL,WCL   Insert goto function
*      RCALL   ,TREPUB,(SGOND)     Copy goto into object code
*      SETVA   CSTNCL,CMOFCL       Set up failure offset
*      PUTD    CMBSCL,FRNCL,CSTNCL Insert argument of INIT
*      INCRA   CMOFCL,DESCR        Increment offset
*      PUTD    CMBSCL,CMOFCL,GOGOCL
*                                  Insert goto function
*      RCALL   ,TREPUB,(FGOND),RTN3
*                                  Copy goto into object code
                                                             SPACE
CMPILN   LA    14,S4$01CA6               . 001C8A 41E0 B810
         STM   11,14,104(12)             . 001C8E 90BE C068
         LR    13,12                     . 001C92 18DC
         LA    12,16(12)                 . 001C94 41CC 0010
         C     12,@@STACKT               . 001C98 59C0 A828
         BH    OVER                      . 001C9C 4720 9664
         L     11,@@EXPR                 . 001CA0 58B0 A8BC
         BR    11                        . 001CA4 07FB
S4$01CA6 STD   0,SGOND                   . 001CA6 6000 A508
         B     CDIAG                     . 001CAA 47F0 B930
         L     1,BRTYPE                  . 001CAE 5810 9E20
         C     1,GOBRCL                  . 001CB2 5910 9C30
         BNE   CERR11                    . 001CB6 4770 B928
         LA    14,S4$01CD6               . 001CBA 41E0 B840
         STM   11,14,104(12)             . 001CBE 90BE C068
         LR    13,12                     . 001CC2 18DC
         LA    12,16(12)                 . 001CC4 41CC 0010
         C     12,@@STACKT               . 001CC8 59C0 A828
         BH    OVER                      . 001CCC 4720 9664
         L     11,@@FORWRD               . 001CD0 58B0 A8A8
         BR    11                        . 001CD4 07FB
S4$01CD6 SR    0,0                       . 001CD6 1B00
         SR    0,0                       . 001CD8 1B00
         B     S4$010                    . 001CDA 47F0 95AC
         LA    6,6                       . 001CDE 4160 0006
         C     6,BRTYPE                  . 001CE2 5960 9E20
         BNE   CERR11                    . 001CE6 4770 B928
         L     1,CMOFCL                  . 001CEA 5810 9E28
         AR    1,8                       . 001CEE 1A18
         ST    1,CMOFCL                  . 001CF0 5010 9E28
         LD    0,96(12)                  . 001CF4 680C 0060
         STD   0,WCL                     . 001CF8 6000 A3F8
         SR    12,8                      . 001CFC 1BC8
         L     2,CMBSCL                  . 001CFE 5820 A458
         STD   0,0(1,2)                  . 001D02 6001 2000
         LA    14,S4$01D2A               . 001D06 41E0 B894
         STM   11,14,104(12)             . 001D0A 90BE C068
         LR    13,12                     . 001D0E 18DC
         LD    0,SGOND                   . 001D10 6800 A508
         STD   0,120(12)                 . 001D14 600C 0078
         LA    12,24(12)                 . 001D18 41CC 0018
         C     12,@@STACKT               . 001D1C 59C0 A828
         BH    OVER                      . 001D20 4720 9664
         L     11,@@TREPUB               . 001D24 58B0 A8B8
         BR    11                        . 001D28 07FB
S4$01D2A SR    0,0                       . 001D2A 1B00
         SR    0,0                       . 001D2C 1B00
         MVC   CSTNCL$5(3),CMOFCL$1      . 001D2E D202 9B75 9E29
         L     1,FRNCL                   . 001D34 5810 A4F0
         L     2,CMBSCL                  . 001D38 5820 A458
         LD    0,CSTNCL                  . 001D3C 6800 9B70
         STD   0,0(1,2)                  . 001D40 6001 2000
         L     1,CMOFCL                  . 001D44 5810 9E28
         AR    1,8                       . 001D48 1A18
         ST    1,CMOFCL                  . 001D4A 5010 9E28
         LD    0,GOGOCL                  . 001D4E 6800 9E90
         STD   0,0(1,2)                  . 001D52 6001 2000
         LA    14,S4$01D7A               . 001D56 41E0 B8E4
         STM   11,14,104(12)             . 001D5A 90BE C068
         LR    13,12                     . 001D5E 18DC
         LD    0,FGOND                   . 001D60 6800 A4E0
         STD   0,120(12)                 . 001D64 600C 0078
         LA    12,24(12)                 . 001D68 41CC 0018
         C     12,@@STACKT               . 001D6C 59C0 A828
         BH    OVER                      . 001D70 4720 9664
         L     11,@@TREPUB               . 001D74 58B0 A8B8
         BR    11                        . 001D78 07FB
S4$01D7A SR    0,0                       . 001D7A 1B00
         SR    0,0                       . 001D7C 1B00
         B     RTNUL3                    . 001D7E 47F0 9030
                                                             SPACE
* CERR1 SETAC  EMSGCL,EMSG1        Erroneous label
*      BRANCH  CDIAG
                                                             SPACE
CERR1    L     1,@@EMSG1                 . 001D82 5810 A8CC
         ST    1,EMSGCL                  . 001D86 5010 9E50
         B     CDIAG                     . 001D8A 47F0 B930
                                                             SPACE
* CERR2 SETAC  EMSGCL,EMSG2        Multidefined label
*      BRANCH  CDIAG
                                                             SPACE
CERR2    L     1,@@EMSG2                 . 001D8E 5810 A8D0
         ST    1,EMSGCL                  . 001D92 5010 9E50
         B     CDIAG                     . 001D96 47F0 B930
                                                             SPACE
* CERR3 SETAC  EMSGCL,EMSG3        Break character before subject
*      BRANCH  CDIAG
                                                             SPACE
CERR3    L     1,@@EMSG3                 . 001D9A 5810 A8D4
         ST    1,EMSGCL                  . 001D9E 5010 9E50
         B     CDIAG                     . 001DA2 47F0 B930
                                                             SPACE
* CERR5 SETAC  EMSGCL,ILLBRK       Illegal character after pattern
*      BRANCH  CDIAG
                                                             SPACE
CERR5    L     1,@@ILLBRK                . 001DA6 5810 A8D8
         ST    1,EMSGCL                  . 001DAA 5010 9E50
         B     CDIAG                     . 001DAE 47F0 B930
                                                             SPACE
* CERR12 SETAC EMSGCL,ILLEOS       Illegal statement termination
*      BRANCH  CDIAG
                                                             SPACE
CERR12   L     1,@@ILLEOS                . 001DB2 5810 A8B0
         ST    1,EMSGCL                  . 001DB6 5010 9E50
         B     CDIAG                     . 001DBA 47F0 B930
                                                             SPACE
* CERR11 SETAC EMSGCL,EMSG14       Characters after goto
                                                             SPACE
CERR11   L     1,@@EMSG14                . 001DBE 5810 A8DC
         ST    1,EMSGCL                  . 001DC2 5010 9E50
                                                             SPACE
* CDIAG INCRA  BOSCL,DESCR         Increment offset of beginning
*      PUTD    CMBSCL,BOSCL,ERORCL Insert ERROR function
*      INCRA   BOSCL,DESCR         Increment offset
*      PUTD    CMBSCL,BOSCL,CSTNCL Insert argument of ERROR
*      MOVD    CMOFCL,BOSCL        Reposition offset
*      INCRA   ESAICL,DESCR        Increment count of errors
*      ACOMP   ESAICL,ESALIM,COMP9 Test for excessive errors
*      AEQLC   LISTCL,0,,CDIAG1    Check for listing mode
*      MOVD    YCL,ERRBAS          Set up length of error vector
*      AEQLC   BRTYPE,EOSTYP,,CDIAG3
*                                  Check for end of statement
*      GETLG   XCL,TEXTSP          Get length remaining
*      SUBTRT  YCL,YCL,XCL         Compute position for marker
                                                             SPACE
CDIAG    L     1,BOSCL                   . 001DC6 5810 A450
         AR    1,8                       . 001DCA 1A18
         ST    1,BOSCL                   . 001DCC 5010 A450
         L     2,CMBSCL                  . 001DD0 5820 A458
         LD    0,ERORCL                  . 001DD4 6800 9D38
         STD   0,0(1,2)                  . 001DD8 6001 2000
         L     1,BOSCL                   . 001DDC 5810 A450
         AR    1,8                       . 001DE0 1A18
         ST    1,BOSCL                   . 001DE2 5010 A450
         LD    0,CSTNCL                  . 001DE6 6800 9B70
         STD   0,0(1,2)                  . 001DEA 6001 2000
         LD    0,BOSCL                   . 001DEE 6800 A450
         STD   0,CMOFCL                  . 001DF2 6000 9E28
         L     1,ESAICL                  . 001DF6 5810 9E60
         AR    1,8                       . 001DFA 1A18
         ST    1,ESAICL                  . 001DFC 5010 9E60
         C     1,ESALIM                  . 001E00 5910 9C18
         BH    COMP9                     . 001E04 4720 95C4
         C     0,LISTCL                  . 001E08 5900 9BC8
         BE    CDIAG1                    . 001E0C 4780 BA4C
         LD    0,ERRBAS                  . 001E10 6800 9E58
         STD   0,YCL                     . 001E14 6000 A420
         LA    6,6                       . 001E18 4160 0006
         C     6,BRTYPE                  . 001E1C 5960 9E20
         BE    CDIAG3                    . 001E20 4780 B9A0
         L     15,TEXTSP                 . 001E24 58F0 A590
         STM   15,0,XCL                  . 001E28 90F0 A408
         L     1,YCL                     . 001E2C 5810 A420
         SR    1,15                      . 001E30 1B1F
         ST    1,YCL                     . 001E32 5010 A420
                                                             SPACE
* CDIAG3 PUTLG ERRSP,YCL           Insert length
*      APDSP   ERRSP,QTSP          Set in marker
*      AEQLC   BRTYPE,EOSTYP,,CDIAG2
*                                  Check for end of statement
*      STPRNT  IOKEY,OUTBLK,LNBFSP Print statement
                                                             SPACE
CDIAG3   L     1,YCL                     . 001E36 5810 A420
         ST    1,ERRSP                   . 001E3A 5010 9FA8
         L     15,@@APDSP                . 001E3E 58F0 A870
         LA    2,ERRSP                   . 001E42 4120 9FA8
         LM    3,5,QTSP                  . 001E46 9835 A078
         BALR  14,15                          CALL                     *
                                         . 001E4A 05EF
         LA    6,6                       . 001E4C 4160 0006
         C     6,BRTYPE                  . 001E50 5960 9E20
         BE    CDIAG2                    . 001E54 4780 B9D4
         L     15,@@STPRNT               . 001E58 58F0 A838
         LA    1,IOKEY                   . 001E5C 4110 9EA0
         LA    2,OUTBLK                  . 001E60 4120 9C70
         LA    3,LNBFSP                  . 001E64 4130 9FC8
         BALR  14,15                          CALL                     *
                                         . 001E68 05EF
                                                             SPACE
* CDIAG2 STPRNT IOKEY,OUTBLK,ERRSP Print error marker
*      PUTLG   ERRSP,YCL           Insert length in marker
*      APDSP   ERRSP,BLSP          Blank out marker
*      GETSPC  TSP,EMSGCL,0        Get error message
*      SETLC   CERRSP,0            Clear specifier
*      APDSP   CERRSP,STARSP       Append attention getter
*      APDSP   CERRSP,TSP          Append error message
*      STPRNT  IOKEY,OUTBLK,CERRSP Print error message
*      STPRNT  IOKEY,OUTBLK,BLSP   Print blank line
                                                             SPACE
CDIAG2   L     15,@@STPRNT               . 001E6A 58F0 A838
         LA    1,IOKEY                   . 001E6E 4110 9EA0
         LA    2,OUTBLK                  . 001E72 4120 9C70
         LA    3,ERRSP                   . 001E76 4130 9FA8
         BALR  14,15                          CALL                     *
                                         . 001E7A 05EF
         L     1,YCL                     . 001E7C 5810 A420
         ST    1,ERRSP                   . 001E80 5010 9FA8
         L     15,@@APDSP                . 001E84 58F0 A870
         LA    2,ERRSP                   . 001E88 4120 9FA8
         LM    3,5,BLSP                  . 001E8C 9835 A0C8
         BALR  14,15                          CALL                     *
                                         . 001E90 05EF
         L     1,EMSGCL                  . 001E92 5810 9E50
         LM    1,4,0(1)                  . 001E96 9814 1000
         STM   1,4,TSP                   . 001E9A 9014 A5A0
         ST    0,CERRSP                  . 001E9E 5000 A028
         L     15,@@APDSP                . 001EA2 58F0 A870
         LA    2,CERRSP                  . 001EA6 4120 A028
         LM    3,5,STARSP                . 001EAA 9835 A188
         BALR  14,15                          CALL                     *
                                         . 001EAE 05EF
         L     15,@@APDSP                . 001EB0 58F0 A870
         LA    2,CERRSP                  . 001EB4 4120 A028
         LM    3,5,TSP                   . 001EB8 9835 A5A0
         BALR  14,15                          CALL                     *
                                         . 001EBC 05EF
         L     15,@@STPRNT               . 001EBE 58F0 A838
         LA    1,IOKEY                   . 001EC2 4110 9EA0
         LA    2,OUTBLK                  . 001EC6 4120 9C70
         LA    3,CERRSP                  . 001ECA 4130 A028
         BALR  14,15                          CALL                     *
                                         . 001ECE 05EF
         L     15,@@STPRNT               . 001ED0 58F0 A838
         LA    1,IOKEY                   . 001ED4 4110 9EA0
         LA    2,OUTBLK                  . 001ED8 4120 9C70
         LA    3,BLSP                    . 001EDC 4130 A0C8
         BALR  14,15                          CALL                     *
                                         . 001EE0 05EF
                                                             SPACE
* CDIAG1 AEQLC UNIT,0,,RTN1                                     E3.0.1
*      AEQLC   BRTYPE,EOSTYP,,RTN3                              E3.0.1
*      STREAM  XSP,TEXTSP,EOSTB,COMP3,,RTN3
*                                  Get to end of statement
                                                             SPACE
CDIAG1   C     0,UNIT                    . 001EE2 5900 9F18
         BE    FAIL                      . 001EE6 4780 9010
         LA    6,6                       . 001EEA 4160 0006
         C     6,BRTYPE                  . 001EEE 5960 9E20
         BE    RTNUL3                    . 001EF2 4780 9030
         L     15,@@STREAM               . 001EF6 58F0 A840
         LA    1,XSP                     . 001EFA 4110 A5D0
         LA    2,TEXTSP                  . 001EFE 4120 A590
         L     3,@@EOSTB                 . 001F02 5830 A8E0
         BALR  14,15                          CALL                     *
                                         . 001F06 05EF
         B     S4$010                    . 001F08 47F0 95AC
         B     DIAGRN                    . 001F0C 47F0 BA7E
         B     RTNUL3                    . 001F10 47F0 9030
                                                             SPACE
* DIAGRN STREAD INBFSP,UNIT,DIAGRN,COMP5
*                                  Read card image
*      SETSP   TEXTSP,NEXTSP       Set up new line
*      STREAM  XSP,TEXTSP,CARDTB,COMP3,COMP3
*                                  Analyze card type
*      RCALL   ,NEWCRD,,(,,RTN3)   Process card image
*      AEQLC   LISTCL,0,,DIAGRN
*      STPRNT  IOKEY,OUTBLK,LNBFSP Print out bypassed card
*      BRANCH  DIAGRN
DIAGRN   L     15,@@STREAD               . 001F14 58F0 A83C
         LA    1,INBFSP                  . 001F18 4110 9FB8
         LA    2,UNIT                    . 001F1C 4120 9F18
         BALR  14,15                          CALL                     *
                                         . 001F20 05EF
         B     DIAGRN                    . 001F22 47F0 BA7E
         B     COMP5                     . 001F26 47F0 95B4
         LM    1,4,NEXTSP                . 001F2A 9814 9FD8
         STM   1,4,TEXTSP                . 001F2E 9014 A590
         L     15,@@STREAM               . 001F32 58F0 A840
         LA    1,XSP                     . 001F36 4110 A5D0
         LA    2,TEXTSP                  . 001F3A 4120 A590
         L     3,@@CARDTB                . 001F3E 5830 A844
         BALR  14,15                          CALL                     *
                                         . 001F42 05EF
         B     S4$010                    . 001F44 47F0 95AC
         B     S4$010                    . 001F48 47F0 95AC
         LA    14,S4$01F68               . 001F4C 41E0 BAD2
         STM   11,14,104(12)             . 001F50 90BE C068
         LR    13,12                     . 001F54 18DC
         LA    12,16(12)                 . 001F56 41CC 0010
         C     12,@@STACKT               . 001F5A 59C0 A828
         BH    OVER                      . 001F5E 4720 9664
         L     11,@@NEWCRD               . 001F62 58B0 A848
         BR    11                        . 001F66 07FB
S4$01F68 SR    0,0                       . 001F68 1B00
         SR    0,0                       . 001F6A 1B00
         B     S4$01F78                  . 001F6C 47F0 BAE2
         B     S4$01F78                  . 001F70 47F0 BAE2
         B     RTNUL3                    . 001F74 47F0 9030
S4$01F78 C     0,LISTCL                  . 001F78 5900 9BC8
         BE    DIAGRN                    . 001F7C 4780 BA7E
         L     15,@@STPRNT               . 001F80 58F0 A838
         LA    1,IOKEY                   . 001F84 4110 9EA0
         LA    2,OUTBLK                  . 001F88 4120 9C70
         LA    3,LNBFSP                  . 001F8C 4130 9FC8
         BALR  14,15                          CALL                     *
                                         . 001F90 05EF
         B     DIAGRN                    . 001F92 47F0 BA7E
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Element Analysis
*
                                                             SPACE
* ELEMNT PROC  ,                   Element analysis procedure
*      RCALL   ELEMND,UNOP,,RTN2   Get tree of unary operators
*      STREAM  XSP,TEXTSP,ELEMTB,ELEICH,ELEILI
*                                  Break out element
                                                             SPACE
         USING ELEMNT,11                 .
ELEMNT   LA    14,S4$01FB2               . 001F96 41E0 B01C
         STM   11,14,104(12)             . 001F9A 90BE C068
         LR    13,12                     . 001F9E 18DC
         LA    12,16(12)                 . 001FA0 41CC 0010
         C     12,@@STACKT               . 001FA4 59C0 A828
         BH    OVER                      . 001FA8 4720 9664
         L     11,@@UNOP                 . 001FAC 58B0 A8E4
         BR    11                        . 001FB0 07FB
S4$01FB2 STD   0,ELEMND                  . 001FB2 6000 A4A0
         B     RTN2                      . 001FB6 47F0 9028
         L     15,@@STREAM               . 001FBA 58F0 A840
         LA    1,XSP                     . 001FBE 4110 A5D0
         LA    2,TEXTSP                  . 001FC2 4120 A590
         L     3,@@ELEMTB                . 001FC6 5830 A8E8
         BALR  14,15                          CALL                     *
                                         . 001FCA 05EF
         B     ELEICH                    . 001FCC 47F0 B6BA
         B     ELEILI                    . 001FD0 47F0 B6C6
                                                             SPACE
* ELEMN9 SELBRA STYPE,(,ELEILT,ELEVBL,ELENST,ELEFNC,ELEFLT,ELEARY)
*                                  Branch on element type
*      FSHRTN  XSP,1               Delete initial quote
*      SHORTN  XSP,1               Remove terminal quote
*      RCALL   XPTR,GENVAR,(XSPPTR)
*                                  Generate variable for literal
                                                             SPACE
ELEMN9   L     1,STYPE                   . 001FD4 5810 9F08
         SLA   1,2                       . 001FD8 8B10 0002
S4$01FDC B     S4$01FDC(1)               . 001FDC 47F1 B046
         B     S4$01FFC                  . 001FE0 47F0 B066
         B     ELEILT                    . 001FE4 47F0 B182
         B     ELEVBL                    . 001FE8 47F0 B1B6
         B     ELENST                    . 001FEC 47F0 B216
         B     ELEFNC                    . 001FF0 47F0 B266
         B     ELEFLT                    . 001FF4 47F0 B198
         B     ELEARY                    . 001FF8 47F0 B530
S4$01FFC LM    1,2,XSP                   . 001FFC 9812 A5D0
         BCTR  1,0                            DECREMENT                *
                                         . 002000 0610
         LA    2,1(2)                    . 002002 4122 0001
         BCTR  1,0                            DECREMENT                *
                                         . 002006 0610
         STM   1,2,XSP                   . 002008 9012 A5D0
         LA    14,S4$02030               . 00200C 41E0 B09A
         STM   11,14,104(12)             . 002010 90BE C068
         LR    13,12                     . 002014 18DC
         LD    0,XSPPTR                  . 002016 6800 9F60
         STD   0,120(12)                 . 00201A 600C 0078
         LA    12,24(12)                 . 00201E 41CC 0018
         C     12,@@STACKT               . 002022 59C0 A828
         BH    OVER                      . 002026 4720 9664
         L     11,@@GENVAR               . 00202A 58B0 A830
         BR    11                        . 00202E 07FB
S4$02030 STD   0,XPTR                    . 002030 6000 A410
                                                             SPACE
* ELEMN5 RCALL ELEXND,BLOCK,CNDSIZ Allocate block for tree node
*      PUTDC   ELEXND,CODE,LITCL   Insert literal function
*      RCALL   ELEYND,BLOCK,CNDSIZ Allocate block for tree node
*      PUTDC   ELEYND,CODE,XPTR    Insert literal value
*      ADDSON  ELEXND,ELEYND       Add node as son
                                                             SPACE
ELEMN5   LA    14,S4$02058               . 002034 41E0 B0C2
         STM   11,14,104(12)             . 002038 90BE C068
         LR    13,12                     . 00203C 18DC
         LD    0,CNDSIZ                  . 00203E 6800 9BF8
         STD   0,120(12)                 . 002042 600C 0078
         LA    12,24(12)                 . 002046 41CC 0018
         C     12,@@STACKT               . 00204A 59C0 A828
         BH    OVER                      . 00204E 4720 9664
         L     11,@@BLOCK                . 002052 58B0 A82C
         BR    11                        . 002056 07FB
S4$02058 STD   0,ELEXND                  . 002058 6000 A4A8
         L     1,ELEXND                  . 00205C 5810 A4A8
         LD    0,LITCL                   . 002060 6800 9D78
         STD   0,32(1)                   . 002064 6001 0020
         LA    14,S4$0208C               . 002068 41E0 B0F6
         STM   11,14,104(12)             . 00206C 90BE C068
         LR    13,12                     . 002070 18DC
         LD    0,CNDSIZ                  . 002072 6800 9BF8
         STD   0,120(12)                 . 002076 600C 0078
         LA    12,24(12)                 . 00207A 41CC 0018
         C     12,@@STACKT               . 00207E 59C0 A828
         BH    OVER                      . 002082 4720 9664
         L     11,@@BLOCK                . 002086 58B0 A82C
         BR    11                        . 00208A 07FB
S4$0208C STD   0,ELEYND                  . 00208C 6000 A4B0
         L     1,ELEYND                  . 002090 5810 A4B0
         LD    0,XPTR                    . 002094 6800 A410
         STD   0,32(1)                   . 002098 6001 0020
         LM    1,2,ELEXND                . 00209C 9812 A4A8
         L     4,36(1)                   . 0020A0 5841 0024
         LA    4,1(4)                    . 0020A4 4144 0001
         STH   4,38(1)                   . 0020A8 4041 0026
         LM    4,5,ELEYND                . 0020AC 9845 A4B0
         STM   1,2,8(4)                  . 0020B0 9012 4008
         LM    2,3,16(1)                 . 0020B4 9823 1010
         STM   2,3,24(4)                 . 0020B8 9023 4018
         STM   4,5,16(1)                 . 0020BC 9045 1010
                                                             SPACE
* ELEMN1 AEQLC ELEMND,0,ELEMN6     Check for empty tree
*      MOVD    ZPTR,ELEXND         Set up return
*      BRANCH  ELEMRR              Join return processing
                                                             SPACE
ELEMN1   C     0,ELEMND                  . 0020C0 5900 A4A0
         BNE   ELEMN6                    . 0020C4 4770 B13E
         LD    0,ELEXND                  . 0020C8 6800 A4A8
         STD   0,ZPTR                    . 0020CC 6000 A440
         B     ELEMRR                    . 0020D0 47F0 B16A
                                                             SPACE
* ELEMN6 ADDSON ELEMND,ELEXND      Add as son of present tree
                                                             SPACE
ELEMN6   LM    1,2,ELEMND                . 0020D4 9812 A4A0
         L     4,36(1)                   . 0020D8 5841 0024
         LA    4,1(4)                    . 0020DC 4144 0001
         STH   4,38(1)                   . 0020E0 4041 0026
         LM    4,5,ELEXND                . 0020E4 9845 A4A8
         STM   1,2,8(4)                  . 0020E8 9012 4008
         LM    2,3,16(1)                 . 0020EC 9823 1010
         STM   2,3,24(4)                 . 0020F0 9023 4018
         STM   4,5,16(1)                 . 0020F4 9045 1010
                                                             SPACE
* ELEMNR MOVD  ZPTR,ELEMND         Move tree to return
                                                             SPACE
ELEMNR   LD    0,ELEMND                  . 0020F8 6800 A4A0
         STD   0,ZPTR                    . 0020FC 6000 A440
                                                             SPACE
* ELEMRR AEQLIC ZPTR,FATHER,0,,RTZPTR
*                                  Is pointer at top of tree?
*      GETDC   ZPTR,ZPTR,FATHER    Move back to father
*      BRANCH  ELEMRR              Continue up tree
                                                             SPACE
ELEMRR   L     1,ZPTR                    . 002100 5810 A440
         C     0,8(1)                    . 002104 5901 0008
         BE    RTZPTR                    . 002108 4780 9074
         LD    0,8(1)                    . 00210C 6801 0008
         STD   0,ZPTR                    . 002110 6000 A440
         B     ELEMRR                    . 002114 47F0 B16A
                                                             SPACE
* ELEILT SPCINT XPTR,XSP,ELEINT,ELEMN5
*                                  Convert string to integer
                                                             SPACE
ELEILT   L     15,@@DECBIN               . 002118 58F0 A8EC
         LA    1,XPTR                    . 00211C 4110 A410
         LA    2,XSP                     . 002120 4120 A5D0
         BALR  14,15                          CALL                     *
                                         . 002124 05EF
         B     ELEINT                    . 002126 47F0 B6DE
         B     ELEMN5                    . 00212A 47F0 B09E
                                                             SPACE
* ELEFLT SPREAL XPTR,XSP,ELEDEC,ELEMN5
*                                  Convert string to real
                                                             SPACE
ELEFLT   L     15,@@SPREAL               . 00212E 58F0 A8F0
         LA    1,XPTR                    . 002132 4110 A410
         LM    2,4,XSP                   . 002136 9824 A5D0
         BALR  14,15                          CALL                     *
                                         . 00213A 05EF
         B     ELEDEC                    . 00213C 47F0 B6EA
         LA    2,7                       . 002140 4120 0007
         ST    2,XPTR$4                  . 002144 5020 A414
         B     ELEMN5                    . 002148 47F0 B09E
                                                             SPACE
* ELEVBL RCALL XPTR,GENVAR,(XSPPTR)
*                                  Generate variable
*      RCALL   ELEXND,BLOCK,CNDSIZ Allocate block for tree node
*      PUTDC   ELEXND,CODE,XPTR    Insert name
*      BRANCH  ELEMN1              Join exit processing
                                                             SPACE
ELEVBL   LA    14,S4$02170               . 00214C 41E0 B1DA
         STM   11,14,104(12)             . 002150 90BE C068
         LR    13,12                     . 002154 18DC
         LD    0,XSPPTR                  . 002156 6800 9F60
         STD   0,120(12)                 . 00215A 600C 0078
         LA    12,24(12)                 . 00215E 41CC 0018
         C     12,@@STACKT               . 002162 59C0 A828
         BH    OVER                      . 002166 4720 9664
         L     11,@@GENVAR               . 00216A 58B0 A830
         BR    11                        . 00216E 07FB
S4$02170 STD   0,XPTR                    . 002170 6000 A410
         LA    14,S4$02198               . 002174 41E0 B202
         STM   11,14,104(12)             . 002178 90BE C068
         LR    13,12                     . 00217C 18DC
         LD    0,CNDSIZ                  . 00217E 6800 9BF8
         STD   0,120(12)                 . 002182 600C 0078
         LA    12,24(12)                 . 002186 41CC 0018
         C     12,@@STACKT               . 00218A 59C0 A828
         BH    OVER                      . 00218E 4720 9664
         L     11,@@BLOCK                . 002192 58B0 A82C
         BR    11                        . 002196 07FB
S4$02198 STD   0,ELEXND                  . 002198 6000 A4A8
         L     1,ELEXND                  . 00219C 5810 A4A8
         LD    0,XPTR                    . 0021A0 6800 A410
         STD   0,32(1)                   . 0021A4 6001 0020
         B     ELEMN1                    . 0021A8 47F0 B12A
                                                             SPACE
* ELENST PUSH  ELEMND              Save current tree
*      RCALL   ELEXND,EXPR,,RTN1   Evaluate nested expression
*      POP     ELEMND              Restore tree
*      AEQLC   BRTYPE,RPTYP,ELECMA,ELEMN1
*                                  Verify right parenthesis
                                                             SPACE
ELENST   LD    0,ELEMND                  . 0021AC 6800 A4A0
         STD   0,104(12)                 . 0021B0 600C 0068
         AR    12,8                      . 0021B4 1AC8
         C     12,@@STACKT               . 0021B6 59C0 A828
         BH    OVER                      . 0021BA 4720 9664
         LA    14,S4$021DA               . 0021BE 41E0 B244
         STM   11,14,104(12)             . 0021C2 90BE C068
         LR    13,12                     . 0021C6 18DC
         LA    12,16(12)                 . 0021C8 41CC 0010
         C     12,@@STACKT               . 0021CC 59C0 A828
         BH    OVER                      . 0021D0 4720 9664
         L     11,@@EXPR                 . 0021D4 58B0 A8BC
         BR    11                        . 0021D8 07FB
S4$021DA STD   0,ELEXND                  . 0021DA 6000 A4A8
         B     FAIL                      . 0021DE 47F0 9010
         LD    0,96(12)                  . 0021E2 680C 0060
         STD   0,ELEMND                  . 0021E6 6000 A4A0
         SR    12,8                      . 0021EA 1BC8
         LA    6,3                       . 0021EC 4160 0003
         C     6,BRTYPE                  . 0021F0 5960 9E20
         BNE   ELECMA                    . 0021F4 4770 B6F6
         BE    ELEMN1                    . 0021F8 4780 B12A
                                                             SPACE
* ELEFNC SHORTN XSP,1              Delete open parenthesis
*      RCALL   XPTR,GENVAR,(XSPPTR)
*                                  Generate variable for function name
*      RCALL   XCL,FINDEX,(XPTR)   Find function descriptor
*      RCALL   ELEXND,BLOCK,CNDSIZ Allocate block for tree node
*      PUTDC   ELEXND,CODE,XCL     Insert function descriptor in node
*      AEQLC   ELEMND,0,,ELEMN7    Is tree empty?
*      ADDSON  ELEMND,ELEXND       Add node as son to tree
                                                             SPACE
ELEFNC   L     1,XSP                     . 0021FC 5810 A5D0
         BCTR  1,0                            DECREMENT                *
                                         . 002200 0610
         ST    1,XSP                     . 002202 5010 A5D0
         LA    14,S4$0222A               . 002206 41E0 B294
         STM   11,14,104(12)             . 00220A 90BE C068
         LR    13,12                     . 00220E 18DC
         LD    0,XSPPTR                  . 002210 6800 9F60
         STD   0,120(12)                 . 002214 600C 0078
         LA    12,24(12)                 . 002218 41CC 0018
         C     12,@@STACKT               . 00221C 59C0 A828
         BH    OVER                      . 002220 4720 9664
         L     11,@@GENVAR               . 002224 58B0 A830
         BR    11                        . 002228 07FB
S4$0222A STD   0,XPTR                    . 00222A 6000 A410
         LA    14,S4$0224E               . 00222E 41E0 B2B8
         STM   11,14,104(12)             . 002232 90BE C068
         LR    13,12                     . 002236 18DC
         STD   0,120(12)                 . 002238 600C 0078
         LA    12,24(12)                 . 00223C 41CC 0018
         C     12,@@STACKT               . 002240 59C0 A828
         BH    OVER                      . 002244 4720 9664
         L     11,@@FINDEX               . 002248 58B0 A8F4
         BR    11                        . 00224C 07FB
S4$0224E STD   0,XCL                     . 00224E 6000 A408
         LA    14,S4$02276               . 002252 41E0 B2E0
         STM   11,14,104(12)             . 002256 90BE C068
         LR    13,12                     . 00225A 18DC
         LD    0,CNDSIZ                  . 00225C 6800 9BF8
         STD   0,120(12)                 . 002260 600C 0078
         LA    12,24(12)                 . 002264 41CC 0018
         C     12,@@STACKT               . 002268 59C0 A828
         BH    OVER                      . 00226C 4720 9664
         L     11,@@BLOCK                . 002270 58B0 A82C
         BR    11                        . 002274 07FB
S4$02276 STD   0,ELEXND                  . 002276 6000 A4A8
         L     1,ELEXND                  . 00227A 5810 A4A8
         LD    0,XCL                     . 00227E 6800 A408
         STD   0,32(1)                   . 002282 6001 0020
         C     0,ELEMND                  . 002286 5900 A4A0
         BE    ELEMN7                    . 00228A 4780 B31C
         LM    1,2,ELEMND                . 00228E 9812 A4A0
         L     4,36(1)                   . 002292 5841 0024
         LA    4,1(4)                    . 002296 4144 0001
         STH   4,38(1)                   . 00229A 4041 0026
         LM    4,5,ELEXND                . 00229E 9845 A4A8
         STM   1,2,8(4)                  . 0022A2 9012 4008
         LM    2,3,16(1)                 . 0022A6 9823 1010
         STM   2,3,24(4)                 . 0022AA 9023 4018
         STM   4,5,16(1)                 . 0022AE 9045 1010
                                                             SPACE
* ELEMN7 PUSH  ELEXND              Save current node
*      RCALL   ELEXND,EXPR,,RTN1   Evaluate argument of function
*      POP     ELEMND              Resotre current node
*      ADDSON  ELEMND,ELEXND       Add argument as son
*      MOVD    ELEMND,ELEXND       Move to new node
                                                             SPACE
ELEMN7   LD    0,ELEXND                  . 0022B2 6800 A4A8
         STD   0,104(12)                 . 0022B6 600C 0068
         AR    12,8                      . 0022BA 1AC8
         C     12,@@STACKT               . 0022BC 59C0 A828
         BH    OVER                      . 0022C0 4720 9664
         LA    14,S4$022E0               . 0022C4 41E0 B34A
         STM   11,14,104(12)             . 0022C8 90BE C068
         LR    13,12                     . 0022CC 18DC
         LA    12,16(12)                 . 0022CE 41CC 0010
         C     12,@@STACKT               . 0022D2 59C0 A828
         BH    OVER                      . 0022D6 4720 9664
         L     11,@@EXPR                 . 0022DA 58B0 A8BC
         BR    11                        . 0022DE 07FB
S4$022E0 STD   0,ELEXND                  . 0022E0 6000 A4A8
         B     FAIL                      . 0022E4 47F0 9010
         LD    0,96(12)                  . 0022E8 680C 0060
         STD   0,ELEMND                  . 0022EC 6000 A4A0
         SR    12,8                      . 0022F0 1BC8
         LM    1,2,ELEMND                . 0022F2 9812 A4A0
         L     4,36(1)                   . 0022F6 5841 0024
         LA    4,1(4)                    . 0022FA 4144 0001
         STH   4,38(1)                   . 0022FE 4041 0026
         LM    4,5,ELEXND                . 002302 9845 A4A8
         STM   1,2,8(4)                  . 002306 9012 4008
         LM    2,3,16(1)                 . 00230A 9823 1010
         STM   2,3,24(4)                 . 00230E 9023 4018
         STM   4,5,16(1)                 . 002312 9045 1010
         LD    0,ELEXND                  . 002316 6800 A4A8
         STD   0,ELEMND                  . 00231A 6000 A4A0
                                                             SPACE
* ELEMN2 AEQLC BRTYPE,RPTYP,,ELEMN3
*                                  Check for left parenthesis
*      AEQLC   BRTYPE,CMATYP,ELECMA
*                                  Verify comma
*      PUSH    ELEMND              Save current node
*      RCALL   ELEXND,EXPR,,RTN1   Evaluate next argument
*      POP     ELEMND              Restore current node
*      ADDSIB  ELEMND,ELEXND       Add argument as sibling
*      MOVD    ELEMND,ELEXND       Move to new node
*      BRANCH  ELEMN2              Continue
                                                             SPACE
ELEMN2   LA    6,3                       . 00231E 4160 0003
         C     6,BRTYPE                  . 002322 5960 9E20
         BE    ELEMN3                    . 002326 4780 B418
         LA    6,2                       . 00232A 4160 0002
         C     6,BRTYPE                  . 00232E 5960 9E20
         BNE   ELECMA                    . 002332 4770 B6F6
         LD    0,ELEMND                  . 002336 6800 A4A0
         STD   0,104(12)                 . 00233A 600C 0068
         AR    12,8                      . 00233E 1AC8
         C     12,@@STACKT               . 002340 59C0 A828
         BH    OVER                      . 002344 4720 9664
         LA    14,S4$02364               . 002348 41E0 B3CE
         STM   11,14,104(12)             . 00234C 90BE C068
         LR    13,12                     . 002350 18DC
         LA    12,16(12)                 . 002352 41CC 0010
         C     12,@@STACKT               . 002356 59C0 A828
         BH    OVER                      . 00235A 4720 9664
         L     11,@@EXPR                 . 00235E 58B0 A8BC
         BR    11                        . 002362 07FB
S4$02364 STD   0,ELEXND                  . 002364 6000 A4A8
         B     FAIL                      . 002368 47F0 9010
         LD    0,96(12)                  . 00236C 680C 0060
         STD   0,ELEMND                  . 002370 6000 A4A0
         SR    12,8                      . 002374 1BC8
         L     1,ELEMND                  . 002376 5810 A4A0
         LM    2,3,ELEXND                . 00237A 9823 A4A8
         L     5,8(1)                    . 00237E 5851 0008
         L     4,36(5)                   . 002382 5845 0024
         LA    4,1(4)                    . 002386 4144 0001
         STH   4,38(5)                   . 00238A 4045 0026
         LM    5,6,8(1)                  . 00238E 9856 1008
         STM   5,6,8(2)                  . 002392 9056 2008
         LM    5,6,24(1)                 . 002396 9856 1018
         STM   5,6,24(2)                 . 00239A 9056 2018
         STM   2,3,24(1)                 . 00239E 9023 1018
         LD    0,ELEXND                  . 0023A2 6800 A4A8
         STD   0,ELEMND                  . 0023A6 6000 A4A0
         B     ELEMN2                    . 0023AA 47F0 B388
                                                             SPACE
* ELEMN3 GETDC ELEXND,ELEMND,FATHER
*                                  Get father of current node
*      GETDC   XCL,ELEXND,CODE     Get function descriptor
*      GETDC   YCL,XCL,0           Get procedure descriptor
*      TESTF   YCL,FNC,,ELEMNR     Check for fixed number requirement
*      SETAV   XCL,XCL             Get number of arguments given
*      SETAV   YCL,YCL             Get number of arguments expected
                                                             SPACE
ELEMN3   L     1,ELEMND                  . 0023AE 5810 A4A0
         LM    1,2,8(1)                  . 0023B2 9812 1008
         STM   1,2,ELEXND                . 0023B6 9012 A4A8
         LM    1,2,32(1)                 . 0023BA 9812 1020
         STM   1,2,XCL                   . 0023BE 9012 A408
         LD    0,0(1)                    . 0023C2 6801 0000
         STD   0,YCL                     . 0023C6 6000 A420
         TM    YCL$4,X'04'               . 0023CA 9104 A424
         BO    ELEMNR                    . 0023CE 4710 B162
         L     15,XCL$4                  . 0023D2 58F0 A40C
         LA    15,0(15)                  . 0023D6 41FF 0000
         STM   15,0,XCL                  . 0023DA 90F0 A408
         L     15,YCL$4                  . 0023DE 58F0 A424
         LA    15,0(15)                  . 0023E2 41FF 0000
         STM   15,0,YCL                  . 0023E6 90F0 A420
                                                             SPACE
* ELEMN4 ACOMP XCL,YCL,ELEMNR,ELEMNR
*                                  Compare given and expected
*      RCALL   ELEYND,BLOCK,CNDSIZ Allocate block for tree node
*      PUTDC   ELEYND,CODE,LITCL   Insert literal function
*      RCALL   ELEXND,BLOCK,CNDSIZ Allocate block for tree node
*      PUTDC   ELEXND,CODE,NULVCL  Insert null string value
*      ADDSON  ELEYND,ELEXND       Add null as son of literal
*      ADDSIB  ELEMND,ELEYND       Add literal as extra argument
*      MOVD    ELEMND,ELEYND       Move to new node
*      INCRA   XCL,1               Increment argument count
*      BRANCH  ELEMN4              Continue
                                                             SPACE
ELEMN4   L     1,XCL                     . 0023EA 5810 A408
         C     1,YCL                     . 0023EE 5910 A420
         BNL   ELEMNR                    . 0023F2 47B0 B162
         LA    14,S4$0241A               . 0023F6 41E0 B484
         STM   11,14,104(12)             . 0023FA 90BE C068
         LR    13,12                     . 0023FE 18DC
         LD    0,CNDSIZ                  . 002400 6800 9BF8
         STD   0,120(12)                 . 002404 600C 0078
         LA    12,24(12)                 . 002408 41CC 0018
         C     12,@@STACKT               . 00240C 59C0 A828
         BH    OVER                      . 002410 4720 9664
         L     11,@@BLOCK                . 002414 58B0 A82C
         BR    11                        . 002418 07FB
S4$0241A STD   0,ELEYND                  . 00241A 6000 A4B0
         L     1,ELEYND                  . 00241E 5810 A4B0
         LD    0,LITCL                   . 002422 6800 9D78
         STD   0,32(1)                   . 002426 6001 0020
         LA    14,S4$0244E               . 00242A 41E0 B4B8
         STM   11,14,104(12)             . 00242E 90BE C068
         LR    13,12                     . 002432 18DC
         LD    0,CNDSIZ                  . 002434 6800 9BF8
         STD   0,120(12)                 . 002438 600C 0078
         LA    12,24(12)                 . 00243C 41CC 0018
         C     12,@@STACKT               . 002440 59C0 A828
         BH    OVER                      . 002444 4720 9664
         L     11,@@BLOCK                . 002448 58B0 A82C
         BR    11                        . 00244C 07FB
S4$0244E STD   0,ELEXND                  . 00244E 6000 A4A8
         L     1,ELEXND                  . 002452 5810 A4A8
         LD    0,NULVCL                  . 002456 6800 9ED0
         STD   0,32(1)                   . 00245A 6001 0020
         LM    1,2,ELEYND                . 00245E 9812 A4B0
         L     4,36(1)                   . 002462 5841 0024
         LA    4,1(4)                    . 002466 4144 0001
         STH   4,38(1)                   . 00246A 4041 0026
         LM    4,5,ELEXND                . 00246E 9845 A4A8
         STM   1,2,8(4)                  . 002472 9012 4008
         LM    2,3,16(1)                 . 002476 9823 1010
         STM   2,3,24(4)                 . 00247A 9023 4018
         STM   4,5,16(1)                 . 00247E 9045 1010
         L     1,ELEMND                  . 002482 5810 A4A0
         LM    2,3,ELEYND                . 002486 9823 A4B0
         L     5,8(1)                    . 00248A 5851 0008
         L     4,36(5)                   . 00248E 5845 0024
         LA    4,1(4)                    . 002492 4144 0001
         STH   4,38(5)                   . 002496 4045 0026
         LM    5,6,8(1)                  . 00249A 9856 1008
         STM   5,6,8(2)                  . 00249E 9056 2008
         LM    5,6,24(1)                 . 0024A2 9856 1018
         STM   5,6,24(2)                 . 0024A6 9056 2018
         STM   2,3,24(1)                 . 0024AA 9023 1018
         LD    0,ELEYND                  . 0024AE 6800 A4B0
         STD   0,ELEMND                  . 0024B2 6000 A4A0
         L     1,XCL                     . 0024B6 5810 A408
         LA    1,1(1)                    . 0024BA 4111 0001
         ST    1,XCL                     . 0024BE 5010 A408
         B     ELEMN4                    . 0024C2 47F0 B454
                                                             SPACE
* ELEARY SHORTN XSP,1              Remove left bracket
*      RCALL   XPTR,GENVAR,(XSPPTR)
*                                  Generate variable for array or table
*      RCALL   ELEXND,BLOCK,CNDSIZ Allocate block for tree node
*      PUTDC   ELEXND,CODE,ITEMCL  Insert ITEM function
*      AEQLC   ELEMND,0,,ELEMN8    Is tree empty?
*      ADDSON  ELEMND,ELEXND       Add as son to tree
                                                             SPACE
ELEARY   L     1,XSP                     . 0024C6 5810 A5D0
         BCTR  1,0                            DECREMENT                *
                                         . 0024CA 0610
         ST    1,XSP                     . 0024CC 5010 A5D0
         LA    14,S4$024F4               . 0024D0 41E0 B55E
         STM   11,14,104(12)             . 0024D4 90BE C068
         LR    13,12                     . 0024D8 18DC
         LD    0,XSPPTR                  . 0024DA 6800 9F60
         STD   0,120(12)                 . 0024DE 600C 0078
         LA    12,24(12)                 . 0024E2 41CC 0018
         C     12,@@STACKT               . 0024E6 59C0 A828
         BH    OVER                      . 0024EA 4720 9664
         L     11,@@GENVAR               . 0024EE 58B0 A830
         BR    11                        . 0024F2 07FB
S4$024F4 STD   0,XPTR                    . 0024F4 6000 A410
         LA    14,S4$0251C               . 0024F8 41E0 B586
         STM   11,14,104(12)             . 0024FC 90BE C068
         LR    13,12                     . 002500 18DC
         LD    0,CNDSIZ                  . 002502 6800 9BF8
         STD   0,120(12)                 . 002506 600C 0078
         LA    12,24(12)                 . 00250A 41CC 0018
         C     12,@@STACKT               . 00250E 59C0 A828
         BH    OVER                      . 002512 4720 9664
         L     11,@@BLOCK                . 002516 58B0 A82C
         BR    11                        . 00251A 07FB
S4$0251C STD   0,ELEXND                  . 00251C 6000 A4A8
         L     1,ELEXND                  . 002520 5810 A4A8
         LD    0,ITEMCL                  . 002524 6800 9D70
         STD   0,32(1)                   . 002528 6001 0020
         C     0,ELEMND                  . 00252C 5900 A4A0
         BE    ELEMN8                    . 002530 4780 B5C2
         LM    1,2,ELEMND                . 002534 9812 A4A0
         L     4,36(1)                   . 002538 5841 0024
         LA    4,1(4)                    . 00253C 4144 0001
         STH   4,38(1)                   . 002540 4041 0026
         LM    4,5,ELEXND                . 002544 9845 A4A8
         STM   1,2,8(4)                  . 002548 9012 4008
         LM    2,3,16(1)                 . 00254C 9823 1010
         STM   2,3,24(4)                 . 002550 9023 4018
         STM   4,5,16(1)                 . 002554 9045 1010
                                                             SPACE
* ELEMN8 MOVD  ELEMND,ELEXND       Move to new node
*      RCALL   ELEXND,BLOCK,CNDSIZ Allocate block for tree node
*      PUTDC   ELEXND,CODE,XPTR    Insert array or table name
*      ADDSON  ELEMND,ELEXND       Add as son to tree
*      MOVD    ELEMND,ELEXND       Move to new node
                                                             SPACE
ELEMN8   LD    0,ELEXND                  . 002558 6800 A4A8
         STD   0,ELEMND                  . 00255C 6000 A4A0
         LA    14,S4$02584               . 002560 41E0 B5EE
         STM   11,14,104(12)             . 002564 90BE C068
         LR    13,12                     . 002568 18DC
         LD    0,CNDSIZ                  . 00256A 6800 9BF8
         STD   0,120(12)                 . 00256E 600C 0078
         LA    12,24(12)                 . 002572 41CC 0018
         C     12,@@STACKT               . 002576 59C0 A828
         BH    OVER                      . 00257A 4720 9664
         L     11,@@BLOCK                . 00257E 58B0 A82C
         BR    11                        . 002582 07FB
S4$02584 STD   0,ELEXND                  . 002584 6000 A4A8
         L     1,ELEXND                  . 002588 5810 A4A8
         LD    0,XPTR                    . 00258C 6800 A410
         STD   0,32(1)                   . 002590 6001 0020
         LM    1,2,ELEMND                . 002594 9812 A4A0
         L     4,36(1)                   . 002598 5841 0024
         LA    4,1(4)                    . 00259C 4144 0001
         STH   4,38(1)                   . 0025A0 4041 0026
         LM    4,5,ELEXND                . 0025A4 9845 A4A8
         STM   1,2,8(4)                  . 0025A8 9012 4008
         LM    2,3,16(1)                 . 0025AC 9823 1010
         STM   2,3,24(4)                 . 0025B0 9023 4018
         STM   4,5,16(1)                 . 0025B4 9045 1010
         LD    0,ELEXND                  . 0025B8 6800 A4A8
         STD   0,ELEMND                  . 0025BC 6000 A4A0
                                                             SPACE
* ELEAR1 PUSH  ELEMND              Save current node
*      RCALL   ELEXND,EXPR,,RTN1   Evaluate argument
*      POP     ELEMND              Restore current node
*      ADDSIB  ELEMND,ELEXND       Add as sibling to tree
*      MOVD    ELEMND,ELEXND       Move to new node
*      AEQLC   BRTYPE,RBTYP,,ELEMNR
*                                  Check for right bracket
*      AEQLC   BRTYPE,CMATYP,ELECMA,ELEAR1
*                                  Verify comma
                                                             SPACE
ELEAR1   LD    0,ELEMND                  . 0025C0 6800 A4A0
         STD   0,104(12)                 . 0025C4 600C 0068
         AR    12,8                      . 0025C8 1AC8
         C     12,@@STACKT               . 0025CA 59C0 A828
         BH    OVER                      . 0025CE 4720 9664
         LA    14,S4$025EE               . 0025D2 41E0 B658
         STM   11,14,104(12)             . 0025D6 90BE C068
         LR    13,12                     . 0025DA 18DC
         LA    12,16(12)                 . 0025DC 41CC 0010
         C     12,@@STACKT               . 0025E0 59C0 A828
         BH    OVER                      . 0025E4 4720 9664
         L     11,@@EXPR                 . 0025E8 58B0 A8BC
         BR    11                        . 0025EC 07FB
S4$025EE STD   0,ELEXND                  . 0025EE 6000 A4A8
         B     FAIL                      . 0025F2 47F0 9010
         LD    0,96(12)                  . 0025F6 680C 0060
         STD   0,ELEMND                  . 0025FA 6000 A4A0
         SR    12,8                      . 0025FE 1BC8
         L     1,ELEMND                  . 002600 5810 A4A0
         LM    2,3,ELEXND                . 002604 9823 A4A8
         L     5,8(1)                    . 002608 5851 0008
         L     4,36(5)                   . 00260C 5845 0024
         LA    4,1(4)                    . 002610 4144 0001
         STH   4,38(5)                   . 002614 4045 0026
         LM    5,6,8(1)                  . 002618 9856 1008
         STM   5,6,8(2)                  . 00261C 9056 2008
         LM    5,6,24(1)                 . 002620 9856 1018
         STM   5,6,24(2)                 . 002624 9056 2018
         STM   2,3,24(1)                 . 002628 9023 1018
         LD    0,ELEXND                  . 00262C 6800 A4A8
         STD   0,ELEMND                  . 002630 6000 A4A0
         LA    6,7                       . 002634 4160 0007
         C     6,BRTYPE                  . 002638 5960 9E20
         BE    ELEMNR                    . 00263C 4780 B162
         LA    6,2                       . 002640 4160 0002
         C     6,BRTYPE                  . 002644 5960 9E20
         BNE   ELECMA                    . 002648 4770 B6F6
         BE    ELEAR1                    . 00264C 4780 B62A
                                                             SPACE
* ELEICH SETAC EMSGCL,ILCHAR       'ILLEGAL CHARACTER IN ELEMENT'
*      BRANCH  RTN1                Error return
                                                             SPACE
ELEICH   L     1,@@ILCHAR                . 002650 5810 A8F8
         ST    1,EMSGCL                  . 002654 5010 9E50
         B     FAIL                      . 002658 47F0 9010
                                                             SPACE
* ELEILI AEQLC STYPE,QLITYP,ELEMN9 Check cause of run out
*      SETAC   EMSGCL,OPNLIT       'UNCLOSED LITERAL'
*      BRANCH  RTN1                Error return
                                                             SPACE
ELEILI   LA    6,1                       . 00265C 4160 0001
         C     6,STYPE                   . 002660 5960 9F08
         BNE   ELEMN9                    . 002664 4770 B03E
         L     1,@@OPNLIT                . 002668 5810 A8FC
         ST    1,EMSGCL                  . 00266C 5010 9E50
         B     FAIL                      . 002670 47F0 9010
                                                             SPACE
* ELEINT SETAC EMSGCL,ILLINT       'ILLEGAL INTEGER'
*      BRANCH  RTN1                Error return
                                                             SPACE
ELEINT   L     1,@@ILLINT                . 002674 5810 A900
         ST    1,EMSGCL                  . 002678 5010 9E50
         B     FAIL                      . 00267C 47F0 9010
                                                             SPACE
* ELEDEC SETAC EMSGCL,ILLDEC       'ILLEGAL REAL'
*      BRANCH  RTN1                Error return
                                                             SPACE
ELEDEC   L     1,@@ILLDEC                . 002680 5810 A904
         ST    1,EMSGCL                  . 002684 5010 9E50
         B     FAIL                      . 002688 47F0 9010
                                                             SPACE
* ELECMA SETAC EMSGCL,ILLBRK       'ILLEGAL BREAK CHARACTER'
*      BRANCH  RTN1                Error return
ELECMA   L     1,@@ILLBRK                . 00268C 5810 A8D8
         ST    1,EMSGCL                  . 002690 5010 9E50
         B     FAIL                      . 002694 47F0 9010
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Expression Analysis
*
                                                             SPACE
* EXPR PROC    ,                   Procedure to compile expression
*      RCALL   EXELND,ELEMNT,,(RTN1,EXPNUL)
*                                  Compile element
*      SETAC   EXPRND,0            Zero expression tree
*      BRANCH  EXPR2               Join main processing
                                                             SPACE
         USING EXPR,11                   .
EXPR     LA    14,S4$026B4               . 002698 41E0 B01C
         STM   11,14,104(12)             . 00269C 90BE C068
         LR    13,12                     . 0026A0 18DC
         LA    12,16(12)                 . 0026A2 41CC 0010
         C     12,@@STACKT               . 0026A6 59C0 A828
         BH    OVER                      . 0026AA 4720 9664
         L     11,@@ELEMNT               . 0026AE 58B0 A8B4
         BR    11                        . 0026B2 07FB
S4$026B4 STD   0,EXELND                  . 0026B4 6000 A4B8
         B     FAIL                      . 0026B8 47F0 9010
         B     EXPNUL                    . 0026BC 47F0 B2CC
         ST    0,EXPRND                  . 0026C0 5000 A4D8
         B     EXPR2                     . 0026C4 47F0 B074
                                                             SPACE
* EXPR1 PUSH   EXPRND              Save expression tree
*      RCALL   EXELND,ELEMNT,,(RTN1,EXPERR)
*                                  Compile element
*      POP     EXPRND              Restore expression tree
                                                             SPACE
EXPR1    LD    0,EXPRND                  . 0026C8 6800 A4D8
         STD   0,104(12)                 . 0026CC 600C 0068
         AR    12,8                      . 0026D0 1AC8
         C     12,@@STACKT               . 0026D2 59C0 A828
         BH    OVER                      . 0026D6 4720 9664
         LA    14,S4$026F6               . 0026DA 41E0 B05E
         STM   11,14,104(12)             . 0026DE 90BE C068
         LR    13,12                     . 0026E2 18DC
         LA    12,16(12)                 . 0026E4 41CC 0010
         C     12,@@STACKT               . 0026E8 59C0 A828
         BH    OVER                      . 0026EC 4720 9664
         L     11,@@ELEMNT               . 0026F0 58B0 A8B4
         BR    11                        . 0026F4 07FB
S4$026F6 STD   0,EXELND                  . 0026F6 6000 A4B8
         B     FAIL                      . 0026FA 47F0 9010
         B     EXPERR                    . 0026FE 47F0 B364
         LD    0,96(12)                  . 002702 680C 0060
         STD   0,EXPRND                  . 002706 6000 A4D8
         SR    12,8                      . 00270A 1BC8
                                                             SPACE
* EXPR2 RCALL  EXOPCL,BINOP,,(RTN1,EXPR7)
*                                  Get binary operator
*      RCALL   EXOPND,BLOCK,CNDSIZ Allocate block for tree node
*      PUTDC   EXOPND,CODE,EXOPCL  Insert binary operator
*      AEQLC   EXPRND,0,EXPR3      Check for empty tree
*      ADDSON  EXOPND,EXELND       Add node as son
*      MOVD    EXPRND,EXELND       Move to new node
*      BRANCH  EXPR1               Continue processing
                                                             SPACE
EXPR2    LA    14,S4$02728               . 00270C 41E0 B090
         STM   11,14,104(12)             . 002710 90BE C068
         LR    13,12                     . 002714 18DC
         LA    12,16(12)                 . 002716 41CC 0010
         C     12,@@STACKT               . 00271A 59C0 A828
         BH    OVER                      . 00271E 4720 9664
         L     11,@@BINOP                . 002722 58B0 A908
         BR    11                        . 002726 07FB
S4$02728 STD   0,EXOPCL                  . 002728 6000 A4C8
         B     FAIL                      . 00272C 47F0 9010
         B     EXPR7                     . 002730 47F0 B244
         LA    14,S4$02758               . 002734 41E0 B0C0
         STM   11,14,104(12)             . 002738 90BE C068
         LR    13,12                     . 00273C 18DC
         LD    0,CNDSIZ                  . 00273E 6800 9BF8
         STD   0,120(12)                 . 002742 600C 0078
         LA    12,24(12)                 . 002746 41CC 0018
         C     12,@@STACKT               . 00274A 59C0 A828
         BH    OVER                      . 00274E 4720 9664
         L     11,@@BLOCK                . 002752 58B0 A82C
         BR    11                        . 002756 07FB
S4$02758 STD   0,EXOPND                  . 002758 6000 A4D0
         L     1,EXOPND                  . 00275C 5810 A4D0
         LD    0,EXOPCL                  . 002760 6800 A4C8
         STD   0,32(1)                   . 002764 6001 0020
         C     0,EXPRND                  . 002768 5900 A4D8
         BNE   EXPR3                     . 00276C 4770 B108
         LM    1,2,EXOPND                . 002770 9812 A4D0
         L     4,36(1)                   . 002774 5841 0024
         LA    4,1(4)                    . 002778 4144 0001
         STH   4,38(1)                   . 00277C 4041 0026
         LM    4,5,EXELND                . 002780 9845 A4B8
         STM   1,2,8(4)                  . 002784 9012 4008
         LM    2,3,16(1)                 . 002788 9823 1010
         STM   2,3,24(4)                 . 00278C 9023 4018
         STM   4,5,16(1)                 . 002790 9045 1010
         LD    0,EXELND                  . 002794 6800 A4B8
         STD   0,EXPRND                  . 002798 6000 A4D8
         B     EXPR1                     . 00279C 47F0 B030
                                                             SPACE
* EXPR3 GETDC  EXOPCL,EXOPCL,2*DESCR
*                                  Get precedence descriptor
*      SETAV   EXOPCL,EXOPCL       Get left precedence
*      GETDC   EXEXND,EXPRND,FATHER
*                                  Get father of node
*      GETDC   XPTR,EXEXND,CODE    Get function descriptor
*      GETDC   XPTR,XPTR,2*DESCR   Get precedence descriptor
*      ACOMP   XPTR,EXOPCL,EXPR4   Compare precedences
*      ADDSIB  EXPRND,EXOPND       Add node as sibling
*      MOVD    EXPRND,EXOPND       Move to new node
*      ADDSON  EXPRND,EXELND       Put current node as son
*      MOVD    EXPRND,EXELND       Move to new node
*      BRANCH  EXPR1               Continue processing
                                                             SPACE
EXPR3    L     1,EXOPCL                  . 0027A0 5810 A4C8
         LD    0,16(1)                   . 0027A4 6801 0010
         STD   0,EXOPCL                  . 0027A8 6000 A4C8
         L     15,EXOPCL$4               . 0027AC 58F0 A4CC
         LA    15,0(15)                  . 0027B0 41FF 0000
         STM   15,0,EXOPCL               . 0027B4 90F0 A4C8
         L     1,EXPRND                  . 0027B8 5810 A4D8
         LM    1,2,8(1)                  . 0027BC 9812 1008
         STM   1,2,EXEXND                . 0027C0 9012 A4C0
         LM    1,2,32(1)                 . 0027C4 9812 1020
         STM   1,2,XPTR                  . 0027C8 9012 A410
         LM    1,2,16(1)                 . 0027CC 9812 1010
         STM   1,2,XPTR                  . 0027D0 9012 A410
         C     1,EXOPCL                  . 0027D4 5910 A4C8
         BH    EXPR4                     . 0027D8 4720 B1A8
         L     1,EXPRND                  . 0027DC 5810 A4D8
         LM    2,3,EXOPND                . 0027E0 9823 A4D0
         L     5,8(1)                    . 0027E4 5851 0008
         L     4,36(5)                   . 0027E8 5845 0024
         LA    4,1(4)                    . 0027EC 4144 0001
         STH   4,38(5)                   . 0027F0 4045 0026
         LM    5,6,8(1)                  . 0027F4 9856 1008
         STM   5,6,8(2)                  . 0027F8 9056 2008
         LM    5,6,24(1)                 . 0027FC 9856 1018
         STM   5,6,24(2)                 . 002800 9056 2018
         STM   2,3,24(1)                 . 002804 9023 1018
         LD    0,EXOPND                  . 002808 6800 A4D0
         STD   0,EXPRND                  . 00280C 6000 A4D8
         LM    1,2,EXPRND                . 002810 9812 A4D8
         L     4,36(1)                   . 002814 5841 0024
         LA    4,1(4)                    . 002818 4144 0001
         STH   4,38(1)                   . 00281C 4041 0026
         LM    4,5,EXELND                . 002820 9845 A4B8
         STM   1,2,8(4)                  . 002824 9012 4008
         LM    2,3,16(1)                 . 002828 9823 1010
         STM   2,3,24(4)                 . 00282C 9023 4018
         STM   4,5,16(1)                 . 002830 9045 1010
         LD    0,EXELND                  . 002834 6800 A4B8
         STD   0,EXPRND                  . 002838 6000 A4D8
         B     EXPR1                     . 00283C 47F0 B030
                                                             SPACE
* EXPR4 ADDSIB EXPRND,EXELND       Add current node as sibling
                                                             SPACE
EXPR4    L     1,EXPRND                  . 002840 5810 A4D8
         LM    2,3,EXELND                . 002844 9823 A4B8
         L     5,8(1)                    . 002848 5851 0008
         L     4,36(5)                   . 00284C 5845 0024
         LA    4,1(4)                    . 002850 4144 0001
         STH   4,38(5)                   . 002854 4045 0026
         LM    5,6,8(1)                  . 002858 9856 1008
         STM   5,6,8(2)                  . 00285C 9056 2008
         LM    5,6,24(1)                 . 002860 9856 1018
         STM   5,6,24(2)                 . 002864 9056 2018
         STM   2,3,24(1)                 . 002868 9023 1018
                                                             SPACE
* EXPR5 AEQLIC EXPRND,FATHER,0,,EXPR11
*                                  Check for root node
*      GETDC   EXPRND,EXPRND,FATHER
*                                  Get father node
*      AEQLIC  EXPRND,FATHER,0,,EXPR11
*                                  Check for root node
*      GETDC   EXEXND,EXPRND,FATHER
*                                  Get father node
*      GETDC   XPTR,EXEXND,CODE    Get function descriptor
*      GETDC   XPTR,XPTR,2*DESCR   Get precedence descriptor
*      ACOMP   XPTR,EXOPCL,EXPR5   Compare precedences
*      INSERT  EXPRND,EXOPND       Insert node above
*      BRANCH  EXPR1               Continue processing
                                                             SPACE
EXPR5    L     1,EXPRND                  . 00286C 5810 A4D8
         C     0,8(1)                    . 002870 5901 0008
         BE    EXPR11                    . 002874 4780 B2A4
         LM    1,2,8(1)                  . 002878 9812 1008
         STM   1,2,EXPRND                . 00287C 9012 A4D8
         C     0,8(1)                    . 002880 5901 0008
         BE    EXPR11                    . 002884 4780 B2A4
         LM    1,2,8(1)                  . 002888 9812 1008
         STM   1,2,EXEXND                . 00288C 9012 A4C0
         LM    1,2,32(1)                 . 002890 9812 1020
         STM   1,2,XPTR                  . 002894 9012 A410
         LM    1,2,16(1)                 . 002898 9812 1010
         STM   1,2,XPTR                  . 00289C 9012 A410
         C     1,EXOPCL                  . 0028A0 5910 A4C8
         BH    EXPR5                     . 0028A4 4720 B1D4
         LM    1,2,EXPRND                . 0028A8 9812 A4D8
         LM    3,4,8(1)                  . 0028AC 9834 1008
         LM    3,4,16(3)                 . 0028B0 9834 3010
         LM    5,6,EXOPND                . 0028B4 9856 A4D0
         L     7,36(5)                   . 0028B8 5875 0024
         LA    7,1(7)                    . 0028BC 4177 0001
         STH   7,38(5)                   . 0028C0 4075 0026
         STM   5,6,24(3)                 . 0028C4 9056 3018
         LM    3,4,8(1)                  . 0028C8 9834 1008
         STM   3,4,8(5)                  . 0028CC 9034 5008
         STM   5,6,8(1)                  . 0028D0 9056 1008
         STM   1,2,16(5)                 . 0028D4 9012 5010
         B     EXPR1                     . 0028D8 47F0 B030
                                                             SPACE
* EXPR7 AEQLC  EXPRND,0,EXPR10     Check for empty tree
*      MOVD    XPTR,EXELND         Set up for return
*      BRANCH  EXPR9               Join end processing
                                                             SPACE
EXPR7    C     0,EXPRND                  . 0028DC 5900 A4D8
         BNE   EXPR10                    . 0028E0 4770 B258
         LD    0,EXELND                  . 0028E4 6800 A4B8
         STD   0,XPTR                    . 0028E8 6000 A410
         B     EXPR9                     . 0028EC 47F0 B28C
                                                             SPACE
* EXPR10 ADDSIB EXPRND,EXELND      Add node as sibling
*      MOVD    XPTR,EXPRND         Set up for return
                                                             SPACE
EXPR10   L     1,EXPRND                  . 0028F0 5810 A4D8
         LM    2,3,EXELND                . 0028F4 9823 A4B8
         L     5,8(1)                    . 0028F8 5851 0008
         L     4,36(5)                   . 0028FC 5845 0024
         LA    4,1(4)                    . 002900 4144 0001
         STH   4,38(5)                   . 002904 4045 0026
         LM    5,6,8(1)                  . 002908 9856 1008
         STM   5,6,8(2)                  . 00290C 9056 2008
         LM    5,6,24(1)                 . 002910 9856 1018
         STM   5,6,24(2)                 . 002914 9056 2018
         STM   2,3,24(1)                 . 002918 9023 1018
         LD    0,EXPRND                  . 00291C 6800 A4D8
         STD   0,XPTR                    . 002920 6000 A410
                                                             SPACE
* EXPR9 AEQLIC XPTR,FATHER,0,,RTXNAM
*                                  Check for root node
*      GETDC   XPTR,XPTR,FATHER    Go back to father
*      BRANCH  EXPR9               Continue up tree
                                                             SPACE
EXPR9    L     1,XPTR                    . 002924 5810 A410
         C     0,8(1)                    . 002928 5901 0008
         BE    RTXNAM                    . 00292C 4780 9038
         LD    0,8(1)                    . 002930 6801 0008
         STD   0,XPTR                    . 002934 6000 A410
         B     EXPR9                     . 002938 47F0 B28C
                                                             SPACE
* EXPR11 ADDSON EXOPND,EXPRND      Add node as son
*      BRANCH  EXPR1               Continue processing
                                                             SPACE
EXPR11   LM    1,2,EXOPND                . 00293C 9812 A4D0
         L     4,36(1)                   . 002940 5841 0024
         LA    4,1(4)                    . 002944 4144 0001
         STH   4,38(1)                   . 002948 4041 0026
         LM    4,5,EXPRND                . 00294C 9845 A4D8
         STM   1,2,8(4)                  . 002950 9012 4008
         LM    2,3,16(1)                 . 002954 9823 1010
         STM   2,3,24(4)                 . 002958 9023 4018
         STM   4,5,16(1)                 . 00295C 9045 1010
         B     EXPR1                     . 002960 47F0 B030
                                                             SPACE
* EXPNUL RCALL EXPRND,BLOCK,CNDSIZ Allocate block for tree node
*      PUTDC   EXPRND,CODE,LITCL   Insert literal function
*      RCALL   EXEXND,BLOCK,CNDSIZ Allocate block for tree node
*      PUTDC   EXEXND,CODE,NULVCL  Insert null string as value
*      ADDSON  EXPRND,EXEXND       Add node as son
*      MOVD    XPTR,EXPRND         Set up for return
*      BRANCH  RTXNAM
                                                             SPACE
EXPNUL   LA    14,S4$02988               . 002964 41E0 B2F0
         STM   11,14,104(12)             . 002968 90BE C068
         LR    13,12                     . 00296C 18DC
         LD    0,CNDSIZ                  . 00296E 6800 9BF8
         STD   0,120(12)                 . 002972 600C 0078
         LA    12,24(12)                 . 002976 41CC 0018
         C     12,@@STACKT               . 00297A 59C0 A828
         BH    OVER                      . 00297E 4720 9664
         L     11,@@BLOCK                . 002982 58B0 A82C
         BR    11                        . 002986 07FB
S4$02988 STD   0,EXPRND                  . 002988 6000 A4D8
         L     1,EXPRND                  . 00298C 5810 A4D8
         LD    0,LITCL                   . 002990 6800 9D78
         STD   0,32(1)                   . 002994 6001 0020
         LA    14,S4$029BC               . 002998 41E0 B324
         STM   11,14,104(12)             . 00299C 90BE C068
         LR    13,12                     . 0029A0 18DC
         LD    0,CNDSIZ                  . 0029A2 6800 9BF8
         STD   0,120(12)                 . 0029A6 600C 0078
         LA    12,24(12)                 . 0029AA 41CC 0018
         C     12,@@STACKT               . 0029AE 59C0 A828
         BH    OVER                      . 0029B2 4720 9664
         L     11,@@BLOCK                . 0029B6 58B0 A82C
         BR    11                        . 0029BA 07FB
S4$029BC STD   0,EXEXND                  . 0029BC 6000 A4C0
         L     1,EXEXND                  . 0029C0 5810 A4C0
         LD    0,NULVCL                  . 0029C4 6800 9ED0
         STD   0,32(1)                   . 0029C8 6001 0020
         LM    1,2,EXPRND                . 0029CC 9812 A4D8
         L     4,36(1)                   . 0029D0 5841 0024
         LA    4,1(4)                    . 0029D4 4144 0001
         STH   4,38(1)                   . 0029D8 4041 0026
         LM    4,5,EXEXND                . 0029DC 9845 A4C0
         STM   1,2,8(4)                  . 0029E0 9012 4008
         LM    2,3,16(1)                 . 0029E4 9823 1010
         STM   2,3,24(4)                 . 0029E8 9023 4018
         STM   4,5,16(1)                 . 0029EC 9045 1010
         LD    0,EXPRND                  . 0029F0 6800 A4D8
         STD   0,XPTR                    . 0029F4 6000 A410
         B     RTXNAM                    . 0029F8 47F0 9038
                                                             SPACE
* EXPERR SETAC EMSGCL,ILLEOS       'ILLEGAL END OF STATEMENT'
*      BRANCH  RTN1                Take error return
EXPERR   L     1,@@ILLEOS                . 0029FC 5810 A8B0
         ST    1,EMSGCL                  . 002A00 5010 9E50
         B     FAIL                      . 002A04 47F0 9010
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Location of Next Nonblank Character
*
                                                             SPACE
* FORWRD PROC  ,                   Procedure to get to next character
*      STREAM  XSP,TEXTSP,FRWDTB,COMP3,FORRUN
*                                  Break for next nonblank
                                                             SPACE
         USING FORWRD,11                 .
FORWRD   L     15,@@STREAM               . 002A08 58F0 A840
         LA    1,XSP                     . 002A0C 4110 A5D0
         LA    2,TEXTSP                  . 002A10 4120 A590
         L     3,@@FRWDTB                . 002A14 5830 A88C
         BALR  14,15                          CALL                     *
                                         . 002A18 05EF
         B     S4$010                    . 002A1A 47F0 95AC
         B     FORRUN                    . 002A1E 47F0 B026
                                                             SPACE
* FORJRN MOVD  BRTYPE,STYPE        Set up break type
*      BRANCH  RTN2                Return
                                                             SPACE
FORJRN   LD    0,STYPE                   . 002A22 6800 9F08
         STD   0,BRTYPE                  . 002A26 6000 9E20
         B     RTN2                      . 002A2A 47F0 9028
                                                             SPACE
* FORRUN AEQLC UNIT,0,,FOREOS      Check for input stream
*      AEQLC   LISTCL,0,,FORRUR    Check listing switch
*      STPRNT  IOKEY,OUTBLK,LNBFSP Print card image
                                                             SPACE
FORRUN   C     0,UNIT                    . 002A2E 5900 9F18
         BE    FOREOS                    . 002A32 4780 B0A8
         C     0,LISTCL                  . 002A36 5900 9BC8
         BE    FORRUR                    . 002A3A 4780 B048
         L     15,@@STPRNT               . 002A3E 58F0 A838
         LA    1,IOKEY                   . 002A42 4110 9EA0
         LA    2,OUTBLK                  . 002A46 4120 9C70
         LA    3,LNBFSP                  . 002A4A 4130 9FC8
         BALR  14,15                          CALL                     *
                                         . 002A4E 05EF
                                                             SPACE
* FORRUR STREAD INBFSP,UNIT,FORRUR,COMP5
*                                  Read new card iamge
*      SETSP   TEXTSP,NEXTSP       Set up new line
*      STREAM  XSP,TEXTSP,CARDTB,COMP3,COMP3
*                                  Determine card type
*      RCALL   ,NEWCRD,,(FORRUN,FORWRD)
*                                  Process new card
                                                             SPACE
FORRUR   L     15,@@STREAD               . 002A50 58F0 A83C
         LA    1,INBFSP                  . 002A54 4110 9FB8
         LA    2,UNIT                    . 002A58 4120 9F18
         BALR  14,15                          CALL                     *
                                         . 002A5C 05EF
         B     FORRUR                    . 002A5E 47F0 B048
         B     COMP5                     . 002A62 47F0 95B4
         LM    1,4,NEXTSP                . 002A66 9814 9FD8
         STM   1,4,TEXTSP                . 002A6A 9014 A590
         L     15,@@STREAM               . 002A6E 58F0 A840
         LA    1,XSP                     . 002A72 4110 A5D0
         LA    2,TEXTSP                  . 002A76 4120 A590
         L     3,@@CARDTB                . 002A7A 5830 A844
         BALR  14,15                          CALL                     *
                                         . 002A7E 05EF
         B     S4$010                    . 002A80 47F0 95AC
         B     S4$010                    . 002A84 47F0 95AC
         LA    14,S4$02AA4               . 002A88 41E0 B09C
         STM   11,14,104(12)             . 002A8C 90BE C068
         LR    13,12                     . 002A90 18DC
         LA    12,16(12)                 . 002A92 41CC 0010
         C     12,@@STACKT               . 002A96 59C0 A828
         BH    OVER                      . 002A9A 4720 9664
         L     11,@@NEWCRD               . 002A9E 58B0 A848
         BR    11                        . 002AA2 07FB
S4$02AA4 SR    0,0                       . 002AA4 1B00
         SR    0,0                       . 002AA6 1B00
         B     FORRUN                    . 002AA8 47F0 B026
         B     FORWRD                    . 002AAC 47F0 B000
                                                             SPACE
* FOREOS MOVD  BRTYPE,EOSCL        Set up end-of-card
*      BRANCH  RTN2                Return
                                                             SPACE
FOREOS   LD    0,EOSCL                   . 002AB0 6800 9C10
         STD   0,BRTYPE                  . 002AB4 6000 9E20
         B     RTN2                      . 002AB8 47F0 9028
                                                             SPACE
* FORBLK PROC  FORWRD              Procedure to get to nonblank
*      STREAM  XSP,TEXTSP,IBLKTB,RTN1,FORRUN,FORJRN
*                                  Break out nonblank from blank
FORBLK   L     11,@@FORWRD               . 002ABC 58B0 A8A8
         L     15,@@STREAM               . 002AC0 58F0 A840
         LA    1,XSP                     . 002AC4 4110 A5D0
         LA    2,TEXTSP                  . 002AC8 4120 A590
         L     3,@@IBLKTB                . 002ACC 5830 A850
         BALR  14,15                          CALL                     *
                                         . 002AD0 05EF
         B     FAIL                      . 002AD2 47F0 9010
         B     FORRUN                    . 002AD6 47F0 B026
         B     FORJRN                    . 002ADA 47F0 B01A
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Card Image Processing
*
                                                             SPACE
* NEWCRD PROC  ,                   Process new card image
*      SELBRA  STYPE,(,CMTCRD,CTLCRD,CNTCRD)
*                                  Branch on card type
*      AEQLC   LISTCL,0,,RTN3      Return if listing is off
*      MOVD    XCL,CSTNCL          Copy of statement number
*      INCRA   XCL,1               Increment number
*      INTSPC  TSP,XCL             Convert it to STRING
*      AEQLC   LLIST,0,CARDL       Check for left listing
*      SETLC   RNOSP,0             Clear right specifier
*      APDSP   RNOSP,TSP           Set to statement number
*      BRANCH  RTN3
                                                             SPACE
         USING NEWCRD,11                 .
NEWCRD   L     1,STYPE                   . 002ADE 5810 9F08
         SLA   1,2                       . 002AE2 8B10 0002
S4$02AE6 B     S4$02AE6(1)               . 002AE6 47F1 B008
         B     S4$02AFA                  . 002AEA 47F0 B01C
         B     CMTCRD                    . 002AEE 47F0 B076
         B     CTLCRD                    . 002AF2 47F0 B0FE
         B     CNTCRD                    . 002AF6 47F0 B0A6
S4$02AFA C     0,LISTCL                  . 002AFA 5900 9BC8
         BE    RTNUL3                    . 002AFE 4780 9030
         LM    1,2,CSTNCL                . 002B02 9812 9B70
         STM   1,2,XCL                   . 002B06 9012 A408
         LA    1,1(1)                    . 002B0A 4111 0001
         ST    1,XCL                     . 002B0E 5010 A408
         L     15,@@BDSPEC               . 002B12 58F0 A874
         LA    1,TSP                     . 002B16 4110 A5A0
         LA    2,XCL                     . 002B1A 4120 A408
         BALR  14,15                          CALL                     *
                                         . 002B1E 05EF
         C     0,LLIST                   . 002B20 5900 9BD0
         BNE   CARDL                     . 002B24 4770 B060
         ST    0,RNOSP                   . 002B28 5000 9FF8
         L     15,@@APDSP                . 002B2C 58F0 A870
         LA    2,RNOSP                   . 002B30 4120 9FF8
         LM    3,5,TSP                   . 002B34 9835 A5A0
         BALR  14,15                          CALL                     *
                                         . 002B38 05EF
         B     RTNUL3                    . 002B3A 47F0 9030
                                                             SPACE
* CARDL SETLC  LNOSP,0             Clear left specifier
*      APDSP   LNOSP,TSP           Set to statement number
*      BRANCH  RTN3
                                                             SPACE
CARDL    ST    0,LNOSP                   . 002B3E 5000 9FE8
         L     15,@@APDSP                . 002B42 58F0 A870
         LA    2,LNOSP                   . 002B46 4120 9FE8
         LM    3,5,TSP                   . 002B4A 9835 A5A0
         BALR  14,15                          CALL                     *
                                         . 002B4E 05EF
         B     RTNUL3                    . 002B50 47F0 9030
                                                             SPACE
* CMTCRD AEQLC LISTCL,0,,RTN1      Return if listing is off
                                                             SPACE
CMTCRD   C     0,LISTCL                  . 002B54 5900 9BC8
         BE    FAIL                      . 002B58 4780 9010
                                                             SPACE
* CMTCLR SETLC LNOSP,0             Clear left specifier
*      SETLC   RNOSP,0             Clear right specifier
*      APDSP   LNOSP,BLNSP         Blank left specifier
*      APDSP   RNOSP,BLNSP         Blank right specifier
*      BRANCH  RTN1
                                                             SPACE
CMTCLR   ST    0,LNOSP                   . 002B5C 5000 9FE8
         ST    0,RNOSP                   . 002B60 5000 9FF8
         L     15,@@APDSP                . 002B64 58F0 A870
         LA    2,LNOSP                   . 002B68 4120 9FE8
         LM    3,5,BLNSP                 . 002B6C 9835 9F98
         BALR  14,15                          CALL                     *
                                         . 002B70 05EF
         L     15,@@APDSP                . 002B72 58F0 A870
         LA    2,RNOSP                   . 002B76 4120 9FF8
         LM    3,5,BLNSP                 . 002B7A 9835 9F98
         BALR  14,15                          CALL                     *
                                         . 002B7E 05EF
         B     FAIL                      . 002B80 47F0 9010
                                                             SPACE
* CNTCRD FSHRTN TEXTSP,1           Remove continue character
*      AEQLC   LISTCL,0,,RTN2      Return if listing is off
*      INTSPC  TSP,CSTNCL          Get specifier for number
*      AEQLC   LLIST,0,CARDLL      Check for left listing
*      SETLC   RNOSP,0             Clear right specifier
*      APDSP   RNOSP,TSP           Set to statement number
*      BRANCH  RTN2
                                                             SPACE
CNTCRD   LM    1,2,TEXTSP                . 002B84 9812 A590
         BCTR  1,0                            DECREMENT                *
                                         . 002B88 0610
         LA    2,1(2)                    . 002B8A 4122 0001
         STM   1,2,TEXTSP                . 002B8E 9012 A590
         C     0,LISTCL                  . 002B92 5900 9BC8
         BE    RTN2                      . 002B96 4780 9028
         L     15,@@BDSPEC               . 002B9A 58F0 A874
         LA    1,TSP                     . 002B9E 4110 A5A0
         LA    2,CSTNCL                  . 002BA2 4120 9B70
         BALR  14,15                          CALL                     *
                                         . 002BA6 05EF
         C     0,LLIST                   . 002BA8 5900 9BD0
         BNE   CARDLL                    . 002BAC 4770 B0E8
         ST    0,RNOSP                   . 002BB0 5000 9FF8
         L     15,@@APDSP                . 002BB4 58F0 A870
         LA    2,RNOSP                   . 002BB8 4120 9FF8
         LM    3,5,TSP                   . 002BBC 9835 A5A0
         BALR  14,15                          CALL                     *
                                         . 002BC0 05EF
         B     RTN2                      . 002BC2 47F0 9028
                                                             SPACE
* CARDLL SETLC LNOSP,0             Clear left specifier
*      APDSP   LNOSP,TSP           Set to statement number
*      BRANCH  RTN2
                                                             SPACE
CARDLL   ST    0,LNOSP                   . 002BC6 5000 9FE8
         L     15,@@APDSP                . 002BCA 58F0 A870
         LA    2,LNOSP                   . 002BCE 4120 9FE8
         LM    3,5,TSP                   . 002BD2 9835 A5A0
         BALR  14,15                          CALL                     *
                                         . 002BD6 05EF
         B     RTN2                      . 002BD8 47F0 9028
                                                             SPACE
* CTLCRD FSHRTN TEXTSP,1           Delete control character
*      STREAM  XSP,TEXTSP,FRWDTB,COMP3,CMTCRD
*                                  Get to next nonblank character
*      AEQLC   STYPE,NBTYP,CMTCRD  Verify nonbreak
*      STREAM  XSP,TEXTSP,LBLXTB,CMTCLR,CMTCLR
*                                  Break out command
*      LEXCMP  XSP,UNLSP,CTLCR1,,CTLCR1
*                                  Is it UNLIST?
*      SETAC   LISTCL,0            Zero listing switch
*      BRANCH  RTN1                Return
                                                             SPACE
CTLCRD   LM    1,2,TEXTSP                . 002BDC 9812 A590
         BCTR  1,0                            DECREMENT                *
                                         . 002BE0 0610
         LA    2,1(2)                    . 002BE2 4122 0001
         STM   1,2,TEXTSP                . 002BE6 9012 A590
         L     15,@@STREAM               . 002BEA 58F0 A840
         LA    1,XSP                     . 002BEE 4110 A5D0
         LA    2,TEXTSP                  . 002BF2 4120 A590
         L     3,@@FRWDTB                . 002BF6 5830 A88C
         BALR  14,15                          CALL                     *
                                         . 002BFA 05EF
         B     S4$010                    . 002BFC 47F0 95AC
         B     CMTCRD                    . 002C00 47F0 B076
         LA    6,1                       . 002C04 4160 0001
         C     6,STYPE                   . 002C08 5960 9F08
         BNE   CMTCRD                    . 002C0C 4770 B076
         L     15,@@STREAM               . 002C10 58F0 A840
         LA    1,XSP                     . 002C14 4110 A5D0
         LA    2,TEXTSP                  . 002C18 4120 A590
         L     3,@@LBLXTB                . 002C1C 5830 A90C
         BALR  14,15                          CALL                     *
                                         . 002C20 05EF
         B     CMTCLR                    . 002C22 47F0 B07E
         B     CMTCLR                    . 002C26 47F0 B07E
         LM    2,4,XSP                   . 002C2A 9824 A5D0
         LM    5,7,UNLSP                 . 002C2E 9857 A1C8
         CR    2,5                       . 002C32 1925
         BNE   CTLCR1                    . 002C34 4770 B16C
         L     15,@@SPECEQ               . 002C38 58F0 A890
         BALR  14,15                          CALL                     *
                                         . 002C3C 05EF
         B     CTLCR1                    . 002C3E 47F0 B16C
         ST    0,LISTCL                  . 002C42 5000 9BC8
         B     FAIL                      . 002C46 47F0 9010
                                                             SPACE
* CTLCR1 LEXCMP XSP,LISTSP,CTLCR3,,CTLCR3
*                                  Is it LIST?
*      SETAC   LISTCL,1            Turn on listing
*      STREAM  XSP,TEXTSP,FRWDTB,COMP3,CMTCLR
*                                  Get to next nonblank character
*      AEQLC   STYPE,NBTYP,CMTCLR  Verify nonbreak
*      STREAM  XSP,TEXTSP,LBLXTB,CMTCLR,CMTCLR
*                                  Get type of listing
*      LEXCMP  XSP,LEFTSP,CTLCR2,,CTLCR2
*                                  Is it LEFT?
*      SETAC   LLIST,1             Set left listing switch
*      BRANCH  CMTCLR              Join terminal processing
                                                             SPACE
CTLCR1   LM    2,4,XSP                   . 002C4A 9824 A5D0
         LM    5,7,LISTSP                . 002C4E 9857 A148
         CR    2,5                       . 002C52 1925
         BNE   CTLCR3                    . 002C54 4770 B1F8
         L     15,@@SPECEQ               . 002C58 58F0 A890
         BALR  14,15                          CALL                     *
                                         . 002C5C 05EF
         B     CTLCR3                    . 002C5E 47F0 B1F8
         LA    1,1                       . 002C62 4110 0001
         ST    1,LISTCL                  . 002C66 5010 9BC8
         L     15,@@STREAM               . 002C6A 58F0 A840
         LA    1,XSP                     . 002C6E 4110 A5D0
         LA    2,TEXTSP                  . 002C72 4120 A590
         L     3,@@FRWDTB                . 002C76 5830 A88C
         BALR  14,15                          CALL                     *
                                         . 002C7A 05EF
         B     S4$010                    . 002C7C 47F0 95AC
         B     CMTCLR                    . 002C80 47F0 B07E
         LA    6,1                       . 002C84 4160 0001
         C     6,STYPE                   . 002C88 5960 9F08
         BNE   CMTCLR                    . 002C8C 4770 B07E
         L     15,@@STREAM               . 002C90 58F0 A840
         LA    1,XSP                     . 002C94 4110 A5D0
         LA    2,TEXTSP                  . 002C98 4120 A590
         L     3,@@LBLXTB                . 002C9C 5830 A90C
         BALR  14,15                          CALL                     *
                                         . 002CA0 05EF
         B     CMTCLR                    . 002CA2 47F0 B07E
         B     CMTCLR                    . 002CA6 47F0 B07E
         LM    2,4,XSP                   . 002CAA 9824 A5D0
         LM    5,7,LEFTSP                . 002CAE 9857 A138
         CR    2,5                       . 002CB2 1925
         BNE   CTLCR2                    . 002CB4 4770 B1F0
         L     15,@@SPECEQ               . 002CB8 58F0 A890
         BALR  14,15                          CALL                     *
                                         . 002CBC 05EF
         B     CTLCR2                    . 002CBE 47F0 B1F0
         LA    1,1                       . 002CC2 4110 0001
         ST    1,LLIST                   . 002CC6 5010 9BD0
         B     CMTCLR                    . 002CCA 47F0 B07E
                                                             SPACE
* CTLCR2 SETAC LLIST,0             Zero left listing as default
*      BRANCH  CMTCLR              Join terminal processing
                                                             SPACE
CTLCR2   ST    0,LLIST                   . 002CCE 5000 9BD0
         B     CMTCLR                    . 002CD2 47F0 B07E
                                                             SPACE
* CTLCR3 LEXCMP XSP,EJCTSP,CMTCLR,,CMTCLR
*                                  Is it EJECT?
*      AEQLC   LISTCL,0,,CMTCLR    Skip eject if not listing
*      OUTPUT  OUTPUT,EJECTF       Eject page
*      BRANCH  CMTCLR              Join terminal processing
CTLCR3   LM    2,4,XSP                   . 002CD6 9824 A5D0
         LM    5,7,EJCTSP                . 002CDA 9857 A0F8
         CR    2,5                       . 002CDE 1925
         BNE   CMTCLR                    . 002CE0 4770 B07E
         L     15,@@SPECEQ               . 002CE4 58F0 A890
         BALR  14,15                          CALL                     *
                                         . 002CE8 05EF
         B     CMTCLR                    . 002CEA 47F0 B07E
         C     0,LISTCL                  . 002CEE 5900 9BC8
         BE    CMTCLR                    . 002CF2 4780 B07E
         STM   13,1,AISAVE               . 002CF6 90D1 A770
         L     13,@@SAVSAV               . 002CFA 58D0 A810
         L     15,@@IBCOM#               . 002CFE 58F0 A814
         NOPR  0                         . 002D02 0700
         BAL   14,4(15)                       CALL                     *
                                         . 002D04 45EF 0004
         DC    X'01'                     . 002D08 01
         DC    AL3(OUTPUT)               . 002D09 00D068
         DC    X'01'                     . 002D0C 01
         DC    AL3(EJECTF)               . 002D0D 014137
         BAL   14,16(15)                      CALL                     *
                                         . 002D10 45EF 0010
         LM    13,1,AISAVE               . 002D14 98D1 A770
         B     CMTCLR                    . 002D18 47F0 B07E
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Publication of Code Trees
*
                                                             SPACE
* TREPUB PROC  ,                   Publish code tree
*      POP     YPTR                Restore root node
                                                             SPACE
         USING TREPUB,11                 .
TREPUB   LD    0,96(12)                  . 002D1C 680C 0060
         STD   0,YPTR                    . 002D20 6000 A428
         SR    12,8                      . 002D24 1BC8
                                                             SPACE
* TREPU1 GETDC XPTR,YPTR,CODE      Get code descriptor
*      INCRA   CMOFCL,DESCR        Increment offset
*      PUTD    CMBSCL,CMOFCL,XPTR  Insert code descriptor
*      SUM     ZPTR,CMBSCL,CMOFCL  Compute total position
*      ACOMP   ZPTR,OCLIM,TREPU5   Check against limit
                                                             SPACE
TREPU1   L     1,YPTR                    . 002D26 5810 A428
         LD    0,32(1)                   . 002D2A 6801 0020
         STD   0,XPTR                    . 002D2E 6000 A410
         L     1,CMOFCL                  . 002D32 5810 9E28
         AR    1,8                       . 002D36 1A18
         ST    1,CMOFCL                  . 002D38 5010 9E28
         L     2,CMBSCL                  . 002D3C 5820 A458
         STD   0,0(1,2)                  . 002D40 6001 2000
         LM    1,2,CMBSCL                . 002D44 9812 A458
         A     1,CMOFCL                  . 002D48 5A10 9E28
         STM   1,2,ZPTR                  . 002D4C 9012 A440
         C     1,OCLIM                   . 002D50 5910 A478
         BH    TREPU5                    . 002D54 4720 B084
                                                             SPACE
* TREPU4 AEQLIC YPTR,LSON,0,,TREPU2 Is there a left son?
*      GETDC   YPTR,YPTR,LSON      Get left son
*      BRANCH  TREPU1              Continue
                                                             SPACE
TREPU4   L     1,YPTR                    . 002D58 5810 A428
         C     0,16(1)                   . 002D5C 5901 0010
         BE    TREPU2                    . 002D60 4780 B054
         LD    0,16(1)                   . 002D64 6801 0010
         STD   0,YPTR                    . 002D68 6000 A428
         B     TREPU1                    . 002D6C 47F0 B00A
                                                             SPACE
* TREPU2 AEQLIC YPTR,RSIB,0,,TREPU3 Is there a right sibling?
*      GETDC   YPTR,YPTR,RSIB      Get right sibling
*      BRANCH  TREPU1              Continue
                                                             SPACE
TREPU2   L     1,YPTR                    . 002D70 5810 A428
         C     0,24(1)                   . 002D74 5901 0018
         BE    TREPU3                    . 002D78 4780 B06C
         LD    0,24(1)                   . 002D7C 6801 0018
         STD   0,YPTR                    . 002D80 6000 A428
         B     TREPU1                    . 002D84 47F0 B00A
                                                             SPACE
* TREPU3 AEQLIC YPTR,FATHER,0,,RTN1 Is there a father?
*      GETDC   YPTR,YPTR,FATHER    Get father
*      BRANCH  TREPU2              Continue
                                                             SPACE
TREPU3   L     1,YPTR                    . 002D88 5810 A428
         C     0,8(1)                    . 002D8C 5901 0008
         BE    FAIL                      . 002D90 4780 9010
         LD    0,8(1)                    . 002D94 6801 0008
         STD   0,YPTR                    . 002D98 6000 A428
         B     TREPU2                    . 002D9C 47F0 B054
                                                             SPACE
* TREPU5 SUM   ZPTR,CMOFCL,CODELT  Compute additional to get
*      SETVC   ZPTR,C              Insert CODE data type
*      RCALL   XCL,BLOCK,ZPTR      Allocate new code block
*      AEQLC   LPTR,0,,TREPU6      Is there a last label?
*      PUTDC   LPTR,ATTRIB,XCL     Insert new code position
                                                             SPACE
TREPU5   LM    1,2,CMOFCL                . 002DA0 9812 9E28
         A     1,CODELT                  . 002DA4 5A10 9C00
         STM   1,2,ZPTR                  . 002DA8 9012 A440
         MVC   ZPTR$5(3),@@C             . 002DAC D202 A445 AA7E
         LA    14,S4$02DD6               . 002DB2 41E0 B0BA
         STM   11,14,104(12)             . 002DB6 90BE C068
         LR    13,12                     . 002DBA 18DC
         LD    0,ZPTR                    . 002DBC 6800 A440
         STD   0,120(12)                 . 002DC0 600C 0078
         LA    12,24(12)                 . 002DC4 41CC 0018
         C     12,@@STACKT               . 002DC8 59C0 A828
         BH    OVER                      . 002DCC 4720 9664
         L     11,@@BLOCK                . 002DD0 58B0 A82C
         BR    11                        . 002DD4 07FB
S4$02DD6 STD   0,XCL                     . 002DD6 6000 A408
         C     0,LPTR                    . 002DDA 5900 A3A0
         BE    TREPU6                    . 002DDE 4780 B0CE
         L     1,LPTR                    . 002DE2 5810 A3A0
         STD   0,16(1)                   . 002DE6 6001 0010
                                                             SPACE
* TREPU6 MOVBLK XCL,CMBSCL,CMOFCL  Move old code
*      PUTDC   CMBSCL,DESCR,GOTGCL Insert direct goto
*      PUTDC   CMBSCL,2*DESCR,LIT1CL                            E3.7.1
*                                  Insert literal function
*      PUTDC   CMBSCL,3*DESCR,XCL  Insert pointer to new code
*      INCRA   CMBSCL,3*DESCR      Update end pointer
*      RCALL   ,SPLIT,(CMBSCL)     Split off old portion
*      MOVD    CMBSCL,XCL          Set up new compiler base pointer
*      SUM     OCLIM,CMBSCL,ZPTR   Compute new limit
*      DECRA   OCLIM,5*DESCR       Leave safety factor
*      BRANCH  TREPU4              Rejoin processing
TREPU6   L     6,XCL                     . 002DEA 5860 A408
         L     4,CMBSCL                  . 002DEE 5840 A458
         AR    4,8                       . 002DF2 1A48
         AR    6,8                       . 002DF4 1A68
         L     3,CMOFCL                  . 002DF6 5830 9E28
         L     15,@@MOVTST               . 002DFA 58F0 A864
         BALR  14,15                          CALL                     *
                                         . 002DFE 05EF
         L     1,CMBSCL                  . 002E00 5810 A458
         LD    0,GOTGCL                  . 002E04 6800 9D50
         STD   0,8(1)                    . 002E08 6001 0008
         LD    0,DOTCL                   . 002E0C 6800 9D18
         STD   0,16(1)                   . 002E10 6001 0010
         LD    0,XCL                     . 002E14 6800 A408
         STD   0,24(1)                   . 002E18 6001 0018
         LA    1,24(1)                   . 002E1C 4111 0018
         ST    1,CMBSCL                  . 002E20 5010 A458
         LA    14,S4$02E48               . 002E24 41E0 B12C
         STM   11,14,104(12)             . 002E28 90BE C068
         LR    13,12                     . 002E2C 18DC
         LD    0,CMBSCL                  . 002E2E 6800 A458
         STD   0,120(12)                 . 002E32 600C 0078
         LA    12,24(12)                 . 002E36 41CC 0018
         C     12,@@STACKT               . 002E3A 59C0 A828
         BH    OVER                      . 002E3E 4720 9664
         L     11,@@SPLIT                . 002E42 58B0 A858
         BR    11                        . 002E46 07FB
S4$02E48 SR    0,0                       . 002E48 1B00
         SR    0,0                       . 002E4A 1B00
         LM    1,2,XCL                   . 002E4C 9812 A408
         STM   1,2,CMBSCL                . 002E50 9012 A458
         A     1,ZPTR                    . 002E54 5A10 A440
         STM   1,2,OCLIM                 . 002E58 9012 A478
         S     1,@@5MDESC                . 002E5C 5B10 A834
         ST    1,OCLIM                   . 002E60 5010 A478
         B     TREPU4                    . 002E64 47F0 B03C
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Unary Operator Analysis
*
                                                             SPACE
* UNOP PROC    ,                   Unary operator analysis
*      RCALL   ,FORWRD,,COMP3      Get to next nonblank character
*      SETAC   XPTR,0              Zero code tree
*      AEQLC   BRTYPE,NBTYP,RTN1   Verify nonbreak
                                                             SPACE
         USING UNOP,11                   .
UNOP     LA    14,S4$02E84               . 002E68 41E0 B01C
         STM   11,14,104(12)             . 002E6C 90BE C068
         LR    13,12                     . 002E70 18DC
         LA    12,16(12)                 . 002E72 41CC 0010
         C     12,@@STACKT               . 002E76 59C0 A828
         BH    OVER                      . 002E7A 4720 9664
         L     11,@@FORWRD               . 002E7E 58B0 A8A8
         BR    11                        . 002E82 07FB
S4$02E84 SR    0,0                       . 002E84 1B00
         SR    0,0                       . 002E86 1B00
         B     S4$010                    . 002E88 47F0 95AC
         ST    0,XPTR                    . 002E8C 5000 A410
         LA    6,1                       . 002E90 4160 0001
         C     6,BRTYPE                  . 002E94 5960 9E20
         BNE   FAIL                      . 002E98 4770 9010
                                                             SPACE
* UNOPA STREAM XSP,TEXTSP,UNOPTB,RTXNAM,RTN1                    E3.4.3
*                                  Break out unary operator
*      RCALL   YPTR,BLOCK,CNDSIZ   Allocate block for tree node
*      PUTDC   YPTR,CODE,STYPE     Insert function descriptor
*      AEQLC   XPTR,0,,UNOPB       Is tree empty
*      ADDSON  XPTR,YPTR           Add new node as son
                                                             SPACE
UNOPA    L     15,@@STREAM               . 002E9C 58F0 A840
         LA    1,XSP                     . 002EA0 4110 A5D0
         LA    2,TEXTSP                  . 002EA4 4120 A590
         L     3,@@UNOPTB                . 002EA8 5830 A910
         BALR  14,15                          CALL                     *
                                         . 002EAC 05EF
         B     RTXNAM                    . 002EAE 47F0 9038
         B     FAIL                      . 002EB2 47F0 9010
         LA    14,S4$02EDA               . 002EB6 41E0 B072
         STM   11,14,104(12)             . 002EBA 90BE C068
         LR    13,12                     . 002EBE 18DC
         LD    0,CNDSIZ                  . 002EC0 6800 9BF8
         STD   0,120(12)                 . 002EC4 600C 0078
         LA    12,24(12)                 . 002EC8 41CC 0018
         C     12,@@STACKT               . 002ECC 59C0 A828
         BH    OVER                      . 002ED0 4720 9664
         L     11,@@BLOCK                . 002ED4 58B0 A82C
         BR    11                        . 002ED8 07FB
S4$02EDA STD   0,YPTR                    . 002EDA 6000 A428
         L     1,YPTR                    . 002EDE 5810 A428
         LD    0,STYPE                   . 002EE2 6800 9F08
         STD   0,32(1)                   . 002EE6 6001 0020
         C     0,XPTR                    . 002EEA 5900 A410
         BE    UNOPB                     . 002EEE 4780 B0AE
         LM    1,2,XPTR                  . 002EF2 9812 A410
         L     4,36(1)                   . 002EF6 5841 0024
         LA    4,1(4)                    . 002EFA 4144 0001
         STH   4,38(1)                   . 002EFE 4041 0026
         LM    4,5,YPTR                  . 002F02 9845 A428
         STM   1,2,8(4)                  . 002F06 9012 4008
         LM    2,3,16(1)                 . 002F0A 9823 1010
         STM   2,3,24(4)                 . 002F0E 9023 4018
         STM   4,5,16(1)                 . 002F12 9045 1010
                                                             SPACE
* UNOPB MOVD   XPTR,YPTR           Move to new node
*      BRANCH  UNOPA               Continue
UNOPB    LD    0,YPTR                    . 002F16 6800 A428
         STD   0,XPTR                    . 002F1A 6000 A410
         B     UNOPA                     . 002F1E 47F0 B034
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Interpreter Executive and Control Procedures'
*
*      Code Basing
*
                                                             SPACE
* BASE PROC    ,                   Interpreter code basing procedure
*      SUM     OCBSCL,OCBSCL,OCICL Add offset to base
*      SETAC   OCICL,0             Zero offset
*      BRANCH  RTNUL3
         USING BASE,11                   .
BASE     L     1,OCBSCL                  . 002F22 5810 A470
         A     1,OCICL                   . 002F26 5A10 9ED8
         ST    1,OCBSCL                  . 002F2A 5010 A470
         ST    0,OCICL                   . 002F2E 5000 9ED8
         B     RTNUL3                    . 002F32 47F0 9030
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Direct Goto
*
                                                             SPACE
* GOTG PROC    ,                   :<X>
*      RCALL   OCBSCL,ARGVAL,,INTR5
*                                  Get code pointer
*      VEQLC   OCBSCL,C,INTR4      Must have CODE data type
*      SETAC   OCICL,0             Zero offset
*      BRANCH  RTNUL3
         USING GOTG,11                   .
GOTG     LA    14,S4$02F52               . 002F36 41E0 B01C
         STM   11,14,104(12)             . 002F3A 90BE C068
         LR    13,12                     . 002F3E 18DC
         LA    12,16(12)                 . 002F40 41CC 0010
         C     12,@@STACKT               . 002F44 59C0 A828
         BH    OVER                      . 002F48 4720 9664
         L     11,@@ARGVAL               . 002F4C 58B0 A914
         BR    11                        . 002F50 07FB
S4$02F52 STD   0,OCBSCL                  . 002F52 6000 A470
         B     INTR5                     . 002F56 47F0 960C
         CLC   OCBSCL$5(3),@@C           . 002F5A D502 A475 AA7E
         BNE   INTR4                     . 002F60 4770 9604
         ST    0,OCICL                   . 002F64 5000 9ED8
         B     RTNUL3                    . 002F68 47F0 9030
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Label Goto
*
                                                             SPACE
* GOTL PROC    ,                   :(X)
*      INCRA   OCICL,DESCR         Increment offset
*      GETD    XPTR,OCBSCL,OCICL   Get object code descriptor
*      TESTF   XPTR,FNC,,GOTLC     Test for function
                                                             SPACE
         USING GOTL,11                   .
GOTL     L     1,OCICL                   . 002F6C 5810 9ED8
         AR    1,8                       . 002F70 1A18
         ST    1,OCICL                   . 002F72 5010 9ED8
         L     2,OCBSCL                  . 002F76 5820 A470
         LD    0,0(1,2)                  . 002F7A 6801 2000
         STD   0,XPTR                    . 002F7E 6000 A410
         TM    XPTR$4,X'04'              . 002F82 9104 A414
         BO    GOTLC                     . 002F86 4710 B0DE
                                                             SPACE
* GOTLV ACOMPC TRAPCL,0,,GOTLV1,GOTLV1
*                                  Check &TRACE
*      LOCAPT  ATPTR,TLABL,XPTR,GOTLV1
*                                  Look for LABEL trace
*      PUSH    XPTR                Save variable
*      RCALL   ,TRPHND,ATPTR       Perform trace                E3.3.1
*      POP     XPTR                Restore variable
                                                             SPACE
GOTLV    C     0,TRAPCL                  . 002F8A 5900 9818
         BNL   GOTLV1                    . 002F8E 47B0 B08E
         L     15,TLABL                  . 002F92 58F0 A320
         L     5,4(15)                   . 002F96 585F 0004
         LA    5,0(5,15)                 . 002F9A 4155 F000
         LR    4,8                       . 002F9E 1848
         SR    5,4                       . 002FA0 1B54
         AR    4,8                       . 002FA2 1A48
S4$02FA4 CLC   8(8,15),XPTR              . 002FA4 D507 F008 A410
         BE    S4$02FB6                  . 002FAA 4780 B04A
         BXLE  15,4,S4$02FA4             . 002FAE 87F4 B038
         B     GOTLV1                    . 002FB2 47F0 B08E
S4$02FB6 LD    0,XPTR                    . 002FB6 6800 A410
         STD   0,104(12)                 . 002FBA 600C 0068
         AR    12,8                      . 002FBE 1AC8
         C     12,@@STACKT               . 002FC0 59C0 A828
         BH    OVER                      . 002FC4 4720 9664
         LA    14,S4$02FE8               . 002FC8 41E0 B07C
         STM   11,14,104(12)             . 002FCC 90BE C068
         LR    13,12                     . 002FD0 18DC
         STM   15,0,120(12)              . 002FD2 90F0 C078
         LA    12,24(12)                 . 002FD6 41CC 0018
         C     12,@@STACKT               . 002FDA 59C0 A828
         BH    OVER                      . 002FDE 4720 9664
         L     11,@@TRPHND               . 002FE2 58B0 A918
         BR    11                        . 002FE6 07FB
S4$02FE8 SR    0,0                       . 002FE8 1B00
         SR    0,0                       . 002FEA 1B00
         LA    0,0                       . 002FEC 4100 0000
         LD    0,96(12)                  . 002FF0 680C 0060
         STD   0,XPTR                    . 002FF4 6000 A410
         SR    12,8                      . 002FF8 1BC8
                                                             SPACE
* GOTLV1 DEQL  XPTR,RETCL,GOTL1    Compare with RETURN
*      RRTURN  ,6                  Return by value
                                                             SPACE
GOTLV1   CLC   XPTR(8),RETCL             . 002FFA D507 A410 A540
         BNE   GOTL1                     . 003000 4770 B0A0
         LM    11,14,104(13)             . 003004 98BE D068
         B     24(14)                    . 003008 47FE 0018
                                                             SPACE
* GOTL1 DEQL   XPTR,FRETCL,GOTL2   Compare with FRETURN
*      RRTURN  ,4                  Fail
                                                             SPACE
GOTL1    CLC   XPTR(8),FRETCL            . 00300C D507 A410 A530
         BNE   GOTL2                     . 003012 4770 B0B2
         LM    11,14,104(13)             . 003016 98BE D068
         B     16(14)                    . 00301A 47FE 0010
                                                             SPACE
* GOTL2 DEQL   XPTR,NRETCL,GOTL3   Compare with NRETURN
*      RRTURN  ,5                  Return by name
                                                             SPACE
GOTL2    CLC   XPTR(8),NRETCL            . 00301E D507 A410 A538
         BNE   GOTL3                     . 003024 4770 B0C4
         LM    11,14,104(13)             . 003028 98BE D068
         B     20(14)                    . 00302C 47FE 0014
                                                             SPACE
* GOTL3 GETDC  OCBSCL,XPTR,ATTRIB  Get object code base
*      AEQLC   OCBSCL,0,,INTR4     Must not be zero
*      SETAC   OCICL,0             Zero offset
*      BRANCH  RTNUL3              Return
                                                             SPACE
GOTL3    L     1,XPTR                    . 003030 5810 A410
         LM    1,2,16(1)                 . 003034 9812 1010
         STM   1,2,OCBSCL                . 003038 9012 A470
         CR    0,1                       . 00303C 1901
         BE    INTR4                     . 00303E 4780 9604
         ST    0,OCICL                   . 003042 5000 9ED8
         B     RTNUL3                    . 003046 47F0 9030
                                                             SPACE
* GOTLC RCALL  XPTR,INVOKE,XPTR,(INTR5,,INTR4)                  E3.10.3
*                                  Evaluate goto
*      VEQLC   XPTR,S,INTR4,GOTLV  Variable must be STRING
GOTLC    LA    14,S4$0306E               . 00304A 41E0 B102
         STM   11,14,104(12)             . 00304E 90BE C068
         LR    13,12                     . 003052 18DC
         LD    0,XPTR                    . 003054 6800 A410
         STD   0,120(12)                 . 003058 600C 0078
         LA    12,24(12)                 . 00305C 41CC 0018
         C     12,@@STACKT               . 003060 59C0 A828
         BH    OVER                      . 003064 4720 9664
         L     11,@@INVOKE               . 003068 58B0 A91C
         BR    11                        . 00306C 07FB
S4$0306E STD   0,XPTR                    . 00306E 6000 A410
         B     INTR5                     . 003072 47F0 960C
         B     S4$0307E                  . 003076 47F0 B112
         B     NEMO                      . 00307A 47F0 964C
S4$0307E CLC   XPTR$5(3),@@S             . 00307E D502 A415 AA7B
         BNE   INTR4                     . 003084 4770 9604
         BE    GOTLV                     . 003088 4780 B01E
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Internal Goto
*
                                                             SPACE
* GOTO PROC    ,                   Interpreter goto procedure
*      INCRA   OCICL,DESCR         Increment offset
*      GETD    OCICL,OCBSCL,OCICL  Get offset
*      BRANCH  RTNUL3              Return
         USING GOTO,11                   .
GOTO     L     1,OCICL                   . 00308C 5810 9ED8
         L     2,OCBSCL                  . 003090 5820 A470
         LD    0,8(1,2)                  . 003094 6801 2008
         STD   0,OCICL                   . 003098 6000 9ED8
         B     RTNUL3                    . 00309C 47F0 9030
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Statement Initialization
*
                                                             SPACE
* INIT PROC    ,                   Statement initialization procedure
*      MOVD    LSTNCL,STNOCL       Update &LASTNO
*      INCRA   OCICL,DESCR         Increment offset
*      GETD    XCL,OCBSCL,OCICL    Get statement data
*      MOVA    STNOCL,XCL          Update &STNO
*      SETAV   FRTNCL,XCL          Set up failure offset
*      ACOMP   EXNOCL,EXLMCL,EXEX,EXEX
*                                  Check &STLIMIT
*      INCRA   EXNOCL,1            Increment &STCOUNT
*      ACOMPC  TRAPCL,0,,RTNUL3,RTNUL3
*                                  Check &TRACE
*      LOCAPT  ATPTR,TKEYL,STCTKY,RTNUL3
*      RCALL   ,TRPHND,ATPTR       Perform trace                E3.3.1
*      BRANCH  RTNUL3
         USING INIT,11                   .
INIT     L     1,STNOCL                  . 0030A0 5810 9990
         ST    1,LSTNCL                  . 0030A4 5010 9970
         L     1,OCICL                   . 0030A8 5810 9ED8
         AR    1,8                       . 0030AC 1A18
         ST    1,OCICL                   . 0030AE 5010 9ED8
         A     1,OCBSCL                  . 0030B2 5A10 A470
         LM    1,2,0(1)                  . 0030B6 9812 1000
         ST    1,STNOCL                  . 0030BA 5010 9990
         ST    2,FRTNCL                  . 0030BE 5020 9E88
         L     1,EXNOCL                  . 0030C2 5810 99B0
         C     1,EXLMCL                  . 0030C6 5910 9828
         BNL   EXEX                      . 0030CA 47B0 95F4
         LA    1,1(1)                    . 0030CE 4111 0001
         ST    1,EXNOCL                  . 0030D2 5010 99B0
         C     0,TRAPCL                  . 0030D6 5900 9818
         BNL   RTNUL3                    . 0030DA 47B0 9030
         L     15,TKEYL                  . 0030DE 58F0 A350
         L     5,4(15)                   . 0030E2 585F 0004
         LA    5,0(5,15)                 . 0030E6 4155 F000
         LR    4,8                       . 0030EA 1848
         SR    5,4                       . 0030EC 1B54
         AR    4,8                       . 0030EE 1A48
S4$030F0 CLC   8(8,15),STCTKY            . 0030F0 D507 F008 99B8
         BE    S4$03102                  . 0030F6 4780 B062
         BXLE  15,4,S4$030F0             . 0030FA 87F4 B050
         B     RTNUL3                    . 0030FE 47F0 9030
S4$03102 STM   15,0,ATPTR                . 003102 90F0 A378
         LA    14,S4$0312A               . 003106 41E0 B08A
         STM   11,14,104(12)             . 00310A 90BE C068
         LR    13,12                     . 00310E 18DC
         LD    0,ATPTR                   . 003110 6800 A378
         STD   0,120(12)                 . 003114 600C 0078
         LA    12,24(12)                 . 003118 41CC 0018
         C     12,@@STACKT               . 00311C 59C0 A828
         BH    OVER                      . 003120 4720 9664
         L     11,@@TRPHND               . 003124 58B0 A918
         BR    11                        . 003128 07FB
S4$0312A SR    0,0                       . 00312A 1B00
         SR    0,0                       . 00312C 1B00
         B     RTNUL3                    . 00312E 47F0 9030
         B     RTNUL3                    . 003132 47F0 9030
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Basic Interpreter Procedure
*
                                                             SPACE
* INTERP PROC  ,                   Interpreter core procedure
*      INCRA   OCICL,DESCR         Increment offset
*      GETD    XPTR,OCBSCL,OCICL   Get object code descriptor
*      TESTF   XPTR,FNC,INTERP     Test for function
*      RCALL   XPTR,INVOKE,(XPTR),(,INTERP,INTERP,RTN1,RTN2,RTN3)
*      MOVD    OCICL,FRTNCL        Set offset for failure
*      INCRA   FALCL,1             Increment &STFCOUNT
*      ACOMPC  TRAPCL,0,,INTERP,INTERP
*                                  Check &TRACE
*      LOCAPT  ATPTR,TKEYL,FALKY,INTERP
*      RCALL   ,TRPHND,ATPTR       Perform trace                E3.3.1
*      BRANCH  INTERP
         USING INTERP,11                 .
INTERP   L     1,OCICL                   . 003136 5810 9ED8
         AR    1,8                       . 00313A 1A18
         ST    1,OCICL                   . 00313C 5010 9ED8
         L     2,OCBSCL                  . 003140 5820 A470
         LD    0,0(1,2)                  . 003144 6801 2000
         STD   0,XPTR                    . 003148 6000 A410
         TM    XPTR$4,X'04'              . 00314C 9104 A414
         BNO   INTERP                    . 003150 47E0 B000
         LA    14,S4$03174               . 003154 41E0 B03E
         STM   11,14,104(12)             . 003158 90BE C068
         LR    13,12                     . 00315C 18DC
         STD   0,120(12)                 . 00315E 600C 0078
         LA    12,24(12)                 . 003162 41CC 0018
         C     12,@@STACKT               . 003166 59C0 A828
         BH    OVER                      . 00316A 4720 9664
         L     11,@@INVOKE               . 00316E 58B0 A91C
         BR    11                        . 003172 07FB
S4$03174 STD   0,XPTR                    . 003174 6000 A410
         B     S4$03190                  . 003178 47F0 B05A
         B     INTERP                    . 00317C 47F0 B000
         B     INTERP                    . 003180 47F0 B000
         B     FAIL                      . 003184 47F0 9010
         B     RTN2                      . 003188 47F0 9028
         B     RTNUL3                    . 00318C 47F0 9030
S4$03190 LD    0,FRTNCL                  . 003190 6800 9E88
         STD   0,OCICL                   . 003194 6000 9ED8
         L     1,FALCL                   . 003198 5810 9960
         LA    1,1(1)                    . 00319C 4111 0001
         ST    1,FALCL                   . 0031A0 5010 9960
         C     0,TRAPCL                  . 0031A4 5900 9818
         BNL   INTERP                    . 0031A8 47B0 B000
         L     15,TKEYL                  . 0031AC 58F0 A350
         L     5,4(15)                   . 0031B0 585F 0004
         LA    5,0(5,15)                 . 0031B4 4155 F000
         LR    4,8                       . 0031B8 1848
         SR    5,4                       . 0031BA 1B54
         AR    4,8                       . 0031BC 1A48
S4$031BE CLC   8(8,15),FALKY             . 0031BE D507 F008 9968
         BE    S4$031D0                  . 0031C4 4780 B09A
         BXLE  15,4,S4$031BE             . 0031C8 87F4 B088
         B     INTERP                    . 0031CC 47F0 B000
S4$031D0 STM   15,0,ATPTR                . 0031D0 90F0 A378
         LA    14,S4$031F8               . 0031D4 41E0 B0C2
         STM   11,14,104(12)             . 0031D8 90BE C068
         LR    13,12                     . 0031DC 18DC
         LD    0,ATPTR                   . 0031DE 6800 A378
         STD   0,120(12)                 . 0031E2 600C 0078
         LA    12,24(12)                 . 0031E6 41CC 0018
         C     12,@@STACKT               . 0031EA 59C0 A828
         BH    OVER                      . 0031EE 4720 9664
         L     11,@@TRPHND               . 0031F2 58B0 A918
         BR    11                        . 0031F6 07FB
S4$031F8 SR    0,0                       . 0031F8 1B00
         SR    0,0                       . 0031FA 1B00
         B     INTERP                    . 0031FC 47F0 B000
         B     INTERP                    . 003200 47F0 B000
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Procedure Invocation
*
                                                             SPACE
* INVOKE PROC  ,                   Invokation procedure
*      POP     INCL                Get function index
*      GETDC   XPTR,INCL,0         Get procedure descriptor
*      VEQL    INCL,XPTR,INVK2     Check argument counts
                                                             SPACE
         USING INVOKE,11                 .
INVOKE   LM    1,2,96(12)                . 003204 9812 C060
         STM   1,2,INCL                  . 003208 9012 9E98
         SR    12,8                      . 00320C 1BC8
         CLC   INCL$5(3),5(1)            . 00320E D502 9E9D 1005
         BNE   INVK2                     . 003214 4770 B01A
                                                             SPACE
* INVK1 BRANIC INCL,0              If equal, branch indirect
                                                             SPACE
INVK1    L     11,0(1)                   . 003218 58B1 0000
         BR    11                        . 00321C 07FB
                                                             SPACE
* INVK2 TESTF  XPTR,FNC,ARGNER,INVK1
*                                  Check for variable argument number
INVK2    TM    4(1),X'04'                . 00321E 9104 1004
         BO    INVK1                     . 003222 4710 B014
         BNO   ARGNER                    . 003226 47E0 95A0
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Argument Evaluation Procedures'
*
*      Argument Evaluation
*
                                                             SPACE
* ARGVAL PROC  ,                   Procedure to evaluate argument
*      INCRA   OCICL,DESCR         Increment interpreter offset
*      GETD    XPTR,OCBSCL,OCICL   Get argument
*      TESTF   XPTR,FNC,,ARGVC     Test for function descriptor
                                                             SPACE
         USING ARGVAL,11                 .
ARGVAL   L     1,OCICL                   . 00322A 5810 9ED8
         AR    1,8                       . 00322E 1A18
         ST    1,OCICL                   . 003230 5010 9ED8
         L     2,OCBSCL                  . 003234 5820 A470
         LD    0,0(1,2)                  . 003238 6801 2000
         STD   0,XPTR                    . 00323C 6000 A410
         TM    XPTR$4,X'04'              . 003240 9104 A414
         BO    ARGVC                     . 003244 4710 B08C
                                                             SPACE
* ARGV1 AEQLC  INSW,0,,ARGV2       Check &INPUT
*      LOCAPV  ZPTR,INATL,XPTR,ARGV2
*                                  Look for input association
*      GETDC   ZPTR,ZPTR,DESCR     Get input descriptor
*      RCALL   XPTR,PUTIN,(ZPTR,XPTR),(FAIL,RTXNAM)
                                                             SPACE
ARGV1    C     0,INSW                    . 003248 5900 9858
         BE    ARGV2                     . 00324C 4780 B0C0
         L     15,INATL                  . 003250 58F0 A300
         L     5,4(15)                   . 003254 585F 0004
         LA    5,0(5,15)                 . 003258 4155 F000
         LR    4,8                       . 00325C 1848
         SR    5,4                       . 00325E 1B54
         AR    4,8                       . 003260 1A48
S4$03262 CLC   16(8,15),XPTR             . 003262 D507 F010 A410
         BE    S4$03274                  . 003268 4780 B04A
         BXLE  15,4,S4$03262             . 00326C 87F4 B038
         B     ARGV2                     . 003270 47F0 B0C0
S4$03274 STM   15,0,ZPTR                 . 003274 90F0 A440
         LR    1,15                      . 003278 181F
         LD    0,8(1)                    . 00327A 6801 0008
         STD   0,ZPTR                    . 00327E 6000 A440
         LA    14,S4$032AA               . 003282 41E0 B080
         STM   11,14,104(12)             . 003286 90BE C068
         LR    13,12                     . 00328A 18DC
         STD   0,128(12)                 . 00328C 600C 0080
         LD    0,XPTR                    . 003290 6800 A410
         STD   0,120(12)                 . 003294 600C 0078
         LA    12,32(12)                 . 003298 41CC 0020
         C     12,@@STACKT               . 00329C 59C0 A828
         BH    OVER                      . 0032A0 4720 9664
         L     11,@@PUTIN                . 0032A4 58B0 A920
         BR    11                        . 0032A8 07FB
S4$032AA STD   0,XPTR                    . 0032AA 6000 A410
         B     FAIL                      . 0032AE 47F0 9010
         B     RTXNAM                    . 0032B2 47F0 9038
                                                             SPACE
* ARGVC RCALL  XPTR,INVOKE,(XPTR),(FAIL,ARGV1,RTXNAM)
                                                             SPACE
ARGVC    LA    14,S4$032DA               . 0032B6 41E0 B0B0
         STM   11,14,104(12)             . 0032BA 90BE C068
         LR    13,12                     . 0032BE 18DC
         LD    0,XPTR                    . 0032C0 6800 A410
         STD   0,120(12)                 . 0032C4 600C 0078
         LA    12,24(12)                 . 0032C8 41CC 0018
         C     12,@@STACKT               . 0032CC 59C0 A828
         BH    OVER                      . 0032D0 4720 9664
         L     11,@@INVOKE               . 0032D4 58B0 A91C
         BR    11                        . 0032D8 07FB
S4$032DA STD   0,XPTR                    . 0032DA 6000 A410
         B     FAIL                      . 0032DE 47F0 9010
         B     ARGV1                     . 0032E2 47F0 B01E
         B     RTXNAM                    . 0032E6 47F0 9038
                                                             SPACE
* ARGV2 GETDC  XPTR,XPTR,DESCR     Get value from name
*      BRANCH  RTXNAM
ARGV2    L     1,XPTR                    . 0032EA 5810 A410
         LD    0,8(1)                    . 0032EE 6801 0008
         STD   0,XPTR                    . 0032F2 6000 A410
         B     RTXNAM                    . 0032F6 47F0 9038
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Evaluation of Unevaluated Expressions
*
                                                             SPACE
* EXPVAL PROC  ,                   Procedure to evaluate expression
*      SETAC   SCL,1               Note procedure entrance
                                                             SPACE
         USING EXPVAL,11                 .
EXPVAL   LA    1,1                       . 0032FA 4110 0001
         ST    1,SCL                     . 0032FE 5010 9EF8
                                                             SPACE
* EXPVJN POP   XPTR                Restore pointer to object code
                                                             SPACE
EXPVJN   LD    0,96(12)                  . 003302 680C 0060
         STD   0,XPTR                    . 003306 6000 A410
         SR    12,8                      . 00330A 1BC8
                                                             SPACE
* EXPVJ2 PUSH  (OCBSCL,OCICL,PATBCL,PATICL,WPTR,XCL,YCL,TCL)
*      PUSH    (MAXLEN,LENFCL,PDLPTR,PDLHED,NAMICL,NHEDCL)
*                                  Save system state descriptors
*      SPUSH   (HEADSP,TSP,TXSP,XSP)
*                                  Save system state specifiers
*      MOVD    OCBSCL,XPTR         Set up new code base
*      SETAC   OCICL,DESCR         Initialize offset
*      MOVD    PDLHED,PDLPTR       Set up new history list header
*      MOVD    NHEDCL,NAMICL       Set up new name list header
*      GETD    XPTR,OCBSCL,OCICL   Get object code descriptor
*      TESTF   XPTR,FNC,,EXPVC     Check for function
                                                             SPACE
EXPVJ2   LD    0,OCBSCL                  . 00330C 6800 A470
         STD   0,104(12)                 . 003310 600C 0068
         LD    0,OCICL                   . 003314 6800 9ED8
         STD   0,112(12)                 . 003318 600C 0070
         LD    0,PATBCL                  . 00331C 6800 A488
         STD   0,120(12)                 . 003320 600C 0078
         LD    0,PATICL                  . 003324 6800 9EE0
         STD   0,128(12)                 . 003328 600C 0080
         LD    0,WPTR                    . 00332C 6800 A400
         STD   0,136(12)                 . 003330 600C 0088
         LD    0,XCL                     . 003334 6800 A408
         STD   0,144(12)                 . 003338 600C 0090
         LD    0,YCL                     . 00333C 6800 A420
         STD   0,152(12)                 . 003340 600C 0098
         LD    0,TCL                     . 003344 6800 A3D8
         STD   0,160(12)                 . 003348 600C 00A0
         LA    12,64(12)                 . 00334C 41CC 0040
         C     12,@@STACKT               . 003350 59C0 A828
         BH    OVER                      . 003354 4720 9664
         LD    0,MAXLEN                  . 003358 6800 9EA8
         STD   0,104(12)                 . 00335C 600C 0068
         LD    0,FNVLCL                  . 003360 6800 9BC0
         STD   0,112(12)                 . 003364 600C 0070
         LD    0,PDLPTR                  . 003368 6800 9EF0
         STD   0,120(12)                 . 00336C 600C 0078
         LD    0,PDLHED                  . 003370 6800 9F48
         STD   0,128(12)                 . 003374 600C 0080
         LD    0,NAMICL                  . 003378 6800 9EB8
         STD   0,136(12)                 . 00337C 600C 0088
         LD    0,NHEDCL                  . 003380 6800 9EC0
         STD   0,144(12)                 . 003384 600C 0090
         LA    12,48(12)                 . 003388 41CC 0030
         C     12,@@STACKT               . 00338C 59C0 A828
         BH    OVER                      . 003390 4720 9664
         LM    1,4,HEADSP                . 003394 9814 A560
         STM   1,4,104(12)               . 003398 9014 C068
         LM    1,4,TSP                   . 00339C 9814 A5A0
         STM   1,4,120(12)               . 0033A0 9014 C078
         LM    1,4,TXSP                  . 0033A4 9814 A5B0
         STM   1,4,136(12)               . 0033A8 9014 C088
         LM    1,4,XSP                   . 0033AC 9814 A5D0
         STM   1,4,152(12)               . 0033B0 9014 C098
         LA    12,64(12)                 . 0033B4 41CC 0040
         C     12,@@STACKT               . 0033B8 59C0 A828
         BH    OVER                      . 0033BC 4720 9664
         LD    0,XPTR                    . 0033C0 6800 A410
         STD   0,OCBSCL                  . 0033C4 6000 A470
         ST    8,OCICL                   . 0033C8 5080 9ED8
         LD    0,PDLPTR                  . 0033CC 6800 9EF0
         STD   0,PDLHED                  . 0033D0 6000 9F48
         LD    0,NAMICL                  . 0033D4 6800 9EB8
         STD   0,NHEDCL                  . 0033D8 6000 9EC0
         L     2,OCBSCL                  . 0033DC 5820 A470
         LD    0,8(2)                    . 0033E0 6802 0008
         STD   0,XPTR                    . 0033E4 6000 A410
         TM    XPTR$4,X'04'              . 0033E8 9104 A414
         BO    EXPVC                     . 0033EC 4710 B246
                                                             SPACE
* EXPV11 AEQLC SCL,0,,EXPV6        Check procedure entry
*      AEQLC   INSW,0,,EXPV4       Check &INPUT
*      LOCAPV  ZPTR,INATL,XPTR,EXPV4
*                                  Look for input association
*      GETDC   ZPTR,ZPTR,DESCR     Get input association
*      RCALL   XPTR,PUTIN,(ZPTR,XPTR),(EXPV1,EXPV6)
*                                  Perform input
                                                             SPACE
EXPV11   C     0,SCL                     . 0033F0 5900 9EF8
         BE    EXPV6                     . 0033F4 4780 B172
         C     0,INSW                    . 0033F8 5900 9858
         BE    EXPV4                     . 0033FC 4780 B166
         L     15,INATL                  . 003400 58F0 A300
         L     5,4(15)                   . 003404 585F 0004
         LA    5,0(5,15)                 . 003408 4155 F000
         LR    4,8                       . 00340C 1848
         SR    5,4                       . 00340E 1B54
         AR    4,8                       . 003410 1A48
S4$03412 CLC   16(8,15),XPTR             . 003412 D507 F010 A410
         BE    S4$03424                  . 003418 4780 B12A
         BXLE  15,4,S4$03412             . 00341C 87F4 B118
         B     EXPV4                     . 003420 47F0 B166
S4$03424 LD    0,8(15)                   . 003424 680F 0008
         STD   0,ZPTR                    . 003428 6000 A440
         LA    14,S4$03454               . 00342C 41E0 B15A
         STM   11,14,104(12)             . 003430 90BE C068
         LR    13,12                     . 003434 18DC
         STD   0,128(12)                 . 003436 600C 0080
         LD    0,XPTR                    . 00343A 6800 A410
         STD   0,120(12)                 . 00343E 600C 0078
         LA    12,32(12)                 . 003442 41CC 0020
         C     12,@@STACKT               . 003446 59C0 A828
         BH    OVER                      . 00344A 4720 9664
         L     11,@@PUTIN                . 00344E 58B0 A920
         BR    11                        . 003452 07FB
S4$03454 STD   0,XPTR                    . 003454 6000 A410
         B     EXPV1                     . 003458 47F0 B188
         B     EXPV6                     . 00345C 47F0 B172
                                                             SPACE
* EXPV4 GETDC  XPTR,XPTR,DESCR     Get value
                                                             SPACE
EXPV4    L     1,XPTR                    . 003460 5810 A410
         LD    0,8(1)                    . 003464 6801 0008
         STD   0,XPTR                    . 003468 6000 A410
                                                             SPACE
* EXPV6 SETAC  SCL,2               Set up exit
*      BRANCH  EXPV7               Join processing
                                                             SPACE
EXPV6    LA    1,2                       . 00346C 4110 0002
         ST    1,SCL                     . 003470 5010 9EF8
         B     EXPV7                     . 003474 47F0 B192
                                                             SPACE
* EXPV9 POP    SCL                 Popoff switch
                                                             SPACE
EXPV9    LD    0,96(12)                  . 003478 680C 0060
         STD   0,SCL                     . 00347C 6000 9EF8
         SR    12,8                      . 003480 1BC8
                                                             SPACE
* EXPV1 SETAC  SCL,1               Set new exit switch
                                                             SPACE
EXPV1    LA    1,1                       . 003482 4110 0001
         ST    1,SCL                     . 003486 5010 9EF8
         NOPR  0                         . 00348A 0700
                                                             SPACE
* EXPV7 SPOP   (XSP,TXSP,TSP,HEADSP)
*                                  Restore system specifiers
*      POP     (NHEDCL,NAMICL,PDLHED,PDLPTR,LENFCL,MAXLEN)
*      POP     (TCL,YCL,XCL,WPTR,PATICL,PATBCL,OCICL,OCBSCL)
*                                  Restore system descriptors
*      SELBRA  SCL,(FAIL,RTXNAM,RTZPTR)
*                                  Select exit
                                                             SPACE
EXPV7    LM    1,4,88(12)                . 00348C 9814 C058
         STM   1,4,XSP                   . 003490 9014 A5D0
         LM    1,4,72(12)                . 003494 9814 C048
         STM   1,4,TXSP                  . 003498 9014 A5B0
         LM    1,4,56(12)                . 00349C 9814 C038
         STM   1,4,TSP                   . 0034A0 9014 A5A0
         LM    1,4,40(12)                . 0034A4 9814 C028
         STM   1,4,HEADSP                . 0034A8 9014 A560
         S     12,@@16M4                 . 0034AC 5BC0 A924
         LD    0,96(12)                  . 0034B0 680C 0060
         STD   0,NHEDCL                  . 0034B4 6000 9EC0
         LD    0,88(12)                  . 0034B8 680C 0058
         STD   0,NAMICL                  . 0034BC 6000 9EB8
         LD    0,80(12)                  . 0034C0 680C 0050
         STD   0,PDLHED                  . 0034C4 6000 9F48
         LD    0,72(12)                  . 0034C8 680C 0048
         STD   0,PDLPTR                  . 0034CC 6000 9EF0
         LD    0,64(12)                  . 0034D0 680C 0040
         STD   0,FNVLCL                  . 0034D4 6000 9BC0
         LD    0,56(12)                  . 0034D8 680C 0038
         STD   0,MAXLEN                  . 0034DC 6000 9EA8
         S     12,@@6XDESC               . 0034E0 5BC0 A928
         LD    0,96(12)                  . 0034E4 680C 0060
         STD   0,TCL                     . 0034E8 6000 A3D8
         LD    0,88(12)                  . 0034EC 680C 0058
         STD   0,YCL                     . 0034F0 6000 A420
         LD    0,80(12)                  . 0034F4 680C 0050
         STD   0,XCL                     . 0034F8 6000 A408
         LD    0,72(12)                  . 0034FC 680C 0048
         STD   0,WPTR                    . 003500 6000 A400
         LD    0,64(12)                  . 003504 680C 0040
         STD   0,PATICL                  . 003508 6000 9EE0
         LD    0,56(12)                  . 00350C 680C 0038
         STD   0,PATBCL                  . 003510 6000 A488
         LD    0,48(12)                  . 003514 680C 0030
         STD   0,OCICL                   . 003518 6000 9ED8
         LD    0,40(12)                  . 00351C 680C 0028
         STD   0,OCBSCL                  . 003520 6000 A470
         S     12,@@4M16                 . 003524 5BC0 A92C
         L     1,SCL                     . 003528 5810 9EF8
         SLA   1,2                       . 00352C 8B10 0002
S4$03530 B     S4$03530(1)               . 003530 47F1 B236
         B     FAIL                      . 003534 47F0 9010
         B     RTXNAM                    . 003538 47F0 9038
         B     RTZPTR                    . 00353C 47F0 9074
                                                             SPACE
* EXPVC PUSH   SCL                 Save entrance indicator
*      RCALL   XPTR,INVOKE,XPTR,(EXPV9,EXPV5,)
*                                  Evaluate function
*      POP     SCL                 Restore entrance indicator
*      AEQLC   SCL,0,EXPV6         Check entry indicator
*      SETAC   SCL,3               Set exit switch
*      MOVD    ZPTR,XPTR           Set up value
*      BRANCH  EXPV7               Join end processing
                                                             SPACE
EXPVC    LD    0,SCL                     . 003540 6800 9EF8
         STD   0,104(12)                 . 003544 600C 0068
         AR    12,8                      . 003548 1AC8
         C     12,@@STACKT               . 00354A 59C0 A828
         BH    OVER                      . 00354E 4720 9664
         LA    14,S4$03576               . 003552 41E0 B27C
         STM   11,14,104(12)             . 003556 90BE C068
         LR    13,12                     . 00355A 18DC
         LD    0,XPTR                    . 00355C 6800 A410
         STD   0,120(12)                 . 003560 600C 0078
         LA    12,24(12)                 . 003564 41CC 0018
         C     12,@@STACKT               . 003568 59C0 A828
         BH    OVER                      . 00356C 4720 9664
         L     11,@@INVOKE               . 003570 58B0 A91C
         BR    11                        . 003574 07FB
S4$03576 STD   0,XPTR                    . 003576 6000 A410
         B     EXPV9                     . 00357A 47F0 B17E
         B     EXPV5                     . 00357E 47F0 B2B2
         B     S4$03586                  . 003582 47F0 B28C
S4$03586 LD    0,96(12)                  . 003586 680C 0060
         STD   0,SCL                     . 00358A 6000 9EF8
         SR    12,8                      . 00358E 1BC8
         C     0,SCL                     . 003590 5900 9EF8
         BNE   EXPV6                     . 003594 4770 B172
         LA    1,3                       . 003598 4110 0003
         ST    1,SCL                     . 00359C 5010 9EF8
         LD    0,XPTR                    . 0035A0 6800 A410
         STD   0,ZPTR                    . 0035A4 6000 A440
         B     EXPV7                     . 0035A8 47F0 B192
                                                             SPACE
* EXPV5 POP    SCL                 Restore entry indicator
*      BRANCH  EXPV11              Join processing with name
                                                             SPACE
EXPV5    LD    0,96(12)                  . 0035AC 680C 0060
         STD   0,SCL                     . 0035B0 6000 9EF8
         SR    12,8                      . 0035B4 1BC8
         B     EXPV11                    . 0035B6 47F0 B0F6
                                                             SPACE
* EXPEVL PROC  EXPVAL              Procedure to get expression value
*      SETAC   SCL,0               Set entry indicator
*      BRANCH  EXPVJN              Join processing
                                                             SPACE
EXPEVL   L     11,@@EXPVAL               . 0035BA 58B0 A930
         ST    0,SCL                     . 0035BE 5000 9EF8
         B     EXPVJN                    . 0035C2 47F0 B008
                                                             SPACE
* EVAL PROC    EXPVAL              EVAL(X)
*      RCALL   XPTR,ARGVAL,,FAIL   Get argument
*      VEQLC   XPTR,E,,EVAL1       Is it EXPRESSION?
*      VEQLC   XPTR,I,,RTXPTR      INTEGER is idempotent
*      VEQLC   XPTR,R,,RTXPTR      REAL is idempotent
*      VEQLC   XPTR,S,INTR1        Is it STRING?
*      LOCSP   XSP,XPTR            Get specifier
*      LEQLC   XSP,0,,RTXPTR                                    E3.1.4
*      SPCINT  XPTR,XSP,,RTXPTR    Convert to INTEGER
*      SPREAL  XPTR,XSP,,RTXPTR    Convert to REAL
*      MOVD    ZPTR,XPTR           Set up to convert to EXPRESSION
*      RCALL   XPTR,CONVE,,(FAIL,INTR10)
*                                  Convert to EXPRESSION
                                                             SPACE
EVAL     L     11,@@EXPVAL               . 0035C6 58B0 A930
         LA    14,S4$035E6               . 0035CA 41E0 B2EC
         STM   11,14,104(12)             . 0035CE 90BE C068
         LR    13,12                     . 0035D2 18DC
         LA    12,16(12)                 . 0035D4 41CC 0010
         C     12,@@STACKT               . 0035D8 59C0 A828
         BH    OVER                      . 0035DC 4720 9664
         L     11,@@ARGVAL               . 0035E0 58B0 A914
         BR    11                        . 0035E4 07FB
S4$035E6 STD   0,XPTR                    . 0035E6 6000 A410
         B     FAIL                      . 0035EA 47F0 9010
         CLC   XPTR$5(3),@@E             . 0035EE D502 A415 AA81
         BE    EVAL1                     . 0035F4 4780 B3A2
         CLC   XPTR$5(3),@@I             . 0035F8 D502 A415 AA84
         BE    RTXPTR                    . 0035FE 4780 9048
         CLC   XPTR$5(3),@@R             . 003602 D502 A415 AA75
         BE    RTXPTR                    . 003608 4780 9048
         CLC   XPTR$5(3),@@S             . 00360C D502 A415 AA7B
         BNE   INTR1                     . 003612 4770 95FC
         LM    3,4,XPTR                  . 003616 9834 A410
         CR    0,3                       . 00361A 1903
         BNE   S4$03628                  . 00361C 4770 B32E
         BE    RTXPTR                    . 003620 4780 9048
         B     S4$03638                  . 003624 47F0 B33E
S4$03628 L     1,4(3)                    . 003628 5813 0004
         LA    1,0(1)                    . 00362C 4111 0000
         LA    2,32                      . 003630 4120 0020
         STM   1,4,XSP                   . 003634 9014 A5D0
S4$03638 L     15,@@DECBIN               . 003638 58F0 A8EC
         LA    1,XPTR                    . 00363C 4110 A410
         LA    2,XSP                     . 003640 4120 A5D0
         BALR  14,15                          CALL                     *
                                         . 003644 05EF
         B     S4$0364E                  . 003646 47F0 B354
         B     RTXPTR                    . 00364A 47F0 9048
S4$0364E L     15,@@SPREAL               . 00364E 58F0 A8F0
         LA    1,XPTR                    . 003652 4110 A410
         LM    2,4,XSP                   . 003656 9824 A5D0
         BALR  14,15                          CALL                     *
                                         . 00365A 05EF
         B     S4$0366C                  . 00365C 47F0 B372
         LA    2,7                       . 003660 4120 0007
         ST    2,XPTR$4                  . 003664 5020 A414
         B     RTXPTR                    . 003668 47F0 9048
S4$0366C LD    0,XPTR                    . 00366C 6800 A410
         STD   0,ZPTR                    . 003670 6000 A440
         LA    14,S4$03690               . 003674 41E0 B396
         STM   11,14,104(12)             . 003678 90BE C068
         LR    13,12                     . 00367C 18DC
         LA    12,16(12)                 . 00367E 41CC 0010
         C     12,@@STACKT               . 003682 59C0 A828
         BH    OVER                      . 003686 4720 9664
         L     11,@@CONVE                . 00368A 58B0 A934
         BR    11                        . 00368E 07FB
S4$03690 STD   0,XPTR                    . 003690 6000 A410
         B     FAIL                      . 003694 47F0 9010
         B     S4$010                    . 003698 47F0 95AC
                                                             SPACE
* EVAL1 SETAC  SCL,0               Set up entry indicator
*      BRANCH  EXPVJ2              Join processing
EVAL1    ST    0,SCL                     . 00369C 5000 9EF8
         B     EXPVJ2                    . 0036A0 47F0 B012
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Evaluation of Integer Argument
*
                                                             SPACE
* INTVAL PROC  ,                   Integer argument procedure
*      INCRA   OCICL,DESCR         Increment offset
*      GETD    XPTR,OCBSCL,OCICL   Get object code descriptor
*      TESTF   XPTR,FNC,,INTVC     Check for function
                                                             SPACE
         USING INTVAL,11                 .
INTVAL   L     1,OCICL                   . 0036A4 5810 9ED8
         AR    1,8                       . 0036A8 1A18
         ST    1,OCICL                   . 0036AA 5010 9ED8
         L     2,OCBSCL                  . 0036AE 5820 A470
         LD    0,0(1,2)                  . 0036B2 6801 2000
         STD   0,XPTR                    . 0036B6 6000 A410
         TM    XPTR$4,X'04'              . 0036BA 9104 A414
         BO    INTVC                     . 0036BE 4710 B0DE
                                                             SPACE
* INTV1 AEQLC  INSW,0,,INTV3       Check &INPUT
*      LOCAPV  ZPTR,INATL,XPTR,INTV3
*                                  Look for input association
*      GETDC   ZPTR,ZPTR,DESCR     Get association
*      RCALL   XPTR,PUTIN,(ZPTR,XPTR),FAIL
*                                  Perform input
                                                             SPACE
INTV1    C     0,INSW                    . 0036C2 5900 9858
         BE    INTV3                     . 0036C6 4780 B0BA
         L     15,INATL                  . 0036CA 58F0 A300
         L     5,4(15)                   . 0036CE 585F 0004
         LA    5,0(5,15)                 . 0036D2 4155 F000
         LR    4,8                       . 0036D6 1848
         SR    5,4                       . 0036D8 1B54
         AR    4,8                       . 0036DA 1A48
S4$036DC CLC   16(8,15),XPTR             . 0036DC D507 F010 A410
         BE    S4$036EE                  . 0036E2 4780 B04A
         BXLE  15,4,S4$036DC             . 0036E6 87F4 B038
         B     INTV3                     . 0036EA 47F0 B0BA
S4$036EE LD    0,8(15)                   . 0036EE 680F 0008
         STD   0,ZPTR                    . 0036F2 6000 A440
         LA    14,S4$0371E               . 0036F6 41E0 B07A
         STM   11,14,104(12)             . 0036FA 90BE C068
         LR    13,12                     . 0036FE 18DC
         STD   0,128(12)                 . 003700 600C 0080
         LD    0,XPTR                    . 003704 6800 A410
         STD   0,120(12)                 . 003708 600C 0078
         LA    12,32(12)                 . 00370C 41CC 0020
         C     12,@@STACKT               . 003710 59C0 A828
         BH    OVER                      . 003714 4720 9664
         L     11,@@PUTIN                . 003718 58B0 A920
         BR    11                        . 00371C 07FB
S4$0371E STD   0,XPTR                    . 00371E 6000 A410
         B     FAIL                      . 003722 47F0 9010
S4$03726 LM    3,4,XPTR                  . 003726 9834 A410
         CR    0,3                       . 00372A 1903
         BNE   INTV                      . 00372C 4770 B094
         ST    0,XSP                     . 003730 5000 A5D0
         B     S4$03748                  . 003734 47F0 B0A4
                                                             SPACE
* INTV LOCSP   XSP,XPTR            Get specifier for string
*      SPCINT  XPTR,XSP,INTR1,RTXNAM
*                                  Convert to integer
                                                             SPACE
INTV     L     1,4(3)                    . 003738 5813 0004
         LA    1,0(1)                    . 00373C 4111 0000
         LA    2,32                      . 003740 4120 0020
         STM   1,4,XSP                   . 003744 9014 A5D0
S4$03748 L     15,@@DECBIN               . 003748 58F0 A8EC
         LA    1,XPTR                    . 00374C 4110 A410
         LA    2,XSP                     . 003750 4120 A5D0
         BALR  14,15                          CALL                     *
                                         . 003754 05EF
         B     INTR1                     . 003756 47F0 95FC
         B     RTXNAM                    . 00375A 47F0 9038
                                                             SPACE
* INTV3 GETDC  XPTR,XPTR,DESCR     Get value
                                                             SPACE
INTV3    L     1,XPTR                    . 00375E 5810 A410
         LD    0,8(1)                    . 003762 6801 0008
         STD   0,XPTR                    . 003766 6000 A410
                                                             SPACE
* INTV2 VEQLC  XPTR,I,,RTXNAM      INTEGER desired
*      VEQLC   XPTR,S,INTR1,INTV   STRING must be converted
                                                             SPACE
INTV2    CLC   XPTR$5(3),@@I             . 00376A D502 A415 AA84
         BE    RTXNAM                    . 003770 4780 9038
         CLC   XPTR$5(3),@@S             . 003774 D502 A415 AA7B
         BNE   INTR1                     . 00377A 4770 95FC
         BE    S4$03726                  . 00377E 4780 B082
                                                             SPACE
* INTVC RCALL  XPTR,INVOKE,(XPTR),(FAIL,INTV1,INTV2)
INTVC    LA    14,S4$037A6               . 003782 41E0 B102
         STM   11,14,104(12)             . 003786 90BE C068
         LR    13,12                     . 00378A 18DC
         LD    0,XPTR                    . 00378C 6800 A410
         STD   0,120(12)                 . 003790 600C 0078
         LA    12,24(12)                 . 003794 41CC 0018
         C     12,@@STACKT               . 003798 59C0 A828
         BH    OVER                      . 00379C 4720 9664
         L     11,@@INVOKE               . 0037A0 58B0 A91C
         BR    11                        . 0037A4 07FB
S4$037A6 STD   0,XPTR                    . 0037A6 6000 A410
         B     FAIL                      . 0037AA 47F0 9010
         B     INTV1                     . 0037AE 47F0 B01E
         B     INTV2                     . 0037B2 47F0 B0C6
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Evaluation of Argument as Pattern
*
                                                             SPACE
* PATVAL PROC  ,                   Evaluate argument as pattern
*      INCRA   OCICL,DESCR         Increment offset
*      GETD    XPTR,OCBSCL,OCICL   Get object code descriptor
*      TESTF   XPTR,FNC,,PATVC     Check for function descriptor
                                                             SPACE
         USING PATVAL,11                 .
PATVAL   L     1,OCICL                   . 0037B6 5810 9ED8
         AR    1,8                       . 0037BA 1A18
         ST    1,OCICL                   . 0037BC 5010 9ED8
         L     2,OCBSCL                  . 0037C0 5820 A470
         LD    0,0(1,2)                  . 0037C4 6801 2000
         STD   0,XPTR                    . 0037C8 6000 A410
         TM    XPTR$4,X'04'              . 0037CC 9104 A414
         BO    PATVC                     . 0037D0 4710 B086
                                                             SPACE
* PATV1 AEQLC  INSW,0,,PATV2       Check &INPUT
*      LOCAPV  ZPTR,INATL,XPTR,PATV2
*                                  Look for input association
*      GETDC   ZPTR,ZPTR,DESCR     Get association
*      RCALL   XPTR,PUTIN,(ZPTR,XPTR),(FAIL,RTXNAM)
*                                  Perform input
                                                             SPACE
PATV1    C     0,INSW                    . 0037D4 5900 9858
         BE    PATV2                     . 0037D8 4780 B0BA
         L     15,INATL                  . 0037DC 58F0 A300
         L     5,4(15)                   . 0037E0 585F 0004
         LA    5,0(5,15)                 . 0037E4 4155 F000
         LR    4,8                       . 0037E8 1848
         SR    5,4                       . 0037EA 1B54
         AR    4,8                       . 0037EC 1A48
S4$037EE CLC   16(8,15),XPTR             . 0037EE D507 F010 A410
         BE    S4$03800                  . 0037F4 4780 B04A
         BXLE  15,4,S4$037EE             . 0037F8 87F4 B038
         B     PATV2                     . 0037FC 47F0 B0BA
S4$03800 LD    0,8(15)                   . 003800 680F 0008
         STD   0,ZPTR                    . 003804 6000 A440
         LA    14,S4$03830               . 003808 41E0 B07A
         STM   11,14,104(12)             . 00380C 90BE C068
         LR    13,12                     . 003810 18DC
         STD   0,128(12)                 . 003812 600C 0080
         LD    0,XPTR                    . 003816 6800 A410
         STD   0,120(12)                 . 00381A 600C 0078
         LA    12,32(12)                 . 00381E 41CC 0020
         C     12,@@STACKT               . 003822 59C0 A828
         BH    OVER                      . 003826 4720 9664
         L     11,@@PUTIN                . 00382A 58B0 A920
         BR    11                        . 00382E 07FB
S4$03830 STD   0,XPTR                    . 003830 6000 A410
         B     FAIL                      . 003834 47F0 9010
         B     RTXNAM                    . 003838 47F0 9038
                                                             SPACE
* PATVC RCALL  XPTR,INVOKE,(XPTR),(FAIL,PATV1,PATV3)
*                                  Evaluate argument
                                                             SPACE
PATVC    LA    14,S4$03860               . 00383C 41E0 B0AA
         STM   11,14,104(12)             . 003840 90BE C068
         LR    13,12                     . 003844 18DC
         LD    0,XPTR                    . 003846 6800 A410
         STD   0,120(12)                 . 00384A 600C 0078
         LA    12,24(12)                 . 00384E 41CC 0018
         C     12,@@STACKT               . 003852 59C0 A828
         BH    OVER                      . 003856 4720 9664
         L     11,@@INVOKE               . 00385A 58B0 A91C
         BR    11                        . 00385E 07FB
S4$03860 STD   0,XPTR                    . 003860 6000 A410
         B     FAIL                      . 003864 47F0 9010
         B     PATV1                     . 003868 47F0 B01E
         B     PATV3                     . 00386C 47F0 B0C6
                                                             SPACE
* PATV2 GETDC  XPTR,XPTR,DESCR     Get value
                                                             SPACE
PATV2    L     1,XPTR                    . 003870 5810 A410
         LD    0,8(1)                    . 003874 6801 0008
         STD   0,XPTR                    . 003878 6000 A410
                                                             SPACE
* PATV3 VEQLC  XPTR,P,,RTXNAM      Is it PATTERN?
*      VEQLC   XPTR,S,,RTXNAM      Is it STRING?
*      VEQLC   XPTR,I,,GENVIX      Is it INTEGER?
*      VEQLC   XPTR,R,,PATVR       Is it REAL?
*      VEQLC   XPTR,E,INTR1        Is it EXPRESSION?
*      RCALL   TPTR,BLOCK,STARSZ   Allocate block for pattern
*      MOVBLK  TPTR,STRPAT,STARSZ  Copy pattern for expression
*      PUTDC   TPTR,4*DESCR,XPTR   Insert expression
*      MOVD    XPTR,TPTR           Set up value
*      BRANCH  RTXNAM              Return
                                                             SPACE
PATV3    CLC   XPTR$5(3),@@P             . 00387C D502 A415 AA87
         BE    RTXNAM                    . 003882 4780 9038
         CLC   XPTR$5(3),@@S             . 003886 D502 A415 AA7B
         BE    RTXNAM                    . 00388C 4780 9038
         CLC   XPTR$5(3),@@I             . 003890 D502 A415 AA84
         BE    GENVIX                    . 003896 4780 90FE
         CLC   XPTR$5(3),@@R             . 00389A D502 A415 AA75
         BE    PATVR                     . 0038A0 4780 B14E
         CLC   XPTR$5(3),@@E             . 0038A4 D502 A415 AA81
         BNE   INTR1                     . 0038AA 4770 95FC
         LA    14,S4$038D2               . 0038AE 41E0 B11C
         STM   11,14,104(12)             . 0038B2 90BE C068
         LR    13,12                     . 0038B6 18DC
         LD    0,STARSZ                  . 0038B8 6800 9C88
         STD   0,120(12)                 . 0038BC 600C 0078
         LA    12,24(12)                 . 0038C0 41CC 0018
         C     12,@@STACKT               . 0038C4 59C0 A828
         BH    OVER                      . 0038C8 4720 9664
         L     11,@@BLOCK                . 0038CC 58B0 A82C
         BR    11                        . 0038D0 07FB
S4$038D2 STD   0,TPTR                    . 0038D2 6000 A3D0
         L     6,TPTR                    . 0038D6 5860 A3D0
         L     4,STRPAT                  . 0038DA 5840 9CC8
         AR    4,8                       . 0038DE 1A48
         AR    6,8                       . 0038E0 1A68
         L     3,STARSZ                  . 0038E2 5830 9C88
         L     15,@@MOVTST               . 0038E6 58F0 A864
         BALR  14,15                          CALL                     *
                                         . 0038EA 05EF
         L     1,TPTR                    . 0038EC 5810 A3D0
         LD    0,XPTR                    . 0038F0 6800 A410
         STD   0,32(1)                   . 0038F4 6001 0020
         LD    0,TPTR                    . 0038F8 6800 A3D0
         STD   0,XPTR                    . 0038FC 6000 A410
         B     RTXNAM                    . 003900 47F0 9038
                                                             SPACE
* PATVR REALST XSP,XPTR            Convert REAL to STRING
*      RCALL   XPTR,GENVAR,XSPPTR,RTXNAM
*                                  Generate variable
PATVR    L     15,@@REALST               . 003904 58F0 A86C
         LA    5,XSP                     . 003908 4150 A5D0
         LE    2,XPTR                    . 00390C 7820 A410
         BALR  14,15                          CALL                     *
                                         . 003910 05EF
         LA    14,S4$03936               . 003912 41E0 B180
         STM   11,14,104(12)             . 003916 90BE C068
         LR    13,12                     . 00391A 18DC
         LD    0,XSPPTR                  . 00391C 6800 9F60
         STD   0,120(12)                 . 003920 600C 0078
         LA    12,24(12)                 . 003924 41CC 0018
         C     12,@@STACKT               . 003928 59C0 A828
         BH    OVER                      . 00392C 4720 9664
         L     11,@@GENVAR               . 003930 58B0 A830
         BR    11                        . 003934 07FB
S4$03936 STD   0,XPTR                    . 003936 6000 A410
         B     RTXNAM                    . 00393A 47F0 9038
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Evaluation of Argument as String
*
                                                             SPACE
* VARVAL PROC  ,                   Evaluate argument as string
*      INCRA   OCICL,DESCR         Increment offset
*      GETD    XPTR,OCBSCL,OCICL   Get object code descriptor
*      TESTF   XPTR,FNC,,VARVC     Check for function
                                                             SPACE
         USING VARVAL,11                 .
VARVAL   L     1,OCICL                   . 00393E 5810 9ED8
         AR    1,8                       . 003942 1A18
         ST    1,OCICL                   . 003944 5010 9ED8
         L     2,OCBSCL                  . 003948 5820 A470
         LD    0,0(1,2)                  . 00394C 6801 2000
         STD   0,XPTR                    . 003950 6000 A410
         TM    XPTR$4,X'04'              . 003954 9104 A414
         BO    VARVC                     . 003958 4710 B0AA
                                                             SPACE
* VARV1 AEQLC  INSW,0,,VARV4       Check &INPUT
*      LOCAPV  ZPTR,INATL,XPTR,VARV4
*                                  Look for input association
*      GETDC   ZPTR,ZPTR,DESCR     Get input association
*      RCALL   XPTR,PUTIN,(ZPTR,XPTR),(FAIL,RTXNAM)
*                                  Perform input
                                                             SPACE
VARV1    C     0,INSW                    . 00395C 5900 9858
         BE    VARV4                     . 003960 4780 B086
         L     15,INATL                  . 003964 58F0 A300
         L     5,4(15)                   . 003968 585F 0004
         LA    5,0(5,15)                 . 00396C 4155 F000
         LR    4,8                       . 003970 1848
         SR    5,4                       . 003972 1B54
         AR    4,8                       . 003974 1A48
S4$03976 CLC   16(8,15),XPTR             . 003976 D507 F010 A410
         BE    S4$03988                  . 00397C 4780 B04A
         BXLE  15,4,S4$03976             . 003980 87F4 B038
         B     VARV4                     . 003984 47F0 B086
S4$03988 LD    0,8(15)                   . 003988 680F 0008
         STD   0,ZPTR                    . 00398C 6000 A440
         LA    14,S4$039B8               . 003990 41E0 B07A
         STM   11,14,104(12)             . 003994 90BE C068
         LR    13,12                     . 003998 18DC
         STD   0,128(12)                 . 00399A 600C 0080
         LD    0,XPTR                    . 00399E 6800 A410
         STD   0,120(12)                 . 0039A2 600C 0078
         LA    12,32(12)                 . 0039A6 41CC 0020
         C     12,@@STACKT               . 0039AA 59C0 A828
         BH    OVER                      . 0039AE 4720 9664
         L     11,@@PUTIN                . 0039B2 58B0 A920
         BR    11                        . 0039B6 07FB
S4$039B8 STD   0,XPTR                    . 0039B8 6000 A410
         B     FAIL                      . 0039BC 47F0 9010
         B     RTXNAM                    . 0039C0 47F0 9038
                                                             SPACE
* VARV4 GETDC  XPTR,XPTR,DESCR     Get value
                                                             SPACE
VARV4    L     1,XPTR                    . 0039C4 5810 A410
         LD    0,8(1)                    . 0039C8 6801 0008
         STD   0,XPTR                    . 0039CC 6000 A410
                                                             SPACE
* VARV2 VEQLC  XPTR,S,,RTXNAM      Is it STRING?
*      VEQLC   XPTR,I,INTR1,GENVIX Convert INTEGER to STRING
                                                             SPACE
VARV2    CLC   XPTR$5(3),@@S             . 0039D0 D502 A415 AA7B
         BE    RTXNAM                    . 0039D6 4780 9038
         CLC   XPTR$5(3),@@I             . 0039DA D502 A415 AA84
         BNE   INTR1                     . 0039E0 4770 95FC
         BE    GENVIX                    . 0039E4 4780 90FE
                                                             SPACE
* VARVC RCALL  XPTR,INVOKE,(XPTR),(FAIL,VARV1,VARV2)
*                                  Evaluate function
VARVC    LA    14,S4$03A0C               . 0039E8 41E0 B0CE
         STM   11,14,104(12)             . 0039EC 90BE C068
         LR    13,12                     . 0039F0 18DC
         LD    0,XPTR                    . 0039F2 6800 A410
         STD   0,120(12)                 . 0039F6 600C 0078
         LA    12,24(12)                 . 0039FA 41CC 0018
         C     12,@@STACKT               . 0039FE 59C0 A828
         BH    OVER                      . 003A02 4720 9664
         L     11,@@INVOKE               . 003A06 58B0 A91C
         BR    11                        . 003A0A 07FB
S4$03A0C STD   0,XPTR                    . 003A0C 6000 A410
         B     FAIL                      . 003A10 47F0 9010
         B     VARV1                     . 003A14 47F0 B01E
         B     VARV2                     . 003A18 47F0 B092
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Evaluation of Argument Pair
*
                                                             SPACE
* XYARGS PROC  ,                   Procedure to evaluate argument pair
*      SETAC   SCL,0               Note first argument
                                                             SPACE
         USING XYARGS,11                 .
XYARGS   ST    0,SCL                     . 003A1C 5000 9EF8
                                                             SPACE
* XYN  INCRA   OCICL,DESCR         Increment offset
*      GETD    YPTR,OCBSCL,OCICL   Get object code descriptor
*      TESTF   YPTR,FNC,,XYC       Check for function
                                                             SPACE
XYN      L     1,OCICL                   . 003A20 5810 9ED8
         AR    1,8                       . 003A24 1A18
         ST    1,OCICL                   . 003A26 5010 9ED8
         L     2,OCBSCL                  . 003A2A 5820 A470
         LD    0,0(1,2)                  . 003A2E 6801 2000
         STD   0,YPTR                    . 003A32 6000 A428
         TM    YPTR$4,X'04'              . 003A36 9104 A42C
         BO    XYC                       . 003A3A 4710 B0B2
                                                             SPACE
* XY1  AEQLC   INSW,0,,XY2         Check &INPUT
*      LOCAPV  ZPTR,INATL,YPTR,XY2 Look for input association
*      GETDC   ZPTR,ZPTR,DESCR     Get input association
*      RCALL   YPTR,PUTIN,(ZPTR,YPTR),FAIL
*                                  Perform input
                                                             SPACE
XY1      C     0,INSW                    . 003A3E 5900 9858
         BE    XY2                       . 003A42 4780 B0A2
         L     15,INATL                  . 003A46 58F0 A300
         L     5,4(15)                   . 003A4A 585F 0004
         LA    5,0(5,15)                 . 003A4E 4155 F000
         LR    4,8                       . 003A52 1848
         SR    5,4                       . 003A54 1B54
         AR    4,8                       . 003A56 1A48
S4$03A58 CLC   16(8,15),YPTR             . 003A58 D507 F010 A428
         BE    S4$03A6A                  . 003A5E 4780 B04E
         BXLE  15,4,S4$03A58             . 003A62 87F4 B03C
         B     XY2                       . 003A66 47F0 B0A2
S4$03A6A LD    0,8(15)                   . 003A6A 680F 0008
         STD   0,ZPTR                    . 003A6E 6000 A440
         LA    14,S4$03A9A               . 003A72 41E0 B07E
         STM   11,14,104(12)             . 003A76 90BE C068
         LR    13,12                     . 003A7A 18DC
         STD   0,128(12)                 . 003A7C 600C 0080
         LD    0,YPTR                    . 003A80 6800 A428
         STD   0,120(12)                 . 003A84 600C 0078
         LA    12,32(12)                 . 003A88 41CC 0020
         C     12,@@STACKT               . 003A8C 59C0 A828
         BH    OVER                      . 003A90 4720 9664
         L     11,@@PUTIN                . 003A94 58B0 A920
         BR    11                        . 003A98 07FB
S4$03A9A STD   0,YPTR                    . 003A9A 6000 A428
         B     FAIL                      . 003A9E 47F0 9010
                                                             SPACE
* XY3  AEQLC   SCL,0,RTN2          Check for completion
*      SETAC   SCL,1               Note seconf argument
*      MOVD    XPTR,YPTR           Set up first argument
*      BRANCH  XYN                 Go around again
                                                             SPACE
XY3      C     0,SCL                     . 003AA2 5900 9EF8
         BNE   RTN2                      . 003AA6 4770 9028
         LA    1,1                       . 003AAA 4110 0001
         ST    1,SCL                     . 003AAE 5010 9EF8
         LD    0,YPTR                    . 003AB2 6800 A428
         STD   0,XPTR                    . 003AB6 6000 A410
         B     XYN                       . 003ABA 47F0 B004
                                                             SPACE
* XY2  GETDC   YPTR,YPTR,DESCR     Get value
*      BRANCH  XY3                 Continue
                                                             SPACE
XY2      L     1,YPTR                    . 003ABE 5810 A428
         LD    0,8(1)                    . 003AC2 6801 0008
         STD   0,YPTR                    . 003AC6 6000 A428
         B     XY3                       . 003ACA 47F0 B086
                                                             SPACE
* XYC  PUSH    (SCL,XPTR)          Save indicator and argument
*      RCALL   YPTR,INVOKE,(YPTR),(FAIL,XY4)
*                                  Evaluate function
*      POP     (XPTR,SCL)          Restore indicator and argument
*      BRANCH  XY3                 Join processing
                                                             SPACE
XYC      LD    0,SCL                     . 003ACE 6800 9EF8
         STD   0,104(12)                 . 003AD2 600C 0068
         LD    0,XPTR                    . 003AD6 6800 A410
         STD   0,112(12)                 . 003ADA 600C 0070
         LA    12,16(12)                 . 003ADE 41CC 0010
         C     12,@@STACKT               . 003AE2 59C0 A828
         BH    OVER                      . 003AE6 4720 9664
         LA    14,S4$03B0E               . 003AEA 41E0 B0F2
         STM   11,14,104(12)             . 003AEE 90BE C068
         LR    13,12                     . 003AF2 18DC
         LD    0,YPTR                    . 003AF4 6800 A428
         STD   0,120(12)                 . 003AF8 600C 0078
         LA    12,24(12)                 . 003AFC 41CC 0018
         C     12,@@STACKT               . 003B00 59C0 A828
         BH    OVER                      . 003B04 4720 9664
         L     11,@@INVOKE               . 003B08 58B0 A91C
         BR    11                        . 003B0C 07FB
S4$03B0E STD   0,YPTR                    . 003B0E 6000 A428
         B     FAIL                      . 003B12 47F0 9010
         B     XY4                       . 003B16 47F0 B116
         LD    0,96(12)                  . 003B1A 680C 0060
         STD   0,XPTR                    . 003B1E 6000 A410
         LD    0,88(12)                  . 003B22 680C 0058
         STD   0,SCL                     . 003B26 6000 9EF8
         SR    12,8                      . 003B2A 1BC8
         SR    12,8                      . 003B2C 1BC8
         B     XY3                       . 003B2E 47F0 B086
                                                             SPACE
* XY4  POP     (XPTR,SCL)          Restore indicator and argument
*      BRANCH  XY1                 Join processing
XY4      LD    0,96(12)                  . 003B32 680C 0060
         STD   0,XPTR                    . 003B36 6000 A410
         LD    0,88(12)                  . 003B3A 680C 0058
         STD   0,SCL                     . 003B3E 6000 9EF8
         SR    12,8                      . 003B42 1BC8
         SR    12,8                      . 003B44 1BC8
         B     XY1                       . 003B46 47F0 B022
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Arithmetic Operations, Predicates, and Functions'
* ADD  PROC    ,                   X + Y
*      SETAC   SCL,1
*      BRANCH  ARITH
                                                             SPACE
         USING ADD,11                    .
ADD      LA    15,1                      . 003B4A 41F0 0001
         B     ARITH                     . 003B4E 47F0 B088
                                                             SPACE
* DIV  PROC    ADD                 X / Y
*      SETAC   SCL,2
*      BRANCH  ARITH
                                                             SPACE
DIV      L     11,@@ADD                  . 003B52 58B0 A938
         LA    15,2                      . 003B56 41F0 0002
         B     ARITH                     . 003B5A 47F0 B088
                                                             SPACE
* EXP  PROC    ADD                 X ** Y and X ^ Y
*      SETAC   SCL,3
*      BRANCH  ARITH
                                                             SPACE
EXP      L     11,@@ADD                  . 003B5E 58B0 A938
         LA    15,3                      . 003B62 41F0 0003
         B     ARITH                     . 003B66 47F0 B088
                                                             SPACE
* MPY  PROC    ADD                 X * Y
*      SETAC   SCL,4
*      BRANCH  ARITH
                                                             SPACE
MPY      L     11,@@ADD                  . 003B6A 58B0 A938
         LA    15,4                      . 003B6E 41F0 0004
         B     ARITH                     . 003B72 47F0 B088
                                                             SPACE
* SUB  PROC    ADD                 X - Y
*      SETAC   SCL,5
*      BRANCH  ARITH
                                                             SPACE
SUB      L     11,@@ADD                  . 003B76 58B0 A938
         LA    15,5                      . 003B7A 41F0 0005
         B     ARITH                     . 003B7E 47F0 B088
                                                             SPACE
* EQ   PROC    ADD                 EQ(X,Y)
*      SETAC   SCL,6
*      BRANCH  ARITH
                                                             SPACE
EQ       L     11,@@ADD                  . 003B82 58B0 A938
         LA    15,6                      . 003B86 41F0 0006
         B     ARITH                     . 003B8A 47F0 B088
                                                             SPACE
* GE   PROC    ADD                 GE(X,Y)
*      SETAC   SCL,7
*      BRANCH  ARITH
                                                             SPACE
GE       L     11,@@ADD                  . 003B8E 58B0 A938
         LA    15,7                      . 003B92 41F0 0007
         B     ARITH                     . 003B96 47F0 B088
                                                             SPACE
* GT   PROC    ADD                 GT(X,Y)
*      SETAC   SCL,8
*      BRANCH  ARITH
                                                             SPACE
GT       L     11,@@ADD                  . 003B9A 58B0 A938
         LA    15,8                      . 003B9E 41F0 0008
         B     ARITH                     . 003BA2 47F0 B088
                                                             SPACE
* LE   PROC    ADD                 LE(X,Y)
*      SETAC   SCL,9
*      BRANCH  ARITH
                                                             SPACE
LE       L     11,@@ADD                  . 003BA6 58B0 A938
         LA    15,9                      . 003BAA 41F0 0009
         B     ARITH                     . 003BAE 47F0 B088
                                                             SPACE
* LT   PROC    ADD                 LT(X,Y)
*      SETAC   SCL,10
*      BRANCH  ARITH
                                                             SPACE
LT       L     11,@@ADD                  . 003BB2 58B0 A938
         LA    15,10                     . 003BB6 41F0 000A
         B     ARITH                     . 003BBA 47F0 B088
                                                             SPACE
* NE   PROC    ADD                 NE(X,Y)
*      SETAC   SCL,11
*      BRANCH  ARITH
                                                             SPACE
NE       L     11,@@ADD                  . 003BBE 58B0 A938
         LA    15,11                     . 003BC2 41F0 000B
         B     ARITH                     . 003BC6 47F0 B088
                                                             SPACE
* REMDR PROC   ADD                 REMDR(X,Y)
*      SETAC   SCL,12
*      BRANCH  ARITH
                                                             SPACE
REMDR    L     11,@@ADD                  . 003BCA 58B0 A938
         LA    15,12                     . 003BCE 41F0 000C
                                                             SPACE
* ARITH PUSH   SCL                 Save procedure switch
*      RCALL   ,XYARGS,,FAIL       Evaluate arguments
*      POP     SCL                 Restore procedure switch
*      SETAV   DTCL,XPTR           Set up data type pair
*      MOVV    DTCL,YPTR
*      DEQL    DTCL,IIDTP,,ARTHII  INTEGER-INTEGER
*      DEQL    DTCL,IVDTP,,ARTHIV  INTEGER-STRING
*      DEQL    DTCL,VIDTP,,ARTHVI  STRING-INTEGER
*      DEQL    DTCL,VVDTP,,ARTHVV  STRING-STRING
*      DEQL    DTCL,RRDTP,,ARTHRR  REAL-REAL
*      DEQL    DTCL,IRDTP,,ARTHIR  INTEGER-REAL
*      DEQL    DTCL,RIDTP,,ARTHRI  REAL-INTEGER
*      DEQL    DTCL,VRDTP,,ARTHVR  STRING-REAL
*      DEQL    DTCL,RVDTP,INTR1,ARTHRV
*                                  REAL-STRING
                                                             SPACE
ARITH    STM   15,0,104(12)              . 003BD2 90F0 C068
         AR    12,8                      . 003BD6 1AC8
         C     12,@@STACKT               . 003BD8 59C0 A828
         BH    OVER                      . 003BDC 4720 9664
         LA    14,S4$03BFC               . 003BE0 41E0 B0B2
         STM   11,14,104(12)             . 003BE4 90BE C068
         LR    13,12                     . 003BE8 18DC
         LA    12,16(12)                 . 003BEA 41CC 0010
         C     12,@@STACKT               . 003BEE 59C0 A828
         BH    OVER                      . 003BF2 4720 9664
         L     11,@@XYARGS               . 003BF6 58B0 A93C
         BR    11                        . 003BFA 07FB
S4$03BFC SR    0,0                       . 003BFC 1B00
         SR    0,0                       . 003BFE 1B00
         B     FAIL                      . 003C00 47F0 9010
         LD    0,96(12)                  . 003C04 680C 0060
         STD   0,SCL                     . 003C08 6000 9EF8
         SR    12,8                      . 003C0C 1BC8
         L     15,XPTR$4                 . 003C0E 58F0 A414
         LA    15,0(15)                  . 003C12 41FF 0000
         STM   15,0,DTCL                 . 003C16 90F0 9E40
         MVC   DTCL$5(3),YPTR$5          . 003C1A D202 9E45 A42D
         CLC   DTCL(8),IIDTP             . 003C20 D507 9E40 9AD8
         BE    ARTHII                    . 003C26 4780 B134
         CLC   DTCL(8),IVDTP             . 003C2A D507 9E40 9AF0
         BE    ARTHIV                    . 003C30 4780 B1C6
         CLC   DTCL(8),VIDTP             . 003C34 D507 9E40 9B48
         BE    ARTHVI                    . 003C3A 4780 B170
         CLC   DTCL(8),VVDTP             . 003C3E D507 9E40 9B60
         BE    ARTHVV                    . 003C44 4780 B21C
         CLC   DTCL(8),RRDTP             . 003C48 D507 9E40 9B20
         BE    ARTHRR                    . 003C4E 4780 B272
         CLC   DTCL(8),IRDTP             . 003C52 D507 9E40 9AE8
         BE    ARTHIR                    . 003C58 4780 B2AE
         CLC   DTCL(8),RIDTP             . 003C5C D507 9E40 9B10
         BE    ARTHRI                    . 003C62 4780 B2D2
         CLC   DTCL(8),VRDTP             . 003C66 D507 9E40 9B58
         BE    ARTHVR                    . 003C6C 4780 B2F6
         CLC   DTCL(8),RVDTP             . 003C70 D507 9E40 9B28
         BNE   INTR1                     . 003C76 4770 95FC
         BE    ARTHRV                    . 003C7A 4780 B34C
                                                             SPACE
* ARTHII SELBRA SCL,(AD,DV,EX,MP,SB,CEQ,CGE,CGT,CLE,CLT,CNE,RM)
                                                             SPACE
ARTHII   L     1,SCL                     . 003C7E 5810 9EF8
         SLA   1,2                       . 003C82 8B10 0002
S4$03C86 B     S4$03C86(1)               . 003C86 47F1 B13C
         B     AD                        . 003C8A 47F0 B3A2
         B     DV                        . 003C8E 47F0 B3B6
         B     EX                        . 003C92 47F0 B3D4
         B     MP                        . 003C96 47F0 B440
         B     SB                        . 003C9A 47F0 B458
         B     CEQ                       . 003C9E 47F0 B46C
         B     CGE                       . 003CA2 47F0 B47C
         B     CGT                       . 003CA6 47F0 B48C
         B     CLE                       . 003CAA 47F0 B49C
         B     CLT                       . 003CAE 47F0 B4AC
         B     CNE                       . 003CB2 47F0 B4BC
         B     RM                        . 003CB6 47F0 B5B8
                                                             SPACE
* ARTHVI LOCSP XSP,XPTR            Get specifier
*      SPCINT  XPTR,XSP,,ARTHII    Convert string to integer
*      SPREAL  XPTR,XSP,INTR1,ARTHRI
*                                  Convert to real if possible
                                                             SPACE
ARTHVI   LM    3,4,XPTR                  . 003CBA 9834 A410
         CR    0,3                       . 003CBE 1903
         BNE   S4$03CCC                  . 003CC0 4770 B182
         ST    0,XSP                     . 003CC4 5000 A5D0
         B     S4$03CDC                  . 003CC8 47F0 B192
S4$03CCC L     1,4(3)                    . 003CCC 5813 0004
         LA    1,0(1)                    . 003CD0 4111 0000
         LA    2,32                      . 003CD4 4120 0020
         STM   1,4,XSP                   . 003CD8 9014 A5D0
S4$03CDC L     15,@@DECBIN               . 003CDC 58F0 A8EC
         LA    1,XPTR                    . 003CE0 4110 A410
         LA    2,XSP                     . 003CE4 4120 A5D0
         BALR  14,15                          CALL                     *
                                         . 003CE8 05EF
         B     S4$03CF2                  . 003CEA 47F0 B1A8
         B     ARTHII                    . 003CEE 47F0 B134
S4$03CF2 L     15,@@SPREAL               . 003CF2 58F0 A8F0
         LA    1,XPTR                    . 003CF6 4110 A410
         LM    2,4,XSP                   . 003CFA 9824 A5D0
         BALR  14,15                          CALL                     *
                                         . 003CFE 05EF
         B     INTR1                     . 003D00 47F0 95FC
         LA    2,7                       . 003D04 4120 0007
         ST    2,XPTR$4                  . 003D08 5020 A414
         B     ARTHRI                    . 003D0C 47F0 B2D2
                                                             SPACE
* ARTHIV LOCSP YSP,YPTR            Get specifier
*      SPCINT  YPTR,YSP,,ARTHII    Convert string to integer
*      SPREAL  YPTR,YSP,INTR1,ARTHIR
*                                  Convert to real if possible
                                                             SPACE
ARTHIV   LM    3,4,YPTR                  . 003D10 9834 A428
         CR    0,3                       . 003D14 1903
         BNE   S4$03D22                  . 003D16 4770 B1D8
         ST    0,YSP                     . 003D1A 5000 A5E0
         B     S4$03D32                  . 003D1E 47F0 B1E8
S4$03D22 L     1,4(3)                    . 003D22 5813 0004
         LA    1,0(1)                    . 003D26 4111 0000
         LA    2,32                      . 003D2A 4120 0020
         STM   1,4,YSP                   . 003D2E 9014 A5E0
S4$03D32 L     15,@@DECBIN               . 003D32 58F0 A8EC
         LA    1,YPTR                    . 003D36 4110 A428
         LA    2,YSP                     . 003D3A 4120 A5E0
         BALR  14,15                          CALL                     *
                                         . 003D3E 05EF
         B     S4$03D48                  . 003D40 47F0 B1FE
         B     ARTHII                    . 003D44 47F0 B134
S4$03D48 L     15,@@SPREAL               . 003D48 58F0 A8F0
         LA    1,YPTR                    . 003D4C 4110 A428
         LM    2,4,YSP                   . 003D50 9824 A5E0
         BALR  14,15                          CALL                     *
                                         . 003D54 05EF
         B     INTR1                     . 003D56 47F0 95FC
         LA    2,7                       . 003D5A 4120 0007
         ST    2,YPTR$4                  . 003D5E 5020 A42C
         B     ARTHIR                    . 003D62 47F0 B2AE
                                                             SPACE
* ARTHVV LOCSP XSP,XPTR            Get specifier
*      SPCINT  XPTR,XSP,,ARTHIV    Convert string to integer
*      SPREAL  XPTR,XSP,INTR1,ARTHRV
*                                  Convert to real if possible
                                                             SPACE
ARTHVV   LM    3,4,XPTR                  . 003D66 9834 A410
         CR    0,3                       . 003D6A 1903
         BNE   S4$03D78                  . 003D6C 4770 B22E
         ST    0,XSP                     . 003D70 5000 A5D0
         B     S4$03D88                  . 003D74 47F0 B23E
S4$03D78 L     1,4(3)                    . 003D78 5813 0004
         LA    1,0(1)                    . 003D7C 4111 0000
         LA    2,32                      . 003D80 4120 0020
         STM   1,4,XSP                   . 003D84 9014 A5D0
S4$03D88 L     15,@@DECBIN               . 003D88 58F0 A8EC
         LA    1,XPTR                    . 003D8C 4110 A410
         LA    2,XSP                     . 003D90 4120 A5D0
         BALR  14,15                          CALL                     *
                                         . 003D94 05EF
         B     S4$03D9E                  . 003D96 47F0 B254
         B     ARTHIV                    . 003D9A 47F0 B1C6
S4$03D9E L     15,@@SPREAL               . 003D9E 58F0 A8F0
         LA    1,XPTR                    . 003DA2 4110 A410
         LM    2,4,XSP                   . 003DA6 9824 A5D0
         BALR  14,15                          CALL                     *
                                         . 003DAA 05EF
         B     INTR1                     . 003DAC 47F0 95FC
         LA    2,7                       . 003DB0 4120 0007
         ST    2,XPTR$4                  . 003DB4 5020 A414
         B     ARTHRV                    . 003DB8 47F0 B34C
                                                             SPACE
* ARTHRR SELBRA SCL,(AR,DR,EXR,MR,SR,REQ,RGE,RGT,RLE,RLT,RNE,INTR1)
                                                             SPACE
ARTHRR   L     1,SCL                     . 003DBC 5810 9EF8
         SLA   1,2                       . 003DC0 8B10 0002
S4$03DC4 B     S4$03DC4(1)               . 003DC4 47F1 B27A
         B     AR                        . 003DC8 47F0 B4CC
         B     DR                        . 003DCC 47F0 B4DC
         B     EXR                       . 003DD0 47F0 B4F6
         B     MR                        . 003DD4 47F0 B518
         B     SR                        . 003DD8 47F0 B530
         B     REQ                       . 003DDC 47F0 B540
         B     RGE                       . 003DE0 47F0 B554
         B     RGT                       . 003DE4 47F0 B568
         B     RLE                       . 003DE8 47F0 B57C
         B     RLT                       . 003DEC 47F0 B590
         B     RNE                       . 003DF0 47F0 B5A4
         B     INTR1                     . 003DF4 47F0 95FC
                                                             SPACE
* ARTHIR INTRL XPTR,XPTR           Convert integer to real
*      BRANCH  ARTHRR
                                                             SPACE
ARTHIR   L     2,XPTR                    . 003DF8 5820 A410
         AL    2,BIG2$4                  . 003DFC 5E20 A79C
         ST    2,REALBB$4                . 003E00 5020 A794
         LD    2,REALBB                  . 003E04 6820 A790
         SD    2,BIG2                    . 003E08 6B20 A798
         STE   2,XPTR                    . 003E0C 7020 A410
         LA    2,7                       . 003E10 4120 0007
         ST    2,XPTR$4                  . 003E14 5020 A414
         B     ARTHRR                    . 003E18 47F0 B272
                                                             SPACE
* ARTHRI INTRL YPTR,YPTR           Convert integer to real
*      BRANCH  ARTHRR
                                                             SPACE
ARTHRI   L     2,YPTR                    . 003E1C 5820 A428
         AL    2,BIG2$4                  . 003E20 5E20 A79C
         ST    2,REALBB$4                . 003E24 5020 A794
         LD    2,REALBB                  . 003E28 6820 A790
         SD    2,BIG2                    . 003E2C 6B20 A798
         STE   2,YPTR                    . 003E30 7020 A428
         LA    2,7                       . 003E34 4120 0007
         ST    2,YPTR$4                  . 003E38 5020 A42C
         B     ARTHRR                    . 003E3C 47F0 B272
                                                             SPACE
* ARTHVR LOCSP XSP,XPTR            Get spedifier
*      SPCINT  XPTR,XSP,,ARTHIR    Convert string to integer
*      SPREAL  XPTR,XSP,INTR1,ARTHRR
*                                  Convert to real if possible
                                                             SPACE
ARTHVR   LM    3,4,XPTR                  . 003E40 9834 A410
         CR    0,3                       . 003E44 1903
         BNE   S4$03E52                  . 003E46 4770 B308
         ST    0,XSP                     . 003E4A 5000 A5D0
         B     S4$03E62                  . 003E4E 47F0 B318
S4$03E52 L     1,4(3)                    . 003E52 5813 0004
         LA    1,0(1)                    . 003E56 4111 0000
         LA    2,32                      . 003E5A 4120 0020
         STM   1,4,XSP                   . 003E5E 9014 A5D0
S4$03E62 L     15,@@DECBIN               . 003E62 58F0 A8EC
         LA    1,XPTR                    . 003E66 4110 A410
         LA    2,XSP                     . 003E6A 4120 A5D0
         BALR  14,15                          CALL                     *
                                         . 003E6E 05EF
         B     S4$03E78                  . 003E70 47F0 B32E
         B     ARTHIR                    . 003E74 47F0 B2AE
S4$03E78 L     15,@@SPREAL               . 003E78 58F0 A8F0
         LA    1,XPTR                    . 003E7C 4110 A410
         LM    2,4,XSP                   . 003E80 9824 A5D0
         BALR  14,15                          CALL                     *
                                         . 003E84 05EF
         B     INTR1                     . 003E86 47F0 95FC
         LA    2,7                       . 003E8A 4120 0007
         ST    2,XPTR$4                  . 003E8E 5020 A414
         B     ARTHRR                    . 003E92 47F0 B272
                                                             SPACE
* ARTHRV LOCSP YSP,YPTR
*      SPCINT  YPTR,YSP,,ARTHRI    Convert string to integer
*      SPREAL  YPTR,YSP,INTR1,ARTHRR
*                                  Convert to real if possible
                                                             SPACE
ARTHRV   LM    3,4,YPTR                  . 003E96 9834 A428
         CR    0,3                       . 003E9A 1903
         BNE   S4$03EA8                  . 003E9C 4770 B35E
         ST    0,YSP                     . 003EA0 5000 A5E0
         B     S4$03EB8                  . 003EA4 47F0 B36E
S4$03EA8 L     1,4(3)                    . 003EA8 5813 0004
         LA    1,0(1)                    . 003EAC 4111 0000
         LA    2,32                      . 003EB0 4120 0020
         STM   1,4,YSP                   . 003EB4 9014 A5E0
S4$03EB8 L     15,@@DECBIN               . 003EB8 58F0 A8EC
         LA    1,YPTR                    . 003EBC 4110 A428
         LA    2,YSP                     . 003EC0 4120 A5E0
         BALR  14,15                          CALL                     *
                                         . 003EC4 05EF
         B     S4$03ECE                  . 003EC6 47F0 B384
         B     ARTHRI                    . 003ECA 47F0 B2D2
S4$03ECE L     15,@@SPREAL               . 003ECE 58F0 A8F0
         LA    1,YPTR                    . 003ED2 4110 A428
         LM    2,4,YSP                   . 003ED6 9824 A5E0
         BALR  14,15                          CALL                     *
                                         . 003EDA 05EF
         B     INTR1                     . 003EDC 47F0 95FC
         LA    2,7                       . 003EE0 4120 0007
         ST    2,YPTR$4                  . 003EE4 5020 A42C
         B     ARTHRR                    . 003EE8 47F0 B272
                                                             SPACE
* AD   SUM     ZPTR,XPTR,YPTR,AERROR,ARTN
                                                             SPACE
AD       LM    1,2,XPTR                  . 003EEC 9812 A410
         A     1,YPTR                    . 003EF0 5A10 A428
         STM   1,2,ZPTR                  . 003EF4 9012 A440
         BO    AERROR                    . 003EF8 4710 9588
         BNO   ARTN                      . 003EFC 47E0 9068
                                                             SPACE
* DV   DIVIDE  ZPTR,XPTR,YPTR,AERROR,ARTN
                                                             SPACE
DV       LM    3,4,YPTR                  . 003F00 9834 A428
         CR    3,0                       . 003F04 1930
         BE    AERROR                    . 003F06 4780 9588
         L     2,XPTR                    . 003F0A 5820 A410
         SRDA  2,32                      . 003F0E 8E20 0020
         D     2,YPTR                    . 003F12 5D20 A428
         STM   3,4,ZPTR                  . 003F16 9034 A440
         B     ARTN                      . 003F1A 47F0 9068
                                                             SPACE
* EX   EXPINT  ZPTR,XPTR,YPTR,AERROR,ARTN
                                                             SPACE
EX       C     0,XPTR                    . 003F1E 5900 A410
         BNE   S4$03F34                  . 003F22 4770 B3EA
         C     0,YPTR                    . 003F26 5900 A428
         BNL   AERROR                    . 003F2A 47B0 9588
S4$03F2E LR    3,0                       . 003F2E 1830
         B     S4$03F7E                  . 003F30 47F0 B434
S4$03F34 C     0,YPTR                    . 003F34 5900 A428
         BNE   S4$03F44                  . 003F38 4770 B3FA
         LA    3,1                       . 003F3C 4130 0001
         B     S4$03F7E                  . 003F40 47F0 B434
S4$03F44 BL    S4$03F5E                  . 003F44 4740 B414
         L     3,XPTR                    . 003F48 5830 A410
         LPR   3,3                       . 003F4C 1033
         C     3,@@F1                    . 003F4E 5930 A940
         BNE   S4$03F2E                  . 003F52 4770 B3E4
         L     3,XPTR                    . 003F56 5830 A410
         B     S4$03F62                  . 003F5A 47F0 B418
S4$03F5E LA    3,1                       . 003F5E 4130 0001
S4$03F62 L     4,YPTR                    . 003F62 5840 A428
         LPR   4,4                       . 003F66 1044
S4$03F68 LR    2,3                       . 003F68 1823
         M     2,XPTR                    . 003F6A 5C20 A410
         SLDA  2,32                      . 003F6E 8F20 0020
         BO    AERROR                    . 003F72 4710 9588
         SRDA  2,32                      . 003F76 8E20 0020
         BCT   4,S4$03F68                     LOOP                     *
                                         . 003F7A 4640 B41E
S4$03F7E L     4,XPTR$4                  . 003F7E 5840 A414
         STM   3,4,ZPTR                  . 003F82 9034 A440
         B     ARTN                      . 003F86 47F0 9068
                                                             SPACE
* MP   MULT    ZPTR,XPTR,YPTR,AERROR,ARTN
                                                             SPACE
MP       LM    3,4,XPTR                  . 003F8A 9834 A410
         M     2,YPTR                    . 003F8E 5C20 A428
         STM   3,4,ZPTR                  . 003F92 9034 A440
         SLDA  2,32                      . 003F96 8F20 0020
         BO    AERROR                    . 003F9A 4710 9588
         B     ARTN                      . 003F9E 47F0 9068
                                                             SPACE
* SB   SUBTRT  ZPTR,XPTR,YPTR,AERROR,ARTN
                                                             SPACE
SB       LM    1,2,XPTR                  . 003FA2 9812 A410
         S     1,YPTR                    . 003FA6 5B10 A428
         STM   1,2,ZPTR                  . 003FAA 9012 A440
         BO    AERROR                    . 003FAE 4710 9588
         BNO   ARTN                      . 003FB2 47E0 9068
                                                             SPACE
* CEQ  AEQL    XPTR,YPTR,FAIL,RETNUL
                                                             SPACE
CEQ      L     1,XPTR                    . 003FB6 5810 A410
         C     1,YPTR                    . 003FBA 5910 A428
         BNE   FAIL                      . 003FBE 4770 9010
         BE    RETNUL                    . 003FC2 4780 9018
                                                             SPACE
* CGE  ACOMP   XPTR,YPTR,RETNUL,RETNUL,FAIL
                                                             SPACE
CGE      L     1,XPTR                    . 003FC6 5810 A410
         C     1,YPTR                    . 003FCA 5910 A428
         BNL   RETNUL                    . 003FCE 47B0 9018
         BL    FAIL                      . 003FD2 4740 9010
                                                             SPACE
* CGT  ACOMP   XPTR,YPTR,RETNUL,FAIL,FAIL
                                                             SPACE
CGT      L     1,XPTR                    . 003FD6 5810 A410
         C     1,YPTR                    . 003FDA 5910 A428
         BNH   FAIL                      . 003FDE 47D0 9010
         BH    RETNUL                    . 003FE2 4720 9018
                                                             SPACE
* CLE  ACOMP   XPTR,YPTR,FAIL,RETNUL,RETNUL
                                                             SPACE
CLE      L     1,XPTR                    . 003FE6 5810 A410
         C     1,YPTR                    . 003FEA 5910 A428
         BNH   RETNUL                    . 003FEE 47D0 9018
         BH    FAIL                      . 003FF2 4720 9010
                                                             SPACE
* CLT  ACOMP   XPTR,YPTR,FAIL,FAIL,RETNUL
                                                             SPACE
CLT      L     1,XPTR                    . 003FF6 5810 A410
         C     1,YPTR                    . 003FFA 5910 A428
         BNL   FAIL                      . 003FFE 47B0 9010
         BL    RETNUL                    . 004002 4740 9018
                                                             SPACE
* CNE  AEQL    XPTR,YPTR,RETNUL,FAIL
                                                             SPACE
CNE      L     1,XPTR                    . 004006 5810 A410
         C     1,YPTR                    . 00400A 5910 A428
         BNE   RETNUL                    . 00400E 4770 9018
         BE    FAIL                      . 004012 4780 9010
                                                             SPACE
* AR   ADREAL  ZPTR,XPTR,YPTR,AERROR,ARTN
                                                             SPACE
AR       LD    2,XPTR                    . 004016 6820 A410
         AE    2,YPTR                    . 00401A 7A20 A428
         STD   2,ZPTR                    . 00401E 6020 A440
         B     ARTN                      . 004022 47F0 9068
                                                             SPACE
* DR   DVREAL  ZPTR,XPTR,YPTR,AERROR,ARTN
                                                             SPACE
DR       LE    4,YPTR                    . 004026 7840 A428
         CE    4,ZEROCL                  . 00402A 7940 9C90
         BE    AERROR                    . 00402E 4780 9588
         LD    2,XPTR                    . 004032 6820 A410
         DER   2,4                       . 004036 3D24
         STD   2,ZPTR                    . 004038 6020 A440
         B     ARTN                      . 00403C 47F0 9068
                                                             SPACE
* EXR  EXREAL  ZPTR,XPTR,YPTR,AERROR,ARTN
                                                             SPACE
EXR      LE    0,XPTR                    . 004040 7800 A410
         LE    2,YPTR                    . 004044 7820 A428
         L     15,@@EXREAL               . 004048 58F0 A944
         BALR  14,15                          CALL                     *
                                         . 00404C 05EF
         B     AERROR                    . 00404E 47F0 9588
         STE   0,ZPTR                    . 004052 7000 A440
         L     2,XPTR$4                  . 004056 5820 A414
         ST    2,ZPTR$4                  . 00405A 5020 A444
         B     ARTN                      . 00405E 47F0 9068
                                                             SPACE
* MR   MPREAL  ZPTR,XPTR,YPTR,AERROR,ARTN
                                                             SPACE
MR       LE    2,XPTR                    . 004062 7820 A410
         ME    2,YPTR                    . 004066 7C20 A428
         STE   2,ZPTR                    . 00406A 7020 A440
         L     1,XPTR$4                  . 00406E 5810 A414
         ST    1,ZPTR$4                  . 004072 5010 A444
         B     ARTN                      . 004076 47F0 9068
                                                             SPACE
* SR   SBREAL  ZPTR,XPTR,YPTR,AERROR,ARTN
                                                             SPACE
SR       LD    2,XPTR                    . 00407A 6820 A410
         SE    2,YPTR                    . 00407E 7B20 A428
         STD   2,ZPTR                    . 004082 6020 A440
         B     ARTN                      . 004086 47F0 9068
                                                             SPACE
* REQ  RCOMP   XPTR,YPTR,FAIL,RETNUL,FAIL
                                                             SPACE
REQ      LE    0,XPTR                    . 00408A 7800 A410
         CE    0,YPTR                    . 00408E 7900 A428
         BH    FAIL                      . 004092 4720 9010
         BE    RETNUL                    . 004096 4780 9018
         B     FAIL                      . 00409A 47F0 9010
                                                             SPACE
* RGE  RCOMP   XPTR,YPTR,RETNUL,RETNUL,FAIL
                                                             SPACE
RGE      LE    0,XPTR                    . 00409E 7800 A410
         CE    0,YPTR                    . 0040A2 7900 A428
         BH    RETNUL                    . 0040A6 4720 9018
         BE    RETNUL                    . 0040AA 4780 9018
         B     FAIL                      . 0040AE 47F0 9010
                                                             SPACE
* RGT  RCOMP   XPTR,YPTR,RETNUL,FAIL,FAIL
                                                             SPACE
RGT      LE    0,XPTR                    . 0040B2 7800 A410
         CE    0,YPTR                    . 0040B6 7900 A428
         BH    RETNUL                    . 0040BA 4720 9018
         BE    FAIL                      . 0040BE 4780 9010
         B     FAIL                      . 0040C2 47F0 9010
                                                             SPACE
* RLE  RCOMP   XPTR,YPTR,FAIL,RETNUL,RETNUL
                                                             SPACE
RLE      LE    0,XPTR                    . 0040C6 7800 A410
         CE    0,YPTR                    . 0040CA 7900 A428
         BH    FAIL                      . 0040CE 4720 9010
         BE    RETNUL                    . 0040D2 4780 9018
         B     RETNUL                    . 0040D6 47F0 9018
                                                             SPACE
* RLT  RCOMP   XPTR,YPTR,FAIL,FAIL,RETNUL
                                                             SPACE
RLT      LE    0,XPTR                    . 0040DA 7800 A410
         CE    0,YPTR                    . 0040DE 7900 A428
         BH    FAIL                      . 0040E2 4720 9010
         BE    FAIL                      . 0040E6 4780 9010
         B     RETNUL                    . 0040EA 47F0 9018
                                                             SPACE
* RNE  RCOMP   XPTR,YPTR,RETNUL,FAIL,RETNUL
                                                             SPACE
RNE      LE    0,XPTR                    . 0040EE 7800 A410
         CE    0,YPTR                    . 0040F2 7900 A428
         BH    RETNUL                    . 0040F6 4720 9018
         BE    FAIL                      . 0040FA 4780 9010
         B     RETNUL                    . 0040FE 47F0 9018
                                                             SPACE
* RM   DIVIDE  ZPTR,XPTR,YPTR,AERROR
*                                  First divide
*      MULT    WPTR,ZPTR,YPTR      Multiply truncated part
*      SUBTRT  ZPTR,XPTR,WPTR      Get difference
*      BRANCH  ARTN
RM       LM    3,4,YPTR                  . 004102 9834 A428
         CR    3,0                       . 004106 1930
         BE    AERROR                    . 004108 4780 9588
         L     2,XPTR                    . 00410C 5820 A410
         SRDA  2,32                      . 004110 8E20 0020
         D     2,YPTR                    . 004114 5D20 A428
         STM   3,4,ZPTR                  . 004118 9034 A440
         LM    3,4,ZPTR                  . 00411C 9834 A440
         M     2,YPTR                    . 004120 5C20 A428
         STM   3,4,WPTR                  . 004124 9034 A400
         LM    1,2,XPTR                  . 004128 9812 A410
         SR    1,3                       . 00412C 1B13
         STM   1,2,ZPTR                  . 00412E 9012 A440
         B     ARTN                      . 004132 47F0 9068
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      INTEGER(X)
*
                                                             SPACE
* INTGER PROC  ,                   INTEGER(X)
*      RCALL   XPTR,ARGVAL,,FAIL   Get argument
*      VEQLC   XPTR,I,,RETNUL      INTEGER succeeds
*      VEQLC   XPTR,S,FAIL         STRING must be checked
*      LOCSP   XSP,XPTR            Get specifier
*      SPCINT  XPTR,XSP,FAIL,RETNUL
*                                  Try conversion to INTEGER
         USING INTGER,11                 .
INTGER   LA    14,S4$04152               . 004136 41E0 B01C
         STM   11,14,104(12)             . 00413A 90BE C068
         LR    13,12                     . 00413E 18DC
         LA    12,16(12)                 . 004140 41CC 0010
         C     12,@@STACKT               . 004144 59C0 A828
         BH    OVER                      . 004148 4720 9664
         L     11,@@ARGVAL               . 00414C 58B0 A914
         BR    11                        . 004150 07FB
S4$04152 STD   0,XPTR                    . 004152 6000 A410
         B     FAIL                      . 004156 47F0 9010
         CLC   XPTR$5(3),@@I             . 00415A D502 A415 AA84
         BE    RETNUL                    . 004160 4780 9018
         CLC   XPTR$5(3),@@S             . 004164 D502 A415 AA7B
         BNE   FAIL                      . 00416A 4770 9010
         LM    3,4,XPTR                  . 00416E 9834 A410
         CR    0,3                       . 004172 1903
         BNE   S4$04180                  . 004174 4770 B04A
         ST    0,XSP                     . 004178 5000 A5D0
         B     S4$04190                  . 00417C 47F0 B05A
S4$04180 L     1,4(3)                    . 004180 5813 0004
         LA    1,0(1)                    . 004184 4111 0000
         LA    2,32                      . 004188 4120 0020
         STM   1,4,XSP                   . 00418C 9014 A5D0
S4$04190 L     15,@@DECBIN               . 004190 58F0 A8EC
         LA    1,XPTR                    . 004194 4110 A410
         LA    2,XSP                     . 004198 4120 A5D0
         BALR  14,15                          CALL                     *
                                         . 00419C 05EF
         B     FAIL                      . 00419E 47F0 9010
         B     RETNUL                    . 0041A2 47F0 9018
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Arithmetic Negative
*
                                                             SPACE
* MNS  PROC    ,                   -X
*      RCALL   XPTR,ARGVAL,,FAIL   Get argument
*      VEQLC   XPTR,I,,MNSM        INTEGER acceptable
*      VEQLC   XPTR,S,,MNSV        STRING must be converted
*      VEQLC   XPTR,R,INTR1,MNSR   REAL is acceptable
                                                             SPACE
         USING MNS,11                    .
MNS      LA    14,S4$041C2               . 0041A6 41E0 B01C
         STM   11,14,104(12)             . 0041AA 90BE C068
         LR    13,12                     . 0041AE 18DC
         LA    12,16(12)                 . 0041B0 41CC 0010
         C     12,@@STACKT               . 0041B4 59C0 A828
         BH    OVER                      . 0041B8 4720 9664
         L     11,@@ARGVAL               . 0041BC 58B0 A914
         BR    11                        . 0041C0 07FB
S4$041C2 STD   0,XPTR                    . 0041C2 6000 A410
         B     FAIL                      . 0041C6 47F0 9010
         CLC   XPTR$5(3),@@I             . 0041CA D502 A415 AA84
         BE    MNSM                      . 0041D0 4780 B046
         CLC   XPTR$5(3),@@S             . 0041D4 D502 A415 AA7B
         BE    MNSV                      . 0041DA 4780 B058
         CLC   XPTR$5(3),@@R             . 0041DE D502 A415 AA75
         BNE   INTR1                     . 0041E4 4770 95FC
         BE    MNSR                      . 0041E8 4780 B0AA
                                                             SPACE
* MNSM MNSINT  ZPTR,XPTR,AERROR,ARTN
*                                  Form negative of integer
                                                             SPACE
MNSM     LM    2,3,XPTR                  . 0041EC 9823 A410
         LCR   2,2                       . 0041F0 1322
         BO    AERROR                    . 0041F2 4710 9588
         STM   2,3,ZPTR                  . 0041F6 9023 A440
         B     ARTN                      . 0041FA 47F0 9068
                                                             SPACE
* MNSV LOCSP   XSP,XPTR            Get specifier for string
*      SPCINT  XPTR,XSP,,MNSM      Convert to INTEGER
*      SPREAL  XPTR,XSP,INTR1      Convert to REAL
                                                             SPACE
MNSV     LM    3,4,XPTR                  . 0041FE 9834 A410
         CR    0,3                       . 004202 1903
         BNE   S4$04210                  . 004204 4770 B06A
         ST    0,XSP                     . 004208 5000 A5D0
         B     S4$04220                  . 00420C 47F0 B07A
S4$04210 L     1,4(3)                    . 004210 5813 0004
         LA    1,0(1)                    . 004214 4111 0000
         LA    2,32                      . 004218 4120 0020
         STM   1,4,XSP                   . 00421C 9014 A5D0
S4$04220 L     15,@@DECBIN               . 004220 58F0 A8EC
         LA    1,XPTR                    . 004224 4110 A410
         LA    2,XSP                     . 004228 4120 A5D0
         BALR  14,15                          CALL                     *
                                         . 00422C 05EF
         B     S4$04236                  . 00422E 47F0 B090
         B     MNSM                      . 004232 47F0 B046
S4$04236 L     15,@@SPREAL               . 004236 58F0 A8F0
         LA    1,XPTR                    . 00423A 4110 A410
         LM    2,4,XSP                   . 00423E 9824 A5D0
         BALR  14,15                          CALL                     *
                                         . 004242 05EF
         B     INTR1                     . 004244 47F0 95FC
         LA    2,7                       . 004248 4120 0007
         ST    2,XPTR$4                  . 00424C 5020 A414
                                                             SPACE
* MNSR MNREAL  ZPTR,XPTR           Form negative of real
*      BRANCH  ARTN
MNSR     LD    2,XPTR                    . 004250 6820 A410
         LCER  2,2                       . 004254 3322
         STD   2,ZPTR                    . 004256 6020 A440
         B     ARTN                      . 00425A 47F0 9068
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Unary Plus Operator
*
                                                             SPACE
* PLS  PROC    ,                   +X
*      RCALL   ZPTR,ARGVAL,,FAIL   Get argument
*      VEQLC   ZPTR,I,,ARTN        Is it INTEGER?
*      VEQLC   ZPTR,S,,PLSV        Is it STRING?
*      VEQLC   ZPTR,R,INTR1,ARTN   Is it REAL?
                                                             SPACE
         USING PLS,11                    .
PLS      LA    14,S4$0427A               . 00425E 41E0 B01C
         STM   11,14,104(12)             . 004262 90BE C068
         LR    13,12                     . 004266 18DC
         LA    12,16(12)                 . 004268 41CC 0010
         C     12,@@STACKT               . 00426C 59C0 A828
         BH    OVER                      . 004270 4720 9664
         L     11,@@ARGVAL               . 004274 58B0 A914
         BR    11                        . 004278 07FB
S4$0427A STD   0,ZPTR                    . 00427A 6000 A440
         B     FAIL                      . 00427E 47F0 9010
         CLC   ZPTR$5(3),@@I             . 004282 D502 A445 AA84
         BE    ARTN                      . 004288 4780 9068
         CLC   ZPTR$5(3),@@S             . 00428C D502 A445 AA7B
         BE    PLSV                      . 004292 4780 B046
         CLC   ZPTR$5(3),@@R             . 004296 D502 A445 AA75
         BNE   INTR1                     . 00429C 4770 95FC
         BE    ARTN                      . 0042A0 4780 9068
                                                             SPACE
* PLSV LOCSP   XSP,ZPTR            Get specifier
*      SPCINT  ZPTR,XSP,,ARTN      Convert STRING to INTEGER
*      SPREAL  ZPTR,XSP,INTR1,ARTN Convert STRING to REAL
PLSV     LM    3,4,ZPTR                  . 0042A4 9834 A440
         CR    0,3                       . 0042A8 1903
         BNE   S4$042B6                  . 0042AA 4770 B058
         ST    0,XSP                     . 0042AE 5000 A5D0
         B     S4$042C6                  . 0042B2 47F0 B068
S4$042B6 L     1,4(3)                    . 0042B6 5813 0004
         LA    1,0(1)                    . 0042BA 4111 0000
         LA    2,32                      . 0042BE 4120 0020
         STM   1,4,XSP                   . 0042C2 9014 A5D0
S4$042C6 L     15,@@DECBIN               . 0042C6 58F0 A8EC
         LA    1,ZPTR                    . 0042CA 4110 A440
         LA    2,XSP                     . 0042CE 4120 A5D0
         BALR  14,15                          CALL                     *
                                         . 0042D2 05EF
         B     S4$042DC                  . 0042D4 47F0 B07E
         B     ARTN                      . 0042D8 47F0 9068
S4$042DC L     15,@@SPREAL               . 0042DC 58F0 A8F0
         LA    1,ZPTR                    . 0042E0 4110 A440
         LM    2,4,XSP                   . 0042E4 9824 A5D0
         BALR  14,15                          CALL                     *
                                         . 0042E8 05EF
         B     INTR1                     . 0042EA 47F0 95FC
         LA    2,7                       . 0042EE 4120 0007
         ST    2,ZPTR$4                  . 0042F2 5020 A444
         B     ARTN                      . 0042F6 47F0 9068
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Pattern-valued Functions and Operations'
* ANY  PROC    ,                   ANY(S)
*      PUSH    ANYCCL              Save function descriptor
*      BRANCH  CHARZ               Join common processing
                                                             SPACE
         USING ANY,11                    .
ANY      LD    0,ANYCCL                  . 0042FA 6800 9CD0
         STD   0,104(12)                 . 0042FE 600C 0068
         AR    12,8                      . 004302 1AC8
         C     12,@@STACKT               . 004304 59C0 A828
         BH    OVER                      . 004308 4720 9664
         B     CHARZ                     . 00430C 47F0 B072
                                                             SPACE
* BREAK PROC   ANY                 BREAK(S)
*      PUSH    BRKCCL              Save function descriptor
*      PUSH    ZEROCL              Save minimum length of zero
*      BRANCH  ABNSND              Join common processing
                                                             SPACE
BREAK    L     11,@@ANY                  . 004310 58B0 A948
         LD    0,BRKCCL                  . 004314 6800 9CF0
         STD   0,104(12)                 . 004318 600C 0068
         AR    12,8                      . 00431C 1AC8
         C     12,@@STACKT               . 00431E 59C0 A828
         BH    OVER                      . 004322 4720 9664
         LD    0,ZEROCL                  . 004326 6800 9C90
         STD   0,104(12)                 . 00432A 600C 0068
         AR    12,8                      . 00432E 1AC8
         C     12,@@STACKT               . 004330 59C0 A828
         BH    OVER                      . 004334 4720 9664
         B     ABNSND                    . 004338 47F0 B084
                                                             SPACE
* NOTANY PROC  ANY                 NOTANY(S)
*      PUSH    NNYCCL              Save function descriptor
*      BRANCH  CHARZ
                                                             SPACE
NOTANY   L     11,@@ANY                  . 00433C 58B0 A948
         LD    0,NNYCCL                  . 004340 6800 9D90
         STD   0,104(12)                 . 004344 600C 0068
         AR    12,8                      . 004348 1AC8
         C     12,@@STACKT               . 00434A 59C0 A828
         BH    OVER                      . 00434E 4720 9664
         B     CHARZ                     . 004352 47F0 B072
                                                             SPACE
* SPAN PROC    ANY                 SPAN(S)
*      PUSH    SPNCCL              Save function descriptor
                                                             SPACE
SPAN     L     11,@@ANY                  . 004356 58B0 A948
         LD    0,SPNCCL                  . 00435A 6800 9DD8
         STD   0,104(12)                 . 00435E 600C 0068
         AR    12,8                      . 004362 1AC8
         C     12,@@STACKT               . 004364 59C0 A828
         BH    OVER                      . 004368 4720 9664
                                                             SPACE
* CHARZ PUSH   CHARCL              Save minimum length of one
                                                             SPACE
CHARZ    LD    0,CHARCL                  . 00436C 6800 9BF0
         STD   0,104(12)                 . 004370 600C 0068
         AR    12,8                      . 004374 1AC8
         C     12,@@STACKT               . 004376 59C0 A828
         BH    OVER                      . 00437A 4720 9664
                                                             SPACE
* ABNSND RCALL XPTR,ARGVAL,,FAIL   Evaluate argument
*      POP     (ZCL,YCL)           Restore descriptor and length
*      VEQLC   XPTR,S,,PATNOD      STRING is acceptable argument
*      VEQLC   XPTR,E,,PATNOD      So is EXPRESSION
*      VEQLC   XPTR,I,INTR1        INTEGER must be converted
*      RCALL   XPTR,GNVARI,XPTR
                                                             SPACE
ABNSND   LA    14,S4$0439A               . 00437E 41E0 B0A0
         STM   11,14,104(12)             . 004382 90BE C068
         LR    13,12                     . 004386 18DC
         LA    12,16(12)                 . 004388 41CC 0010
         C     12,@@STACKT               . 00438C 59C0 A828
         BH    OVER                      . 004390 4720 9664
         L     11,@@ARGVAL               . 004394 58B0 A914
         BR    11                        . 004398 07FB
S4$0439A STD   0,XPTR                    . 00439A 6000 A410
         B     FAIL                      . 00439E 47F0 9010
         LD    0,96(12)                  . 0043A2 680C 0060
         STD   0,ZCL                     . 0043A6 6000 A438
         LD    0,88(12)                  . 0043AA 680C 0058
         STD   0,YCL                     . 0043AE 6000 A420
         SR    12,8                      . 0043B2 1BC8
         SR    12,8                      . 0043B4 1BC8
         CLC   XPTR$5(3),@@S             . 0043B6 D502 A415 AA7B
         BE    PATNOD                    . 0043BC 4780 B102
         CLC   XPTR$5(3),@@E             . 0043C0 D502 A415 AA81
         BE    PATNOD                    . 0043C6 4780 B102
         CLC   XPTR$5(3),@@I             . 0043CA D502 A415 AA84
         BNE   INTR1                     . 0043D0 4770 95FC
         LA    14,S4$043F8               . 0043D4 41E0 B0FE
         STM   11,14,104(12)             . 0043D8 90BE C068
         LR    13,12                     . 0043DC 18DC
         LD    0,XPTR                    . 0043DE 6800 A410
         STD   0,120(12)                 . 0043E2 600C 0078
         LA    12,24(12)                 . 0043E6 41CC 0018
         C     12,@@STACKT               . 0043EA 59C0 A828
         BH    OVER                      . 0043EE 4720 9664
         L     11,@@GNVARI               . 0043F2 58B0 A94C
         BR    11                        . 0043F6 07FB
S4$043F8 STD   0,XPTR                    . 0043F8 6000 A410
                                                             SPACE
* PATNOD DEQL  XPTR,NULVCL,,NONAME                              E3.5.4
*      RCALL   TPTR,BLOCK,LNODSZ                                E3.5.4
*      MAKNOD  ZPTR,TPTR,ZCL,ZEROCL,YCL,XPTR
*                                  Construct the pattern
*      BRANCH  RTZPTR
                                                             SPACE
PATNOD   LA    14,S4$04420               . 0043FC 41E0 B126
         STM   11,14,104(12)             . 004400 90BE C068
         LR    13,12                     . 004404 18DC
         LD    0,LNODSZ                  . 004406 6800 9C48
         STD   0,120(12)                 . 00440A 600C 0078
         LA    12,24(12)                 . 00440E 41CC 0018
         C     12,@@STACKT               . 004412 59C0 A828
         BH    OVER                      . 004416 4720 9664
         L     11,@@BLOCK                . 00441A 58B0 A82C
         BR    11                        . 00441E 07FB
S4$04420 STD   0,TPTR                    . 004420 6000 A3D0
         LM    1,2,TPTR                  . 004424 9812 A3D0
         LM    3,4,YCL                   . 004428 9834 A420
         LR    5,0                       . 00442C 1850
         LR    6,0                       . 00442E 1860
         L     7,ZCL                     . 004430 5870 A438
         STM   3,7,8(1)                  . 004434 9037 1008
         LM    3,4,XPTR                  . 004438 9834 A410
         STM   3,4,32(1)                 . 00443C 9034 1020
         STM   1,2,ZPTR                  . 004440 9012 A440
         B     RTZPTR                    . 004444 47F0 9074
                                                             SPACE
* LEN  PROC    ANY                 LEN(N)
*      PUSH    LNTHCL              Save function descriptor
*      BRANCH  LPRTND
                                                             SPACE
LEN      L     11,@@ANY                  . 004448 58B0 A948
         LD    0,LNTHCL                  . 00444C 6800 9D80
         STD   0,104(12)                 . 004450 600C 0068
         AR    12,8                      . 004454 1AC8
         C     12,@@STACKT               . 004456 59C0 A828
         BH    OVER                      . 00445A 4720 9664
         B     LPRTND                    . 00445E 47F0 B1CC
                                                             SPACE
* POS  PROC    ANY                 POS(N)
*      PUSH    POSICL              Save function descriptor
*      BRANCH  LPRTND
                                                             SPACE
POS      L     11,@@ANY                  . 004462 58B0 A948
         LD    0,POSICL                  . 004466 6800 9D98
         STD   0,104(12)                 . 00446A 600C 0068
         AR    12,8                      . 00446E 1AC8
         C     12,@@STACKT               . 004470 59C0 A828
         BH    OVER                      . 004474 4720 9664
         B     LPRTND                    . 004478 47F0 B1CC
                                                             SPACE
* RPOS PROC    ANY                 RPOS(N)
*      PUSH    RPSICL              Save function descriptor
*      BRANCH  LPRTND
                                                             SPACE
RPOS     L     11,@@ANY                  . 00447C 58B0 A948
         LD    0,RPSICL                  . 004480 6800 9DA0
         STD   0,104(12)                 . 004484 600C 0068
         AR    12,8                      . 004488 1AC8
         C     12,@@STACKT               . 00448A 59C0 A828
         BH    OVER                      . 00448E 4720 9664
         B     LPRTND                    . 004492 47F0 B1CC
                                                             SPACE
* RTAB PROC    ANY                 RTAB(N)
*      PUSH    RTBCL               Save function descriptor
*      BRANCH  LPRTND
                                                             SPACE
RTAB     L     11,@@ANY                  . 004496 58B0 A948
         LD    0,RTBCL                   . 00449A 6800 9DA8
         STD   0,104(12)                 . 00449E 600C 0068
         AR    12,8                      . 0044A2 1AC8
         C     12,@@STACKT               . 0044A4 59C0 A828
         BH    OVER                      . 0044A8 4720 9664
         B     LPRTND                    . 0044AC 47F0 B1CC
                                                             SPACE
* TAB  PROC    ANY                 TAB(N)
*      PUSH    TBCL                Save function descriptor
                                                             SPACE
TAB      L     11,@@ANY                  . 0044B0 58B0 A948
         LD    0,TBCL                    . 0044B4 6800 9DE8
         STD   0,104(12)                 . 0044B8 600C 0068
         AR    12,8                      . 0044BC 1AC8
         C     12,@@STACKT               . 0044BE 59C0 A828
         BH    OVER                      . 0044C2 4720 9664
                                                             SPACE
* LPRTND RCALL XPTR,ARGVAL,,FAIL   Evaluate argument
*      POP     YCL                 Restore function descriptor
*      MOVD    ZCL,ZEROCL          Predict minimum length of zero
*      VEQLC   XPTR,I,,LPRTNI      If INTEGER check for LEN
*      VEQLC   XPTR,E,,PATNOD      EXPRESSION is acceptable
*      VEQLC   XPTR,S,INTR1        STRING must be converted to INTEGER
*      LOCSP   ZSP,XPTR            Get specifier
*      SPCINT  XPTR,ZSP,INTR1      Convert to INTEGER
                                                             SPACE
LPRTND   LA    14,S4$044E2               . 0044C6 41E0 B1E8
         STM   11,14,104(12)             . 0044CA 90BE C068
         LR    13,12                     . 0044CE 18DC
         LA    12,16(12)                 . 0044D0 41CC 0010
         C     12,@@STACKT               . 0044D4 59C0 A828
         BH    OVER                      . 0044D8 4720 9664
         L     11,@@ARGVAL               . 0044DC 58B0 A914
         BR    11                        . 0044E0 07FB
S4$044E2 STD   0,XPTR                    . 0044E2 6000 A410
         B     FAIL                      . 0044E6 47F0 9010
         LD    0,96(12)                  . 0044EA 680C 0060
         STD   0,YCL                     . 0044EE 6000 A420
         SR    12,8                      . 0044F2 1BC8
         LD    0,ZEROCL                  . 0044F4 6800 9C90
         STD   0,ZCL                     . 0044F8 6000 A438
         CLC   XPTR$5(3),@@I             . 0044FC D502 A415 AA84
         BE    LPRTNI                    . 004502 4780 B254
         CLC   XPTR$5(3),@@E             . 004506 D502 A415 AA81
         BE    PATNOD                    . 00450C 4780 B102
         CLC   XPTR$5(3),@@S             . 004510 D502 A415 AA7B
         BNE   INTR1                     . 004516 4770 95FC
         LM    3,4,XPTR                  . 00451A 9834 A410
         CR    0,3                       . 00451E 1903
         BNE   S4$0452C                  . 004520 4770 B232
         ST    0,ZSP                     . 004524 5000 A5F0
         B     S4$0453C                  . 004528 47F0 B242
S4$0452C L     1,4(3)                    . 00452C 5813 0004
         LA    1,0(1)                    . 004530 4111 0000
         LA    2,32                      . 004534 4120 0020
         STM   1,4,ZSP                   . 004538 9014 A5F0
S4$0453C L     15,@@DECBIN               . 00453C 58F0 A8EC
         LA    1,XPTR                    . 004540 4110 A410
         LA    2,ZSP                     . 004544 4120 A5F0
         BALR  14,15                          CALL                     *
                                         . 004548 05EF
         B     INTR1                     . 00454A 47F0 95FC
                                                             SPACE
* LPRTNI ACOMPC XPTR,0,,,LENERR                                 E3.6.1
*      DEQL    YCL,LNTHCL,PATNOD                                E3.6.1
*      MOVA    ZCL,XPTR            If so, use value of integer
*      BRANCH  PATNOD              Go form pattern
LPRTNI   CLC   YCL(8),LNTHCL             . 00454E D507 A420 9D80
         BNE   PATNOD                    . 004554 4770 B102
         L     1,XPTR                    . 004558 5810 A410
         ST    1,ZCL                     . 00455C 5010 A438
         B     PATNOD                    . 004560 47F0 B102
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      ARBNO(P)
*
                                                             SPACE
* ARBNO PROC   ,                   ARBNO(P)
*      RCALL   XPTR,PATVAL,,FAIL   Evaluate argument as pattern
*      VEQLC   XPTR,P,,ARBP        PATTERN is desired form
*      VEQLC   XPTR,S,INTR1        STRING must be made into PATTERN
*      LOCSP   TSP,XPTR            Get specifier
*      GETLG   TMVAL,TSP           Get length of string
*      RCALL   TPTR,BLOCK,LNODSZ   Allocate block for argument
*      MAKNOD  XPTR,TPTR,TMVAL,ZEROCL,CHRCL,XPTR
                                                             SPACE
         USING ARBNO,11                  .
ARBNO    LA    14,S4$04580               . 004564 41E0 B01C
         STM   11,14,104(12)             . 004568 90BE C068
         LR    13,12                     . 00456C 18DC
         LA    12,16(12)                 . 00456E 41CC 0010
         C     12,@@STACKT               . 004572 59C0 A828
         BH    OVER                      . 004576 4720 9664
         L     11,@@PATVAL               . 00457A 58B0 A950
         BR    11                        . 00457E 07FB
S4$04580 STD   0,XPTR                    . 004580 6000 A410
         B     FAIL                      . 004584 47F0 9010
         CLC   XPTR$5(3),@@P             . 004588 D502 A415 AA87
         BE    ARBP                      . 00458E 4780 B0AA
         CLC   XPTR$5(3),@@S             . 004592 D502 A415 AA7B
         BNE   INTR1                     . 004598 4770 95FC
         LM    3,4,XPTR                  . 00459C 9834 A410
         CR    0,3                       . 0045A0 1903
         BNE   S4$045AE                  . 0045A2 4770 B04A
         ST    0,TSP                     . 0045A6 5000 A5A0
         B     S4$045BE                  . 0045AA 47F0 B05A
S4$045AE L     1,4(3)                    . 0045AE 5813 0004
         LA    1,0(1)                    . 0045B2 4111 0000
         LA    2,32                      . 0045B6 4120 0020
         STM   1,4,TSP                   . 0045BA 9014 A5A0
S4$045BE L     15,TSP                    . 0045BE 58F0 A5A0
         STM   15,0,TMVAL                . 0045C2 90F0 A3C8
         LA    14,S4$045EA               . 0045C6 41E0 B086
         STM   11,14,104(12)             . 0045CA 90BE C068
         LR    13,12                     . 0045CE 18DC
         LD    0,LNODSZ                  . 0045D0 6800 9C48
         STD   0,120(12)                 . 0045D4 600C 0078
         LA    12,24(12)                 . 0045D8 41CC 0018
         C     12,@@STACKT               . 0045DC 59C0 A828
         BH    OVER                      . 0045E0 4720 9664
         L     11,@@BLOCK                . 0045E4 58B0 A82C
         BR    11                        . 0045E8 07FB
S4$045EA STD   0,TPTR                    . 0045EA 6000 A3D0
         LM    1,2,TPTR                  . 0045EE 9812 A3D0
         LM    3,4,CHRCL                 . 0045F2 9834 9CF8
         LR    5,0                       . 0045F6 1850
         LR    6,0                       . 0045F8 1860
         L     7,TMVAL                   . 0045FA 5870 A3C8
         STM   3,7,8(1)                  . 0045FE 9037 1008
         LM    3,4,XPTR                  . 004602 9834 A410
         STM   3,4,32(1)                 . 004606 9034 1020
         STM   1,2,XPTR                  . 00460A 9012 A410
                                                             SPACE
* ARBP GETSIZ  XSIZ,XPTR           Get size of pattern
*      SUM     TSIZ,XSIZ,ARBSIZ    Add additional space for ARBNO node
*      SETVC   TSIZ,P              Insert PATTERN data type
*      RCALL   TPTR,BLOCK,TSIZ     Allocate block for pattern
*      MOVD    ZPTR,TPTR           Save pointer to return
*      GETSIZ  TSIZ,ARHEAD         Set up copy for heading node
*      CPYPAT  TPTR,ARHEAD,ZEROCL,ZEROCL,ZEROCL,TSIZ
*      SUM     ZSIZ,XSIZ,TSIZ
*      CPYPAT  TPTR,XPTR,ZEROCL,TSIZ,ZSIZ,XSIZ
*      SUM     TSIZ,NODSIZ,NODSIZ  Set up size for trailing node
*      CPYPAT  TPTR,ARTAIL,ZEROCL,ZSIZ,ZEROCL,TSIZ
*      SUM     ZSIZ,TSIZ,ZSIZ      Set up size for backup node
*      CPYPAT  TPTR,ARBACK,ZEROCL,ZSIZ,TSIZ,TSIZ
*      BRANCH  RTZPTR
ARBP     L     15,XPTR                   . 00460E 58F0 A410
         L     15,4(15)                  . 004612 58FF 0004
         LA    15,0(15)                  . 004616 41FF 0000
         STM   15,0,XSIZ                 . 00461A 90F0 A418
         LM    1,2,XSIZ                  . 00461E 9812 A418
         A     1,ARBSIZ                  . 004622 5A10 9BE8
         STM   1,2,TSIZ                  . 004626 9012 A3E0
         MVC   TSIZ$5(3),@@P             . 00462A D202 A3E5 AA87
         LA    14,S4$04654               . 004630 41E0 B0F0
         STM   11,14,104(12)             . 004634 90BE C068
         LR    13,12                     . 004638 18DC
         LD    0,TSIZ                    . 00463A 6800 A3E0
         STD   0,120(12)                 . 00463E 600C 0078
         LA    12,24(12)                 . 004642 41CC 0018
         C     12,@@STACKT               . 004646 59C0 A828
         BH    OVER                      . 00464A 4720 9664
         L     11,@@BLOCK                . 00464E 58B0 A82C
         BR    11                        . 004652 07FB
S4$04654 STD   0,TPTR                    . 004654 6000 A3D0
         STD   0,ZPTR                    . 004658 6000 A440
         L     15,ARHEAD                 . 00465C 58F0 9CB8
         L     15,4(15)                  . 004660 58FF 0004
         LA    15,0(15)                  . 004664 41FF 0000
         STM   15,0,TSIZ                 . 004668 90F0 A3E0
         L     15,@@COPL                 . 00466C 58F0 A954
         LA    2,TPTR                    . 004670 4120 A3D0
         L     3,ARHEAD                  . 004674 5830 9CB8
         LR    4,0                       . 004678 1840
         LR    5,0                       . 00467A 1850
         LR    6,0                       . 00467C 1860
         L     7,TSIZ                    . 00467E 5870 A3E0
         BALR  14,15                          CALL                     *
                                         . 004682 05EF
         LM    1,2,XSIZ                  . 004684 9812 A418
         A     1,TSIZ                    . 004688 5A10 A3E0
         STM   1,2,ZSIZ                  . 00468C 9012 A448
         L     15,@@COPL                 . 004690 58F0 A954
         LA    2,TPTR                    . 004694 4120 A3D0
         L     3,XPTR                    . 004698 5830 A410
         LR    4,0                       . 00469C 1840
         L     5,TSIZ                    . 00469E 5850 A3E0
         LR    6,1                       . 0046A2 1861
         L     7,XSIZ                    . 0046A4 5870 A418
         BALR  14,15                          CALL                     *
                                         . 0046A8 05EF
         LM    1,2,NODSIZ                . 0046AA 9812 9C50
         A     1,NODSIZ                  . 0046AE 5A10 9C50
         STM   1,2,TSIZ                  . 0046B2 9012 A3E0
         L     15,@@COPL                 . 0046B6 58F0 A954
         LA    2,TPTR                    . 0046BA 4120 A3D0
         L     3,ARTAIL                  . 0046BE 5830 9CC0
         LR    4,0                       . 0046C2 1840
         L     5,ZSIZ                    . 0046C4 5850 A448
         LR    6,0                       . 0046C8 1860
         LR    7,1                       . 0046CA 1871
         BALR  14,15                          CALL                     *
                                         . 0046CC 05EF
         LM    1,2,TSIZ                  . 0046CE 9812 A3E0
         A     1,ZSIZ                    . 0046D2 5A10 A448
         STM   1,2,ZSIZ                  . 0046D6 9012 A448
         L     15,@@COPL                 . 0046DA 58F0 A954
         LA    2,TPTR                    . 0046DE 4120 A3D0
         L     3,ARBACK                  . 0046E2 5830 9CB0
         LR    4,0                       . 0046E6 1840
         LR    5,1                       . 0046E8 1851
         L     6,TSIZ                    . 0046EA 5860 A3E0
         LR    7,6                       . 0046EE 1876
         BALR  14,15                          CALL                     *
                                         . 0046F0 05EF
         B     RTZPTR                    . 0046F2 47F0 9074
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      @X
*
                                                             SPACE
* ATOP PROC    ,                   @X
*      INCRA   OCICL,DESCR         Increment interpreter offset
*      GETD    YPTR,OCBSCL,OCICL   Get object code descriptor
*      TESTF   YPTR,FNC,ATOP1      Test for function descriptor
*      RCALL   YPTR,INVOKE,YPTR,(FAIL,ATOP1,)
*      VEQLC   YPTR,E,NEMO         Only EXPRESSION can be value
                                                             SPACE
         USING ATOP,11                   .
ATOP     L     1,OCICL                   . 0046F6 5810 9ED8
         AR    1,8                       . 0046FA 1A18
         ST    1,OCICL                   . 0046FC 5010 9ED8
         L     2,OCBSCL                  . 004700 5820 A470
         LD    0,0(1,2)                  . 004704 6801 2000
         STD   0,YPTR                    . 004708 6000 A428
         TM    YPTR$4,X'04'              . 00470C 9104 A42C
         BNO   S4$0474E                  . 004710 47E0 B058
         LA    14,ATOP1                  . 004714 41E0 B03E
         STM   11,14,104(12)             . 004718 90BE C068
         LR    13,12                     . 00471C 18DC
         STD   0,120(12)                 . 00471E 600C 0078
         LA    12,24(12)                 . 004722 41CC 0018
         C     12,@@STACKT               . 004726 59C0 A828
         BH    OVER                      . 00472A 4720 9664
         L     11,@@INVOKE               . 00472E 58B0 A91C
         BR    11                        . 004732 07FB
                                                             SPACE
* ATOP1 RCALL  TPTR,BLOCK,LNODSZ   Allocate pattern node
*      MAKNOD  ZPTR,TPTR,ZEROCL,ZEROCL,ATOPCL,YPTR
*      BRANCH  RTZPTR
ATOP1    STD   0,YPTR                    . 004734 6000 A428
         B     FAIL                      . 004738 47F0 9010
         B     S4$0474E                  . 00473C 47F0 B058
         B     S4$04744                  . 004740 47F0 B04E
S4$04744 CLC   YPTR$5(3),@@E             . 004744 D502 A42D AA81
         BNE   NEMO                      . 00474A 4770 964C
S4$0474E LA    14,S4$04772               . 00474E 41E0 B07C
         STM   11,14,104(12)             . 004752 90BE C068
         LR    13,12                     . 004756 18DC
         LD    0,LNODSZ                  . 004758 6800 9C48
         STD   0,120(12)                 . 00475C 600C 0078
         LA    12,24(12)                 . 004760 41CC 0018
         C     12,@@STACKT               . 004764 59C0 A828
         BH    OVER                      . 004768 4720 9664
         L     11,@@BLOCK                . 00476C 58B0 A82C
         BR    11                        . 004770 07FB
S4$04772 STD   0,TPTR                    . 004772 6000 A3D0
         LM    1,2,TPTR                  . 004776 9812 A3D0
         LM    3,4,ATOPCL                . 00477A 9834 9CE0
         LR    5,0                       . 00477E 1850
         LR    6,0                       . 004780 1860
         LR    7,0                       . 004782 1870
         STM   3,7,8(1)                  . 004784 9037 1008
         LM    3,4,YPTR                  . 004788 9834 A428
         STM   3,4,32(1)                 . 00478C 9034 1020
         STM   1,2,ZPTR                  . 004790 9012 A440
         B     RTZPTR                    . 004794 47F0 9074
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Value Assignment Operators
*
                                                             SPACE
* NAM  PROC    ,                   X . Y
*      PUSH    ENMECL              Save function descriptor
*      BRANCH  NAM5                Join processing
                                                             SPACE
         USING NAM,11                    .
NAM      LD    0,ENMECL                  . 004798 6800 9D28
         STD   0,104(12)                 . 00479C 600C 0068
         AR    12,8                      . 0047A0 1AC8
         C     12,@@STACKT               . 0047A2 59C0 A828
         BH    OVER                      . 0047A6 4720 9664
         B     NAM5                      . 0047AA 47F0 B02C
                                                             SPACE
* DOL  PROC    NAM                 X $ Y
*      PUSH    ENMICL              Save function descritpor
                                                             SPACE
DOL      L     11,@@NAM                  . 0047AE 58B0 A958
         LD    0,ENMICL                  . 0047B2 6800 9D30
         STD   0,104(12)                 . 0047B6 600C 0068
         AR    12,8                      . 0047BA 1AC8
         C     12,@@STACKT               . 0047BC 59C0 A828
         BH    OVER                      . 0047C0 4720 9664
                                                             SPACE
* NAM5 RCALL   XPTR,PATVAL,,FAIL   Get pattern for first argument
*      INCRA   OCICL,DESCR         Increment offset
*      GETD    YPTR,OCBSCL,OCICL   Get object code descriptor
*      TESTF   YPTR,FNC,,NAMC2     Check for function
                                                             SPACE
NAM5     LA    14,S4$047E0               . 0047C4 41E0 B048
         STM   11,14,104(12)             . 0047C8 90BE C068
         LR    13,12                     . 0047CC 18DC
         LA    12,16(12)                 . 0047CE 41CC 0010
         C     12,@@STACKT               . 0047D2 59C0 A828
         BH    OVER                      . 0047D6 4720 9664
         L     11,@@PATVAL               . 0047DA 58B0 A950
         BR    11                        . 0047DE 07FB
S4$047E0 STD   0,XPTR                    . 0047E0 6000 A410
         B     FAIL                      . 0047E4 47F0 9010
         L     1,OCICL                   . 0047E8 5810 9ED8
         AR    1,8                       . 0047EC 1A18
         ST    1,OCICL                   . 0047EE 5010 9ED8
         L     2,OCBSCL                  . 0047F2 5820 A470
         LD    0,0(1,2)                  . 0047F6 6801 2000
         STD   0,YPTR                    . 0047FA 6000 A428
         TM    YPTR$4,X'04'              . 0047FE 9104 A42C
         BO    NAMC2                     . 004802 4710 B086
                                                             SPACE
* NAM3 VEQLC   XPTR,S,,NAMV        Is first argument STRING?
*      VEQLC   XPTR,P,INTR1,NAMP   Is it PATTERN?
                                                             SPACE
NAM3     CLC   XPTR$5(3),@@S             . 004806 D502 A415 AA7B
         BE    NAMV                      . 00480C 4780 B0E4
         CLC   XPTR$5(3),@@P             . 004810 D502 A415 AA87
         BNE   INTR1                     . 004816 4770 95FC
         BE    NAMP                      . 00481A 4780 B156
                                                             SPACE
* NAMC2 PUSH   XPTR                Save first argument
*      RCALL   YPTR,INVOKE,YPTR,(FAIL,NAM4,)
*                                  Evaluate second argument
*      VEQLC   YPTR,E,NEMO         Verify EXPRESSION
                                                             SPACE
NAMC2    LD    0,XPTR                    . 00481E 6800 A410
         STD   0,104(12)                 . 004822 600C 0068
         AR    12,8                      . 004826 1AC8
         C     12,@@STACKT               . 004828 59C0 A828
         BH    OVER                      . 00482C 4720 9664
         LA    14,S4$04854               . 004830 41E0 B0BC
         STM   11,14,104(12)             . 004834 90BE C068
         LR    13,12                     . 004838 18DC
         LD    0,YPTR                    . 00483A 6800 A428
         STD   0,120(12)                 . 00483E 600C 0078
         LA    12,24(12)                 . 004842 41CC 0018
         C     12,@@STACKT               . 004846 59C0 A828
         BH    OVER                      . 00484A 4720 9664
         L     11,@@INVOKE               . 00484E 58B0 A91C
         BR    11                        . 004852 07FB
S4$04854 STD   0,YPTR                    . 004854 6000 A428
         B     FAIL                      . 004858 47F0 9010
         B     NAM4                      . 00485C 47F0 B0D6
         B     S4$04864                  . 004860 47F0 B0CC
S4$04864 CLC   YPTR$5(3),@@E             . 004864 D502 A42D AA81
         BNE   NEMO                      . 00486A 4770 964C
                                                             SPACE
* NAM4 POP     XPTR                Restore first argument
*      BRANCH  NAM3                Join processing
                                                             SPACE
NAM4     LD    0,96(12)                  . 00486E 680C 0060
         STD   0,XPTR                    . 004872 6000 A410
         SR    12,8                      . 004876 1BC8
         B     NAM3                      . 004878 47F0 B06E
                                                             SPACE
* NAMV LOCSP   TSP,XPTR            Get specifier
*      GETLG   TMVAL,TSP           Get length
*      RCALL   TPTR,BLOCK,LNODSZ   Allocate block for pattern
*      MAKNOD  XPTR,TPTR,TMVAL,ZEROCL,CHRCL,XPTR
*                                  Make pattern node
                                                             SPACE
NAMV     LM    3,4,XPTR                  . 00487C 9834 A410
         CR    0,3                       . 004880 1903
         BNE   S4$0488E                  . 004882 4770 B0F6
         ST    0,TSP                     . 004886 5000 A5A0
         B     S4$0489E                  . 00488A 47F0 B106
S4$0488E L     1,4(3)                    . 00488E 5813 0004
         LA    1,0(1)                    . 004892 4111 0000
         LA    2,32                      . 004896 4120 0020
         STM   1,4,TSP                   . 00489A 9014 A5A0
S4$0489E L     15,TSP                    . 00489E 58F0 A5A0
         STM   15,0,TMVAL                . 0048A2 90F0 A3C8
         LA    14,S4$048CA               . 0048A6 41E0 B132
         STM   11,14,104(12)             . 0048AA 90BE C068
         LR    13,12                     . 0048AE 18DC
         LD    0,LNODSZ                  . 0048B0 6800 9C48
         STD   0,120(12)                 . 0048B4 600C 0078
         LA    12,24(12)                 . 0048B8 41CC 0018
         C     12,@@STACKT               . 0048BC 59C0 A828
         BH    OVER                      . 0048C0 4720 9664
         L     11,@@BLOCK                . 0048C4 58B0 A82C
         BR    11                        . 0048C8 07FB
S4$048CA STD   0,TPTR                    . 0048CA 6000 A3D0
         LM    1,2,TPTR                  . 0048CE 9812 A3D0
         LM    3,4,CHRCL                 . 0048D2 9834 9CF8
         LR    5,0                       . 0048D6 1850
         LR    6,0                       . 0048D8 1860
         L     7,TMVAL                   . 0048DA 5870 A3C8
         STM   3,7,8(1)                  . 0048DE 9037 1008
         LM    3,4,XPTR                  . 0048E2 9834 A410
         STM   3,4,32(1)                 . 0048E6 9034 1020
         STM   1,2,XPTR                  . 0048EA 9012 A410
                                                             SPACE
* NAMP RCALL   TPTR,BLOCK,SNODSZ   Allocate block for pattern
*      MAKNOD  WPTR,TPTR,ZEROCL,ZEROCL,NMECL
*                                  Make node for naming
*      RCALL   TPTR,BLOCK,LNODSZ   Allocate block for  pattern
*      POP     TVAL                Restore function descriptor
*      MAKNOD  YPTR,TPTR,ZEROCL,ZEROCL,TVAL,YPTR
*                                  Make pattern for backup
*      GETSIZ  XSIZ,XPTR           Get size of first pattern
*      SUM     YSIZ,XSIZ,NODSIZ    Compute total size
*      GETSIZ  TSIZ,YPTR           Get size of naming node
*      SUM     ZSIZ,YSIZ,TSIZ      Compute total
*      SETVC   ZSIZ,P              Insert PATTERN data type
*      RCALL   TPTR,BLOCK,ZSIZ     Allocate block for total pattern
*      MOVD    ZPTR,TPTR           Save copy
*      LVALUE  TVAL,XPTR           Get least value
*      CPYPAT  TPTR,WPTR,TVAL,ZEROCL,NODSIZ,NODSIZ
*                                  Copy three patterns
*      CPYPAT  TPTR,XPTR,ZEROCL,NODSIZ,YSIZ,XSIZ
*      CPYPAT  TPTR,YPTR,ZEROCL,YSIZ,ZEROCL,TSIZ
*      BRANCH  RTZPTR              Return pattern as value
NAMP     LA    14,S4$04912               . 0048EE 41E0 B17A
         STM   11,14,104(12)             . 0048F2 90BE C068
         LR    13,12                     . 0048F6 18DC
         LD    0,SNODSZ                  . 0048F8 6800 9C80
         STD   0,120(12)                 . 0048FC 600C 0078
         LA    12,24(12)                 . 004900 41CC 0018
         C     12,@@STACKT               . 004904 59C0 A828
         BH    OVER                      . 004908 4720 9664
         L     11,@@BLOCK                . 00490C 58B0 A82C
         BR    11                        . 004910 07FB
S4$04912 STD   0,TPTR                    . 004912 6000 A3D0
         LM    1,2,TPTR                  . 004916 9812 A3D0
         LM    3,4,NMECL                 . 00491A 9834 9D88
         LR    5,0                       . 00491E 1850
         LR    6,0                       . 004920 1860
         LR    7,0                       . 004922 1870
         STM   3,7,8(1)                  . 004924 9037 1008
         STM   1,2,WPTR                  . 004928 9012 A400
         LA    14,S4$04950               . 00492C 41E0 B1B8
         STM   11,14,104(12)             . 004930 90BE C068
         LR    13,12                     . 004934 18DC
         LD    0,LNODSZ                  . 004936 6800 9C48
         STD   0,120(12)                 . 00493A 600C 0078
         LA    12,24(12)                 . 00493E 41CC 0018
         C     12,@@STACKT               . 004942 59C0 A828
         BH    OVER                      . 004946 4720 9664
         L     11,@@BLOCK                . 00494A 58B0 A82C
         BR    11                        . 00494E 07FB
S4$04950 STD   0,TPTR                    . 004950 6000 A3D0
         LD    0,96(12)                  . 004954 680C 0060
         STD   0,TVAL                    . 004958 6000 A3E8
         SR    12,8                      . 00495C 1BC8
         LM    1,2,TPTR                  . 00495E 9812 A3D0
         LM    3,4,TVAL                  . 004962 9834 A3E8
         LR    5,0                       . 004966 1850
         LR    6,0                       . 004968 1860
         LR    7,0                       . 00496A 1870
         STM   3,7,8(1)                  . 00496C 9037 1008
         LM    3,4,YPTR                  . 004970 9834 A428
         STM   3,4,32(1)                 . 004974 9034 1020
         STM   1,2,YPTR                  . 004978 9012 A428
         L     15,XPTR                   . 00497C 58F0 A410
         L     15,4(15)                  . 004980 58FF 0004
         LA    15,0(15)                  . 004984 41FF 0000
         STM   15,0,XSIZ                 . 004988 90F0 A418
         LM    1,2,XSIZ                  . 00498C 9812 A418
         A     1,NODSIZ                  . 004990 5A10 9C50
         STM   1,2,YSIZ                  . 004994 9012 A430
         L     15,YPTR                   . 004998 58F0 A428
         L     15,4(15)                  . 00499C 58FF 0004
         LA    15,0(15)                  . 0049A0 41FF 0000
         STM   15,0,TSIZ                 . 0049A4 90F0 A3E0
         AR    1,15                      . 0049A8 1A1F
         STM   1,2,ZSIZ                  . 0049AA 9012 A448
         MVC   ZSIZ$5(3),@@P             . 0049AE D202 A44D AA87
         LA    14,S4$049D8               . 0049B4 41E0 B240
         STM   11,14,104(12)             . 0049B8 90BE C068
         LR    13,12                     . 0049BC 18DC
         LD    0,ZSIZ                    . 0049BE 6800 A448
         STD   0,120(12)                 . 0049C2 600C 0078
         LA    12,24(12)                 . 0049C6 41CC 0018
         C     12,@@STACKT               . 0049CA 59C0 A828
         BH    OVER                      . 0049CE 4720 9664
         L     11,@@BLOCK                . 0049D2 58B0 A82C
         BR    11                        . 0049D6 07FB
S4$049D8 STD   0,TPTR                    . 0049D8 6000 A3D0
         STD   0,ZPTR                    . 0049DC 6000 A440
         L     15,@@LVAL                 . 0049E0 58F0 A95C
         LA    1,TVAL                    . 0049E4 4110 A3E8
         L     2,XPTR                    . 0049E8 5820 A410
         BALR  14,15                          CALL                     *
                                         . 0049EC 05EF
         L     15,@@COPL                 . 0049EE 58F0 A954
         LA    2,TPTR                    . 0049F2 4120 A3D0
         L     3,WPTR                    . 0049F6 5830 A400
         L     4,TVAL                    . 0049FA 5840 A3E8
         LR    5,0                       . 0049FE 1850
         L     6,NODSIZ                  . 004A00 5860 9C50
         L     7,NODSIZ                  . 004A04 5870 9C50
         BALR  14,15                          CALL                     *
                                         . 004A08 05EF
         L     15,@@COPL                 . 004A0A 58F0 A954
         LA    2,TPTR                    . 004A0E 4120 A3D0
         L     3,XPTR                    . 004A12 5830 A410
         LR    4,0                       . 004A16 1840
         L     5,NODSIZ                  . 004A18 5850 9C50
         L     6,YSIZ                    . 004A1C 5860 A430
         L     7,XSIZ                    . 004A20 5870 A418
         BALR  14,15                          CALL                     *
                                         . 004A24 05EF
         L     15,@@COPL                 . 004A26 58F0 A954
         LA    2,TPTR                    . 004A2A 4120 A3D0
         L     3,YPTR                    . 004A2E 5830 A428
         LR    4,0                       . 004A32 1840
         L     5,YSIZ                    . 004A34 5850 A430
         LR    6,0                       . 004A38 1860
         L     7,TSIZ                    . 004A3A 5870 A3E0
         BALR  14,15                          CALL                     *
                                         . 004A3E 05EF
         B     RTZPTR                    . 004A40 47F0 9074
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Binary Alternation Operator
*
                                                             SPACE
* OR   PROC    ,                   X | Y
*      RCALL   XPTR,PATVAL,,FAIL   Get first argument
*      PUSH    XPTR                Save first argument
*      RCALL   YPTR,PATVAL,,FAIL   Get second argument
*      POP     XPTR                Restore first argument
*      SETAV   DTCL,XPTR           Get first data type
*      MOVV    DTCL,YPTR           Insert second data type
*      DEQL    DTCL,VVDTP,,ORVV    Is it STRING-STRING?
*      DEQL    DTCL,VPDTP,,ORVP    Is it STRING-PATTERN?
*      DEQL    DTCL,PVDTP,,ORPV    Is it PATTERN-STRING?
*      DEQL    DTCL,PPDTP,INTR1,ORPP
*                                  Is it PATTERN_PATTERN?
                                                             SPACE
         USING OR,11                     .
OR       LA    14,S4$04A60               . 004A44 41E0 B01C
         STM   11,14,104(12)             . 004A48 90BE C068
         LR    13,12                     . 004A4C 18DC
         LA    12,16(12)                 . 004A4E 41CC 0010
         C     12,@@STACKT               . 004A52 59C0 A828
         BH    OVER                      . 004A56 4720 9664
         L     11,@@PATVAL               . 004A5A 58B0 A950
         BR    11                        . 004A5E 07FB
S4$04A60 STD   0,XPTR                    . 004A60 6000 A410
         B     FAIL                      . 004A64 47F0 9010
         LD    0,XPTR                    . 004A68 6800 A410
         STD   0,104(12)                 . 004A6C 600C 0068
         AR    12,8                      . 004A70 1AC8
         C     12,@@STACKT               . 004A72 59C0 A828
         BH    OVER                      . 004A76 4720 9664
         LA    14,S4$04A96               . 004A7A 41E0 B052
         STM   11,14,104(12)             . 004A7E 90BE C068
         LR    13,12                     . 004A82 18DC
         LA    12,16(12)                 . 004A84 41CC 0010
         C     12,@@STACKT               . 004A88 59C0 A828
         BH    OVER                      . 004A8C 4720 9664
         L     11,@@PATVAL               . 004A90 58B0 A950
         BR    11                        . 004A94 07FB
S4$04A96 STD   0,YPTR                    . 004A96 6000 A428
         B     FAIL                      . 004A9A 47F0 9010
         LD    0,96(12)                  . 004A9E 680C 0060
         STD   0,XPTR                    . 004AA2 6000 A410
         SR    12,8                      . 004AA6 1BC8
         L     15,XPTR$4                 . 004AA8 58F0 A414
         LA    15,0(15)                  . 004AAC 41FF 0000
         STM   15,0,DTCL                 . 004AB0 90F0 9E40
         MVC   DTCL$5(3),YPTR$5          . 004AB4 D202 9E45 A42D
         CLC   DTCL(8),VVDTP             . 004ABA D507 9E40 9B60
         BE    ORVV                      . 004AC0 4780 B0A2
         CLC   DTCL(8),VPDTP             . 004AC4 D507 9E40 9B50
         BE    ORVP                      . 004ACA 4780 B238
         CLC   DTCL(8),PVDTP             . 004ACE D507 9E40 9B08
         BE    ORPP                      . 004AD4 4780 B114
         CLC   DTCL(8),PPDTP             . 004AD8 D507 9E40 9B00
         BNE   INTR1                     . 004ADE 4770 95FC
         BE    S4$04BCA                  . 004AE2 4780 B186
                                                             SPACE
* ORVV LOCSP   XSP,XPTR            Get specifier
*      GETLG   TMVAL,XSP           Get length
*      RCALL   TPTR,BLOCK,LNODSZ   Get block for pattern
*      MAKNOD  XPTR,TPTR,TMVAL,ZEROCL,CHRCL,XPTR
*                                  Construct pattern
                                                             SPACE
ORVV     LM    3,4,XPTR                  . 004AE6 9834 A410
         CR    0,3                       . 004AEA 1903
         BNE   S4$04AF8                  . 004AEC 4770 B0B4
         ST    0,XSP                     . 004AF0 5000 A5D0
         B     ORPV                      . 004AF4 47F0 B0C4
S4$04AF8 L     1,4(3)                    . 004AF8 5813 0004
         LA    1,0(1)                    . 004AFC 4111 0000
         LA    2,32                      . 004B00 4120 0020
         STM   1,4,XSP                   . 004B04 9014 A5D0
                                                             SPACE
* ORPV LOCSP   YSP,YPTR            Get specifier
*      GETLG   TMVAL,YSP           Get length
*      RCALL   TPTR,BLOCK,LNODSZ   Get block for pattern
*      MAKNOD  YPTR,TPTR,TMVAL,ZEROCL,CHRCL,YPTR
*                                  Construct pattern
                                                             SPACE
ORPV     L     15,XSP                    . 004B08 58F0 A5D0
         STM   15,0,TMVAL                . 004B0C 90F0 A3C8
         LA    14,S4$04B34               . 004B10 41E0 B0F0
         STM   11,14,104(12)             . 004B14 90BE C068
         LR    13,12                     . 004B18 18DC
         LD    0,LNODSZ                  . 004B1A 6800 9C48
         STD   0,120(12)                 . 004B1E 600C 0078
         LA    12,24(12)                 . 004B22 41CC 0018
         C     12,@@STACKT               . 004B26 59C0 A828
         BH    OVER                      . 004B2A 4720 9664
         L     11,@@BLOCK                . 004B2E 58B0 A82C
         BR    11                        . 004B32 07FB
S4$04B34 STD   0,TPTR                    . 004B34 6000 A3D0
         LM    1,2,TPTR                  . 004B38 9812 A3D0
         LM    3,4,CHRCL                 . 004B3C 9834 9CF8
         LR    5,0                       . 004B40 1850
         LR    6,0                       . 004B42 1860
         L     7,TMVAL                   . 004B44 5870 A3C8
         STM   3,7,8(1)                  . 004B48 9037 1008
         LM    3,4,XPTR                  . 004B4C 9834 A410
         STM   3,4,32(1)                 . 004B50 9034 1020
         STM   1,2,XPTR                  . 004B54 9012 A410
                                                             SPACE
* ORPP GETSIZ  XSIZ,XPTR           Get size of first pattern
*      GETSIZ  YSIZ,YPTR           Get size of second pattern
*      SUM     TSIZ,XSIZ,YSIZ      Compute total size
*      SETVC   TSIZ,P              Insert PATTERN data type
*      RCALL   TPTR,BLOCK,TSIZ     Allocate block for pattern
*      MOVD    ZPTR,TPTR           Save copy
*      CPYPAT  TPTR,XPTR,ZEROCL,ZEROCL,ZEROCL,XSIZ
*                                  Copy first pattern
*      CPYPAT  TPTR,YPTR,ZEROCL,XSIZ,ZEROCL,YSIZ
*                                  Copy second pattern
*      LINKOR  ZPTR,XSIZ           Link alternatives
*      BRANCH  RTZPTR              Return pattern as value
                                                             SPACE
ORPP     LM    3,4,YPTR                  . 004B58 9834 A428
         CR    0,3                       . 004B5C 1903
         BNE   S4$04B6A                  . 004B5E 4770 B126
         ST    0,YSP                     . 004B62 5000 A5E0
         B     S4$04B7A                  . 004B66 47F0 B136
S4$04B6A L     1,4(3)                    . 004B6A 5813 0004
         LA    1,0(1)                    . 004B6E 4111 0000
         LA    2,32                      . 004B72 4120 0020
         STM   1,4,YSP                   . 004B76 9014 A5E0
S4$04B7A L     15,YSP                    . 004B7A 58F0 A5E0
         STM   15,0,TMVAL                . 004B7E 90F0 A3C8
         LA    14,S4$04BA6               . 004B82 41E0 B162
         STM   11,14,104(12)             . 004B86 90BE C068
         LR    13,12                     . 004B8A 18DC
         LD    0,LNODSZ                  . 004B8C 6800 9C48
         STD   0,120(12)                 . 004B90 600C 0078
         LA    12,24(12)                 . 004B94 41CC 0018
         C     12,@@STACKT               . 004B98 59C0 A828
         BH    OVER                      . 004B9C 4720 9664
         L     11,@@BLOCK                . 004BA0 58B0 A82C
         BR    11                        . 004BA4 07FB
S4$04BA6 STD   0,TPTR                    . 004BA6 6000 A3D0
         LM    1,2,TPTR                  . 004BAA 9812 A3D0
         LM    3,4,CHRCL                 . 004BAE 9834 9CF8
         LR    5,0                       . 004BB2 1850
         LR    6,0                       . 004BB4 1860
         L     7,TMVAL                   . 004BB6 5870 A3C8
         STM   3,7,8(1)                  . 004BBA 9037 1008
         LM    3,4,YPTR                  . 004BBE 9834 A428
         STM   3,4,32(1)                 . 004BC2 9034 1020
         STM   1,2,YPTR                  . 004BC6 9012 A428
S4$04BCA L     15,XPTR                   . 004BCA 58F0 A410
         L     15,4(15)                  . 004BCE 58FF 0004
         LA    15,0(15)                  . 004BD2 41FF 0000
         STM   15,0,XSIZ                 . 004BD6 90F0 A418
         L     15,YPTR                   . 004BDA 58F0 A428
         L     15,4(15)                  . 004BDE 58FF 0004
         LA    15,0(15)                  . 004BE2 41FF 0000
         STM   15,0,YSIZ                 . 004BE6 90F0 A430
         LM    1,2,XSIZ                  . 004BEA 9812 A418
         AR    1,15                      . 004BEE 1A1F
         STM   1,2,TSIZ                  . 004BF0 9012 A3E0
         MVC   TSIZ$5(3),@@P             . 004BF4 D202 A3E5 AA87
         LA    14,S4$04C1E               . 004BFA 41E0 B1DA
         STM   11,14,104(12)             . 004BFE 90BE C068
         LR    13,12                     . 004C02 18DC
         LD    0,TSIZ                    . 004C04 6800 A3E0
         STD   0,120(12)                 . 004C08 600C 0078
         LA    12,24(12)                 . 004C0C 41CC 0018
         C     12,@@STACKT               . 004C10 59C0 A828
         BH    OVER                      . 004C14 4720 9664
         L     11,@@BLOCK                . 004C18 58B0 A82C
         BR    11                        . 004C1C 07FB
S4$04C1E STD   0,TPTR                    . 004C1E 6000 A3D0
         STD   0,ZPTR                    . 004C22 6000 A440
         L     15,@@COPL                 . 004C26 58F0 A954
         LA    2,TPTR                    . 004C2A 4120 A3D0
         L     3,XPTR                    . 004C2E 5830 A410
         LR    4,0                       . 004C32 1840
         LR    5,0                       . 004C34 1850
         LR    6,0                       . 004C36 1860
         L     7,XSIZ                    . 004C38 5870 A418
         BALR  14,15                          CALL                     *
                                         . 004C3C 05EF
         L     15,@@COPL                 . 004C3E 58F0 A954
         LA    2,TPTR                    . 004C42 4120 A3D0
         L     3,YPTR                    . 004C46 5830 A428
         LR    4,0                       . 004C4A 1840
         L     5,XSIZ                    . 004C4C 5850 A418
         LR    6,0                       . 004C50 1860
         L     7,YSIZ                    . 004C52 5870 A430
         BALR  14,15                          CALL                     *
                                         . 004C56 05EF
         L     1,ZPTR                    . 004C58 5810 A440
         LR    2,1                       . 004C5C 1821
S4$04C5E L     3,16(2)                   . 004C5E 5832 0010
         CR    3,0                       . 004C62 1930
         BE    S4$04C70                  . 004C64 4780 B22C
         AR    3,1                       . 004C68 1A31
         LR    2,3                       . 004C6A 1823
         B     S4$04C5E                  . 004C6C 47F0 B21A
S4$04C70 L     1,XSIZ                    . 004C70 5810 A418
         ST    1,16(2)                   . 004C74 5012 0010
         B     RTZPTR                    . 004C78 47F0 9074
                                                             SPACE
* ORVP LOCSP   XSP,XPTR            Get specifier
*      GETLG   TMVAL,XSP           Get length
*      RCALL   TPTR,BLOCK,LNODSZ   Get block for pattern
*      MAKNOD  XPTR,TPTR,TMVAL,ZEROCL,CHRCL,XPTR
*                                  Construct pattern
*      BRANCH  ORPP                Join processing
ORVP     LM    3,4,XPTR                  . 004C7C 9834 A410
         CR    0,3                       . 004C80 1903
         BNE   S4$04C8E                  . 004C82 4770 B24A
         ST    0,XSP                     . 004C86 5000 A5D0
         B     S4$04C9E                  . 004C8A 47F0 B25A
S4$04C8E L     1,4(3)                    . 004C8E 5813 0004
         LA    1,0(1)                    . 004C92 4111 0000
         LA    2,32                      . 004C96 4120 0020
         STM   1,4,XSP                   . 004C9A 9014 A5D0
S4$04C9E L     15,XSP                    . 004C9E 58F0 A5D0
         STM   15,0,TMVAL                . 004CA2 90F0 A3C8
         LA    14,S4$04CCA               . 004CA6 41E0 B286
         STM   11,14,104(12)             . 004CAA 90BE C068
         LR    13,12                     . 004CAE 18DC
         LD    0,LNODSZ                  . 004CB0 6800 9C48
         STD   0,120(12)                 . 004CB4 600C 0078
         LA    12,24(12)                 . 004CB8 41CC 0018
         C     12,@@STACKT               . 004CBC 59C0 A828
         BH    OVER                      . 004CC0 4720 9664
         L     11,@@BLOCK                . 004CC4 58B0 A82C
         BR    11                        . 004CC8 07FB
S4$04CCA STD   0,TPTR                    . 004CCA 6000 A3D0
         LM    1,2,TPTR                  . 004CCE 9812 A3D0
         LM    3,4,CHRCL                 . 004CD2 9834 9CF8
         LR    5,0                       . 004CD6 1850
         LR    6,0                       . 004CD8 1860
         L     7,TMVAL                   . 004CDA 5870 A3C8
         STM   3,7,8(1)                  . 004CDE 9037 1008
         LM    3,4,XPTR                  . 004CE2 9834 A410
         STM   3,4,32(1)                 . 004CE6 9034 1020
         STM   1,2,XPTR                  . 004CEA 9012 A410
         B     S4$04BCA                  . 004CEE 47F0 B186
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Pattern Matching Procedures'
*
*      Simple Pattern Matching
*
                                                             SPACE
* SCAN PROC    ,                   Pattern Matching
*      RCALL   XPTR,ARGVAL,,FAIL   Get subject
*      PUSH    XPTR                Save subject
*      RCALL   YPTR,PATVAL,,FAIL   Get pattern
*      POP     XPTR                Restore subject
*      SETAV   DTCL,XPTR           Set up data type pair
*      MOVV    DTCL,YPTR
*      INCRA   SCNCL,1             Increment count of scanner entries
*      DEQL    DTCL,VVDTP,,SCANVV  Is it STRING-STRING?
*      DEQL    DTCL,VPDTP,,SCANVP  Is it STRING-PATTERN?
*      DEQL    DTCL,IVDTP,,SCANIV  Is it INTEGER-STRING?
*      DEQL    DTCL,RVDTP,,SCANRV  Is it REAL-STRING?
*      DEQL    DTCL,RPDTP,,SCANRP  Is it REAL-PATTERN?
*      DEQL    DTCL,IPDTP,INTR1,SCANIP
*                                  Is it INTEGER-PATTERN?
                                                             SPACE
         USING SCAN,11                   .
SCAN     LA    14,S4$04D0E               . 004CF2 41E0 B01C
         STM   11,14,104(12)             . 004CF6 90BE C068
         LR    13,12                     . 004CFA 18DC
         LA    12,16(12)                 . 004CFC 41CC 0010
         C     12,@@STACKT               . 004D00 59C0 A828
         BH    OVER                      . 004D04 4720 9664
         L     11,@@ARGVAL               . 004D08 58B0 A914
         BR    11                        . 004D0C 07FB
S4$04D0E STD   0,XPTR                    . 004D0E 6000 A410
         B     FAIL                      . 004D12 47F0 9010
         LD    0,XPTR                    . 004D16 6800 A410
         STD   0,104(12)                 . 004D1A 600C 0068
         AR    12,8                      . 004D1E 1AC8
         C     12,@@STACKT               . 004D20 59C0 A828
         BH    OVER                      . 004D24 4720 9664
         LA    14,S4$04D44               . 004D28 41E0 B052
         STM   11,14,104(12)             . 004D2C 90BE C068
         LR    13,12                     . 004D30 18DC
         LA    12,16(12)                 . 004D32 41CC 0010
         C     12,@@STACKT               . 004D36 59C0 A828
         BH    OVER                      . 004D3A 4720 9664
         L     11,@@PATVAL               . 004D3E 58B0 A950
         BR    11                        . 004D42 07FB
S4$04D44 STD   0,YPTR                    . 004D44 6000 A428
         B     FAIL                      . 004D48 47F0 9010
         LD    0,96(12)                  . 004D4C 680C 0060
         STD   0,XPTR                    . 004D50 6000 A410
         SR    12,8                      . 004D54 1BC8
         L     15,XPTR$4                 . 004D56 58F0 A414
         LA    15,0(15)                  . 004D5A 41FF 0000
         STM   15,0,DTCL                 . 004D5E 90F0 9E40
         MVC   DTCL$5(3),YPTR$5          . 004D62 D202 9E45 A42D
         L     1,SCNCL                   . 004D68 5810 9B80
         LA    1,1(1)                    . 004D6C 4111 0001
         ST    1,SCNCL                   . 004D70 5010 9B80
         CLC   DTCL(8),VVDTP             . 004D74 D507 9E40 9B60
         BE    SCANVV                    . 004D7A 4780 B0C2
         CLC   DTCL(8),VPDTP             . 004D7E D507 9E40 9B50
         BE    SCANVP                    . 004D84 4780 B17C
         CLC   DTCL(8),IVDTP             . 004D88 D507 9E40 9AF0
         BE    SCANIV                    . 004D8E 4780 B150
         CLC   DTCL(8),RVDTP             . 004D92 D507 9E40 9B28
         BE    SCANRV                    . 004D98 4780 B21E
         CLC   DTCL(8),RPDTP             . 004D9C D507 9E40 9B18
         BE    SCANRP                    . 004DA2 4780 B258
         CLC   DTCL(8),IPDTP             . 004DA6 D507 9E40 9AE0
         BNE   INTR1                     . 004DAC 4770 95FC
         BE    SCANIP                    . 004DB0 4780 B1F2
                                                             SPACE
* SCANVV LOCSP XSP,XPTR            Get specifier for subject
*      LOCSP   YSP,YPTR            Get specifier for pattern
                                                             SPACE
SCANVV   LM    3,4,XPTR                  . 004DB4 9834 A410
         CR    0,3                       . 004DB8 1903
         BNE   S4$04DC6                  . 004DBA 4770 B0D4
         ST    0,XSP                     . 004DBE 5000 A5D0
         B     S4$04DD6                  . 004DC2 47F0 B0E4
S4$04DC6 L     1,4(3)                    . 004DC6 5813 0004
         LA    1,0(1)                    . 004DCA 4111 0000
         LA    2,32                      . 004DCE 4120 0020
         STM   1,4,XSP                   . 004DD2 9014 A5D0
S4$04DD6 LM    3,4,YPTR                  . 004DD6 9834 A428
         CR    0,3                       . 004DDA 1903
         BNE   S4$04DE8                  . 004DDC 4770 B0F6
         ST    0,YSP                     . 004DE0 5000 A5E0
         B     SCANVB                    . 004DE4 47F0 B106
S4$04DE8 L     1,4(3)                    . 004DE8 5813 0004
         LA    1,0(1)                    . 004DEC 4111 0000
         LA    2,32                      . 004DF0 4120 0020
         STM   1,4,YSP                   . 004DF4 9014 A5E0
                                                             SPACE
* SCANVB SUBSP TSP,YSP,XSP,FAIL    Get part to compare
*      LEXCMP  TSP,YSP,,RETNUL     Compare strings
*      AEQLC   ANCCL,0,FAIL        Check &ANCHOR
*      FSHRTN  XSP,1               Delete lead character
*      BRANCH  SCANVB              Try again
                                                             SPACE
SCANVB   LM    1,4,XSP                   . 004DF8 9814 A5D0
         C     1,YSP                     . 004DFC 5910 A5E0
         BL    FAIL                      . 004E00 4740 9010
         L     1,YSP                     . 004E04 5810 A5E0
         STM   1,4,TSP                   . 004E08 9014 A5A0
         LM    2,4,TSP                   . 004E0C 9824 A5A0
         LM    5,7,YSP                   . 004E10 9857 A5E0
         CR    2,5                       . 004E14 1925
         BNE   S4$04E28                  . 004E16 4770 B136
         L     15,@@SPECEQ               . 004E1A 58F0 A890
         BALR  14,15                          CALL                     *
                                         . 004E1E 05EF
         B     S4$04E28                  . 004E20 47F0 B136
         B     RETNUL                    . 004E24 47F0 9018
S4$04E28 C     0,ANCCL                   . 004E28 5900 98B8
         BNE   FAIL                      . 004E2C 4770 9010
         LM    1,2,XSP                   . 004E30 9812 A5D0
         BCTR  1,0                            DECREMENT                *
                                         . 004E34 0610
         LA    2,1(2)                    . 004E36 4122 0001
         STM   1,2,XSP                   . 004E3A 9012 A5D0
         B     SCANVB                    . 004E3E 47F0 B106
                                                             SPACE
* SCANIV RCALL XPTR,GNVARI,XPTR    Generate variable for integer
*      BRANCH  SCANVV              Join processing
                                                             SPACE
SCANIV   LA    14,S4$04E66               . 004E42 41E0 B174
         STM   11,14,104(12)             . 004E46 90BE C068
         LR    13,12                     . 004E4A 18DC
         LD    0,XPTR                    . 004E4C 6800 A410
         STD   0,120(12)                 . 004E50 600C 0078
         LA    12,24(12)                 . 004E54 41CC 0018
         C     12,@@STACKT               . 004E58 59C0 A828
         BH    OVER                      . 004E5C 4720 9664
         L     11,@@GNVARI               . 004E60 58B0 A94C
         BR    11                        . 004E64 07FB
S4$04E66 STD   0,XPTR                    . 004E66 6000 A410
         B     SCANVV                    . 004E6A 47F0 B0C2
                                                             SPACE
* SCANVP LOCSP XSP,XPTR            Get specifier for subject
*      RCALL   ,SCNR,,(FAIL,,FAIL) Call scanner
*      RCALL   ,NMD,,(FAIL,RTN2)   Perform naming
                                                             SPACE
SCANVP   LM    3,4,XPTR                  . 004E6E 9834 A410
         CR    0,3                       . 004E72 1903
         BNE   S4$04E80                  . 004E74 4770 B18E
         ST    0,XSP                     . 004E78 5000 A5D0
         B     S4$04E90                  . 004E7C 47F0 B19E
S4$04E80 L     1,4(3)                    . 004E80 5813 0004
         LA    1,0(1)                    . 004E84 4111 0000
         LA    2,32                      . 004E88 4120 0020
         STM   1,4,XSP                   . 004E8C 9014 A5D0
S4$04E90 LA    14,S4$04EAC               . 004E90 41E0 B1BA
         STM   11,14,104(12)             . 004E94 90BE C068
         LR    13,12                     . 004E98 18DC
         LA    12,16(12)                 . 004E9A 41CC 0010
         C     12,@@STACKT               . 004E9E 59C0 A828
         BH    OVER                      . 004EA2 4720 9664
         L     11,@@SCNR                 . 004EA6 58B0 A960
         BR    11                        . 004EAA 07FB
S4$04EAC SR    0,0                       . 004EAC 1B00
         SR    0,0                       . 004EAE 1B00
         B     FAIL                      . 004EB0 47F0 9010
         B     S4$04EBC                  . 004EB4 47F0 B1CA
         B     FAIL                      . 004EB8 47F0 9010
S4$04EBC LA    14,S4$04ED8               . 004EBC 41E0 B1E6
         STM   11,14,104(12)             . 004EC0 90BE C068
         LR    13,12                     . 004EC4 18DC
         LA    12,16(12)                 . 004EC6 41CC 0010
         C     12,@@STACKT               . 004ECA 59C0 A828
         BH    OVER                      . 004ECE 4720 9664
         L     11,@@NMD                  . 004ED2 58B0 A964
         BR    11                        . 004ED6 07FB
S4$04ED8 SR    0,0                       . 004ED8 1B00
         SR    0,0                       . 004EDA 1B00
         B     FAIL                      . 004EDC 47F0 9010
         B     RTN2                      . 004EE0 47F0 9028
                                                             SPACE
* SCANIP RCALL XPTR,GNVARI,XPTR    Generate variable for integer
*      BRANCH  SCANVP              Join processing
                                                             SPACE
SCANIP   LA    14,S4$04F08               . 004EE4 41E0 B216
         STM   11,14,104(12)             . 004EE8 90BE C068
         LR    13,12                     . 004EEC 18DC
         LD    0,XPTR                    . 004EEE 6800 A410
         STD   0,120(12)                 . 004EF2 600C 0078
         LA    12,24(12)                 . 004EF6 41CC 0018
         C     12,@@STACKT               . 004EFA 59C0 A828
         BH    OVER                      . 004EFE 4720 9664
         L     11,@@GNVARI               . 004F02 58B0 A94C
         BR    11                        . 004F06 07FB
S4$04F08 STD   0,XPTR                    . 004F08 6000 A410
         B     SCANVP                    . 004F0C 47F0 B17C
                                                             SPACE
* SCANRV REALST XSP,XPTR           Convert REAL to STRING
*      RCALL   XPTR,GENVAR,XSPPTR,SCANVV
                                                             SPACE
SCANRV   L     15,@@REALST               . 004F10 58F0 A86C
         LA    5,XSP                     . 004F14 4150 A5D0
         LE    2,XPTR                    . 004F18 7820 A410
         BALR  14,15                          CALL                     *
                                         . 004F1C 05EF
         LA    14,S4$04F42               . 004F1E 41E0 B250
         STM   11,14,104(12)             . 004F22 90BE C068
         LR    13,12                     . 004F26 18DC
         LD    0,XSPPTR                  . 004F28 6800 9F60
         STD   0,120(12)                 . 004F2C 600C 0078
         LA    12,24(12)                 . 004F30 41CC 0018
         C     12,@@STACKT               . 004F34 59C0 A828
         BH    OVER                      . 004F38 4720 9664
         L     11,@@GENVAR               . 004F3C 58B0 A830
         BR    11                        . 004F40 07FB
S4$04F42 STD   0,XPTR                    . 004F42 6000 A410
         B     SCANVV                    . 004F46 47F0 B0C2
                                                             SPACE
* SCANRP REALST XSP,XPTR           Convert REAL to STRING
*      RCALL   XPTR,GENVAR,XSPPTR,SCANVP
*                                  Generate variable
SCANRP   L     15,@@REALST               . 004F4A 58F0 A86C
         LA    5,XSP                     . 004F4E 4150 A5D0
         LE    2,XPTR                    . 004F52 7820 A410
         BALR  14,15                          CALL                     *
                                         . 004F56 05EF
         LA    14,S4$04F7C               . 004F58 41E0 B28A
         STM   11,14,104(12)             . 004F5C 90BE C068
         LR    13,12                     . 004F60 18DC
         LD    0,XSPPTR                  . 004F62 6800 9F60
         STD   0,120(12)                 . 004F66 600C 0078
         LA    12,24(12)                 . 004F6A 41CC 0018
         C     12,@@STACKT               . 004F6E 59C0 A828
         BH    OVER                      . 004F72 4720 9664
         L     11,@@GENVAR               . 004F76 58B0 A830
         BR    11                        . 004F7A 07FB
S4$04F7C STD   0,XPTR                    . 004F7C 6000 A410
         B     SCANVP                    . 004F80 47F0 B17C
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Pattern Matching with Replacement
*
                                                             SPACE
* SJSR PROC    ,                   Pattern matching with replacement
*      INCRA   OCICL,DESCR         Increment offset
*      GETD    WPTR,OCBSCL,OCICL   Get object code descriptor
*      TESTF   WPTR,FNC,,SJSRC1    Check for function
                                                             SPACE
         USING SJSR,11                   .
SJSR     L     1,OCICL                   . 004F84 5810 9ED8
         AR    1,8                       . 004F88 1A18
         ST    1,OCICL                   . 004F8A 5010 9ED8
         L     2,OCBSCL                  . 004F8E 5820 A470
         LD    0,0(1,2)                  . 004F92 6801 2000
         STD   0,WPTR                    . 004F96 6000 A400
         TM    WPTR$4,X'04'              . 004F9A 9104 A404
         BO    SJSRC1                    . 004F9E 4710 B13A
                                                             SPACE
* SJSR1 AEQLC  INSW,0,,SJSR1A      Check &INPUT
*      LOCAPV  ZPTR,INATL,WPTR,SJSR1A
*                                  Look of input association
*      GETDC   ZPTR,ZPTR,DESCR     Get association
*      RCALL   XPTR,PUTIN,(ZPTR,WPTR),(FAIL,SJSR1B)
*                                  Perform input
                                                             SPACE
SJSR1    C     0,INSW                    . 004FA2 5900 9858
         BE    SJSR1A                    . 004FA6 4780 B086
         L     15,INATL                  . 004FAA 58F0 A300
         L     5,4(15)                   . 004FAE 585F 0004
         LA    5,0(5,15)                 . 004FB2 4155 F000
         LR    4,8                       . 004FB6 1848
         SR    5,4                       . 004FB8 1B54
         AR    4,8                       . 004FBA 1A48
S4$04FBC CLC   16(8,15),WPTR             . 004FBC D507 F010 A400
         BE    S4$04FCE                  . 004FC2 4780 B04A
         BXLE  15,4,S4$04FBC             . 004FC6 87F4 B038
         B     SJSR1A                    . 004FCA 47F0 B086
S4$04FCE LD    0,8(15)                   . 004FCE 680F 0008
         STD   0,ZPTR                    . 004FD2 6000 A440
         LA    14,S4$04FFE               . 004FD6 41E0 B07A
         STM   11,14,104(12)             . 004FDA 90BE C068
         LR    13,12                     . 004FDE 18DC
         STD   0,128(12)                 . 004FE0 600C 0080
         LD    0,WPTR                    . 004FE4 6800 A400
         STD   0,120(12)                 . 004FE8 600C 0078
         LA    12,32(12)                 . 004FEC 41CC 0020
         C     12,@@STACKT               . 004FF0 59C0 A828
         BH    OVER                      . 004FF4 4720 9664
         L     11,@@PUTIN                . 004FF8 58B0 A920
         BR    11                        . 004FFC 07FB
S4$04FFE STD   0,XPTR                    . 004FFE 6000 A410
         B     FAIL                      . 005002 47F0 9010
         B     SJSR1B                    . 005006 47F0 B092
                                                             SPACE
* SJSR1A GETDC XPTR,WPTR,DESCR     Get value
                                                             SPACE
SJSR1A   L     1,WPTR                    . 00500A 5810 A400
         LD    0,8(1)                    . 00500E 6801 0008
         STD   0,XPTR                    . 005012 6000 A410
                                                             SPACE
* SJSR1B PUSH  (WPTR,XPTR)         Save name and value
*      RCALL   YPTR,PATVAL,,FAIL   Get pattern
*      POP     XPTR                Restore value
*      SETAV   DTCL,XPTR           Set up data type pair
*      MOVV    DTCL,YPTR
*      INCRA   SCNCL,1             Increment count of scanner calls
*      DEQL    DTCL,VVDTP,,SJSSVV  Is it STRING-PATTERN?
*      DEQL    DTCL,VPDTP,,SJSSVP  Is it INTEGER-STRING?
*      DEQL    DTCL,IVDTP,,SJSSIV  Is it INTEGER-PATTERN?
*      DEQL    DTCL,RVDTP,,SJSSRV  Is it REAL-STRING?
*      DEQL    DTCL,RPDTP,,SJSSRP  Is it REAL-PATTERN?
*      DEQL    DTCL,IPDTP,INTR1,SJSSIP
                                                             SPACE
SJSR1B   LD    0,WPTR                    . 005016 6800 A400
         STD   0,104(12)                 . 00501A 600C 0068
         LD    0,XPTR                    . 00501E 6800 A410
         STD   0,112(12)                 . 005022 600C 0070
         LA    12,16(12)                 . 005026 41CC 0010
         C     12,@@STACKT               . 00502A 59C0 A828
         BH    OVER                      . 00502E 4720 9664
         LA    14,S4$0504E               . 005032 41E0 B0CA
         STM   11,14,104(12)             . 005036 90BE C068
         LR    13,12                     . 00503A 18DC
         LA    12,16(12)                 . 00503C 41CC 0010
         C     12,@@STACKT               . 005040 59C0 A828
         BH    OVER                      . 005044 4720 9664
         L     11,@@PATVAL               . 005048 58B0 A950
         BR    11                        . 00504C 07FB
S4$0504E STD   0,YPTR                    . 00504E 6000 A428
         B     FAIL                      . 005052 47F0 9010
         LD    0,96(12)                  . 005056 680C 0060
         STD   0,XPTR                    . 00505A 6000 A410
         SR    12,8                      . 00505E 1BC8
         L     15,XPTR$4                 . 005060 58F0 A414
         LA    15,0(15)                  . 005064 41FF 0000
         STM   15,0,DTCL                 . 005068 90F0 9E40
         MVC   DTCL$5(3),YPTR$5          . 00506C D202 9E45 A42D
         L     1,SCNCL                   . 005072 5810 9B80
         LA    1,1(1)                    . 005076 4111 0001
         ST    1,SCNCL                   . 00507A 5010 9B80
         CLC   DTCL(8),VVDTP             . 00507E D507 9E40 9B60
         BE    SJSSVV                    . 005084 4780 B2CA
         CLC   DTCL(8),VPDTP             . 005088 D507 9E40 9B50
         BE    SJSSVP                    . 00508E 4780 B16E
         CLC   DTCL(8),IVDTP             . 005092 D507 9E40 9AF0
         BE    SJSSIV                    . 005098 4780 B204
         CLC   DTCL(8),RVDTP             . 00509C D507 9E40 9B28
         BE    SJSSRV                    . 0050A2 4780 B230
         CLC   DTCL(8),RPDTP             . 0050A6 D507 9E40 9B18
         BE    SJSSRP                    . 0050AC 4780 B26A
         CLC   DTCL(8),IPDTP             . 0050B0 D507 9E40 9AE0
         BNE   INTR1                     . 0050B6 4770 95FC
         BE    SJSSIP                    . 0050BA 4780 B1D8
                                                             SPACE
* SJSRC1 RCALL WPTR,INVOKE,(WPTR),(FAIL,SJSR1,NEMO)
*                                  Evaluate subject
                                                             SPACE
SJSRC1   LA    14,S4$050E2               . 0050BE 41E0 B15E
         STM   11,14,104(12)             . 0050C2 90BE C068
         LR    13,12                     . 0050C6 18DC
         LD    0,WPTR                    . 0050C8 6800 A400
         STD   0,120(12)                 . 0050CC 600C 0078
         LA    12,24(12)                 . 0050D0 41CC 0018
         C     12,@@STACKT               . 0050D4 59C0 A828
         BH    OVER                      . 0050D8 4720 9664
         L     11,@@INVOKE               . 0050DC 58B0 A91C
         BR    11                        . 0050E0 07FB
S4$050E2 STD   0,WPTR                    . 0050E2 6000 A400
         B     FAIL                      . 0050E6 47F0 9010
         B     SJSR1                     . 0050EA 47F0 B01E
         B     NEMO                      . 0050EE 47F0 964C
                                                             SPACE
* SJSSVP LOCSP XSP,XPTR            Get specifier
*      RCALL   ,SCNR,,(FAIL,,FAIL) Call scanner
*      SETAC   NAMGCL,1            Set naming switch
*      REMSP   TAILSP,XSP,TXSP     Get tail of subject
*      BRANCH  SJSS1               Join common processing
                                                             SPACE
SJSSVP   LM    3,4,XPTR                  . 0050F2 9834 A410
         CR    0,3                       . 0050F6 1903
         BNE   S4$05104                  . 0050F8 4770 B180
         ST    0,XSP                     . 0050FC 5000 A5D0
         B     S4$05114                  . 005100 47F0 B190
S4$05104 L     1,4(3)                    . 005104 5813 0004
         LA    1,0(1)                    . 005108 4111 0000
         LA    2,32                      . 00510C 4120 0020
         STM   1,4,XSP                   . 005110 9014 A5D0
S4$05114 LA    14,S4$05130               . 005114 41E0 B1AC
         STM   11,14,104(12)             . 005118 90BE C068
         LR    13,12                     . 00511C 18DC
         LA    12,16(12)                 . 00511E 41CC 0010
         C     12,@@STACKT               . 005122 59C0 A828
         BH    OVER                      . 005126 4720 9664
         L     11,@@SCNR                 . 00512A 58B0 A960
         BR    11                        . 00512E 07FB
S4$05130 SR    0,0                       . 005130 1B00
         SR    0,0                       . 005132 1B00
         B     FAIL                      . 005134 47F0 9010
         B     S4$05140                  . 005138 47F0 B1BC
         B     FAIL                      . 00513C 47F0 9010
S4$05140 LA    1,1                       . 005140 4110 0001
         ST    1,NAMGCL                  . 005144 5010 9BD8
         LM    1,4,XSP                   . 005148 9814 A5D0
         L     5,TXSP                    . 00514C 5850 A5B0
         AR    2,5                       . 005150 1A25
         SR    1,5                       . 005152 1B15
         STM   1,4,TAILSP                . 005154 9014 A580
         B     SJSS1                     . 005158 47F0 B35C
                                                             SPACE
* SJSSIP RCALL XPTR,GNVARI,XPTR    Generate STRING from INTEGER
*      BRANCH  SJSSVP              Join common processing
                                                             SPACE
SJSSIP   LA    14,S4$05180               . 00515C 41E0 B1FC
         STM   11,14,104(12)             . 005160 90BE C068
         LR    13,12                     . 005164 18DC
         LD    0,XPTR                    . 005166 6800 A410
         STD   0,120(12)                 . 00516A 600C 0078
         LA    12,24(12)                 . 00516E 41CC 0018
         C     12,@@STACKT               . 005172 59C0 A828
         BH    OVER                      . 005176 4720 9664
         L     11,@@GNVARI               . 00517A 58B0 A94C
         BR    11                        . 00517E 07FB
S4$05180 STD   0,XPTR                    . 005180 6000 A410
         B     SJSSVP                    . 005184 47F0 B16E
                                                             SPACE
* SJSSIV RCALL XPTR,GNVARI,XPTR    Generate STRING from INTEGER
*      BRANCH  SJSSVV              Join common processing
                                                             SPACE
SJSSIV   LA    14,S4$051AC               . 005188 41E0 B228
         STM   11,14,104(12)             . 00518C 90BE C068
         LR    13,12                     . 005190 18DC
         LD    0,XPTR                    . 005192 6800 A410
         STD   0,120(12)                 . 005196 600C 0078
         LA    12,24(12)                 . 00519A 41CC 0018
         C     12,@@STACKT               . 00519E 59C0 A828
         BH    OVER                      . 0051A2 4720 9664
         L     11,@@GNVARI               . 0051A6 58B0 A94C
         BR    11                        . 0051AA 07FB
S4$051AC STD   0,XPTR                    . 0051AC 6000 A410
         B     SJSSVV                    . 0051B0 47F0 B2CA
                                                             SPACE
* SJSSRV REALST XSP,XPTR           Convert REAL to STRING
*      RCALL   XPTR,GENVAR,XSPPTR,SJSSVV
*                                  Generate variable
                                                             SPACE
SJSSRV   L     15,@@REALST               . 0051B4 58F0 A86C
         LA    5,XSP                     . 0051B8 4150 A5D0
         LE    2,XPTR                    . 0051BC 7820 A410
         BALR  14,15                          CALL                     *
                                         . 0051C0 05EF
         LA    14,S4$051E6               . 0051C2 41E0 B262
         STM   11,14,104(12)             . 0051C6 90BE C068
         LR    13,12                     . 0051CA 18DC
         LD    0,XSPPTR                  . 0051CC 6800 9F60
         STD   0,120(12)                 . 0051D0 600C 0078
         LA    12,24(12)                 . 0051D4 41CC 0018
         C     12,@@STACKT               . 0051D8 59C0 A828
         BH    OVER                      . 0051DC 4720 9664
         L     11,@@GENVAR               . 0051E0 58B0 A830
         BR    11                        . 0051E4 07FB
S4$051E6 STD   0,XPTR                    . 0051E6 6000 A410
         B     SJSSVV                    . 0051EA 47F0 B2CA
                                                             SPACE
* SJSSRP REALST XSP,XPTR           Convert REAL to STRING
*      RCALL   XPTR,GENVAR,XSPPTR,SJSSVP
*                                  Generate variable
                                                             SPACE
SJSSRP   L     15,@@REALST               . 0051EE 58F0 A86C
         LA    5,XSP                     . 0051F2 4150 A5D0
         LE    2,XPTR                    . 0051F6 7820 A410
         BALR  14,15                          CALL                     *
                                         . 0051FA 05EF
         LA    14,S4$05220               . 0051FC 41E0 B29C
         STM   11,14,104(12)             . 005200 90BE C068
         LR    13,12                     . 005204 18DC
         LD    0,XSPPTR                  . 005206 6800 9F60
         STD   0,120(12)                 . 00520A 600C 0078
         LA    12,24(12)                 . 00520E 41CC 0018
         C     12,@@STACKT               . 005212 59C0 A828
         BH    OVER                      . 005216 4720 9664
         L     11,@@GENVAR               . 00521A 58B0 A830
         BR    11                        . 00521E 07FB
S4$05220 STD   0,XPTR                    . 005220 6000 A410
         B     SJSSVP                    . 005224 47F0 B16E
                                                             SPACE
* SJVVON AEQLC ANCCL,0,FAIL        Check &ANCHOR
*      ADDLG   HEADSP,ONECL        Increment length of head
*      FSHRTN  XSP,1               Delete head character
*      BRANCH  SJSSV2              Join common processing
                                                             SPACE
SJVVON   C     0,ANCCL                   . 005228 5900 98B8
         BNE   FAIL                      . 00522C 4770 9010
         L     1,HEADSP                  . 005230 5810 A560
         LA    1,1(1)                    . 005234 4111 0001
         ST    1,HEADSP                  . 005238 5010 A560
         LM    1,2,XSP                   . 00523C 9812 A5D0
         BCTR  1,0                            DECREMENT                *
                                         . 005240 0610
         LA    2,1(2)                    . 005242 4122 0001
         STM   1,2,XSP                   . 005246 9012 A5D0
         B     SJSSV2                    . 00524A 47F0 B31A
                                                             SPACE
* SJSSVV LOCSP XSP,XPTR            Get specifier for subject
*      LOCSP   YSP,YPTR            Get specifier for pattern
*      SETSP   HEADSP,XSP          Set up head specifier
*      SETLC   HEADSP,0            Initialize zero length
                                                             SPACE
SJSSVV   LM    3,4,XPTR                  . 00524E 9834 A410
         CR    0,3                       . 005252 1903
         BNE   S4$05260                  . 005254 4770 B2DC
         ST    0,XSP                     . 005258 5000 A5D0
         B     S4$05270                  . 00525C 47F0 B2EC
S4$05260 L     1,4(3)                    . 005260 5813 0004
         LA    1,0(1)                    . 005264 4111 0000
         LA    2,32                      . 005268 4120 0020
         STM   1,4,XSP                   . 00526C 9014 A5D0
S4$05270 LM    3,4,YPTR                  . 005270 9834 A428
         CR    0,3                       . 005274 1903
         BNE   S4$05282                  . 005276 4770 B2FE
         ST    0,YSP                     . 00527A 5000 A5E0
         B     S4$05292                  . 00527E 47F0 B30E
S4$05282 L     1,4(3)                    . 005282 5813 0004
         LA    1,0(1)                    . 005286 4111 0000
         LA    2,32                      . 00528A 4120 0020
         STM   1,4,YSP                   . 00528E 9014 A5E0
S4$05292 LM    1,4,XSP                   . 005292 9814 A5D0
         STM   1,4,HEADSP                . 005296 9014 A560
         ST    0,HEADSP                  . 00529A 5000 A560
                                                             SPACE
* SJSSV2 SUBSP TSP,YSP,XSP,FAIL    Get common length
*      LEXCMP  TSP,YSP,SJVVON,,SJVVON
*                                  Compare strings
*      SETAC   NAMGCL,0            Clear naming switch
*      REMSP   TAILSP,XSP,TSP      Get tail of subject
                                                             SPACE
SJSSV2   LM    1,4,XSP                   . 00529E 9814 A5D0
         C     1,YSP                     . 0052A2 5910 A5E0
         BL    FAIL                      . 0052A6 4740 9010
         L     1,YSP                     . 0052AA 5810 A5E0
         STM   1,4,TSP                   . 0052AE 9014 A5A0
         LM    2,4,TSP                   . 0052B2 9824 A5A0
         LM    5,7,YSP                   . 0052B6 9857 A5E0
         CR    2,5                       . 0052BA 1925
         BNE   SJVVON                    . 0052BC 4770 B2A4
         L     15,@@SPECEQ               . 0052C0 58F0 A890
         BALR  14,15                          CALL                     *
                                         . 0052C4 05EF
         B     SJVVON                    . 0052C6 47F0 B2A4
         ST    0,NAMGCL                  . 0052CA 5000 9BD8
         LM    1,4,XSP                   . 0052CE 9814 A5D0
         L     5,TSP                     . 0052D2 5850 A5A0
         AR    2,5                       . 0052D6 1A25
         SR    1,5                       . 0052D8 1B15
         STM   1,4,TAILSP                . 0052DA 9014 A580
         NOPR  0                         . 0052DE 0700
                                                             SPACE
* SJSS1 SPUSH  (TAILSP,HEADSP)     Save head and tail
*      AEQLC   NAMGCL,0,,SJSS1A    Check naming switch
*      RCALL   ,NMD,,FAIL          Perform naming
                                                             SPACE
SJSS1    LM    1,4,TAILSP                . 0052E0 9814 A580
         STM   1,4,104(12)               . 0052E4 9014 C068
         LM    1,4,HEADSP                . 0052E8 9814 A560
         STM   1,4,120(12)               . 0052EC 9014 C078
         LA    12,32(12)                 . 0052F0 41CC 0020
         C     12,@@STACKT               . 0052F4 59C0 A828
         BH    OVER                      . 0052F8 4720 9664
         C     0,NAMGCL                  . 0052FC 5900 9BD8
         BE    SJSS1A                    . 005300 4780 B3A4
         LA    14,S4$05320               . 005304 41E0 B39C
         STM   11,14,104(12)             . 005308 90BE C068
         LR    13,12                     . 00530C 18DC
         LA    12,16(12)                 . 00530E 41CC 0010
         C     12,@@STACKT               . 005312 59C0 A828
         BH    OVER                      . 005316 4720 9664
         L     11,@@NMD                  . 00531A 58B0 A964
         BR    11                        . 00531E 07FB
S4$05320 SR    0,0                       . 005320 1B00
         SR    0,0                       . 005322 1B00
         B     FAIL                      . 005324 47F0 9010
                                                             SPACE
* SJSS1A RCALL ZPTR,ARGVAL,,FAIL   Get object
*      SPOP    (HEADSP,TAILSP)     Restore head and tail
*      POP     WPTR                Restore name of subject
*      LEQLC   HEADSP,0,SJSSDT     Check for null head
*      LEQLC   TAILSP,0,,SJSRV1    Check for null tail
                                                             SPACE
SJSS1A   LA    14,S4$05344               . 005328 41E0 B3C0
         STM   11,14,104(12)             . 00532C 90BE C068
         LR    13,12                     . 005330 18DC
         LA    12,16(12)                 . 005332 41CC 0010
         C     12,@@STACKT               . 005336 59C0 A828
         BH    OVER                      . 00533A 4720 9664
         L     11,@@ARGVAL               . 00533E 58B0 A914
         BR    11                        . 005342 07FB
S4$05344 STD   0,ZPTR                    . 005344 6000 A440
         B     FAIL                      . 005348 47F0 9010
         LM    1,4,88(12)                . 00534C 9814 C058
         STM   1,4,HEADSP                . 005350 9014 A560
         LM    1,4,72(12)                . 005354 9814 C048
         STM   1,4,TAILSP                . 005358 9014 A580
         S     12,@@16X2                 . 00535C 5BC0 A968
         LD    0,96(12)                  . 005360 680C 0060
         STD   0,WPTR                    . 005364 6000 A400
         SR    12,8                      . 005368 1BC8
         C     0,HEADSP                  . 00536A 5900 A560
         BNE   SJSSDT                    . 00536E 4770 B3F4
         CR    0,1                       . 005372 1901
         BE    SJSRV1                    . 005374 4780 B75E
                                                             SPACE
* SJSSDT VEQLC ZPTR,S,,SJSRV       Is object STRING?
*      VEQLC   ZPTR,P,,SJSRP       Is object PATTERN?
*      VEQLC   ZPTR,I,,SJSRI       Is object INTEGER?
*      VEQLC   ZPTR,R,,SJSRR       Is object REAL?
*      VEQLC   ZPTR,E,INTR1        Is object EXPRESSION?
*      RCALL   TPTR,BLOCK,STARSZ   Allocate block for pattern
*      MOVBLK  TPTR,STRPAT,STARSZ  Set up pattern for expression
*      PUTDC   TPTR,4*DESCR,ZPTR   Insert object
*      MOVD    ZPTR,TPTR           Set up converted value
                                                             SPACE
SJSSDT   CLC   ZPTR$5(3),@@S             . 005378 D502 A445 AA7B
         BE    SJSRV                     . 00537E 4780 B66A
         CLC   ZPTR$5(3),@@P             . 005382 D502 A445 AA87
         BE    SJSRP                     . 005388 4780 B474
         CLC   ZPTR$5(3),@@I             . 00538C D502 A445 AA84
         BE    SJSRI                     . 005392 4780 B826
         CLC   ZPTR$5(3),@@R             . 005396 D502 A445 AA75
         BE    SJSRR                     . 00539C 4780 B838
         CLC   ZPTR$5(3),@@E             . 0053A0 D502 A445 AA81
         BNE   INTR1                     . 0053A6 4770 95FC
         LA    14,S4$053CE               . 0053AA 41E0 B44A
         STM   11,14,104(12)             . 0053AE 90BE C068
         LR    13,12                     . 0053B2 18DC
         LD    0,STARSZ                  . 0053B4 6800 9C88
         STD   0,120(12)                 . 0053B8 600C 0078
         LA    12,24(12)                 . 0053BC 41CC 0018
         C     12,@@STACKT               . 0053C0 59C0 A828
         BH    OVER                      . 0053C4 4720 9664
         L     11,@@BLOCK                . 0053C8 58B0 A82C
         BR    11                        . 0053CC 07FB
S4$053CE STD   0,TPTR                    . 0053CE 6000 A3D0
         L     6,TPTR                    . 0053D2 5860 A3D0
         L     4,STRPAT                  . 0053D6 5840 9CC8
         AR    4,8                       . 0053DA 1A48
         AR    6,8                       . 0053DC 1A68
         L     3,STARSZ                  . 0053DE 5830 9C88
         L     15,@@MOVTST               . 0053E2 58F0 A864
         BALR  14,15                          CALL                     *
                                         . 0053E6 05EF
         LM    1,2,TPTR                  . 0053E8 9812 A3D0
         LD    0,ZPTR                    . 0053EC 6800 A440
         STD   0,32(1)                   . 0053F0 6001 0020
         STM   1,2,ZPTR                  . 0053F4 9012 A440
                                                             SPACE
* SJSRP SETSP  XSP,HEADSP          Copy specifier
*      RCALL   XPTR,GENVAR,(XSPPTR)
*                                  Generate variable for head
*      GETLG   TMVAL,HEADSP        Get length of head
*      RCALL   TPTR,BLOCK,LNODSZ   Allocate block for pattern
*      MAKNOD  XPTR,TPTR,TMVAL,ZEROCL,CHRCL,XPTR
*                                  Make pattern node
*      SETSP   YSP,TAILSP          Set up tail specifier
*      RCALL   YPTR,GENVAR,(YSPPTR)
*                                  Generate variable for tail
*      GETLG   TMVAL,TAILSP        Get length of tail
*      RCALL   TPTR,BLOCK,LNODSZ   Allocate block for pattern
*      MAKNOD  YPTR,TPTR,TMVAL,ZEROCL,CHRCL,YPTR
*                                  Make pattern node
*      GETSIZ  XSIZ,XPTR           Get size of head node
*      GETSIZ  YSIZ,YPTR           Get size of tail node
*      GETSIZ  ZSIZ,ZPTR           Get size of object
*      SUM     TSIZ,XSIZ,ZSIZ      Compute total size
*      SUM     TSIZ,TSIZ,YSIZ      Get size of new pattern
*      SETVC   TSIZ,P              Insert PATTERN data type
*      RCALL   TPTR,BLOCK,TSIZ     Allocate block for total pattern
*      MOVD    VVAL,TPTR           Get working copy
*      LVALUE  TVAL,ZPTR           Get least value of replacement
*      CPYPAT  TPTR,XPTR,TVAL,ZEROCL,XSIZ,XSIZ
*                                  Copy in head
*      LVALUE  TVAL,YPTR           Get least value of tail
*      SUM     TSIZ,XSIZ,ZSIZ      Get size of first two
*      CPYPAT  TPTR,ZPTR,TVAL,XSIZ,TSIZ,ZSIZ
*                                  Copy in object
*      CPYPAT  TPTR,YPTR,ZEROCL,TSIZ,ZEROCL,YSIZ
*                                  Copy in tail
*      MOVD    ZPTR,VVAL           Set up return value
*      BRANCH  SJSRV1              Join common processing
                                                             SPACE
SJSRP    LM    1,4,HEADSP                . 0053F8 9814 A560
         STM   1,4,XSP                   . 0053FC 9014 A5D0
         LA    14,S4$05424               . 005400 41E0 B4A0
         STM   11,14,104(12)             . 005404 90BE C068
         LR    13,12                     . 005408 18DC
         LD    0,XSPPTR                  . 00540A 6800 9F60
         STD   0,120(12)                 . 00540E 600C 0078
         LA    12,24(12)                 . 005412 41CC 0018
         C     12,@@STACKT               . 005416 59C0 A828
         BH    OVER                      . 00541A 4720 9664
         L     11,@@GENVAR               . 00541E 58B0 A830
         BR    11                        . 005422 07FB
S4$05424 STD   0,XPTR                    . 005424 6000 A410
         L     15,HEADSP                 . 005428 58F0 A560
         STM   15,0,TMVAL                . 00542C 90F0 A3C8
         LA    14,S4$05454               . 005430 41E0 B4D0
         STM   11,14,104(12)             . 005434 90BE C068
         LR    13,12                     . 005438 18DC
         LD    0,LNODSZ                  . 00543A 6800 9C48
         STD   0,120(12)                 . 00543E 600C 0078
         LA    12,24(12)                 . 005442 41CC 0018
         C     12,@@STACKT               . 005446 59C0 A828
         BH    OVER                      . 00544A 4720 9664
         L     11,@@BLOCK                . 00544E 58B0 A82C
         BR    11                        . 005452 07FB
S4$05454 STD   0,TPTR                    . 005454 6000 A3D0
         LM    1,2,TPTR                  . 005458 9812 A3D0
         LM    3,4,CHRCL                 . 00545C 9834 9CF8
         LR    5,0                       . 005460 1850
         LR    6,0                       . 005462 1860
         L     7,TMVAL                   . 005464 5870 A3C8
         STM   3,7,8(1)                  . 005468 9037 1008
         LM    3,4,XPTR                  . 00546C 9834 A410
         STM   3,4,32(1)                 . 005470 9034 1020
         STM   1,2,XPTR                  . 005474 9012 A410
         LM    1,4,TAILSP                . 005478 9814 A580
         STM   1,4,YSP                   . 00547C 9014 A5E0
         LA    14,S4$054A4               . 005480 41E0 B520
         STM   11,14,104(12)             . 005484 90BE C068
         LR    13,12                     . 005488 18DC
         LD    0,YSPPTR                  . 00548A 6800 9F68
         STD   0,120(12)                 . 00548E 600C 0078
         LA    12,24(12)                 . 005492 41CC 0018
         C     12,@@STACKT               . 005496 59C0 A828
         BH    OVER                      . 00549A 4720 9664
         L     11,@@GENVAR               . 00549E 58B0 A830
         BR    11                        . 0054A2 07FB
S4$054A4 STD   0,YPTR                    . 0054A4 6000 A428
         L     15,TAILSP                 . 0054A8 58F0 A580
         STM   15,0,TMVAL                . 0054AC 90F0 A3C8
         LA    14,S4$054D4               . 0054B0 41E0 B550
         STM   11,14,104(12)             . 0054B4 90BE C068
         LR    13,12                     . 0054B8 18DC
         LD    0,LNODSZ                  . 0054BA 6800 9C48
         STD   0,120(12)                 . 0054BE 600C 0078
         LA    12,24(12)                 . 0054C2 41CC 0018
         C     12,@@STACKT               . 0054C6 59C0 A828
         BH    OVER                      . 0054CA 4720 9664
         L     11,@@BLOCK                . 0054CE 58B0 A82C
         BR    11                        . 0054D2 07FB
S4$054D4 STD   0,TPTR                    . 0054D4 6000 A3D0
         LM    1,2,TPTR                  . 0054D8 9812 A3D0
         LM    3,4,CHRCL                 . 0054DC 9834 9CF8
         LR    5,0                       . 0054E0 1850
         LR    6,0                       . 0054E2 1860
         L     7,TMVAL                   . 0054E4 5870 A3C8
         STM   3,7,8(1)                  . 0054E8 9037 1008
         LM    3,4,YPTR                  . 0054EC 9834 A428
         STM   3,4,32(1)                 . 0054F0 9034 1020
         STM   1,2,YPTR                  . 0054F4 9012 A428
         L     15,XPTR                   . 0054F8 58F0 A410
         L     15,4(15)                  . 0054FC 58FF 0004
         LA    15,0(15)                  . 005500 41FF 0000
         STM   15,0,XSIZ                 . 005504 90F0 A418
         LR    15,1                      . 005508 18F1
         L     15,4(15)                  . 00550A 58FF 0004
         LA    15,0(15)                  . 00550E 41FF 0000
         STM   15,0,YSIZ                 . 005512 90F0 A430
         L     15,ZPTR                   . 005516 58F0 A440
         L     15,4(15)                  . 00551A 58FF 0004
         LA    15,0(15)                  . 00551E 41FF 0000
         STM   15,0,ZSIZ                 . 005522 90F0 A448
         LM    1,2,XSIZ                  . 005526 9812 A418
         AR    1,15                      . 00552A 1A1F
         STM   1,2,TSIZ                  . 00552C 9012 A3E0
         A     1,YSIZ                    . 005530 5A10 A430
         ST    1,TSIZ                    . 005534 5010 A3E0
         MVC   TSIZ$5(3),@@P             . 005538 D202 A3E5 AA87
         LA    14,S4$05562               . 00553E 41E0 B5DE
         STM   11,14,104(12)             . 005542 90BE C068
         LR    13,12                     . 005546 18DC
         LD    0,TSIZ                    . 005548 6800 A3E0
         STD   0,120(12)                 . 00554C 600C 0078
         LA    12,24(12)                 . 005550 41CC 0018
         C     12,@@STACKT               . 005554 59C0 A828
         BH    OVER                      . 005558 4720 9664
         L     11,@@BLOCK                . 00555C 58B0 A82C
         BR    11                        . 005560 07FB
S4$05562 STD   0,TPTR                    . 005562 6000 A3D0
         STD   0,VVAL                    . 005566 6000 A3F0
         L     15,@@LVAL                 . 00556A 58F0 A95C
         LA    1,TVAL                    . 00556E 4110 A3E8
         L     2,ZPTR                    . 005572 5820 A440
         BALR  14,15                          CALL                     *
                                         . 005576 05EF
         L     15,@@COPL                 . 005578 58F0 A954
         LA    2,TPTR                    . 00557C 4120 A3D0
         L     3,XPTR                    . 005580 5830 A410
         L     4,TVAL                    . 005584 5840 A3E8
         LR    5,0                       . 005588 1850
         L     6,XSIZ                    . 00558A 5860 A418
         LR    7,6                       . 00558E 1876
         BALR  14,15                          CALL                     *
                                         . 005590 05EF
         L     15,@@LVAL                 . 005592 58F0 A95C
         LA    1,TVAL                    . 005596 4110 A3E8
         L     2,YPTR                    . 00559A 5820 A428
         BALR  14,15                          CALL                     *
                                         . 00559E 05EF
         LM    1,2,XSIZ                  . 0055A0 9812 A418
         A     1,ZSIZ                    . 0055A4 5A10 A448
         STM   1,2,TSIZ                  . 0055A8 9012 A3E0
         L     15,@@COPL                 . 0055AC 58F0 A954
         LA    2,TPTR                    . 0055B0 4120 A3D0
         L     3,ZPTR                    . 0055B4 5830 A440
         L     4,TVAL                    . 0055B8 5840 A3E8
         L     5,XSIZ                    . 0055BC 5850 A418
         LR    6,1                       . 0055C0 1861
         L     7,ZSIZ                    . 0055C2 5870 A448
         BALR  14,15                          CALL                     *
                                         . 0055C6 05EF
         L     15,@@COPL                 . 0055C8 58F0 A954
         LA    2,TPTR                    . 0055CC 4120 A3D0
         L     3,YPTR                    . 0055D0 5830 A428
         LR    4,0                       . 0055D4 1840
         L     5,TSIZ                    . 0055D6 5850 A3E0
         LR    6,0                       . 0055DA 1860
         L     7,YSIZ                    . 0055DC 5870 A430
         BALR  14,15                          CALL                     *
                                         . 0055E0 05EF
         LD    0,VVAL                    . 0055E2 6800 A3F0
         STD   0,ZPTR                    . 0055E6 6000 A440
         B     SJSRV1                    . 0055EA 47F0 B75E
                                                             SPACE
* SJSRV LOCSP  ZSP,ZPTR
                                                             SPACE
SJSRV    LM    3,4,ZPTR                  . 0055EE 9834 A440
         CR    0,3                       . 0055F2 1903
         BNE   S4$05600                  . 0055F4 4770 B67C
         ST    0,ZSP                     . 0055F8 5000 A5F0
         B     SJSRS                     . 0055FC 47F0 B68C
S4$05600 L     1,4(3)                    . 005600 5813 0004
         LA    1,0(1)                    . 005604 4111 0000
         LA    2,32                      . 005608 4120 0020
         STM   1,4,ZSP                   . 00560C 9014 A5F0
                                                             SPACE
* SJSRS GETLG  XPTR,TAILSP         Get length of tail
*      GETLG   YPTR,HEADSP         Get length of tail
*      GETLG   ZPTR,ZSP            Get length of object
*      SUM     XPTR,XPTR,YPTR      Compute total length
*      SUM     XPTR,XPTR,ZPTR
*      ACOMP   XPTR,MLENCL,INTR8   Check &MAXLNGTH
*      RCALL   ZPTR,CONVAR,(XPTR)  Allocate storage for string
*      LOCSP   TSP,ZPTR            Get specifier
*      SETLC   TSP,0               Clear length
*      APDSP   TSP,HEADSP          Append head
*      APDSP   TSP,ZSP             Append object
*      APDSP   TSP,TAILSP          Append tail
*      RCALL   ZPTR,GNVARS,XPTR    Enter string into storage
                                                             SPACE
SJSRS    L     15,TAILSP                 . 005610 58F0 A580
         STM   15,0,XPTR                 . 005614 90F0 A410
         L     15,HEADSP                 . 005618 58F0 A560
         STM   15,0,YPTR                 . 00561C 90F0 A428
         L     15,ZSP                    . 005620 58F0 A5F0
         STM   15,0,ZPTR                 . 005624 90F0 A440
         L     1,XPTR                    . 005628 5810 A410
         A     1,YPTR                    . 00562C 5A10 A428
         ST    1,XPTR                    . 005630 5010 A410
         AR    1,15                      . 005634 1A1F
         ST    1,XPTR                    . 005636 5010 A410
         C     1,MLENCL                  . 00563A 5910 9848
         BH    INTR8                     . 00563E 4720 9614
         LA    14,S4$05666               . 005642 41E0 B6E2
         STM   11,14,104(12)             . 005646 90BE C068
         LR    13,12                     . 00564A 18DC
         LD    0,XPTR                    . 00564C 6800 A410
         STD   0,120(12)                 . 005650 600C 0078
         LA    12,24(12)                 . 005654 41CC 0018
         C     12,@@STACKT               . 005658 59C0 A828
         BH    OVER                      . 00565C 4720 9664
         L     11,@@CONVAR               . 005660 58B0 A96C
         BR    11                        . 005664 07FB
S4$05666 STD   0,ZPTR                    . 005666 6000 A440
         LM    3,4,ZPTR                  . 00566A 9834 A440
         CR    0,3                       . 00566E 1903
         BNE   S4$0567C                  . 005670 4770 B6F8
         ST    0,TSP                     . 005674 5000 A5A0
         B     S4$0568C                  . 005678 47F0 B708
S4$0567C L     1,4(3)                    . 00567C 5813 0004
         LA    1,0(1)                    . 005680 4111 0000
         LA    2,32                      . 005684 4120 0020
         STM   1,4,TSP                   . 005688 9014 A5A0
S4$0568C ST    0,TSP                     . 00568C 5000 A5A0
         L     15,@@APDSP                . 005690 58F0 A870
         LA    2,TSP                     . 005694 4120 A5A0
         LM    3,5,HEADSP                . 005698 9835 A560
         BALR  14,15                          CALL                     *
                                         . 00569C 05EF
         L     15,@@APDSP                . 00569E 58F0 A870
         LA    2,TSP                     . 0056A2 4120 A5A0
         LM    3,5,ZSP                   . 0056A6 9835 A5F0
         BALR  14,15                          CALL                     *
                                         . 0056AA 05EF
         L     15,@@APDSP                . 0056AC 58F0 A870
         LA    2,TSP                     . 0056B0 4120 A5A0
         LM    3,5,TAILSP                . 0056B4 9835 A580
         BALR  14,15                          CALL                     *
                                         . 0056B8 05EF
         LA    14,S4$056DE               . 0056BA 41E0 B75A
         STM   11,14,104(12)             . 0056BE 90BE C068
         LR    13,12                     . 0056C2 18DC
         LD    0,XPTR                    . 0056C4 6800 A410
         STD   0,120(12)                 . 0056C8 600C 0078
         LA    12,24(12)                 . 0056CC 41CC 0018
         C     12,@@STACKT               . 0056D0 59C0 A828
         BH    OVER                      . 0056D4 4720 9664
         L     11,@@GNVARS               . 0056D8 58B0 A970
         BR    11                        . 0056DC 07FB
S4$056DE STD   0,ZPTR                    . 0056DE 6000 A440
                                                             SPACE
* SJSRV1 PUTDC WPTR,DESCR,ZPTR     Assign value to subject name
*      AEQLC   OUTSW,0,,SJSRV2     Check &OUTPUT
*      LOCAPV  YPTR,OUTATL,WPTR,SJSRV2
*                                  Look for output association
*      GETDC   YPTR,YPTR,DESCR     Get output association
*      RCALL   ,PUTOUT,(YPTR,ZPTR) Perform output
                                                             SPACE
SJSRV1   L     1,WPTR                    . 0056E2 5810 A400
         LD    0,ZPTR                    . 0056E6 6800 A440
         STD   0,8(1)                    . 0056EA 6001 0008
         C     0,OUTSW                   . 0056EE 5900 9838
         BE    SJSRV2                    . 0056F2 4780 B7CA
         L     15,OUTATL                 . 0056F6 58F0 A308
         L     5,4(15)                   . 0056FA 585F 0004
         LA    5,0(5,15)                 . 0056FE 4155 F000
         LR    4,8                       . 005702 1848
         SR    5,4                       . 005704 1B54
         AR    4,8                       . 005706 1A48
S4$05708 CLC   16(8,15),WPTR             . 005708 D507 F010 A400
         BE    S4$0571A                  . 00570E 4780 B796
         BXLE  15,4,S4$05708             . 005712 87F4 B784
         B     SJSRV2                    . 005716 47F0 B7CA
S4$0571A LD    0,8(15)                   . 00571A 680F 0008
         STD   0,YPTR                    . 00571E 6000 A428
         LA    14,S4$0574A               . 005722 41E0 B7C6
         STM   11,14,104(12)             . 005726 90BE C068
         LR    13,12                     . 00572A 18DC
         STD   0,128(12)                 . 00572C 600C 0080
         LD    0,ZPTR                    . 005730 6800 A440
         STD   0,120(12)                 . 005734 600C 0078
         LA    12,32(12)                 . 005738 41CC 0020
         C     12,@@STACKT               . 00573C 59C0 A828
         BH    OVER                      . 005740 4720 9664
         L     11,@@PUTOUT               . 005744 58B0 A974
         BR    11                        . 005748 07FB
S4$0574A SR    0,0                       . 00574A 1B00
         SR    0,0                       . 00574C 1B00
                                                             SPACE
* SJSRV2 ACOMPC TRAPCL,0,,RTN3,RTN3 Check &TRACE
*      LOCAPT  ATPTR,TVALL,WPTR,RTN3
*                                  Look for VALUE trace
*      RCALL   ,TRPHND,ATPTR,RTN3  Perform trace                E3.3.1
                                                             SPACE
SJSRV2   C     0,TRAPCL                  . 00574E 5900 9818
         BNL   RTNUL3                    . 005752 47B0 9030
         L     15,TVALL                  . 005756 58F0 A310
         L     5,4(15)                   . 00575A 585F 0004
         LA    5,0(5,15)                 . 00575E 4155 F000
         LR    4,8                       . 005762 1848
         SR    5,4                       . 005764 1B54
         AR    4,8                       . 005766 1A48
S4$05768 CLC   8(8,15),WPTR              . 005768 D507 F008 A400
         BE    S4$0577A                  . 00576E 4780 B7F6
         BXLE  15,4,S4$05768             . 005772 87F4 B7E4
         B     RTNUL3                    . 005776 47F0 9030
S4$0577A STM   15,0,ATPTR                . 00577A 90F0 A378
         LA    14,S4$0579E               . 00577E 41E0 B81A
         STM   11,14,104(12)             . 005782 90BE C068
         LR    13,12                     . 005786 18DC
         STM   15,0,120(12)              . 005788 90F0 C078
         LA    12,24(12)                 . 00578C 41CC 0018
         C     12,@@STACKT               . 005790 59C0 A828
         BH    OVER                      . 005794 4720 9664
         L     11,@@TRPHND               . 005798 58B0 A918
         BR    11                        . 00579C 07FB
S4$0579E SR    0,0                       . 00579E 1B00
         SR    0,0                       . 0057A0 1B00
         B     RTNUL3                    . 0057A2 47F0 9030
         B     RTNUL3                    . 0057A6 47F0 9030
                                                             SPACE
* SJSRI INTSPC ZSP,ZPTR            Convert INTEGER
*      BRANCH  SJSRS
                                                             SPACE
SJSRI    L     15,@@BDSPEC               . 0057AA 58F0 A874
         LA    1,ZSP                     . 0057AE 4110 A5F0
         LA    2,ZPTR                    . 0057B2 4120 A440
         BALR  14,15                          CALL                     *
                                         . 0057B6 05EF
         B     SJSRS                     . 0057B8 47F0 B68C
                                                             SPACE
* SJSRR REALST ZSP,ZPTR            Convert REAL
*      BRANCH  SJSRS
SJSRR    L     15,@@REALST               . 0057BC 58F0 A86C
         LA    5,ZSP                     . 0057C0 4150 A5F0
         LE    2,ZPTR                    . 0057C4 7820 A440
         BALR  14,15                          CALL                     *
                                         . 0057C8 05EF
         B     SJSRS                     . 0057CA 47F0 B68C
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Basic Scanning Procedure
*
                                                             SPACE
* SCNR PROC    ,                   Scanning procedure
*      GETLG   MAXLEN,XSP          Get maximum length
*      LVALUE  YSIZ,YPTR           Get least value
*      AEQLC   FULLCL,0,SCNR1      Check &FULLSCAN
*      ACOMP   YSIZ,MAXLEN,FAIL    CHeck maximum against minimum
                                                             SPACE
         USING SCNR,11                   .
SCNR     L     15,XSP                    . 0057CE 58F0 A5D0
         STM   15,0,MAXLEN               . 0057D2 90F0 9EA8
         L     15,@@LVAL                 . 0057D6 58F0 A95C
         LA    1,YSIZ                    . 0057DA 4110 A430
         L     2,YPTR                    . 0057DE 5820 A428
         BALR  14,15                          CALL                     *
                                         . 0057E2 05EF
         C     0,FULLCL                  . 0057E4 5900 9868
         BNE   SCNR1                     . 0057E8 4770 B02A
         L     1,YSIZ                    . 0057EC 5810 A430
         C     1,MAXLEN                  . 0057F0 5910 9EA8
         BH    FAIL                      . 0057F4 4720 9010
                                                             SPACE
* SCNR1 SETSP  TXSP,XSP            Set up working specifier for head
*      SETLC   TXSP,0              Zero length
*      MOVD    PDLPTR,PDLHED       Initialize history list
*      MOVD    NAMICL,NHEDCL       Initialize name list
*      AEQLC   ANCCL,0,SCNR3       Check &ANCHOR
*      AEQLC   FULLCL,0,,SCNR4     Check &FULLSCAN
*      MOVD    YSIZ,MAXLEN         Set up length
*      BRANCH  SCNR5               Join processing
                                                             SPACE
SCNR1    LM    1,4,XSP                   . 0057F8 9814 A5D0
         STM   1,4,TXSP                  . 0057FC 9014 A5B0
         ST    0,TXSP                    . 005800 5000 A5B0
         LD    0,PDLHED                  . 005804 6800 9F48
         STD   0,PDLPTR                  . 005808 6000 9EF0
         LD    0,NHEDCL                  . 00580C 6800 9EC0
         STD   0,NAMICL                  . 005810 6000 9EB8
         C     0,ANCCL                   . 005814 5900 98B8
         BNE   SCNR3                     . 005818 4770 B0DE
         C     0,FULLCL                  . 00581C 5900 9868
         BE    SCNR4                     . 005820 4780 B062
         LD    0,MAXLEN                  . 005824 6800 9EA8
         STD   0,YSIZ                    . 005828 6000 A430
         B     SCNR5                     . 00582C 47F0 B06E
                                                             SPACE
* SCNR4 SUBTRT YSIZ,MAXLEN,YSIZ    Get difference of lengths
                                                             SPACE
SCNR4    LM    1,2,MAXLEN                . 005830 9812 9EA8
         S     1,YSIZ                    . 005834 5B10 A430
         STM   1,2,YSIZ                  . 005838 9012 A430
                                                             SPACE
* SCNR5 SUM    YSIZ,YSIZ,CHARCL    Add one
                                                             SPACE
SCNR5    L     1,YSIZ                    . 00583C 5810 A430
         LA    1,1(1)                    . 005840 4111 0001
         ST    1,YSIZ                    . 005844 5010 A430
                                                             SPACE
* SCNR2 PUSH   (YPTR,YSIZ)         Save pattern and length
*      SETSP   HEADSP,TXSP         Set up head specifier
*      INCRA   PDLPTR,3*DESCR      Make room for history entry
*      ACOMP   PDLPTR,PDLEND,INTR31
*                                  Check for overflow
*      SETAC   LENFCL,1            Set length failure
*      PUTDC   PDLPTR,DESCR,SCONCL Insert scan function
*      GETLG   TMVAL,TXSP          Get cursor position
*      PUTDC   PDLPTR,2*DESCR,TMVAL
*                                  Insert on history list
*      PUTDC   PDLPTR,3*DESCR,LENFCL
*                                  Insert length failure
*      BRANCH  SCIN1               Join common scanning
                                                             SPACE
SCNR2    LD    0,YPTR                    . 005848 6800 A428
         STD   0,104(12)                 . 00584C 600C 0068
         LD    0,YSIZ                    . 005850 6800 A430
         STD   0,112(12)                 . 005854 600C 0070
         LA    12,16(12)                 . 005858 41CC 0010
         C     12,@@STACKT               . 00585C 59C0 A828
         BH    OVER                      . 005860 4720 9664
         LM    1,4,TXSP                  . 005864 9814 A5B0
         STM   1,4,HEADSP                . 005868 9014 A560
         L     1,PDLPTR                  . 00586C 5810 9EF0
         LA    1,24(1)                   . 005870 4111 0018
         ST    1,PDLPTR                  . 005874 5010 9EF0
         C     1,PDLEND                  . 005878 5910 9EE8
         BH    INTR31                    . 00587C 4720 962C
         LA    2,1                       . 005880 4120 0001
         ST    2,FNVLCL                  . 005884 5020 9BC0
         LD    0,SCONCL                  . 005888 6800 9DC8
         STD   0,8(1)                    . 00588C 6001 0008
         L     15,TXSP                   . 005890 58F0 A5B0
         STM   15,0,TMVAL                . 005894 90F0 A3C8
         LD    0,TMVAL                   . 005898 6800 A3C8
         STD   0,16(1)                   . 00589C 6001 0010
         LD    0,FNVLCL                  . 0058A0 6800 9BC0
         STD   0,24(1)                   . 0058A4 6001 0018
         B     SCIN1                     . 0058A8 47F0 B11E
                                                             SPACE
* SCNR3 INCRA  PDLPTR,3*DESCR      Make room for history entry
*      ACOMP   PDLPTR,PDLEND,INTR31
*                                  Check for overflow
*      SETLC   HEADSP,0            Zero length of head
*      PUTDC   PDLPTR,DESCR,SCFLCL Insert scan failure function
*      GETLG   TMVAL,TXSP          Get cursor position
*      PUTDC   PDLPTR,2*DESCR,TMVAL
*                                  Insert on history list
*      PUTDC   PDLPTR,3*DESCR,LENFCL
*                                  Insert length failure
*      BRANCH  SCIN1               Join common scanning
                                                             SPACE
SCNR3    L     1,PDLPTR                  . 0058AC 5810 9EF0
         LA    1,24(1)                   . 0058B0 4111 0018
         ST    1,PDLPTR                  . 0058B4 5010 9EF0
         C     1,PDLEND                  . 0058B8 5910 9EE8
         BH    INTR31                    . 0058BC 4720 962C
         ST    0,HEADSP                  . 0058C0 5000 A560
         LD    0,SCFLCL                  . 0058C4 6800 9DB8
         STD   0,8(1)                    . 0058C8 6001 0008
         L     15,TXSP                   . 0058CC 58F0 A5B0
         STM   15,0,TMVAL                . 0058D0 90F0 A3C8
         LD    0,TMVAL                   . 0058D4 6800 A3C8
         STD   0,16(1)                   . 0058D8 6001 0010
         LD    0,FNVLCL                  . 0058DC 6800 9BC0
         STD   0,24(1)                   . 0058E0 6001 0018
         B     SCIN1                     . 0058E4 47F0 B11E
                                                             SPACE
* SCIN PROC    SCNR
                                                             SPACE
SCIN     L     11,@@SCNR                 . 0058E8 58B0 A960
                                                             SPACE
* SCIN1 MOVD   PATBCL,YPTR         Set up pattern base pointer
*      SETAC   PATICL,0            Zero offset
                                                             SPACE
SCIN1    LD    0,YPTR                    . 0058EC 6800 A428
         STD   0,PATBCL                  . 0058F0 6000 A488
         ST    0,PATICL                  . 0058F4 5000 9EE0
                                                             SPACE
* SCIN2 SETAC  LENFCL,1            Set length failure
                                                             SPACE
SCIN2    LA    1,1                       . 0058F8 4110 0001
         ST    1,FNVLCL                  . 0058FC 5010 9BC0
                                                             SPACE
* SCIN3 INCRA  PATICL,DESCR        Increment offset
*      GETD    ZCL,PATBCL,PATICL   Get function descriptor
*      INCRA   PATICL,DESCR        Increment offset
*      GETD    XCL,PATBCL,PATICL   Get then-or descriptor
*      INCRA   PATICL,DESCR        Increment offset
*      GETD    YCL,PATBCL,PATICL   Get value-residual descriptor
*      INCRA   PDLPTR,3*DESCR      Make room for history entry
*      ACOMP   PDLPTR,PDLEND,INTR31
*                                  Check for overflow
*      PUTDC   PDLPTR,DESCR,XCL    Insert then-or descriptor
*      GETLG   TMVAL,TXSP          Get cursor position
*      MOVV    TMVAL,YCL           Insert residual
*      PUTDC   PDLPTR,2*DESCR,TMVAL
*                                  Insert on history list
*      PUTDC   PDLPTR,3*DESCR,LENFCL
*                                  Insert length failure
*      AEQLC   FULLCL,0,SCIN4      Check &FULLSCAN
*      CHKVAL  MAXLEN,YCL,TXSP,SALT1
*                                  Check values
                                                             SPACE
SCIN3    L     1,PATICL                  . 005900 5810 9EE0
         AR    1,8                       . 005904 1A18
         L     2,PATBCL                  . 005906 5820 A488
         LD    0,0(1,2)                  . 00590A 6801 2000
         STD   0,ZCL                     . 00590E 6000 A438
         AR    1,8                       . 005912 1A18
         LD    0,0(1,2)                  . 005914 6801 2000
         STD   0,XCL                     . 005918 6000 A408
         AR    1,8                       . 00591C 1A18
         ST    1,PATICL                  . 00591E 5010 9EE0
         LD    0,0(1,2)                  . 005922 6801 2000
         STD   0,YCL                     . 005926 6000 A420
         L     1,PDLPTR                  . 00592A 5810 9EF0
         LA    1,24(1)                   . 00592E 4111 0018
         ST    1,PDLPTR                  . 005932 5010 9EF0
         C     1,PDLEND                  . 005936 5910 9EE8
         BH    INTR31                    . 00593A 4720 962C
         LD    0,XCL                     . 00593E 6800 A408
         STD   0,8(1)                    . 005942 6001 0008
         L     15,TXSP                   . 005946 58F0 A5B0
         STM   15,0,TMVAL                . 00594A 90F0 A3C8
         MVC   TMVAL$5(3),YCL$5          . 00594E D202 A3CD A425
         LD    0,TMVAL                   . 005954 6800 A3C8
         STD   0,16(1)                   . 005958 6001 0010
         LD    0,FNVLCL                  . 00595C 6800 9BC0
         STD   0,24(1)                   . 005960 6001 0018
         C     0,FULLCL                  . 005964 5900 9868
         BNE   SCIN4                     . 005968 4770 B1AC
         LR    6,15                      . 00596C 186F
         A     6,YCL                     . 00596E 5A60 A420
         C     6,MAXLEN                  . 005972 5960 9EA8
         BH    SALT1                     . 005976 4720 B1C6
                                                             SPACE
* SCIN4 BRANIC ZCL,0               Branch to procedure
                                                             SPACE
SCIN4    L     15,ZCL                    . 00597A 58F0 A438
         L     11,0(15)                  . 00597E 58BF 0000
         BR    11                        . 005982 07FB
                                                             SPACE
* SALF PROC    SCNR                Nonlength failure procedure
                                                             SPACE
SALF     L     11,@@SCNR                 . 005984 58B0 A960
                                                             SPACE
* SALF1 SETAC  LENFCL,0            Clear length failure
*      BRANCH  SALT2               Join common processing
                                                             SPACE
SALF1    ST    0,FNVLCL                  . 005988 5000 9BC0
         B     SALT2                     . 00598C 47F0 B1D2
                                                             SPACE
* SALT PROC    SCNR                Length failure procedure
                                                             SPACE
SALT     L     11,@@SCNR                 . 005990 58B0 A960
                                                             SPACE
* SALT1 GETDC  LENFCL,PDLPTR,3*DESCR
*                                  Get length failure from history
                                                             SPACE
SALT1    L     1,PDLPTR                  . 005994 5810 9EF0
         LD    0,24(1)                   . 005998 6801 0018
         STD   0,FNVLCL                  . 00599C 6000 9BC0
                                                             SPACE
* SALT2 GETDC  XCL,PDLPTR,DESCR    Get then-or descriptor
*      GETDC   YCL,PDLPTR,2*DESCR  Get value-residual
*      DECRA   PDLPTR,3*DESCR      Back over history entry
*      MOVD    PATICL,XCL          Set offset to OR link
*      AEQLC   PATICL,0,,SALT3     Check for none
*      PUTLG   TXSP,YCL            Insert old length of head
*      TESTF   PATICL,FNC,SCIN3    Check for function
*      BRANIC  PATICL,0            Branch to procedure
                                                             SPACE
SALT2    L     1,PDLPTR                  . 0059A0 5810 9EF0
         LD    0,8(1)                    . 0059A4 6801 0008
         STD   0,XCL                     . 0059A8 6000 A408
         LD    0,16(1)                   . 0059AC 6801 0010
         STD   0,YCL                     . 0059B0 6000 A420
         S     1,@@3YDESC                . 0059B4 5B10 A89C
         ST    1,PDLPTR                  . 0059B8 5010 9EF0
         LD    0,XCL                     . 0059BC 6800 A408
         STD   0,PATICL                  . 0059C0 6000 9EE0
         C     0,PATICL                  . 0059C4 5900 9EE0
         BE    SALT3                     . 0059C8 4780 B218
         L     1,YCL                     . 0059CC 5810 A420
         ST    1,TXSP                    . 0059D0 5010 A5B0
         TM    PATICL$4,X'04'            . 0059D4 9104 9EE4
         BNO   SCIN3                     . 0059D8 47E0 B132
         L     15,PATICL                 . 0059DC 58F0 9EE0
         L     11,0(15)                  . 0059E0 58BF 0000
         BR    11                        . 0059E4 07FB
                                                             SPACE
* SALT3 AEQLC  LENFCL,0,SALT1      Check length failure
*      BRANCH  SALF1               Go to nonlength failure
                                                             SPACE
SALT3    C     0,FNVLCL                  . 0059E6 5900 9BC0
         BNE   SALT1                     . 0059EA 4770 B1C6
         B     SALF1                     . 0059EE 47F0 B1BA
                                                             SPACE
* SCOK PROC    SCNR                Successful scanning procedure
*      SETAV   PATICL,XCL          Set offset from THEN link
*      AEQLC   PATICL,0,SCIN2,RTN2 Check for none
                                                             SPACE
SCOK     L     11,@@SCNR                 . 0059F2 58B0 A960
         L     15,XCL$4                  . 0059F6 58F0 A40C
         LA    15,0(15)                  . 0059FA 41FF 0000
         STM   15,0,PATICL               . 0059FE 90F0 9EE0
         CR    0,15                      . 005A02 190F
         BNE   SCIN2                     . 005A04 4770 B12A
         BE    RTN2                      . 005A08 4780 9028
                                                             SPACE
* SCON PROC    SCNR
*      AEQLC   FULLCL,0,SCON1      Check &FULLSCAN
*      AEQLC   LENFCL,0,FAIL       Check length failure
                                                             SPACE
SCON     L     11,@@SCNR                 . 005A0C 58B0 A960
         C     0,FULLCL                  . 005A10 5900 9868
         BNE   SCON1                     . 005A14 4770 B252
         C     0,FNVLCL                  . 005A18 5900 9BC0
         BNE   FAIL                      . 005A1C 4770 9010
                                                             SPACE
* SCON1 POP    (YSIZ,YPTR)         Restore save descriptors
*      DECRA   YSIZ,1              Decrement possible count
*      ACOMPC  YSIZ,0,,FAIL,INTR13 CHeck for end
*      ADDLG   TXSP,ONECL          Increment length of head
*      BRANCH  SCNR2               Continue
                                                             SPACE
SCON1    LD    0,96(12)                  . 005A20 680C 0060
         STD   0,YSIZ                    . 005A24 6000 A430
         LD    0,88(12)                  . 005A28 680C 0058
         STD   0,YPTR                    . 005A2C 6000 A428
         SR    12,8                      . 005A30 1BC8
         SR    12,8                      . 005A32 1BC8
         L     1,YSIZ                    . 005A34 5810 A430
         BCTR  1,0                            DECREMENT                *
                                         . 005A38 0610
         ST    1,YSIZ                    . 005A3A 5010 A430
         CR    0,1                       . 005A3E 1901
         BE    FAIL                      . 005A40 4780 9010
         BH    S4$010                    . 005A44 4720 95AC
         L     1,TXSP                    . 005A48 5810 A5B0
         LA    1,1(1)                    . 005A4C 4111 0001
         ST    1,TXSP                    . 005A50 5010 A5B0
         B     SCNR2                     . 005A54 47F0 B07A
                                                             SPACE
* UNSC PROC    SCNR                Backout procedure
*      MOVD    PATBCL,YPTR         Reset pattern base
*      BRANCH  SALT3               Join processing
UNSC     L     11,@@SCNR                 . 005A58 58B0 A960
         LD    0,YPTR                    . 005A5C 6800 A428
         STD   0,PATBCL                  . 005A60 6000 A488
         B     SALT3                     . 005A64 47F0 B218
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      ANY, BREAK, NOTANY, SPAN
*
                                                             SPACE
* ANYC PROC    ,                   Matching procedure for ANY(S)
*      SETAC   SCL,1               Post entry
                                                             SPACE
         USING ANYC,11                   .
ANYC     LA    1,1                       . 005A68 4110 0001
         ST    1,SCL                     . 005A6C 5010 9EF8
                                                             SPACE
* ABNS INCRA   PATICL,DESCR        Increment offset
*      GETD    XPTR,PATBCL,PATICL  Get argument
*      PUSH    SCL                 Save processor switch
                                                             SPACE
ABNS     L     1,PATICL                  . 005A70 5810 9EE0
         AR    1,8                       . 005A74 1A18
         ST    1,PATICL                  . 005A76 5010 9EE0
         L     2,PATBCL                  . 005A7A 5820 A488
         LD    0,0(1,2)                  . 005A7E 6801 2000
         STD   0,XPTR                    . 005A82 6000 A410
         LD    0,SCL                     . 005A86 6800 9EF8
         STD   0,104(12)                 . 005A8A 600C 0068
         AR    12,8                      . 005A8E 1AC8
         C     12,@@STACKT               . 005A90 59C0 A828
         BH    OVER                      . 005A94 4720 9664
                                                             SPACE
* ABNS1 VEQLC  XPTR,S,,ABNSV                                    E3.5.5
*      VEQLC   XPTR,E,,ABNSE       EXPRESSION must be evaluated
*      VEQLC   XPTR,I,,ABNSI                                    E3.5.6
*      POP     SCL                                              E3.5.6
*      BRANCH  SCDTER                                           E3.5.6
                                                             SPACE
ABNS1    CLC   XPTR(8),NULVCL            . 005A98 D507 A410 9ED0
         BE    SCNAME                    . 005A9E 4780 968C
         CLC   XPTR$5(3),@@S             . 005AA2 D502 A415 AA7B
         BE    ABNSV                     . 005AA8 4780 B0B4
         CLC   XPTR$5(3),@@E             . 005AAC D502 A415 AA81
         BE    ABNSE                     . 005AB2 4780 B05C
         CLC   XPTR$5(3),@@I             . 005AB6 D502 A415 AA84
         BNE   SCDTER                    . 005ABC 4770 9674
         BE    ABNSI                     . 005AC0 4780 B08C
                                                             SPACE
* ABNSE RCALL  XPTR,EXPVAL,XPTR,(ABNSF,ABNS1)                   E3.5.5
                                                             SPACE
ABNSE    LA    14,ABNSF                  . 005AC4 41E0 B080
         STM   11,14,104(12)             . 005AC8 90BE C068
         LR    13,12                     . 005ACC 18DC
         LD    0,XPTR                    . 005ACE 6800 A410
         STD   0,120(12)                 . 005AD2 600C 0078
         LA    12,24(12)                 . 005AD6 41CC 0018
         C     12,@@STACKT               . 005ADA 59C0 A828
         BH    OVER                      . 005ADE 4720 9664
         L     11,@@EXPVAL               . 005AE2 58B0 A930
         BR    11                        . 005AE6 07FB
                                                             SPACE
* ABNSF POP    SCL                                              E3.5.5
*      BRANCH  TSALF                                            E3.5.5
                                                             SPACE
ABNSF    STD   0,XPTR                    . 005AE8 6000 A410
         B     TSALF                     . 005AEC 47F0 9094
         B     ABNS1                     . 005AF0 47F0 B030
                                                             SPACE
* ABNSI RCALL  XPTR,GNVARI,XPTR
                                                             SPACE
ABNSI    LA    14,S4$05B18               . 005AF4 41E0 B0B0
         STM   11,14,104(12)             . 005AF8 90BE C068
         LR    13,12                     . 005AFC 18DC
         LD    0,XPTR                    . 005AFE 6800 A410
         STD   0,120(12)                 . 005B02 600C 0078
         LA    12,24(12)                 . 005B06 41CC 0018
         C     12,@@STACKT               . 005B0A 59C0 A828
         BH    OVER                      . 005B0E 4720 9664
         L     11,@@GNVARI               . 005B12 58B0 A94C
         BR    11                        . 005B16 07FB
S4$05B18 STD   0,XPTR                    . 005B18 6000 A410
                                                             SPACE
* ABNSV POP    SCL                 Restore procedure switch
*      AEQLC   XPTR,0,,SCNAME                                   E3.5.5
*      SELBRA  SCL,(,BRKV,NNYV,SPNV)
*                                  Select processor
                                                             SPACE
ABNSV    LD    0,96(12)                  . 005B1C 680C 0060
         STD   0,SCL                     . 005B20 6000 9EF8
         SR    12,8                      . 005B24 1BC8
         L     1,SCL                     . 005B26 5810 9EF8
         SLA   1,2                       . 005B2A 8B10 0002
S4$05B2E B     S4$05B2E(1)               . 005B2E 47F1 B0C6
         B     ANYV                      . 005B32 47F0 B0DA
         B     BRKV                      . 005B36 47F0 B1DA
         B     NNYV                      . 005B3A 47F0 B27A
         B     SPNV                      . 005B3E 47F0 B31C
                                                             SPACE
* ANYV DEQL    XPTR,TBLCS,ANYC2    Was last argument the same?
*      AEQL    TBLFNC,ANYCCL,,ANYC3
*                                  If so, was last procedure for ANY(S)
                                                             SPACE
ANYV     CLC   XPTR(8),TBLCS             . 005B42 D507 A410 A3C0
         BNE   ANYC2                     . 005B48 4770 B0F0
         L     1,TBLFNC                  . 005B4C 5810 9F10
         C     1,ANYCCL                  . 005B50 5910 9CD0
         BE    ANYC3                     . 005B54 4780 B168
                                                             SPACE
* ANYC2 CLERTB SNABTB,ERROR        If not, clear stream table
*      LOCSP   YSP,XPTR
*      PLUGTB  SNABTB,STOP,YSP     Plug entries for characters
*      MOVD    TBLCS,XPTR          Save argument to check next time
*      MOVD    TBLFNC,ANYCCL       Save procedure to check next time
                                                             SPACE
ANYC2    L     1,HEX0C4                  . 005B58 5810 A758
         L     3,@@SNABTB                . 005B5C 5830 A978
         LR    5,0                       . 005B60 1850
         LA    6,4                       . 005B62 4160 0004
         LA    7,252                     . 005B66 4170 00FC
S4$05B6A ST    1,0(3,5)                  . 005B6A 5013 5000
         BXLE  5,6,S4$05B6A              . 005B6E 8756 B102
         LM    3,4,XPTR                  . 005B72 9834 A410
         CR    0,3                       . 005B76 1903
         BNE   S4$05B84                  . 005B78 4770 B11C
         ST    0,YSP                     . 005B7C 5000 A5E0
         B     S4$05B94                  . 005B80 47F0 B12C
S4$05B84 L     1,4(3)                    . 005B84 5813 0004
         LA    1,0(1)                    . 005B88 4111 0000
         LA    2,32                      . 005B8C 4120 0020
         STM   1,4,YSP                   . 005B90 9014 A5E0
S4$05B94 LM    1,2,YSP$4                 . 005B94 9812 A5E4
         AR    1,2                       . 005B98 1A12
         LR    3,0                       . 005B9A 1830
         L     4,@@SNABTB                . 005B9C 5840 A978
         LR    5,0                       . 005BA0 1850
         LA    6,1                       . 005BA2 4160 0001
         L     7,YSP                     . 005BA6 5870 A5E0
         SR    1,6                       . 005BAA 1B16
         L     2,HEX04                   . 005BAC 5820 A764
S4$05BB0 BXH   5,6,S4$05BC0              . 005BB0 8656 B158
         IC    3,0(1,5)                  . 005BB4 4331 5000
         STC   2,0(3,4)                  . 005BB8 4223 4000
         B     S4$05BB0                  . 005BBC 47F0 B148
S4$05BC0 LD    0,XPTR                    . 005BC0 6800 A410
         STD   0,TBLCS                   . 005BC4 6000 A3C0
         LD    0,ANYCCL                  . 005BC8 6800 9CD0
         STD   0,TBLFNC                  . 005BCC 6000 9F10
                                                             SPACE
* ANYC3 SETSP  VSP,XSP             Set up working specifier
*      AEQLC   FULLCL,0,ANYC4      Leave length alone in FULLSCAN mode
*      PUTLG   VSP,MAXLEN          Else insert maximum length
*      LCOMP   VSP,TXSP,,,TSALT    Length failure if too short
*      CHKVAL  MAXLEN,ZEROCL,XSP,,ANYC4,ANYC4                   E3.5.7
*      ADDLG   VSP,ONECL                                        E3.5.7
                                                             SPACE
ANYC3    LM    1,4,XSP                   . 005BD0 9814 A5D0
         STM   1,4,VSP                   . 005BD4 9014 A5C0
         C     0,FULLCL                  . 005BD8 5900 9868
         BNE   ANYC4                     . 005BDC 4770 B188
         L     1,MAXLEN                  . 005BE0 5810 9EA8
         ST    1,VSP                     . 005BE4 5010 A5C0
         C     1,TXSP                    . 005BE8 5910 A5B0
         BL    TSALT                     . 005BEC 4740 909A
                                                             SPACE
* ANYC4 REMSP  YSP,VSP,TXSP        Get specifier to unscanned portion
*      STREAM  ZSP,YSP,SNABTB,TSALF,TSALT
*      GETLG   XPTR,ZSP            Get length accepted
*      ADDLG   TXSP,XPTR           Add to length matched
*      BRANCH  SCOK,SCNR           Return to success point
                                                             SPACE
ANYC4    LM    1,4,VSP                   . 005BF0 9814 A5C0
         L     5,TXSP                    . 005BF4 5850 A5B0
         AR    2,5                       . 005BF8 1A25
         SR    1,5                       . 005BFA 1B15
         STM   1,4,YSP                   . 005BFC 9014 A5E0
         L     15,@@STREAM               . 005C00 58F0 A840
         LA    1,ZSP                     . 005C04 4110 A5F0
         LA    2,YSP                     . 005C08 4120 A5E0
         L     3,@@SNABTB                . 005C0C 5830 A978
         BALR  14,15                          CALL                     *
                                         . 005C10 05EF
         B     TSALF                     . 005C12 47F0 9094
         B     TSALT                     . 005C16 47F0 909A
         L     15,ZSP                    . 005C1A 58F0 A5F0
         STM   15,0,XPTR                 . 005C1E 90F0 A410
         L     1,TXSP                    . 005C22 5810 A5B0
         AR    1,15                      . 005C26 1A1F
         ST    1,TXSP                    . 005C28 5010 A5B0
         L     11,@@SCOK                 . 005C2C 58B0 A97C
         BR    11                        . 005C30 07FB
                                                             SPACE
* BRKC PROC    ANYC                Matching procedure for BREAK(S)
*      SETAC   SCL,2               Post entry
*      BRANCH  ABNS
                                                             SPACE
BRKC     L     11,@@ANYC                 . 005C32 58B0 A980
         LA    1,2                       . 005C36 4110 0002
         ST    1,SCL                     . 005C3A 5010 9EF8
         B     ABNS                      . 005C3E 47F0 B008
                                                             SPACE
* BRKV DEQL    XPTR,TBLCS,BRKC2    Was last argument the same?
*      AEQL    TBLFNC,BRKCCL,,ANYC3
*                                  Was the last procedure for BREAK
                                                             SPACE
BRKV     CLC   XPTR(8),TBLCS             . 005C42 D507 A410 A3C0
         BNE   BRKC2                     . 005C48 4770 B1F0
         L     1,TBLFNC                  . 005C4C 5810 9F10
         C     1,BRKCCL                  . 005C50 5910 9CF0
         BE    ANYC3                     . 005C54 4780 B168
                                                             SPACE
* BRKC2 CLERTB SNABTB,CONTIN       If not, clear stream table
*      LOCSP   YSP,XPTR
*      PLUGTB  SNABTB,STOPSH,YSP   Plug entries for characters
*      MOVD    TBLCS,XPTR          Save argument to check next time
*      MOVD    TBLFNC,BRKCCL       Save procedure to check next time
*      BRANCH  ANYC3               Proceed
                                                             SPACE
BRKC2    LR    1,0                       . 005C58 1810
         L     3,@@SNABTB                . 005C5A 5830 A978
         LR    5,0                       . 005C5E 1850
         LA    6,4                       . 005C60 4160 0004
         LA    7,252                     . 005C64 4170 00FC
S4$05C68 ST    1,0(3,5)                  . 005C68 5013 5000
         BXLE  5,6,S4$05C68              . 005C6C 8756 B200
         LM    3,4,XPTR                  . 005C70 9834 A410
         CR    0,3                       . 005C74 1903
         BNE   S4$05C82                  . 005C76 4770 B21A
         ST    0,YSP                     . 005C7A 5000 A5E0
         B     S4$05C92                  . 005C7E 47F0 B22A
S4$05C82 L     1,4(3)                    . 005C82 5813 0004
         LA    1,0(1)                    . 005C86 4111 0000
         LA    2,32                      . 005C8A 4120 0020
         STM   1,4,YSP                   . 005C8E 9014 A5E0
S4$05C92 LM    1,2,YSP$4                 . 005C92 9812 A5E4
         AR    1,2                       . 005C96 1A12
         LR    3,0                       . 005C98 1830
         L     4,@@SNABTB                . 005C9A 5840 A978
         LR    5,0                       . 005C9E 1850
         LA    6,1                       . 005CA0 4160 0001
         L     7,YSP                     . 005CA4 5870 A5E0
         SR    1,6                       . 005CA8 1B16
         L     2,HEX08                   . 005CAA 5820 A768
S4$05CAE BXH   5,6,S4$05CBE              . 005CAE 8656 B256
         IC    3,0(1,5)                  . 005CB2 4331 5000
         STC   2,0(3,4)                  . 005CB6 4223 4000
         B     S4$05CAE                  . 005CBA 47F0 B246
S4$05CBE LD    0,XPTR                    . 005CBE 6800 A410
         STD   0,TBLCS                   . 005CC2 6000 A3C0
         LD    0,BRKCCL                  . 005CC6 6800 9CF0
         STD   0,TBLFNC                  . 005CCA 6000 9F10
         B     ANYC3                     . 005CCE 47F0 B168
                                                             SPACE
* NNYC PROC    ANYC                Matching procedure for NOTANY(S)
*      SETAC   SCL,3               Post entry
*      BRANCH  ABNS
                                                             SPACE
NNYC     L     11,@@ANYC                 . 005CD2 58B0 A980
         LA    1,3                       . 005CD6 4110 0003
         ST    1,SCL                     . 005CDA 5010 9EF8
         B     ABNS                      . 005CDE 47F0 B008
                                                             SPACE
* NNYV DEQL    XPTR,TBLCS,NNYC2    Was last argument the same?
*      AEQL    TBLFNC,NNYCCL,,ANYC3
*                                  Was the last procedure for NOTANY?
                                                             SPACE
NNYV     CLC   XPTR(8),TBLCS             . 005CE2 D507 A410 A3C0
         BNE   NNYC2                     . 005CE8 4770 B290
         L     1,TBLFNC                  . 005CEC 5810 9F10
         C     1,NNYCCL                  . 005CF0 5910 9D90
         BE    ANYC3                     . 005CF4 4780 B168
                                                             SPACE
* NNYC2 CLERTB SNABTB,STOP         If not, clear stream table
*      LOCSP   YSP,XPTR
*      PLUGTB  SNABTB,ERROR,YSP    Plug entries for characters
*      MOVD    TBLCS,XPTR          Save argument to check next time
*      MOVD    TBLFNC,NNYCCL       Save procedure to check next time
*      BRANCH  ANYC3               Proceed
                                                             SPACE
NNYC2    L     1,HEX044                  . 005CF8 5810 A75C
         L     3,@@SNABTB                . 005CFC 5830 A978
         LR    5,0                       . 005D00 1850
         LA    6,4                       . 005D02 4160 0004
         LA    7,252                     . 005D06 4170 00FC
S4$05D0A ST    1,0(3,5)                  . 005D0A 5013 5000
         BXLE  5,6,S4$05D0A              . 005D0E 8756 B2A2
         LM    3,4,XPTR                  . 005D12 9834 A410
         CR    0,3                       . 005D16 1903
         BNE   S4$05D24                  . 005D18 4770 B2BC
         ST    0,YSP                     . 005D1C 5000 A5E0
         B     S4$05D34                  . 005D20 47F0 B2CC
S4$05D24 L     1,4(3)                    . 005D24 5813 0004
         LA    1,0(1)                    . 005D28 4111 0000
         LA    2,32                      . 005D2C 4120 0020
         STM   1,4,YSP                   . 005D30 9014 A5E0
S4$05D34 LM    1,2,YSP$4                 . 005D34 9812 A5E4
         AR    1,2                       . 005D38 1A12
         LR    3,0                       . 005D3A 1830
         L     4,@@SNABTB                . 005D3C 5840 A978
         LR    5,0                       . 005D40 1850
         LA    6,1                       . 005D42 4160 0001
         L     7,YSP                     . 005D46 5870 A5E0
         SR    1,6                       . 005D4A 1B16
         L     2,HEX0C                   . 005D4C 5820 A76C
S4$05D50 BXH   5,6,S4$05D60              . 005D50 8656 B2F8
         IC    3,0(1,5)                  . 005D54 4331 5000
         STC   2,0(3,4)                  . 005D58 4223 4000
         B     S4$05D50                  . 005D5C 47F0 B2E8
S4$05D60 LD    0,XPTR                    . 005D60 6800 A410
         STD   0,TBLCS                   . 005D64 6000 A3C0
         LD    0,NNYCCL                  . 005D68 6800 9D90
         STD   0,TBLFNC                  . 005D6C 6000 9F10
         B     ANYC3                     . 005D70 47F0 B168
                                                             SPACE
* SPNC PROC    ANYC                Matching procedure for SPAN(S)
*      SETAC   SCL,4               Post entry
*      BRANCH  ABNS
                                                             SPACE
SPNC     L     11,@@ANYC                 . 005D74 58B0 A980
         LA    1,4                       . 005D78 4110 0004
         ST    1,SCL                     . 005D7C 5010 9EF8
         B     ABNS                      . 005D80 47F0 B008
                                                             SPACE
* SPNV DEQL    XPTR,TBLCS,SPNC2    Was last argument the same?
*      AEQL    TBLFNC,SPNCCL,,SPNC3
*                                  Was the last procedure for SPAN?
                                                             SPACE
SPNV     CLC   XPTR(8),TBLCS             . 005D84 D507 A410 A3C0
         BNE   SPNC2                     . 005D8A 4770 B332
         L     1,TBLFNC                  . 005D8E 5810 9F10
         C     1,SPNCCL                  . 005D92 5910 9DD8
         BE    SPNC3                     . 005D96 4780 B3A8
                                                             SPACE
* SPNC2 CLERTB SNABTB,STOPSH       If not, clear stream table
*      LOCSP   YSP,XPTR
*      PLUGTB  SNABTB,CONTIN,YSP   Plug entries for characters
*      MOVD    TBLCS,XPTR          Save argument to check next time
*      MOVD    TBLFNC,SPNCCL       Save procedure to check next time
                                                             SPACE
SPNC2    L     1,HEX084                  . 005D9A 5810 A760
         L     3,@@SNABTB                . 005D9E 5830 A978
         LR    5,0                       . 005DA2 1850
         LA    6,4                       . 005DA4 4160 0004
         LA    7,252                     . 005DA8 4170 00FC
S4$05DAC ST    1,0(3,5)                  . 005DAC 5013 5000
         BXLE  5,6,S4$05DAC              . 005DB0 8756 B344
         LM    3,4,XPTR                  . 005DB4 9834 A410
         CR    0,3                       . 005DB8 1903
         BNE   S4$05DC6                  . 005DBA 4770 B35E
         ST    0,YSP                     . 005DBE 5000 A5E0
         B     S4$05DD6                  . 005DC2 47F0 B36E
S4$05DC6 L     1,4(3)                    . 005DC6 5813 0004
         LA    1,0(1)                    . 005DCA 4111 0000
         LA    2,32                      . 005DCE 4120 0020
         STM   1,4,YSP                   . 005DD2 9014 A5E0
S4$05DD6 LM    1,2,YSP$4                 . 005DD6 9812 A5E4
         AR    1,2                       . 005DDA 1A12
         LR    3,0                       . 005DDC 1830
         L     4,@@SNABTB                . 005DDE 5840 A978
         LR    5,0                       . 005DE2 1850
         LA    6,1                       . 005DE4 4160 0001
         L     7,YSP                     . 005DE8 5870 A5E0
         SR    1,6                       . 005DEC 1B16
         LR    2,0                       . 005DEE 1820
S4$05DF0 BXH   5,6,S4$05E00              . 005DF0 8656 B398
         IC    3,0(1,5)                  . 005DF4 4331 5000
         STC   2,0(3,4)                  . 005DF8 4223 4000
         B     S4$05DF0                  . 005DFC 47F0 B388
S4$05E00 LD    0,XPTR                    . 005E00 6800 A410
         STD   0,TBLCS                   . 005E04 6000 A3C0
         LD    0,SPNCCL                  . 005E08 6800 9DD8
         STD   0,TBLFNC                  . 005E0C 6000 9F10
                                                             SPACE
* SPNC3 LCOMP  XSP,TXSP,,TSALT,TSALT
*                                  Length failure if too short
*      REMSP   YSP,XSP,TXSP        Get specifier to unscanned portion
*      STREAM  ZSP,YSP,SNABTB,TSALF
*      LEQLC   ZSP,0,,TSALF        Failure if length accepted is zero
*      GETLG   XPTR,ZSP            Get length of accepted portion
*      AEQLC   FULLCL,0,SPNC5      Skip length check in FULLSCAN mode
*      CHKVAL  MAXLEN,XPTR,TXSP,TSALT
                                                             SPACE
SPNC3    L     1,XSP                     . 005E10 5810 A5D0
         C     1,TXSP                    . 005E14 5910 A5B0
         BNH   TSALT                     . 005E18 47D0 909A
         LM    1,4,XSP                   . 005E1C 9814 A5D0
         L     5,TXSP                    . 005E20 5850 A5B0
         AR    2,5                       . 005E24 1A25
         SR    1,5                       . 005E26 1B15
         STM   1,4,YSP                   . 005E28 9014 A5E0
         L     15,@@STREAM               . 005E2C 58F0 A840
         LA    1,ZSP                     . 005E30 4110 A5F0
         LA    2,YSP                     . 005E34 4120 A5E0
         L     3,@@SNABTB                . 005E38 5830 A978
         BALR  14,15                          CALL                     *
                                         . 005E3C 05EF
         B     TSALF                     . 005E3E 47F0 9094
         B     S4$05E46                  . 005E42 47F0 B3DE
S4$05E46 C     0,ZSP                     . 005E46 5900 A5F0
         BE    TSALF                     . 005E4A 4780 9094
         L     15,ZSP                    . 005E4E 58F0 A5F0
         STM   15,0,XPTR                 . 005E52 90F0 A410
         C     0,FULLCL                  . 005E56 5900 9868
         BNE   SPNC5                     . 005E5A 4770 B404
         L     6,TXSP                    . 005E5E 5860 A5B0
         AR    6,15                      . 005E62 1A6F
         C     6,MAXLEN                  . 005E64 5960 9EA8
         BH    TSALT                     . 005E68 4720 909A
                                                             SPACE
* SPNC5 ADDLG  TXSP,XPTR           Add length accepted
*      BRANCH  SCOK,SCNR
SPNC5    L     1,TXSP                    . 005E6C 5810 A5B0
         A     1,XPTR                    . 005E70 5A10 A410
         ST    1,TXSP                    . 005E74 5010 A5B0
         L     11,@@SCOK                 . 005E78 58B0 A97C
         BR    11                        . 005E7C 07FB
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      LEN, POS, RPOS, RTAB, TAB
*
                                                             SPACE
* LNTH PROC    ,                   Matching procedure for LEN(N)
*      SETAC   SCL,1               Note entry
                                                             SPACE
         USING LNTH,11                   .
LNTH     LA    1,1                       . 005E7E 4110 0001
         ST    1,SCL                     . 005E82 5010 9EF8
                                                             SPACE
* LPRRT INCRA  PATICL,DESCR        Increment offset
*      GETD    XPTR,PATBCL,PATICL  Get argument
*      PUSH    SCL                 Save entry indicator
*
                                                             SPACE
LPRRT    L     1,PATICL                  . 005E86 5810 9EE0
         AR    1,8                       . 005E8A 1A18
         ST    1,PATICL                  . 005E8C 5010 9EE0
         L     2,PATBCL                  . 005E90 5820 A488
         LD    0,0(1,2)                  . 005E94 6801 2000
         STD   0,XPTR                    . 005E98 6000 A410
         LD    0,SCL                     . 005E9C 6800 9EF8
         STD   0,104(12)                 . 005EA0 600C 0068
         AR    12,8                      . 005EA4 1AC8
         C     12,@@STACKT               . 005EA6 59C0 A828
         BH    OVER                      . 005EAA 4720 9664
                                                             SPACE
* LPRRT1 VEQLC XPTR,I,,LPRRTI      Is it INTEGER?
*      VEQLC   XPTR,E,,LPRRTE      Is it EXPRESSION?
*      VEQLC   XPTR,S,,LPRRTV                                   E3.5.6
*      POP     SCL                                              E3.5.6
*      BRANCH  SCDTER              Is it STRING?                E3.5.6
                                                             SPACE
LPRRT1   CLC   XPTR$5(3),@@I             . 005EAE D502 A415 AA84
         BE    LPRRTI                    . 005EB4 4780 B0B6
         CLC   XPTR$5(3),@@E             . 005EB8 D502 A415 AA81
         BE    LPRRTE                    . 005EBE 4780 B052
         CLC   XPTR$5(3),@@S             . 005EC2 D502 A415 AA7B
         BNE   SCDTER                    . 005EC8 4770 9674
         BE    LPRRTV                    . 005ECC 4780 B082
                                                             SPACE
* LPRRTE RCALL XPTR,EXPVAL,XPTR,(,LPRRT1)                       E3.2.1
*      POP     SCL                                              E3.2.1
*      BRANCH  TSALF                                            E3.2.1
*                                  Evaluate EXPRESSION
                                                             SPACE
LPRRTE   LA    14,S4$05EF4               . 005ED0 41E0 B076
         STM   11,14,104(12)             . 005ED4 90BE C068
         LR    13,12                     . 005ED8 18DC
         LD    0,XPTR                    . 005EDA 6800 A410
         STD   0,120(12)                 . 005EDE 600C 0078
         LA    12,24(12)                 . 005EE2 41CC 0018
         C     12,@@STACKT               . 005EE6 59C0 A828
         BH    OVER                      . 005EEA 4720 9664
         L     11,@@EXPVAL               . 005EEE 58B0 A930
         BR    11                        . 005EF2 07FB
S4$05EF4 STD   0,XPTR                    . 005EF4 6000 A410
         B     S4$05FE2                  . 005EF8 47F0 B164
         B     LPRRT1                    . 005EFC 47F0 B030
                                                             SPACE
* LPRRTV LOCSP ZSP,XPTR            Get specifier
*      SPCINT  XPTR,ZSP,SCDTER     Convert to INTEGER
                                                             SPACE
LPRRTV   LM    3,4,XPTR                  . 005F00 9834 A410
         CR    0,3                       . 005F04 1903
         BNE   S4$05F12                  . 005F06 4770 B094
         ST    0,ZSP                     . 005F0A 5000 A5F0
         B     S4$05F22                  . 005F0E 47F0 B0A4
S4$05F12 L     1,4(3)                    . 005F12 5813 0004
         LA    1,0(1)                    . 005F16 4111 0000
         LA    2,32                      . 005F1A 4120 0020
         STM   1,4,ZSP                   . 005F1E 9014 A5F0
S4$05F22 L     15,@@DECBIN               . 005F22 58F0 A8EC
         LA    1,XPTR                    . 005F26 4110 A410
         LA    2,ZSP                     . 005F2A 4120 A5F0
         BALR  14,15                          CALL                     *
                                         . 005F2E 05EF
         B     SCDTER                    . 005F30 47F0 9674
                                                             SPACE
* LPRRTI POP   SCL                 Restore entry indicator
*      SELBRA  SCL,(,POSII,RPSII,RTBI,TBI)
*                                  Select matching procedure
*      ACOMPC  XPTR,0,,,SCLENR     Check for negative length
*      CHKVAL  MAXLEN,XPTR,TXSP,TSALT
*                                  Compare with maximum length
*      ADDLG   TXSP,XPTR           Add to length matched
*      BRANCH  SCOK,SCNR           Return successful match
                                                             SPACE
LPRRTI   LD    0,96(12)                  . 005F34 680C 0060
         STD   0,SCL                     . 005F38 6000 9EF8
         SR    12,8                      . 005F3C 1BC8
         L     1,SCL                     . 005F3E 5810 9EF8
         SLA   1,2                       . 005F42 8B10 0002
S4$05F46 B     S4$05F46(1)               . 005F46 47F1 B0C8
         B     S4$05F5E                  . 005F4A 47F0 B0E0
         B     POSII                     . 005F4E 47F0 B10A
         B     RPSII                     . 005F52 47F0 B136
         B     RTBI                      . 005F56 47F0 B16C
         B     TBI                       . 005F5A 47F0 B1CE
S4$05F5E C     0,XPTR                    . 005F5E 5900 A410
         BH    SCLENR                    . 005F62 4720 967C
         L     6,TXSP                    . 005F66 5860 A5B0
         A     6,XPTR                    . 005F6A 5A60 A410
         C     6,MAXLEN                  . 005F6E 5960 9EA8
         BH    TSALT                     . 005F72 4720 909A
         L     1,TXSP                    . 005F76 5810 A5B0
         A     1,XPTR                    . 005F7A 5A10 A410
         ST    1,TXSP                    . 005F7E 5010 A5B0
         L     11,@@SCOK                 . 005F82 58B0 A97C
         BR    11                        . 005F86 07FB
                                                             SPACE
* POSII ACOMPC XPTR,0,,,SCLENR     Check for negative position
*      GETLG   NVAL,TXSP           Get cursor position
*      ACOMP   XPTR,MAXLEN,TSALT   Check desired against maximum
*      ACOMP   XPTR,NVAL,TSALF,TSCOK
*                                  Ceck against cursor position
*      BRANCH  SALT,SCNR
                                                             SPACE
POSII    C     0,XPTR                    . 005F88 5900 A410
         BH    SCLENR                    . 005F8C 4720 967C
         L     15,TXSP                   . 005F90 58F0 A5B0
         STM   15,0,NVAL                 . 005F94 90F0 A3A8
         L     1,XPTR                    . 005F98 5810 A410
         C     1,MAXLEN                  . 005F9C 5910 9EA8
         BH    TSALT                     . 005FA0 4720 909A
         CR    1,15                      . 005FA4 191F
         BH    TSALF                     . 005FA6 4720 9094
         BE    TSCOK                     . 005FAA 4780 90A0
         L     11,@@SALT                 . 005FAE 58B0 A984
         BR    11                        . 005FB2 07FB
                                                             SPACE
* RPSII ACOMPC XPTR,0,,,SCLENR     Check for negative position
*      GETLG   NVAL,XSP            Get total length
*      SUBTRT  TVAL,NVAL,XPTR      Find desired position
*      GETLG   NVAL,TXSP           Get cursor position
*      ACOMP   NVAL,TVAL,TSALT,TSCOK,TSALF
*                                  Compare two positions
                                                             SPACE
RPSII    C     0,XPTR                    . 005FB4 5900 A410
         BH    SCLENR                    . 005FB8 4720 967C
         L     1,XSP                     . 005FBC 5810 A5D0
         L     2,NVAL$4                  . 005FC0 5820 A3AC
         S     1,XPTR                    . 005FC4 5B10 A410
         STM   1,2,TVAL                  . 005FC8 9012 A3E8
         L     15,TXSP                   . 005FCC 58F0 A5B0
         STM   15,0,NVAL                 . 005FD0 90F0 A3A8
         CR    15,1                      . 005FD4 19F1
         BH    TSALT                     . 005FD6 4720 909A
         BE    TSCOK                     . 005FDA 4780 90A0
         BL    TSALF                     . 005FDE 4740 9094
S4$05FE2 SR    12,8                      . 005FE2 1BC8
         B     TSALF                     . 005FE4 47F0 9094
         DC    X'9094'                   . 005FE8 9094
                                                             SPACE
* RTBI ACOMPC  XPTR,0,,,SCLENR     Check for negative length
*      GETLG   NVAL,XSP            Get total length
*      SUBTRT  TVAL,NVAL,XPTR      Find desired position
*      GETLG   NVAL,TXSP           Get current position
*      ACOMP   NVAL,TVAL,TSALT     Compare two positions
*      AEQLC   FULLCL,0,RTBII      Check &FULLSCAN
*      SETAV   NVAL,YCL            Get residual
*      SUBTRT  NVAL,MAXLEN,NVAL    Find maximum allowed position
*      ACOMP   NVAL,TVAL,,,TSALT   Compare with desired position
                                                             SPACE
RTBI     C     0,XPTR                    . 005FEA 5900 A410
         BH    SCLENR                    . 005FEE 4720 967C
         L     15,XSP                    . 005FF2 58F0 A5D0
         STM   15,0,NVAL                 . 005FF6 90F0 A3A8
         LM    1,2,NVAL                  . 005FFA 9812 A3A8
         S     1,XPTR                    . 005FFE 5B10 A410
         STM   1,2,TVAL                  . 006002 9012 A3E8
         L     15,TXSP                   . 006006 58F0 A5B0
         STM   15,0,NVAL                 . 00600A 90F0 A3A8
         LR    1,15                      . 00600E 181F
         C     1,TVAL                    . 006010 5910 A3E8
         BH    TSALT                     . 006014 4720 909A
         C     0,FULLCL                  . 006018 5900 9868
         BNE   RTBII                     . 00601C 4770 B1C0
         L     15,YCL$4                  . 006020 58F0 A424
         LA    15,0(15)                  . 006024 41FF 0000
         STM   15,0,NVAL                 . 006028 90F0 A3A8
         LM    1,2,MAXLEN                . 00602C 9812 9EA8
         SR    1,15                      . 006030 1B1F
         STM   1,2,NVAL                  . 006032 9012 A3A8
         C     1,TVAL                    . 006036 5910 A3E8
         BL    TSALT                     . 00603A 4740 909A
                                                             SPACE
* RTBII PUTLG  TXSP,TVAL           Update length of string matched
*      BRANCH  SCOK,SCNR
                                                             SPACE
RTBII    L     1,TVAL                    . 00603E 5810 A3E8
         ST    1,TXSP                    . 006042 5010 A5B0
         L     11,@@SCOK                 . 006046 58B0 A97C
         BR    11                        . 00604A 07FB
                                                             SPACE
* TBI  ACOMPC  XPTR,0,,,SCLENR     Check for negative length
*      GETLG   NVAL,TXSP           Get cursor position
*      ACOMP   NVAL,XPTR,TSALT     Check against desired position
*      ACOMP   XPTR,MAXLEN,TSALT   Check for tab beyond end
*      PUTLG   TXSP,XPTR           Update length of string matched
*      BRANCH  SCOK,SCNR
                                                             SPACE
TBI      C     0,XPTR                    . 00604C 5900 A410
         BH    SCLENR                    . 006050 4720 967C
         L     15,TXSP                   . 006054 58F0 A5B0
         STM   15,0,NVAL                 . 006058 90F0 A3A8
         LR    1,15                      . 00605C 181F
         C     1,XPTR                    . 00605E 5910 A410
         BH    TSALT                     . 006062 4720 909A
         L     1,XPTR                    . 006066 5810 A410
         C     1,MAXLEN                  . 00606A 5910 9EA8
         BH    TSALT                     . 00606E 4720 909A
         ST    1,TXSP                    . 006072 5010 A5B0
         L     11,@@SCOK                 . 006076 58B0 A97C
         BR    11                        . 00607A 07FB
                                                             SPACE
* POSI PROC    LNTH                Matching procedure for POS(N)
*      SETAC   SCL,2               Note entry
*      BRANCH  LPRRT               Join common processing
                                                             SPACE
POSI     L     11,@@LNTH                 . 00607C 58B0 A988
         LA    1,2                       . 006080 4110 0002
         ST    1,SCL                     . 006084 5010 9EF8
         B     LPRRT                     . 006088 47F0 B008
                                                             SPACE
* RPSI PROC    LNTH                Matching procedure for RPOS(N)
*      SETAC   SCL,3               Note entry
*      BRANCH  LPRRT               Join common processing
                                                             SPACE
RPSI     L     11,@@LNTH                 . 00608C 58B0 A988
         LA    1,3                       . 006090 4110 0003
         ST    1,SCL                     . 006094 5010 9EF8
         B     LPRRT                     . 006098 47F0 B008
                                                             SPACE
* RTB  PROC    LNTH                Matching procedure for RTAB(N)
*      SETAC   SCL,4               Note entry
*      BRANCH  LPRRT               Join common processing
                                                             SPACE
RTB      L     11,@@LNTH                 . 00609C 58B0 A988
         LA    1,4                       . 0060A0 4110 0004
         ST    1,SCL                     . 0060A4 5010 9EF8
         B     LPRRT                     . 0060A8 47F0 B008
                                                             SPACE
* TB   PROC    LNTH                Matching procedure for TAB(N)
*      SETAC   SCL,5               Note entry
*      BRANCH  LPRRT               Join common processing
TB       L     11,@@LNTH                 . 0060AC 58B0 A988
         LA    1,5                       . 0060B0 4110 0005
         ST    1,SCL                     . 0060B4 5010 9EF8
         B     LPRRT                     . 0060B8 47F0 B008
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      ARBNO
*
                                                             SPACE
* ARBN PROC    ,                   Matching for ARBNO(P)
*      GETLG   TMVAL,TXSP          Get cursor position
*      PUSH    TMVAL               Save cursor position
*      BRANCH  SCOK,SCNR           Return matching successfully
                                                             SPACE
         USING ARBN,11                   .
ARBN     L     15,TXSP                   . 0060BC 58F0 A5B0
         STM   15,0,TMVAL                . 0060C0 90F0 A3C8
         STM   15,0,104(12)              . 0060C4 90F0 C068
         AR    12,8                      . 0060C8 1AC8
         C     12,@@STACKT               . 0060CA 59C0 A828
         BH    OVER                      . 0060CE 4720 9664
         L     11,@@SCOK                 . 0060D2 58B0 A97C
         BR    11                        . 0060D6 07FB
                                                             SPACE
* ARBF PROC    ARBN                Backup matching for ARBNO(P)
*      POP     (TMVAL)             Restore cursor position
*      BRANCH  ONAR2               Join common processing
                                                             SPACE
ARBF     L     11,@@ARBN                 . 0060D8 58B0 A98C
         LD    0,96(12)                  . 0060DC 680C 0060
         STD   0,TMVAL                   . 0060E0 6000 A3C8
         SR    12,8                      . 0060E4 1BC8
         B     ONAR2                     . 0060E6 47F0 B0AA
                                                             SPACE
* EARB PROC    ARBN
*      POP     (TMVAL)             Restore cursor position
*      PUTDC   PDLPTR,DESCR,TMVAL  Insert on history list
*      GETLG   TMVAL,TXSP          Get cursor position
*      PUTDC   PDLPTR,2*DESCR,TMVAL
*      PUTDC   PDLPTR,3*DESCR,ZEROCL
*      BRANCH  SCOK,SCNR           Return matching successfully
                                                             SPACE
EARB     L     11,@@ARBN                 . 0060EA 58B0 A98C
         LD    0,96(12)                  . 0060EE 680C 0060
         STD   0,TMVAL                   . 0060F2 6000 A3C8
         SR    12,8                      . 0060F6 1BC8
         L     1,PDLPTR                  . 0060F8 5810 9EF0
         STD   0,8(1)                    . 0060FC 6001 0008
         L     15,TXSP                   . 006100 58F0 A5B0
         STM   15,0,TMVAL                . 006104 90F0 A3C8
         STM   15,0,16(1)                . 006108 90F0 1010
         LD    0,ZEROCL                  . 00610C 6800 9C90
         STD   0,24(1)                   . 006110 6001 0018
         L     11,@@SCOK                 . 006114 58B0 A97C
         BR    11                        . 006118 07FB
                                                             SPACE
* ONAR PROC    ARBN
*      AEQLC   FULLCL,0,TSCOK      Check &FULLSCAN
*      MOVD    TVAL,ZEROCL
*      GETAC   TVAL,PDLPTR,-2*DESCR
*                                  Get old cursor position
*      GETLG   TMVAL,TXSP          Get current cursor position
*      ACOMP   TVAL,TMVAL,TSCOK,,TSCOK
*                                  Compare positions
                                                             SPACE
ONAR     L     11,@@ARBN                 . 00611A 58B0 A98C
         C     0,FULLCL                  . 00611E 5900 9868
         BNE   TSCOK                     . 006122 4770 90A0
         L     1,PDLPTR                  . 006126 5810 9EF0
         SR    1,8                       . 00612A 1B18
         SR    1,8                       . 00612C 1B18
         L     1,0(1)                    . 00612E 5811 0000
         ST    1,TVAL                    . 006132 5010 A3E8
         ST    0,TVAL$4                  . 006136 5000 A3EC
         L     15,TXSP                   . 00613A 58F0 A5B0
         STM   15,0,TMVAL                . 00613E 90F0 A3C8
         CR    1,15                      . 006142 191F
         BNE   TSCOK                     . 006144 4770 90A0
                                                             SPACE
* ONAR1 PUSH   TVAL                Save cursor position
*      DECRA   PDLPTR,6*DESCR      Delete history entries
                                                             SPACE
ONAR1    LD    0,TVAL                    . 006148 6800 A3E8
         STD   0,104(12)                 . 00614C 600C 0068
         AR    12,8                      . 006150 1AC8
         C     12,@@STACKT               . 006152 59C0 A828
         BH    OVER                      . 006156 4720 9664
         L     1,PDLPTR                  . 00615A 5810 9EF0
         S     1,@@6MDESC                . 00615E 5B10 A990
         ST    1,PDLPTR                  . 006162 5010 9EF0
                                                             SPACE
* ONAR2 AEQLC  LENFCL,0,TSALT      Check length failure
*      BRANCH  SALF,SCNR           Return matching failure
                                                             SPACE
ONAR2    C     0,FNVLCL                  . 006166 5900 9BC0
         BNE   TSALT                     . 00616A 4770 909A
         L     11,@@SALF                 . 00616E 58B0 A994
         BR    11                        . 006172 07FB
                                                             SPACE
* ONRF PROC    ARBN
*      MOVD    TVAL,ZEROCL
*      GETAC   TVAL,PDLPTR,-2*DESCR
*                                  Get old cursor position
*      BRANCH  ONAR1               Join processing
                                                             SPACE
ONRF     L     11,@@ARBN                 . 006174 58B0 A98C
         L     1,PDLPTR                  . 006178 5810 9EF0
         SR    1,8                       . 00617C 1B18
         SR    1,8                       . 00617E 1B18
         L     15,0(1)                   . 006180 58F1 0000
         STM   15,0,TVAL                 . 006184 90F0 A3E8
         B     ONAR1                     . 006188 47F0 B08C
                                                             SPACE
* FARB PROC    ,
*      AEQLC   FULLCL,0,,FARB2     Check &FULLSCAN
*      SETAC   NVAL,0              Set residual length to 0
*      BRANCH  FARB3               Join processing
                                                             SPACE
         USING FARB,11                   .
FARB     C     0,FULLCL                  . 00618C 5900 9868
         BE    FARB2                     . 006190 4780 B010
         ST    0,NVAL                    . 006194 5000 A3A8
         B     FARB3                     . 006198 47F0 B024
                                                             SPACE
* FARB2 AEQLC  LENFCL,0,FARB1      Check for length failure
*      SETAV   NVAL,YCL            Get residual length
                                                             SPACE
FARB2    C     0,FNVLCL                  . 00619C 5900 9BC0
         BNE   FARB1                     . 0061A0 4770 B05E
         L     15,YCL$4                  . 0061A4 58F0 A424
         LA    15,0(15)                  . 0061A8 41FF 0000
         STM   15,0,NVAL                 . 0061AC 90F0 A3A8
                                                             SPACE
* FARB3 GETLG  TVAL,TXSP           Get cursor position
*      SUM     TVAL,TVAL,NVAL      Add them
*      ACOMP   TVAL,MAXLEN,FARB1,FARB1
*                                  Check against maximum
*      ADDLG   TXSP,ONECL          Add one for ARB
*      GETLG   TVAL,TXSP           Get length matched
*      PUTAC   PDLPTR,2*DESCR,TVAL Insert on history list
*      BRANCH  SCOK,SCNR           Return successful match
                                                             SPACE
FARB3    L     15,TXSP                   . 0061B0 58F0 A5B0
         STM   15,0,TVAL                 . 0061B4 90F0 A3E8
         LR    1,15                      . 0061B8 181F
         A     1,NVAL                    . 0061BA 5A10 A3A8
         ST    1,TVAL                    . 0061BE 5010 A3E8
         C     1,MAXLEN                  . 0061C2 5910 9EA8
         BNL   FARB1                     . 0061C6 47B0 B05E
         LR    1,15                      . 0061CA 181F
         LA    1,1(1)                    . 0061CC 4111 0001
         ST    1,TXSP                    . 0061D0 5010 A5B0
         LR    15,1                      . 0061D4 18F1
         STM   15,0,TVAL                 . 0061D6 90F0 A3E8
         L     1,PDLPTR                  . 0061DA 5810 9EF0
         LR    2,15                      . 0061DE 182F
         ST    2,16(1)                   . 0061E0 5021 0010
         L     11,@@SCOK                 . 0061E4 58B0 A97C
         BR    11                        . 0061E8 07FB
                                                             SPACE
* FARB1 DECRA  PDLPTR,3*DESCR      Back over history entry
*      BRANCH  SALT,SCNR
FARB1    L     1,PDLPTR                  . 0061EA 5810 9EF0
         S     1,@@3YDESC                . 0061EE 5B10 A89C
         ST    1,PDLPTR                  . 0061F2 5010 9EF0
         L     11,@@SALT                 . 0061F6 58B0 A984
         BR    11                        . 0061FA 07FB
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      @X
*
                                                             SPACE
* ATP  PROC    ,                   Matching procedure for @X
*      INCRA   PATICL,DESCR        Increment pattern offset
*      GETD    XPTR,PATBCL,PATICL  Get argument
                                                             SPACE
         USING ATP,11                    .
ATP      L     1,PATICL                  . 0061FC 5810 9EE0
         AR    1,8                       . 006200 1A18
         ST    1,PATICL                  . 006202 5010 9EE0
         L     2,PATBCL                  . 006206 5820 A488
         LD    0,0(1,2)                  . 00620A 6801 2000
         STD   0,XPTR                    . 00620E 6000 A410
                                                             SPACE
* ATP1 VEQLC   XPTR,E,,ATPEXN      EXPRESSION must be evaluated
*      GETLG   NVAL,TXSP           Get length of text matched
*      SETVC   NVAL,I              Set INTEGER data type
*      PUTDC   XPTR,DESCR,NVAL     Assign as value of variable X
*      AEQLC   OUTSW,0,,ATP2       Check &OUTPUT
*      LOCAPV  ZPTR,OUTATL,XPTR,ATP2
*                                  Look for output association
*      GETDC   ZPTR,ZPTR,DESCR     Get output association descriptor
*      RCALL   ,PUTOUT,(ZPTR,NVAL) Perform output
                                                             SPACE
ATP1     CLC   XPTR$5(3),@@E             . 006212 D502 A415 AA81
         BE    ATPEXN                    . 006218 4780 B228
         L     15,TXSP                   . 00621C 58F0 A5B0
         STM   15,0,NVAL                 . 006220 90F0 A3A8
         MVC   NVAL$5(3),@@I             . 006224 D202 A3AD AA84
         L     1,XPTR                    . 00622A 5810 A410
         LD    0,NVAL                    . 00622E 6800 A3A8
         STD   0,8(1)                    . 006232 6001 0008
         C     0,OUTSW                   . 006236 5900 9838
         BE    ATP2                      . 00623A 4780 B09A
         L     15,OUTATL                 . 00623E 58F0 A308
         L     5,4(15)                   . 006242 585F 0004
         LA    5,0(5,15)                 . 006246 4155 F000
         LR    4,8                       . 00624A 1848
         SR    5,4                       . 00624C 1B54
         AR    4,8                       . 00624E 1A48
S4$06250 CLC   16(8,15),XPTR             . 006250 D507 F010 A410
         BE    S4$06262                  . 006256 4780 B066
         BXLE  15,4,S4$06250             . 00625A 87F4 B054
         B     ATP2                      . 00625E 47F0 B09A
S4$06262 LD    0,8(15)                   . 006262 680F 0008
         STD   0,ZPTR                    . 006266 6000 A440
         LA    14,S4$06292               . 00626A 41E0 B096
         STM   11,14,104(12)             . 00626E 90BE C068
         LR    13,12                     . 006272 18DC
         STD   0,128(12)                 . 006274 600C 0080
         LD    0,NVAL                    . 006278 6800 A3A8
         STD   0,120(12)                 . 00627C 600C 0078
         LA    12,32(12)                 . 006280 41CC 0020
         C     12,@@STACKT               . 006284 59C0 A828
         BH    OVER                      . 006288 4720 9664
         L     11,@@PUTOUT               . 00628C 58B0 A974
         BR    11                        . 006290 07FB
S4$06292 SR    0,0                       . 006292 1B00
         SR    0,0                       . 006294 1B00
                                                             SPACE
* ATP2 AEQLC   TRAPCL,0,,TSCOK     Check &TRACE
*      LOCAPT  ATPTR,TVALL,XPTR,TSCOK
*                                  Look for trace association
*      PUSH    (PATBCL,PATICL,WPTR,XCL,YCL)
*      PUSH    (MAXLEN,LENFCL,PDLPTR,PDLHED,NAMICL,NHEDCL)
*      SPUSH   (HEADSP,TSP,TXSP,XSP)
*      MOVD    PDLHED,PDLPTR       Set new stack heading
*      MOVD    NHEDCL,NAMICL       Set new name list heading
*      RCALL   ,TRPHND,ATPTR       Perform tracing              E3.3.1
*      SPOP    (XSP,TXSP,TSP,HEADSP)
*      POP     (NHEDCL,NAMICL,PDLHED,PDLPTR,LENFCL,MAXLEN)
*      POP     (YCL,XCL,WPTR,PATICL,PATBCL)
*      BRANCH  SCOK,SCNR
                                                             SPACE
ATP2     C     0,TRAPCL                  . 006296 5900 9818
         BE    TSCOK                     . 00629A 4780 90A0
         L     15,TVALL                  . 00629E 58F0 A310
         L     5,4(15)                   . 0062A2 585F 0004
         LA    5,0(5,15)                 . 0062A6 4155 F000
         LR    4,8                       . 0062AA 1848
         SR    5,4                       . 0062AC 1B54
         AR    4,8                       . 0062AE 1A48
S4$062B0 CLC   8(8,15),XPTR              . 0062B0 D507 F008 A410
         BE    S4$062C2                  . 0062B6 4780 B0C6
         BXLE  15,4,S4$062B0             . 0062BA 87F4 B0B4
         B     TSCOK                     . 0062BE 47F0 90A0
S4$062C2 STM   15,0,ATPTR                . 0062C2 90F0 A378
         LD    0,PATBCL                  . 0062C6 6800 A488
         STD   0,104(12)                 . 0062CA 600C 0068
         LD    0,PATICL                  . 0062CE 6800 9EE0
         STD   0,112(12)                 . 0062D2 600C 0070
         LD    0,WPTR                    . 0062D6 6800 A400
         STD   0,120(12)                 . 0062DA 600C 0078
         LD    0,XCL                     . 0062DE 6800 A408
         STD   0,128(12)                 . 0062E2 600C 0080
         LD    0,YCL                     . 0062E6 6800 A420
         STD   0,136(12)                 . 0062EA 600C 0088
         LA    12,40(12)                 . 0062EE 41CC 0028
         C     12,@@STACKT               . 0062F2 59C0 A828
         BH    OVER                      . 0062F6 4720 9664
         LD    0,MAXLEN                  . 0062FA 6800 9EA8
         STD   0,104(12)                 . 0062FE 600C 0068
         LD    0,FNVLCL                  . 006302 6800 9BC0
         STD   0,112(12)                 . 006306 600C 0070
         LD    0,PDLPTR                  . 00630A 6800 9EF0
         STD   0,120(12)                 . 00630E 600C 0078
         LD    0,PDLHED                  . 006312 6800 9F48
         STD   0,128(12)                 . 006316 600C 0080
         LD    0,NAMICL                  . 00631A 6800 9EB8
         STD   0,136(12)                 . 00631E 600C 0088
         LD    0,NHEDCL                  . 006322 6800 9EC0
         STD   0,144(12)                 . 006326 600C 0090
         LA    12,48(12)                 . 00632A 41CC 0030
         C     12,@@STACKT               . 00632E 59C0 A828
         BH    OVER                      . 006332 4720 9664
         LM    1,4,HEADSP                . 006336 9814 A560
         STM   1,4,104(12)               . 00633A 9014 C068
         LM    1,4,TSP                   . 00633E 9814 A5A0
         STM   1,4,120(12)               . 006342 9014 C078
         LM    1,4,TXSP                  . 006346 9814 A5B0
         STM   1,4,136(12)               . 00634A 9014 C088
         LM    1,4,XSP                   . 00634E 9814 A5D0
         STM   1,4,152(12)               . 006352 9014 C098
         LA    12,64(12)                 . 006356 41CC 0040
         C     12,@@STACKT               . 00635A 59C0 A828
         BH    OVER                      . 00635E 4720 9664
         LD    0,PDLPTR                  . 006362 6800 9EF0
         STD   0,PDLHED                  . 006366 6000 9F48
         LD    0,NAMICL                  . 00636A 6800 9EB8
         STD   0,NHEDCL                  . 00636E 6000 9EC0
         LA    14,S4$06392               . 006372 41E0 B196
         STM   11,14,104(12)             . 006376 90BE C068
         LR    13,12                     . 00637A 18DC
         STM   15,0,120(12)              . 00637C 90F0 C078
         LA    12,24(12)                 . 006380 41CC 0018
         C     12,@@STACKT               . 006384 59C0 A828
         BH    OVER                      . 006388 4720 9664
         L     11,@@TRPHND               . 00638C 58B0 A918
         BR    11                        . 006390 07FB
S4$06392 SR    0,0                       . 006392 1B00
         SR    0,0                       . 006394 1B00
         LA    0,0                       . 006396 4100 0000
         LM    1,4,88(12)                . 00639A 9814 C058
         STM   1,4,XSP                   . 00639E 9014 A5D0
         LM    1,4,72(12)                . 0063A2 9814 C048
         STM   1,4,TXSP                  . 0063A6 9014 A5B0
         LM    1,4,56(12)                . 0063AA 9814 C038
         STM   1,4,TSP                   . 0063AE 9014 A5A0
         LM    1,4,40(12)                . 0063B2 9814 C028
         STM   1,4,HEADSP                . 0063B6 9014 A560
         S     12,@@16M4                 . 0063BA 5BC0 A924
         LD    0,96(12)                  . 0063BE 680C 0060
         STD   0,NHEDCL                  . 0063C2 6000 9EC0
         LD    0,88(12)                  . 0063C6 680C 0058
         STD   0,NAMICL                  . 0063CA 6000 9EB8
         LD    0,80(12)                  . 0063CE 680C 0050
         STD   0,PDLHED                  . 0063D2 6000 9F48
         LD    0,72(12)                  . 0063D6 680C 0048
         STD   0,PDLPTR                  . 0063DA 6000 9EF0
         LD    0,64(12)                  . 0063DE 680C 0040
         STD   0,FNVLCL                  . 0063E2 6000 9BC0
         LD    0,56(12)                  . 0063E6 680C 0038
         STD   0,MAXLEN                  . 0063EA 6000 9EA8
         S     12,@@6XDESC               . 0063EE 5BC0 A928
         LD    0,96(12)                  . 0063F2 680C 0060
         STD   0,YCL                     . 0063F6 6000 A420
         LD    0,88(12)                  . 0063FA 680C 0058
         STD   0,XCL                     . 0063FE 6000 A408
         LD    0,80(12)                  . 006402 680C 0050
         STD   0,WPTR                    . 006406 6000 A400
         LD    0,72(12)                  . 00640A 680C 0048
         STD   0,PATICL                  . 00640E 6000 9EE0
         LD    0,64(12)                  . 006412 680C 0040
         STD   0,PATBCL                  . 006416 6000 A488
         S     12,@@5XDESC               . 00641A 5BC0 A998
         L     11,@@SCOK                 . 00641E 58B0 A97C
         BR    11                        . 006422 07FB
                                                             SPACE
* ATPEXN RCALL XPTR,EXPEVL,XPTR,(TSALF,ATP1,SCNEMO)             E3.4.4
ATPEXN   LA    14,S4$06448               . 006424 41E0 B24C
         STM   11,14,104(12)             . 006428 90BE C068
         LR    13,12                     . 00642C 18DC
         LD    0,XPTR                    . 00642E 6800 A410
         STD   0,120(12)                 . 006432 600C 0078
         LA    12,24(12)                 . 006436 41CC 0018
         C     12,@@STACKT               . 00643A 59C0 A828
         BH    OVER                      . 00643E 4720 9664
         L     11,@@EXPEVL               . 006442 58B0 A99C
         BR    11                        . 006446 07FB
S4$06448 STD   0,XPTR                    . 006448 6000 A410
         B     TSALF                     . 00644C 47F0 9094
         B     ATP1                      . 006450 47F0 B016
         B     FCL                       . 006454 47F0 9E78
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      BAL
*
                                                             SPACE
* BAL  PROC    ,                   Matching procedure for BAL
* BALF1 AEQLC  FULLCL,0,,BALF4     Check &FULLSCAN
*      SETAC   NVAL,0              Set length to zero
*      BRANCH  BALF2
                                                             SPACE
         USING BAL,11                    .
BAL      C     0,FULLCL                  . 006458 5900 9868
         BE    BALF4                     . 00645C 4780 B010
         ST    0,NVAL                    . 006460 5000 A3A8
         B     BALF2                     . 006464 47F0 B01C
                                                             SPACE
* BALF4 SETAV  NVAL,YCL
                                                             SPACE
BALF4    L     15,YCL$4                  . 006468 58F0 A424
         LA    15,0(15)                  . 00646C 41FF 0000
         STM   15,0,NVAL                 . 006470 90F0 A3A8
                                                             SPACE
* BALF2 GETLG  TVAL,TXSP           Get length of text matched so far
*      SUM     TVAL,TVAL,NVAL      Add remainder possible
*      ACOMP   TVAL,MAXLEN,BAL1,BAL1
*                                  Compare to maximum
*      SUBTRT  TVAL,MAXLEN,TVAL    Get maximum length for BAL
*      GETBAL  TXSP,TVAL,BAL1      Get balanced string
*      GETLG   TVAL,TXSP           Get length matched
*      PUTAC   PDLPTR,2*DESCR,TVAL Insert history entry
*      BRANCH  SCOK,SCNR           Successful match
                                                             SPACE
BALF2    L     15,TXSP                   . 006474 58F0 A5B0
         A     15,NVAL                   . 006478 5AF0 A3A8
         STM   15,0,TVAL                 . 00647C 90F0 A3E8
         C     15,MAXLEN                 . 006480 59F0 9EA8
         BNL   BAL1                      . 006484 47B0 B064
         LM    1,2,MAXLEN                . 006488 9812 9EA8
         S     1,TVAL                    . 00648C 5B10 A3E8
         STM   1,2,TVAL                  . 006490 9012 A3E8
         L     15,@@GBAL                 . 006494 58F0 A9A0
         LA    1,TXSP                    . 006498 4110 A5B0
         L     3,TVAL                    . 00649C 5830 A3E8
         BALR  14,15                          CALL                     *
                                         . 0064A0 05EF
         B     BAL1                      . 0064A2 47F0 B064
         L     15,TXSP                   . 0064A6 58F0 A5B0
         STM   15,0,TVAL                 . 0064AA 90F0 A3E8
         L     1,PDLPTR                  . 0064AE 5810 9EF0
         ST    15,16(1)                  . 0064B2 50F1 0010
         L     11,@@SCOK                 . 0064B6 58B0 A97C
         BR    11                        . 0064BA 07FB
                                                             SPACE
* BAL1 DECRA   PDLPTR,3*DESCR      Back over history entry
*      ACOMP   PDLPTR,PDLHED,TSALF,TSALF,INTR13
                                                             SPACE
BAL1     L     1,PDLPTR                  . 0064BC 5810 9EF0
         S     1,@@3YDESC                . 0064C0 5B10 A89C
         ST    1,PDLPTR                  . 0064C4 5010 9EF0
         C     1,PDLHED                  . 0064C8 5910 9F48
         BNL   TSALF                     . 0064CC 47B0 9094
         BL    S4$010                    . 0064D0 4740 95AC
                                                             SPACE
* BALF PROC    BAL                 Matching procedure for BAL retry
*      AEQLC   FULLCL,0,,BALF3     Check &FULLSCAN
*      SETAC   NVAL,0              If off, set length to zero
*      BRANCH  BALF2               Reenter balanced matching
                                                             SPACE
BALF     L     11,@@BAL                  . 0064D4 58B0 A9A4
         C     0,FULLCL                  . 0064D8 5900 9868
         BE    BALF3                     . 0064DC 4780 B090
         ST    0,NVAL                    . 0064E0 5000 A3A8
         B     BALF2                     . 0064E4 47F0 B01C
                                                             SPACE
* BALF3 AEQLC  LENFCL,0,BAL1,BALF1 If on, test for length failure
BALF3    C     0,FNVLCL                  . 0064E8 5900 9BC0
         BNE   BAL1                      . 0064EC 4770 B064
         BE    BAL                       . 0064F0 4780 B000
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Matching for String
*
                                                             SPACE
* CHR  PROC    ,                   Matching character string
*      INCRA   PATICL,DESCR        Increment offset
*      GETD    YPTR,PATBCL,PATICL  Get argument
                                                             SPACE
         USING CHR,11                    .
CHR      L     1,PATICL                  . 0064F4 5810 9EE0
         AR    1,8                       . 0064F8 1A18
         ST    1,PATICL                  . 0064FA 5010 9EE0
         L     2,PATBCL                  . 0064FE 5820 A488
         LD    0,0(1,2)                  . 006502 6801 2000
         STD   0,YPTR                    . 006506 6000 A428
                                                             SPACE
* CHR1 LOCSP   TSP,YPTR            Get specifier
                                                             SPACE
CHR1     LM    3,4,YPTR                  . 00650A 9834 A428
         CR    0,3                       . 00650E 1903
         BNE   S4$0651C                  . 006510 4770 B028
         ST    0,TSP                     . 006514 5000 A5A0
         B     CHR2                      . 006518 47F0 B038
S4$0651C L     1,4(3)                    . 00651C 5813 0004
         LA    1,0(1)                    . 006520 4111 0000
         LA    2,32                      . 006524 4120 0020
         STM   1,4,TSP                   . 006528 9014 A5A0
                                                             SPACE
* CHR2 REMSP   VSP,XSP,TXSP        Remove part matched
*      SUBSP   VSP,TSP,VSP,TSALT   Get part to match
*      LEXCMP  VSP,TSP,TSALF,,TSALF
*                                  Compare strings
*      GETLG   YPTR,TSP            Get length
*      ADDLG   TXSP,YPTR           Update string matched
*      BRANCH  SCOK,SCNR           Return successful match
CHR2     LM    1,4,XSP                   . 00652C 9814 A5D0
         L     5,TXSP                    . 006530 5850 A5B0
         AR    2,5                       . 006534 1A25
         SR    1,5                       . 006536 1B15
         STM   1,4,VSP                   . 006538 9014 A5C0
         C     1,TSP                     . 00653C 5910 A5A0
         BL    TSALT                     . 006540 4740 909A
         L     1,TSP                     . 006544 5810 A5A0
         STM   1,4,VSP                   . 006548 9014 A5C0
         LM    2,4,VSP                   . 00654C 9824 A5C0
         LM    5,7,TSP                   . 006550 9857 A5A0
         CR    2,5                       . 006554 1925
         BNE   TSALF                     . 006556 4770 9094
         L     15,@@SPECEQ               . 00655A 58F0 A890
         BALR  14,15                          CALL                     *
                                         . 00655E 05EF
         B     TSALF                     . 006560 47F0 9094
         L     15,TSP                    . 006564 58F0 A5A0
         STM   15,0,YPTR                 . 006568 90F0 A428
         L     1,TXSP                    . 00656C 5810 A5B0
         AR    1,15                      . 006570 1A1F
         ST    1,TXSP                    . 006572 5010 A5B0
         L     11,@@SCOK                 . 006576 58B0 A97C
         BR    11                        . 00657A 07FB
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      *X
*
                                                             SPACE
* STAR PROC    CHR                 Matching procedure for expressions
*      INCRA   PATICL,DESCR        Increment offset
*      GETD    YPTR,PATBCL,PATICL  Get argument expression
                                                             SPACE
STAR     L     11,@@CHR                  . 00657C 58B0 A9A8
         L     1,PATICL                  . 006580 5810 9EE0
         AR    1,8                       . 006584 1A18
         ST    1,PATICL                  . 006586 5010 9EE0
         L     2,PATBCL                  . 00658A 5820 A488
         LD    0,0(1,2)                  . 00658E 6801 2000
         STD   0,YPTR                    . 006592 6000 A428
                                                             SPACE
* STAR2 RCALL  YPTR,EXPVAL,YPTR,TSALF
*                                  Evaluate argument
*      VEQLC   YPTR,E,,STAR2       Is is EXPRESSION?
*      SUM     XPTR,PATBCL,PATICL  Compute pointer to argument
*      PUTDC   XPTR,7*DESCR,YPTR   Insert pointer in backup node
*      VEQLC   YPTR,S,,CHR1        Is it STRING?
*      VEQLC   YPTR,P,,STARP       Is it  PATTERN?
*      VEQLC   YPTR,I,SCDTER       Is it INTEGER?
*      INTSPC  TSP,YPTR            Get specifier for integer
*      BRANCH  CHR2                Join processing
                                                             SPACE
STAR2    LA    14,S4$065BA               . 006596 41E0 B0C6
         STM   11,14,104(12)             . 00659A 90BE C068
         LR    13,12                     . 00659E 18DC
         LD    0,YPTR                    . 0065A0 6800 A428
         STD   0,120(12)                 . 0065A4 600C 0078
         LA    12,24(12)                 . 0065A8 41CC 0018
         C     12,@@STACKT               . 0065AC 59C0 A828
         BH    OVER                      . 0065B0 4720 9664
         L     11,@@EXPVAL               . 0065B4 58B0 A930
         BR    11                        . 0065B8 07FB
S4$065BA STD   0,YPTR                    . 0065BA 6000 A428
         B     TSALF                     . 0065BE 47F0 9094
         CLC   YPTR$5(3),@@E             . 0065C2 D502 A42D AA81
         BE    STAR2                     . 0065C8 4780 B0A2
         LM    1,2,PATBCL                . 0065CC 9812 A488
         A     1,PATICL                  . 0065D0 5A10 9EE0
         STM   1,2,XPTR                  . 0065D4 9012 A410
         LD    0,YPTR                    . 0065D8 6800 A428
         STD   0,56(1)                   . 0065DC 6001 0038
         CLC   YPTR$5(3),@@S             . 0065E0 D502 A42D AA7B
         BE    CHR1                      . 0065E6 4780 B016
         CLC   YPTR$5(3),@@P             . 0065EA D502 A42D AA87
         BE    STARP                     . 0065F0 4780 B11C
         CLC   YPTR$5(3),@@I             . 0065F4 D502 A42D AA84
         BNE   SCDTER                    . 0065FA 4770 9674
         L     15,@@BDSPEC               . 0065FE 58F0 A874
         LA    1,TSP                     . 006602 4110 A5A0
         LA    2,YPTR                    . 006606 4120 A428
         BALR  14,15                          CALL                     *
                                         . 00660A 05EF
         B     CHR2                      . 00660C 47F0 B038
                                                             SPACE
* STARP AEQLC  FULLCL,0,,STARP1    Check &FULLSCAN
*      SETAC   NVAL,0              Zero length
*      BRANCH  STARP4              Join processing
                                                             SPACE
STARP    C     0,FULLCL                  . 006610 5900 9868
         BE    STARP1                    . 006614 4780 B12C
         ST    0,NVAL                    . 006618 5000 A3A8
         B     STARP4                    . 00661C 47F0 B138
                                                             SPACE
* STARP1 SETAV NVAL,YCL            Get length
                                                             SPACE
STARP1   L     15,YCL$4                  . 006620 58F0 A424
         LA    15,0(15)                  . 006624 41FF 0000
         STM   15,0,NVAL                 . 006628 90F0 A3A8
                                                             SPACE
* STARP4 SUBTRT NVAL,MAXLEN,NVAL   Compute residual
*      ACOMPC  NVAL,0,,,TSALT
*      LVALUE  TSIZ,YPTR           Check &FULLSCAN
*      AEQLC   FULLCL,0,STARP6
*      ACOMP   TSIZ,NVAL,TSALT     Check against length
                                                             SPACE
STARP4   LM    1,2,MAXLEN                . 00662C 9812 9EA8
         S     1,NVAL                    . 006630 5B10 A3A8
         STM   1,2,NVAL                  . 006634 9012 A3A8
         CR    0,1                       . 006638 1901
         BH    TSALT                     . 00663A 4720 909A
         L     15,@@LVAL                 . 00663E 58F0 A95C
         LA    1,TSIZ                    . 006642 4110 A3E0
         L     2,YPTR                    . 006646 5820 A428
         BALR  14,15                          CALL                     *
                                         . 00664A 05EF
         C     0,FULLCL                  . 00664C 5900 9868
         BNE   STARP6                    . 006650 4770 B16C
         L     1,TSIZ                    . 006654 5810 A3E0
         C     1,NVAL                    . 006658 5910 A3A8
         BH    TSALT                     . 00665C 4720 909A
                                                             SPACE
* STARP6 INCRA PDLPTR,3*DESCR      Make room for history
*      ACOMP   PDLPTR,PDLEND,INTR31
*                                  Check for overflow
*      PUTDC   PDLPTR,DESCR,SCFLCL Insert failure function
*      GETLG   TMVAL,TXSP          Get cursor position
*      PUTDC   PDLPTR,2*DESCR,TMVAL
*                                  Insert on history list
*      PUTDC   PDLPTR,3*DESCR,LENFCL
*                                  Insert length failure
*      PUSH    (MAXLEN,PATBCL,PATICL,XCL,YCL)
*                                  Save scanner state
*      MOVD    MAXLEN,NVAL         Set up new maximum
*      RCALL   ,SCIN,,(STARP5,,RTNUL3)
*                                  Call the scanner
                                                             SPACE
STARP6   L     1,PDLPTR                  . 006660 5810 9EF0
         LA    1,24(1)                   . 006664 4111 0018
         ST    1,PDLPTR                  . 006668 5010 9EF0
         C     1,PDLEND                  . 00666C 5910 9EE8
         BH    INTR31                    . 006670 4720 962C
         LD    0,SCFLCL                  . 006674 6800 9DB8
         STD   0,8(1)                    . 006678 6001 0008
         L     15,TXSP                   . 00667C 58F0 A5B0
         STM   15,0,TMVAL                . 006680 90F0 A3C8
         STM   15,0,16(1)                . 006684 90F0 1010
         LD    0,FNVLCL                  . 006688 6800 9BC0
         STD   0,24(1)                   . 00668C 6001 0018
         LD    0,MAXLEN                  . 006690 6800 9EA8
         STD   0,104(12)                 . 006694 600C 0068
         LD    0,PATBCL                  . 006698 6800 A488
         STD   0,112(12)                 . 00669C 600C 0070
         LD    0,PATICL                  . 0066A0 6800 9EE0
         STD   0,120(12)                 . 0066A4 600C 0078
         LD    0,XCL                     . 0066A8 6800 A408
         STD   0,128(12)                 . 0066AC 600C 0080
         LD    0,YCL                     . 0066B0 6800 A420
         STD   0,136(12)                 . 0066B4 600C 0088
         LA    12,40(12)                 . 0066B8 41CC 0028
         C     12,@@STACKT               . 0066BC 59C0 A828
         BH    OVER                      . 0066C0 4720 9664
         LD    0,NVAL                    . 0066C4 6800 A3A8
         STD   0,MAXLEN                  . 0066C8 6000 9EA8
         LA    14,S4$066E8               . 0066CC 41E0 B1F4
         STM   11,14,104(12)             . 0066D0 90BE C068
         LR    13,12                     . 0066D4 18DC
         LA    12,16(12)                 . 0066D6 41CC 0010
         C     12,@@STACKT               . 0066DA 59C0 A828
         BH    OVER                      . 0066DE 4720 9664
         L     11,@@SCIN                 . 0066E2 58B0 A9AC
         BR    11                        . 0066E6 07FB
S4$066E8 SR    0,0                       . 0066E8 1B00
         SR    0,0                       . 0066EA 1B00
         B     STARP5                    . 0066EC 47F0 B236
         B     STARP2                    . 0066F0 47F0 B204
         B     RTNUL3                    . 0066F4 47F0 9030
                                                             SPACE
* STARP2 POP   (YCL,XCL,PATICL,PATBCL,MAXLEN)
*                                  Restore scanner state
*      BRANCH  SCOK,SCNR           Return matching successfully
                                                             SPACE
STARP2   LD    0,96(12)                  . 0066F8 680C 0060
         STD   0,YCL                     . 0066FC 6000 A420
         LD    0,88(12)                  . 006700 680C 0058
         STD   0,XCL                     . 006704 6000 A408
         LD    0,80(12)                  . 006708 680C 0050
         STD   0,PATICL                  . 00670C 6000 9EE0
         LD    0,72(12)                  . 006710 680C 0048
         STD   0,PATBCL                  . 006714 6000 A488
         LD    0,64(12)                  . 006718 680C 0040
         STD   0,MAXLEN                  . 00671C 6000 9EA8
         S     12,@@5XDESC               . 006720 5BC0 A998
         L     11,@@SCOK                 . 006724 58B0 A97C
         BR    11                        . 006728 07FB
                                                             SPACE
* STARP5 POP   (YCL,XCL,PATICL,PATBCL,MAXLEN)
*                                  Restore scanner state
                                                             SPACE
STARP5   LD    0,96(12)                  . 00672A 680C 0060
         STD   0,YCL                     . 00672E 6000 A420
         LD    0,88(12)                  . 006732 680C 0058
         STD   0,XCL                     . 006736 6000 A408
         LD    0,80(12)                  . 00673A 680C 0050
         STD   0,PATICL                  . 00673E 6000 9EE0
         LD    0,72(12)                  . 006742 680C 0048
         STD   0,PATBCL                  . 006746 6000 A488
         LD    0,64(12)                  . 00674A 680C 0040
         STD   0,MAXLEN                  . 00674E 6000 9EA8
         S     12,@@5XDESC               . 006752 5BC0 A998
                                                             SPACE
* STARP3 AEQLC LENFCL,0,TSALT      Check length failure
*      BRANCH  SALF,SCNR           Return matching failure
                                                             SPACE
STARP3   C     0,FNVLCL                  . 006756 5900 9BC0
         BNE   TSALT                     . 00675A 4770 909A
         L     11,@@SALF                 . 00675E 58B0 A994
         BR    11                        . 006762 07FB
                                                             SPACE
* DSAR PROC    CHR                 Backup matching for expression
*      INCRA   PATICL,DESCR        Increment offset
*      GETD    YPTR,PATBCL,PATICL  Get argument
*      VEQLC   YPTR,S,,STARP3      Is it STRING?
*      VEQLC   YPTR,P,,DSARP       Is it PATTERN?
*      VEQLC   YPTR,I,SCDTER,STARP3
*                                  Is it INTEGER?
                                                             SPACE
DSAR     L     11,@@CHR                  . 006764 58B0 A9A8
         L     1,PATICL                  . 006768 5810 9EE0
         AR    1,8                       . 00676C 1A18
         ST    1,PATICL                  . 00676E 5010 9EE0
         L     2,PATBCL                  . 006772 5820 A488
         LD    0,0(1,2)                  . 006776 6801 2000
         STD   0,YPTR                    . 00677A 6000 A428
         CLC   YPTR$5(3),@@S             . 00677E D502 A42D AA7B
         BE    STARP3                    . 006784 4780 B262
         CLC   YPTR$5(3),@@P             . 006788 D502 A42D AA87
         BE    DSARP                     . 00678E 4780 B2AC
         CLC   YPTR$5(3),@@I             . 006792 D502 A42D AA84
         BNE   SCDTER                    . 006798 4770 9674
         BE    STARP3                    . 00679C 4780 B262
                                                             SPACE
* DSARP AEQLC  FULLCL,0,,DSARP1    Check &FULLSCAN
*      SETAC   NVAL,0              Zero length
*      BRANCH  DSARP2              Join processing
                                                             SPACE
DSARP    C     0,FULLCL                  . 0067A0 5900 9868
         BE    DSARP1                    . 0067A4 4780 B2BC
         ST    0,NVAL                    . 0067A8 5000 A3A8
         B     DSARP2                    . 0067AC 47F0 B2C8
                                                             SPACE
* DSARP1 SETAV NVAL,YCL            Get length
                                                             SPACE
DSARP1   L     15,YCL$4                  . 0067B0 58F0 A424
         LA    15,0(15)                  . 0067B4 41FF 0000
         STM   15,0,NVAL                 . 0067B8 90F0 A3A8
                                                             SPACE
* DSARP2 SUBTRT NVAL,MAXLEN,NVAL   Compute residual
*      PUSH    (MAXLEN,PATBCL,PATICL,XCL,YCL)
*                                  Save scanner state
*      MOVD    MAXLEN,NVAL         Set up new maximum
*      RCALL   ,UNSC,,(STARP5,STARP2,RTNUL3)
*                                  Call unscanning procedure
DSARP2   LM    1,2,MAXLEN                . 0067BC 9812 9EA8
         S     1,NVAL                    . 0067C0 5B10 A3A8
         STM   1,2,NVAL                  . 0067C4 9012 A3A8
         LD    0,MAXLEN                  . 0067C8 6800 9EA8
         STD   0,104(12)                 . 0067CC 600C 0068
         LD    0,PATBCL                  . 0067D0 6800 A488
         STD   0,112(12)                 . 0067D4 600C 0070
         LD    0,PATICL                  . 0067D8 6800 9EE0
         STD   0,120(12)                 . 0067DC 600C 0078
         LD    0,XCL                     . 0067E0 6800 A408
         STD   0,128(12)                 . 0067E4 600C 0080
         LD    0,YCL                     . 0067E8 6800 A420
         STD   0,136(12)                 . 0067EC 600C 0088
         LA    12,40(12)                 . 0067F0 41CC 0028
         C     12,@@STACKT               . 0067F4 59C0 A828
         BH    OVER                      . 0067F8 4720 9664
         STM   1,2,MAXLEN                . 0067FC 9012 9EA8
         LA    14,S4$0681C               . 006800 41E0 B328
         STM   11,14,104(12)             . 006804 90BE C068
         LR    13,12                     . 006808 18DC
         LA    12,16(12)                 . 00680A 41CC 0010
         C     12,@@STACKT               . 00680E 59C0 A828
         BH    OVER                      . 006812 4720 9664
         L     11,@@UNSC                 . 006816 58B0 A9B0
         BR    11                        . 00681A 07FB
S4$0681C SR    0,0                       . 00681C 1B00
         SR    0,0                       . 00681E 1B00
         B     STARP5                    . 006820 47F0 B236
         B     STARP2                    . 006824 47F0 B204
         B     RTNUL3                    . 006828 47F0 9030
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      FENCE
*
                                                             SPACE
* FNCE PROC    ,                   Procedure for matching FENCE
*      INCRA   PDLPTR,3*DESCR      Create new history entry
*      ACOMP   PDLPTR,PDLEND,INTR31
*                                  Check for overflow
*      PUTDC   PDLPTR,DESCR,FNCFCL Insert FENCE failure function
*      GETLG   TMVAL,TXSP          Get length
*      PUTDC   PDLPTR,2*DESCR,TMVAL
*                                  Save length
*      PUTDC   PDLPTR,3*DESCR,LENFCL
*                                  Save length failure switch
*      SETAC   LENFCL,1            Set length failure switch
*      BRANIC  SCOKCL,0            Return matching
         USING FNCE,11                   .
FNCE     L     1,PDLPTR                  . 00682C 5810 9EF0
         LA    1,24(1)                   . 006830 4111 0018
         ST    1,PDLPTR                  . 006834 5010 9EF0
         C     1,PDLEND                  . 006838 5910 9EE8
         BH    INTR31                    . 00683C 4720 962C
         LD    0,FNCFCL                  . 006840 6800 9D40
         STD   0,8(1)                    . 006844 6001 0008
         L     15,TXSP                   . 006848 58F0 A5B0
         STM   15,0,TMVAL                . 00684C 90F0 A3C8
         STM   15,0,16(1)                . 006850 90F0 1010
         LD    0,FNVLCL                  . 006854 6800 9BC0
         STD   0,24(1)                   . 006858 6001 0018
         LA    1,1                       . 00685C 4110 0001
         ST    1,FNVLCL                  . 006860 5010 9BC0
         L     15,SCOKCL                 . 006864 58F0 9DC0
         L     11,0(15)                  . 006868 58BF 0000
         BR    11                        . 00686C 07FB
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      X . Y and X $ Y
*
                                                             SPACE
* NME  PROC    ,                   Matching procedure for naming
*      INCRA   PDLPTR,3*DESCR      Make room for history entry
*      ACOMP   PDLPTR,PDLEND,INTR31
*                                  Check for end of list
*      PUTDC   PDLPTR,DESCR,FNMECL Insert backup function
*      GETLG   TMVAL,TXSP          Get cursor position
*      PUTDC   PDLPTR,2*DESCR,TMVAL
*                                  Put on history list
*      PUTDC   PDLPTR,3*DESCR,LENFCL
*                                  Put length failure indicator
*      PUSH    (TMVAL)             Save cursor
*      SETAC   LENFCL,1            Set length failure indicator
*      BRANCH  SCOK,SCNR           Return matching successfully
                                                             SPACE
         USING NME,11                    .
NME      L     1,PDLPTR                  . 00686E 5810 9EF0
         LA    1,24(1)                   . 006872 4111 0018
         ST    1,PDLPTR                  . 006876 5010 9EF0
         C     1,PDLEND                  . 00687A 5910 9EE8
         BH    INTR31                    . 00687E 4720 962C
         LD    0,FNMECL                  . 006882 6800 9D48
         STD   0,8(1)                    . 006886 6001 0008
         L     15,TXSP                   . 00688A 58F0 A5B0
         STM   15,0,TMVAL                . 00688E 90F0 A3C8
         STM   15,0,16(1)                . 006892 90F0 1010
         LD    0,FNVLCL                  . 006896 6800 9BC0
         STD   0,24(1)                   . 00689A 6001 0018
         STM   15,0,104(12)              . 00689E 90F0 C068
         AR    12,8                      . 0068A2 1AC8
         C     12,@@STACKT               . 0068A4 59C0 A828
         BH    OVER                      . 0068A8 4720 9664
         LA    1,1                       . 0068AC 4110 0001
         ST    1,FNVLCL                  . 0068B0 5010 9BC0
         L     11,@@SCOK                 . 0068B4 58B0 A97C
         BR    11                        . 0068B8 07FB
                                                             SPACE
* FNME PROC    NME                 Backup procedure for naming
*      POP     (TVAL)              Restore cursor
                                                             SPACE
FNME     L     11,@@NME                  . 0068BA 58B0 A9B4
         LD    0,96(12)                  . 0068BE 680C 0060
         STD   0,TVAL                    . 0068C2 6000 A3E8
         SR    12,8                      . 0068C6 1BC8
                                                             SPACE
* FNME1 AEQLC  LENFCL,0,TSALT,TSALF
*                                  Check length failure indicator
                                                             SPACE
FNME1    C     0,FNVLCL                  . 0068C8 5900 9BC0
         BNE   TSALT                     . 0068CC 4770 909A
         BE    TSALF                     . 0068D0 4780 9094
                                                             SPACE
* ENME PROC    NME                 Naming process for X . Y
*      INCRA   PATICL,DESCR        Increment offset
*      GETD    YPTR,PATBCL,PATICL  Get argument
*      POP     (NVAL)              Restore previous cursor position
*      SETVA   YCL,NVAL            Set up length
*      SETSP   TSP,TXSP            Copy specifier
*      PUTLG   TSP,NVAL            Insert length
*      REMSP   TSP,TXSP,TSP        Compute ramainder
*      SUM     TPTR,NBSPTR,NAMICL  Compute position on name list
*      PUTSPC  TPTR,DESCR,TSP      Insert specifier
*      PUTDC   TPTR,DESCR+SPEC,YPTR
*                                  Insert argument
*      INCRA   NAMICL,DESCR+SPEC   Increment list offset
*      ACOMP   NAMICL,NMOVER,INTR13,ENME1
*                                  Check for overflow
                                                             SPACE
ENME     L     11,@@NME                  . 0068D4 58B0 A9B4
         L     1,PATICL                  . 0068D8 5810 9EE0
         AR    1,8                       . 0068DC 1A18
         ST    1,PATICL                  . 0068DE 5010 9EE0
         L     2,PATBCL                  . 0068E2 5820 A488
         LD    0,0(1,2)                  . 0068E6 6801 2000
         STD   0,YPTR                    . 0068EA 6000 A428
         LD    0,96(12)                  . 0068EE 680C 0060
         STD   0,NVAL                    . 0068F2 6000 A3A8
         SR    12,8                      . 0068F6 1BC8
         MVC   YCL$5(3),NVAL$1           . 0068F8 D202 A425 A3A9
         LM    1,4,TXSP                  . 0068FE 9814 A5B0
         L     1,NVAL                    . 006902 5810 A3A8
         STM   1,4,TSP                   . 006906 9014 A5A0
         LM    1,4,TXSP                  . 00690A 9814 A5B0
         L     5,TSP                     . 00690E 5850 A5A0
         AR    2,5                       . 006912 1A25
         SR    1,5                       . 006914 1B15
         STM   1,4,TSP                   . 006916 9014 A5A0
         LM    1,2,NBSPTR                . 00691A 9812 A460
         A     1,NAMICL                  . 00691E 5A10 9EB8
         STM   1,2,TPTR                  . 006922 9012 A3D0
         LM    2,5,TSP                   . 006926 9825 A5A0
         STM   2,5,8(1)                  . 00692A 9025 1008
         LD    0,YPTR                    . 00692E 6800 A428
         STD   0,24(1)                   . 006932 6001 0018
         L     1,NAMICL                  . 006936 5810 9EB8
         LA    1,24(1)                   . 00693A 4111 0018
         ST    1,NAMICL                  . 00693E 5010 9EB8
         C     1,NMOVER                  . 006942 5910 9EC8
         BH    S4$010                    . 006946 4720 95AC
         BE    ENME1                     . 00694A 4780 B12C
                                                             SPACE
* ENME2 INCRA  PDLPTR,DESCR+SPEC   Make room on history list
*      ACOMP   PDLPTR,PDLEND,INTR31
*                                  Check for overflow
*      PUTDC   PDLPTR,DESCR,DNMECL Insert unravelling function
                                                             SPACE
ENME2    L     1,PDLPTR                  . 00694E 5810 9EF0
         LA    1,24(1)                   . 006952 4111 0018
         ST    1,PDLPTR                  . 006956 5010 9EF0
         C     1,PDLEND                  . 00695A 5910 9EE8
         BH    INTR31                    . 00695E 4720 962C
         LD    0,DNMECL                  . 006962 6800 9D08
         STD   0,8(1)                    . 006966 6001 0008
                                                             SPACE
* ENME3 GETLG  TMVAL,TXSP          Get cursor position
*      MOVV    TMVAL,YCL
*      PUTDC   PDLPTR,2*DESCR,TMVAL
*                                  Insert on list
*      PUTDC   PDLPTR,3*DESCR,LENFCL
*                                  Insert length failure
*      SETAC   LENFCL,1            Set length failure
*      BRANCH  SCOK,SCNR           Return matching successfully
                                                             SPACE
ENME3    L     15,TXSP                   . 00696A 58F0 A5B0
         STM   15,0,TMVAL                . 00696E 90F0 A3C8
         MVC   TMVAL$5(3),YCL$5          . 006972 D202 A3CD A425
         L     1,PDLPTR                  . 006978 5810 9EF0
         LD    0,TMVAL                   . 00697C 6800 A3C8
         STD   0,16(1)                   . 006980 6001 0010
         LD    0,FNVLCL                  . 006984 6800 9BC0
         STD   0,24(1)                   . 006988 6001 0018
         LA    1,1                       . 00698C 4110 0001
         ST    1,FNVLCL                  . 006990 5010 9BC0
         L     11,@@SCOK                 . 006994 58B0 A97C
         BR    11                        . 006998 07FB
                                                             SPACE
* ENME1 MOVD   WCL,NMOVER          Save copy of cuurent name list end
*      INCRA   NMOVER,NAMLSZ*SPDR  Increment for larger block
*      RCALL   TPTR,BLOCK,NMOVER   Allocate larger block
*      MOVBLK  TPTR,NBSPTR,WCL     Move in old block
*      MOVD    NBSPTR,TPTR         Set up new base pointer
*      BRANCH  ENME2               Rejoin processing
                                                             SPACE
ENME1    LD    0,NMOVER                  . 00699A 6800 9EC8
         STD   0,WCL                     . 00699E 6000 A3F8
         L     1,NMOVER                  . 0069A2 5810 9EC8
         LA    1,480(1)                  . 0069A6 4111 01E0
         ST    1,NMOVER                  . 0069AA 5010 9EC8
         LA    14,S4$069D2               . 0069AE 41E0 B164
         STM   11,14,104(12)             . 0069B2 90BE C068
         LR    13,12                     . 0069B6 18DC
         LD    0,NMOVER                  . 0069B8 6800 9EC8
         STD   0,120(12)                 . 0069BC 600C 0078
         LA    12,24(12)                 . 0069C0 41CC 0018
         C     12,@@STACKT               . 0069C4 59C0 A828
         BH    OVER                      . 0069C8 4720 9664
         L     11,@@BLOCK                . 0069CC 58B0 A82C
         BR    11                        . 0069D0 07FB
S4$069D2 STD   0,TPTR                    . 0069D2 6000 A3D0
         L     6,TPTR                    . 0069D6 5860 A3D0
         L     4,NBSPTR                  . 0069DA 5840 A460
         AR    4,8                       . 0069DE 1A48
         AR    6,8                       . 0069E0 1A68
         L     3,WCL                     . 0069E2 5830 A3F8
         L     15,@@MOVTST               . 0069E6 58F0 A864
         BALR  14,15                          CALL                     *
                                         . 0069EA 05EF
         LD    0,TPTR                    . 0069EC 6800 A3D0
         STD   0,NBSPTR                  . 0069F0 6000 A460
         B     ENME2                     . 0069F4 47F0 B0E0
                                                             SPACE
* DNME PROC    NME                 Unravelling procedure for naming
*      DECRA   NAMICL,DESCR+SPEC   Back off named string
*      SUM     TPTR,NBSPTR,NAMICL  Compute current position
                                                             SPACE
DNME     L     11,@@NME                  . 0069F8 58B0 A9B4
         L     1,NAMICL                  . 0069FC 5810 9EB8
         S     1,@@3XDESC                . 006A00 5B10 A9B8
         ST    1,NAMICL                  . 006A04 5010 9EB8
         LM    1,2,NBSPTR                . 006A08 9812 A460
         A     1,NAMICL                  . 006A0C 5A10 9EB8
         STM   1,2,TPTR                  . 006A10 9012 A3D0
                                                             SPACE
* DNME1 PROC   NME
*      SETAV   VVAL,YCL
*      PUSH    (VVAL)              Preserve length
*      BRANCH  FNME1
                                                             SPACE
DNME1    L     11,@@NME                  . 006A14 58B0 A9B4
         L     15,YCL$4                  . 006A18 58F0 A424
         LA    15,0(15)                  . 006A1C 41FF 0000
         STM   15,0,VVAL                 . 006A20 90F0 A3F0
         LD    0,VVAL                    . 006A24 6800 A3F0
         STD   0,104(12)                 . 006A28 600C 0068
         AR    12,8                      . 006A2C 1AC8
         C     12,@@STACKT               . 006A2E 59C0 A828
         BH    OVER                      . 006A32 4720 9664
         B     FNME1                     . 006A36 47F0 B05A
                                                             SPACE
* ENMI PROC    NME                 Matching for X $ Y
*      INCRA   PATICL,DESCR        Increment offset
*      GETD    YPTR,PATBCL,PATICL  Get argument
*      POP     (NVAL)              Restore initial length
*      SETVA   YCL,NVAL            Move initial length into value field
*      SETSP   TSP,TXSP            Get working specifier
*      PUTLG   TSP,NVAL            Insert length
*      REMSP   TSP,TXSP,TSP        Get specifier for part matched
*      GETLG   ZCL,TSP             Get length of part
*      ACOMP   ZCL,MLENCL,SCLNOR   Check &MAXLNGTH
*      VEQLC   YPTR,E,,ENMEXN      Is it EXPRESSION?
                                                             SPACE
ENMI     L     11,@@NME                  . 006A3A 58B0 A9B4
         L     1,PATICL                  . 006A3E 5810 9EE0
         AR    1,8                       . 006A42 1A18
         ST    1,PATICL                  . 006A44 5010 9EE0
         L     2,PATBCL                  . 006A48 5820 A488
         LD    0,0(1,2)                  . 006A4C 6801 2000
         STD   0,YPTR                    . 006A50 6000 A428
         LD    0,96(12)                  . 006A54 680C 0060
         STD   0,NVAL                    . 006A58 6000 A3A8
         SR    12,8                      . 006A5C 1BC8
         MVC   YCL$5(3),NVAL$1           . 006A5E D202 A425 A3A9
         LM    1,4,TXSP                  . 006A64 9814 A5B0
         STM   1,4,TSP                   . 006A68 9014 A5A0
         L     1,NVAL                    . 006A6C 5810 A3A8
         ST    1,TSP                     . 006A70 5010 A5A0
         LM    1,4,TXSP                  . 006A74 9814 A5B0
         L     5,TSP                     . 006A78 5850 A5A0
         AR    2,5                       . 006A7C 1A25
         SR    1,5                       . 006A7E 1B15
         STM   1,4,TSP                   . 006A80 9014 A5A0
         LR    15,1                      . 006A84 18F1
         STM   15,0,ZCL                  . 006A86 90F0 A438
         C     1,MLENCL                  . 006A8A 5910 9848
         BH    SCLNOR                    . 006A8E 4720 9684
         CLC   YPTR$5(3),@@E             . 006A92 D502 A42D AA81
         BE    ENMEXN                    . 006A98 4780 B48A
                                                             SPACE
* ENMI5 VEQLC  YPTR,K,,ENMIC       Check for KEYWORD data type
*      RCALL   VVAL,GENVAR,(TSPPTR)
*                                  Generate variable
                                                             SPACE
ENMI5    CLC   YPTR$5(3),@@K             . 006A9C D502 A42D AA8A
         BE    ENMIC                     . 006AA2 4780 B474
         LA    14,S4$06ACA               . 006AA6 41E0 B25C
         STM   11,14,104(12)             . 006AAA 90BE C068
         LR    13,12                     . 006AAE 18DC
         LD    0,TSPPTR                  . 006AB0 6800 9F78
         STD   0,120(12)                 . 006AB4 600C 0078
         LA    12,24(12)                 . 006AB8 41CC 0018
         C     12,@@STACKT               . 006ABC 59C0 A828
         BH    OVER                      . 006AC0 4720 9664
         L     11,@@GENVAR               . 006AC4 58B0 A830
         BR    11                        . 006AC8 07FB
S4$06ACA STD   0,VVAL                    . 006ACA 6000 A3F0
                                                             SPACE
* ENMI3 PUTDC  YPTR,DESCR,VVAL     Perform assignment
*      AEQLC   OUTSW,0,,ENMI4      Check &OUTPUT
*      LOCAPV  ZPTR,OUTATL,YPTR,ENMI4
*                                  Look for output association
*      GETDC   ZPTR,ZPTR,DESCR     Get association
*      RCALL   ,PUTOUT,(ZPTR,VVAL) Perform output
                                                             SPACE
ENMI3    L     1,YPTR                    . 006ACE 5810 A428
         LD    0,VVAL                    . 006AD2 6800 A3F0
         STD   0,8(1)                    . 006AD6 6001 0008
         C     0,OUTSW                   . 006ADA 5900 9838
         BE    ENMI4                     . 006ADE 4780 B2CC
         L     15,OUTATL                 . 006AE2 58F0 A308
         L     5,4(15)                   . 006AE6 585F 0004
         LA    5,0(5,15)                 . 006AEA 4155 F000
         LR    4,8                       . 006AEE 1848
         SR    5,4                       . 006AF0 1B54
         AR    4,8                       . 006AF2 1A48
S4$06AF4 CLC   16(8,15),YPTR             . 006AF4 D507 F010 A428
         BE    S4$06B06                  . 006AFA 4780 B298
         BXLE  15,4,S4$06AF4             . 006AFE 87F4 B286
         B     ENMI4                     . 006B02 47F0 B2CC
S4$06B06 LD    0,8(15)                   . 006B06 680F 0008
         STD   0,ZPTR                    . 006B0A 6000 A440
         LA    14,S4$06B36               . 006B0E 41E0 B2C8
         STM   11,14,104(12)             . 006B12 90BE C068
         LR    13,12                     . 006B16 18DC
         STD   0,128(12)                 . 006B18 600C 0080
         LD    0,VVAL                    . 006B1C 6800 A3F0
         STD   0,120(12)                 . 006B20 600C 0078
         LA    12,32(12)                 . 006B24 41CC 0020
         C     12,@@STACKT               . 006B28 59C0 A828
         BH    OVER                      . 006B2C 4720 9664
         L     11,@@PUTOUT               . 006B30 58B0 A974
         BR    11                        . 006B34 07FB
S4$06B36 SR    0,0                       . 006B36 1B00
         SR    0,0                       . 006B38 1B00
                                                             SPACE
* ENMI4 ACOMPC TRAPCL,0,,ENMI2,ENMI2
*                                  Check &TRACE
*      LOCAPT  ATPTR,TVALL,YPTR,ENMI2
*                                  Look for VALUE trace
*      PUSH    (PATBCL,PATICL,WPTR,XCL,YCL)
*                                  Save relevant descriptors
*      PUSH    (MAXLEN,LENFCL,PDLPTR,PDLHED,NAMICL,NHEDCL)
*      SPUSH   (HEADSP,TSP,TXSP,XSP)
*                                  Save relevant specifiers
*      MOVD    PDLHED,PDLPTR       Set up new history list head
*      MOVD    NHEDCL,NAMICL       Set up new name list head
*      RCALL   ,TRPHND,ATPTR       Perform trace                E3.3.1
*      SPOP    (XSP,TXSP,TSP,HEADSP)
*                                  Restore specifiers
*      POP     (NHEDCL,NAMICL,PDLHED,PDLPTR,LENFCL,MAXLEN)
*                                  Restore descriptors
*      POP     (YCL,XCL,WPTR,PATICL,PATBCL)
                                                             SPACE
ENMI4    C     0,TRAPCL                  . 006B3A 5900 9818
         BNL   ENMI2                     . 006B3E 47B0 B454
         L     15,TVALL                  . 006B42 58F0 A310
         L     5,4(15)                   . 006B46 585F 0004
         LA    5,0(5,15)                 . 006B4A 4155 F000
         LR    4,8                       . 006B4E 1848
         SR    5,4                       . 006B50 1B54
         AR    4,8                       . 006B52 1A48
S4$06B54 CLC   8(8,15),YPTR              . 006B54 D507 F008 A428
         BE    S4$06B66                  . 006B5A 4780 B2F8
         BXLE  15,4,S4$06B54             . 006B5E 87F4 B2E6
         B     ENMI2                     . 006B62 47F0 B454
S4$06B66 STM   15,0,ATPTR                . 006B66 90F0 A378
         LD    0,PATBCL                  . 006B6A 6800 A488
         STD   0,104(12)                 . 006B6E 600C 0068
         LD    0,PATICL                  . 006B72 6800 9EE0
         STD   0,112(12)                 . 006B76 600C 0070
         LD    0,WPTR                    . 006B7A 6800 A400
         STD   0,120(12)                 . 006B7E 600C 0078
         LD    0,XCL                     . 006B82 6800 A408
         STD   0,128(12)                 . 006B86 600C 0080
         LD    0,YCL                     . 006B8A 6800 A420
         STD   0,136(12)                 . 006B8E 600C 0088
         LA    12,40(12)                 . 006B92 41CC 0028
         C     12,@@STACKT               . 006B96 59C0 A828
         BH    OVER                      . 006B9A 4720 9664
         LD    0,MAXLEN                  . 006B9E 6800 9EA8
         STD   0,104(12)                 . 006BA2 600C 0068
         LD    0,FNVLCL                  . 006BA6 6800 9BC0
         STD   0,112(12)                 . 006BAA 600C 0070
         LD    0,PDLPTR                  . 006BAE 6800 9EF0
         STD   0,120(12)                 . 006BB2 600C 0078
         LD    0,PDLHED                  . 006BB6 6800 9F48
         STD   0,128(12)                 . 006BBA 600C 0080
         LD    0,NAMICL                  . 006BBE 6800 9EB8
         STD   0,136(12)                 . 006BC2 600C 0088
         LD    0,NHEDCL                  . 006BC6 6800 9EC0
         STD   0,144(12)                 . 006BCA 600C 0090
         LA    12,48(12)                 . 006BCE 41CC 0030
         C     12,@@STACKT               . 006BD2 59C0 A828
         BH    OVER                      . 006BD6 4720 9664
         LM    1,4,HEADSP                . 006BDA 9814 A560
         STM   1,4,104(12)               . 006BDE 9014 C068
         LM    1,4,TSP                   . 006BE2 9814 A5A0
         STM   1,4,120(12)               . 006BE6 9014 C078
         LM    1,4,TXSP                  . 006BEA 9814 A5B0
         STM   1,4,136(12)               . 006BEE 9014 C088
         LM    1,4,XSP                   . 006BF2 9814 A5D0
         STM   1,4,152(12)               . 006BF6 9014 C098
         LA    12,64(12)                 . 006BFA 41CC 0040
         C     12,@@STACKT               . 006BFE 59C0 A828
         BH    OVER                      . 006C02 4720 9664
         LD    0,PDLPTR                  . 006C06 6800 9EF0
         STD   0,PDLHED                  . 006C0A 6000 9F48
         LD    0,NAMICL                  . 006C0E 6800 9EB8
         STD   0,NHEDCL                  . 006C12 6000 9EC0
         LA    14,S4$06C36               . 006C16 41E0 B3C8
         STM   11,14,104(12)             . 006C1A 90BE C068
         LR    13,12                     . 006C1E 18DC
         STM   15,0,120(12)              . 006C20 90F0 C078
         LA    12,24(12)                 . 006C24 41CC 0018
         C     12,@@STACKT               . 006C28 59C0 A828
         BH    OVER                      . 006C2C 4720 9664
         L     11,@@TRPHND               . 006C30 58B0 A918
         BR    11                        . 006C34 07FB
S4$06C36 SR    0,0                       . 006C36 1B00
         SR    0,0                       . 006C38 1B00
         LA    0,0                       . 006C3A 4100 0000
         LM    1,4,88(12)                . 006C3E 9814 C058
         STM   1,4,XSP                   . 006C42 9014 A5D0
         LM    1,4,72(12)                . 006C46 9814 C048
         STM   1,4,TXSP                  . 006C4A 9014 A5B0
         LM    1,4,56(12)                . 006C4E 9814 C038
         STM   1,4,TSP                   . 006C52 9014 A5A0
         LM    1,4,40(12)                . 006C56 9814 C028
         STM   1,4,HEADSP                . 006C5A 9014 A560
         S     12,@@16M4                 . 006C5E 5BC0 A924
         LD    0,96(12)                  . 006C62 680C 0060
         STD   0,NHEDCL                  . 006C66 6000 9EC0
         LD    0,88(12)                  . 006C6A 680C 0058
         STD   0,NAMICL                  . 006C6E 6000 9EB8
         LD    0,80(12)                  . 006C72 680C 0050
         STD   0,PDLHED                  . 006C76 6000 9F48
         LD    0,72(12)                  . 006C7A 680C 0048
         STD   0,PDLPTR                  . 006C7E 6000 9EF0
         LD    0,64(12)                  . 006C82 680C 0040
         STD   0,FNVLCL                  . 006C86 6000 9BC0
         LD    0,56(12)                  . 006C8A 680C 0038
         STD   0,MAXLEN                  . 006C8E 6000 9EA8
         S     12,@@6XDESC               . 006C92 5BC0 A928
         LD    0,96(12)                  . 006C96 680C 0060
         STD   0,YCL                     . 006C9A 6000 A420
         LD    0,88(12)                  . 006C9E 680C 0058
         STD   0,XCL                     . 006CA2 6000 A408
         LD    0,80(12)                  . 006CA6 680C 0050
         STD   0,WPTR                    . 006CAA 6000 A400
         LD    0,72(12)                  . 006CAE 680C 0048
         STD   0,PATICL                  . 006CB2 6000 9EE0
         LD    0,64(12)                  . 006CB6 680C 0040
         STD   0,PATBCL                  . 006CBA 6000 A488
         S     12,@@5XDESC               . 006CBE 5BC0 A998
                                                             SPACE
* ENMI2 INCRA  PDLPTR,3*DESCR      Make room on history list
*      ACOMP   PDLPTR,PDLEND,INTR31
*                                  Check for overflow
*      PUTDC   PDLPTR,DESCR,DNMICL Insert unravelling function
*      BRANCH  ENME3               Join common processing
                                                             SPACE
ENMI2    L     1,PDLPTR                  . 006CC2 5810 9EF0
         LA    1,24(1)                   . 006CC6 4111 0018
         ST    1,PDLPTR                  . 006CCA 5010 9EF0
         C     1,PDLEND                  . 006CCE 5910 9EE8
         BH    INTR31                    . 006CD2 4720 962C
         LD    0,DNMICL                  . 006CD6 6800 9D10
         STD   0,8(1)                    . 006CDA 6001 0008
         B     ENME3                     . 006CDE 47F0 B0FC
                                                             SPACE
* ENMIC SPCINT VVAL,TSP,SCDTER,ENMI3
*                                  Convert STRING to INTEGER
                                                             SPACE
ENMIC    L     15,@@DECBIN               . 006CE2 58F0 A8EC
         LA    1,VVAL                    . 006CE6 4110 A3F0
         LA    2,TSP                     . 006CEA 4120 A5A0
         BALR  14,15                          CALL                     *
                                         . 006CEE 05EF
         B     SCDTER                    . 006CF0 47F0 9674
         B     ENMI3                     . 006CF4 47F0 B260
                                                             SPACE
* ENMEXN PUSH  ZEROCL                                  E3.4.4 & E3.5.8
*      RCALL   YPTR,EXPEVL,YPTR,(TSALF,,SCNEMO)        E3.4.4 & E3.5.8
*      POP     ZEROCL                                  E3.4.4 & E3.5.8
*      BRANCH  ENMI5                                   E3.4.4 & E3.5.8
ENMEXN   LA    14,S4$06D1C               . 006CF8 41E0 B4AE
         STM   11,14,104(12)             . 006CFC 90BE C068
         LR    13,12                     . 006D00 18DC
         LD    0,YPTR                    . 006D02 6800 A428
         STD   0,120(12)                 . 006D06 600C 0078
         LA    12,24(12)                 . 006D0A 41CC 0018
         C     12,@@STACKT               . 006D0E 59C0 A828
         BH    OVER                      . 006D12 4720 9664
         L     11,@@EXPEVL               . 006D16 58B0 A99C
         BR    11                        . 006D1A 07FB
S4$06D1C STD   0,YPTR                    . 006D1C 6000 A428
         B     TSALF                     . 006D20 47F0 9094
         B     ENMI5                     . 006D24 47F0 B22E
         B     FATLCL                    . 006D28 47F0 9E70
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      SUCCEED
*
                                                             SPACE
* SUCE PROC    ,                   Matching procedure for SUCCEED
* SUCE1 INCRA  PDLPTR,3*DESCR      Make room for history entry
*      ACOMP   PDLPTR,PDLEND,INTR31
*                                  Check for overflow
*      PUTDC   PDLPTR,DESCR,SUCFCL Insert SUCCESS backup function
*      GETLG   TMVAL,TXSP          Get length matched
*      PUTDC   PDLPTR,2*DESCR,TMVAL
*                                  Save on history list
*      PUTDC   PDLPTR,3*DESCR,LENFCL
*                                  Save current length failure
*      SETAC   LENFCL,1            Set length failure
*      BRANIC  SCOKCL,0            Return successful match
                                                             SPACE
         USING SUCE,11                   .
SUCE     L     1,PDLPTR                  . 006D2C 5810 9EF0
         LA    1,24(1)                   . 006D30 4111 0018
         ST    1,PDLPTR                  . 006D34 5010 9EF0
         C     1,PDLEND                  . 006D38 5910 9EE8
         BH    INTR31                    . 006D3C 4720 962C
         LD    0,SUCFCL                  . 006D40 6800 9DE0
         STD   0,8(1)                    . 006D44 6001 0008
         L     15,TXSP                   . 006D48 58F0 A5B0
         STM   15,0,TMVAL                . 006D4C 90F0 A3C8
         STM   15,0,16(1)                . 006D50 90F0 1010
         LD    0,FNVLCL                  . 006D54 6800 9BC0
         STD   0,24(1)                   . 006D58 6001 0018
         LA    1,1                       . 006D5C 4110 0001
         ST    1,FNVLCL                  . 006D60 5010 9BC0
         L     15,SCOKCL                 . 006D64 58F0 9DC0
         L     11,0(15)                  . 006D68 58BF 0000
         BR    11                        . 006D6C 07FB
                                                             SPACE
* SUCF PROC    SUCE                SUCCEED failure
*      GETDC   XCL,PDLPTR,DESCR    Get history entries
*      GETDC   YCL,PDLPTR,2*DESCR
*      BRANCH  SUCE1               Go in front door
SUCF     L     11,@@SUCE                 . 006D6E 58B0 A9BC
         L     1,PDLPTR                  . 006D72 5810 9EF0
         LD    0,8(1)                    . 006D76 6801 0008
         STD   0,XCL                     . 006D7A 6000 A408
         LD    0,16(1)                   . 006D7E 6801 0010
         STD   0,YCL                     . 006D82 6000 A420
         B     SUCE                      . 006D86 47F0 B000
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Defined Functions'
*
*      DEFINE(P,E)
*
                                                             SPACE
* DEFINE PROC  ,                   DEFINE(P,E)
*      RCALL   XPTR,VARVAL,,FAIL   Get prototype
*      PUSH    XPTR                Save prototype
*      RCALL   YPTR,VARVAL,,FAIL   Get entry point
*      POP     XPTR                Restore prototype
*      LOCSP   XSP,XPTR            Specifier for prototype
*      STREAM  YSP,XSP,VARATB,PROTER,PROTER
*                                  Break out function name
*      AEQLC   STYPE,LPTYP,PROTER  Verify open parenthesis
*      RCALL   XPTR,GENVAR,(YSPPTR)
*                                  Get variable for function name
*      RCALL   ZCL,FINDEX,(XPTR)   Get function descriptor for function
*      DEQL    YPTR,NULVCL,DEFIN3  Check for omitted entry point
*      MOVD    YPTR,XPTR           If omitted use function name
                                                             SPACE
         USING DEFINE,11                 .
DEFINE   LA    14,S4$06DA6               . 006D8A 41E0 B01C
         STM   11,14,104(12)             . 006D8E 90BE C068
         LR    13,12                     . 006D92 18DC
         LA    12,16(12)                 . 006D94 41CC 0010
         C     12,@@STACKT               . 006D98 59C0 A828
         BH    OVER                      . 006D9C 4720 9664
         L     11,@@VARVAL               . 006DA0 58B0 A9C0
         BR    11                        . 006DA4 07FB
S4$06DA6 STD   0,XPTR                    . 006DA6 6000 A410
         B     FAIL                      . 006DAA 47F0 9010
         LD    0,XPTR                    . 006DAE 6800 A410
         STD   0,104(12)                 . 006DB2 600C 0068
         AR    12,8                      . 006DB6 1AC8
         C     12,@@STACKT               . 006DB8 59C0 A828
         BH    OVER                      . 006DBC 4720 9664
         LA    14,S4$06DDC               . 006DC0 41E0 B052
         STM   11,14,104(12)             . 006DC4 90BE C068
         LR    13,12                     . 006DC8 18DC
         LA    12,16(12)                 . 006DCA 41CC 0010
         C     12,@@STACKT               . 006DCE 59C0 A828
         BH    OVER                      . 006DD2 4720 9664
         L     11,@@VARVAL               . 006DD6 58B0 A9C0
         BR    11                        . 006DDA 07FB
S4$06DDC STD   0,YPTR                    . 006DDC 6000 A428
         B     FAIL                      . 006DE0 47F0 9010
         LD    0,96(12)                  . 006DE4 680C 0060
         STD   0,XPTR                    . 006DE8 6000 A410
         SR    12,8                      . 006DEC 1BC8
         LM    3,4,XPTR                  . 006DEE 9834 A410
         CR    0,3                       . 006DF2 1903
         BNE   S4$06E00                  . 006DF4 4770 B076
         ST    0,XSP                     . 006DF8 5000 A5D0
         B     S4$06E10                  . 006DFC 47F0 B086
S4$06E00 L     1,4(3)                    . 006E00 5813 0004
         LA    1,0(1)                    . 006E04 4111 0000
         LA    2,32                      . 006E08 4120 0020
         STM   1,4,XSP                   . 006E0C 9014 A5D0
S4$06E10 L     15,@@STREAM               . 006E10 58F0 A840
         LA    1,YSP                     . 006E14 4110 A5E0
         LA    2,XSP                     . 006E18 4120 A5D0
         L     3,@@VARATB                . 006E1C 5830 A9C4
         BALR  14,15                          CALL                     *
                                         . 006E20 05EF
         B     PROTER                    . 006E22 47F0 966C
         B     PROTER                    . 006E26 47F0 966C
         LA    6,1                       . 006E2A 4160 0001
         C     6,STYPE                   . 006E2E 5960 9F08
         BNE   PROTER                    . 006E32 4770 966C
         LA    14,S4$06E5A               . 006E36 41E0 B0D0
         STM   11,14,104(12)             . 006E3A 90BE C068
         LR    13,12                     . 006E3E 18DC
         LD    0,YSPPTR                  . 006E40 6800 9F68
         STD   0,120(12)                 . 006E44 600C 0078
         LA    12,24(12)                 . 006E48 41CC 0018
         C     12,@@STACKT               . 006E4C 59C0 A828
         BH    OVER                      . 006E50 4720 9664
         L     11,@@GENVAR               . 006E54 58B0 A830
         BR    11                        . 006E58 07FB
S4$06E5A STD   0,XPTR                    . 006E5A 6000 A410
         LA    14,S4$06E7E               . 006E5E 41E0 B0F4
         STM   11,14,104(12)             . 006E62 90BE C068
         LR    13,12                     . 006E66 18DC
         STD   0,120(12)                 . 006E68 600C 0078
         LA    12,24(12)                 . 006E6C 41CC 0018
         C     12,@@STACKT               . 006E70 59C0 A828
         BH    OVER                      . 006E74 4720 9664
         L     11,@@FINDEX               . 006E78 58B0 A8F4
         BR    11                        . 006E7C 07FB
S4$06E7E STD   0,ZCL                     . 006E7E 6000 A438
         CLC   YPTR(8),NULVCL            . 006E82 D507 A428 9ED0
         BNE   DEFIN3                    . 006E88 4770 B10A
         LD    0,XPTR                    . 006E8C 6800 A410
         STD   0,YPTR                    . 006E90 6000 A428
                                                             SPACE
* DEFIN3 PUSH  YPTR                Save entry point
*      MOVD    YCL,ZEROCL          Set argument count to 0
*      PUSH    XPTR                Save function name
                                                             SPACE
DEFIN3   LD    0,YPTR                    . 006E94 6800 A428
         STD   0,104(12)                 . 006E98 600C 0068
         AR    12,8                      . 006E9C 1AC8
         C     12,@@STACKT               . 006E9E 59C0 A828
         BH    OVER                      . 006EA2 4720 9664
         LD    0,ZEROCL                  . 006EA6 6800 9C90
         STD   0,YCL                     . 006EAA 6000 A420
         LD    0,XPTR                    . 006EAE 6800 A410
         STD   0,104(12)                 . 006EB2 600C 0068
         AR    12,8                      . 006EB6 1AC8
         C     12,@@STACKT               . 006EB8 59C0 A828
         BH    OVER                      . 006EBC 4720 9664
                                                             SPACE
* DEFIN4 FSHRTN XSP,1              Remove break character
*      STREAM  YSP,XSP,VARATB,PROTER,PROTER
*                                  Break out argument
*      SELBRA  STYPE,(PROTER,,DEFIN6)
*                                  Check for end
*      LEQLC   YSP,0,,DEFIN4       Check for null argument
*      RCALL   XPTR,GENVAR,(YSPPTR)
*                                  Generate variable for argument
*      PUSH    XPTR                Save argument
*      INCRA   YCL,1               Increment argument count
*      BRANCH  DEFIN4              Continue
                                                             SPACE
DEFIN4   LM    1,2,XSP                   . 006EC0 9812 A5D0
         BCTR  1,0                            DECREMENT                *
                                         . 006EC4 0610
         LA    2,1(2)                    . 006EC6 4122 0001
         STM   1,2,XSP                   . 006ECA 9012 A5D0
         L     15,@@STREAM               . 006ECE 58F0 A840
         LA    1,YSP                     . 006ED2 4110 A5E0
         LA    2,XSP                     . 006ED6 4120 A5D0
         L     3,@@VARATB                . 006EDA 5830 A9C4
         BALR  14,15                          CALL                     *
                                         . 006EDE 05EF
         B     PROTER                    . 006EE0 47F0 966C
         B     PROTER                    . 006EE4 47F0 966C
         L     1,STYPE                   . 006EE8 5810 9F08
         SLA   1,2                       . 006EEC 8B10 0002
S4$06EF0 B     S4$06EF0(1)               . 006EF0 47F1 B166
         B     PROTER                    . 006EF4 47F0 966C
         B     S4$06F00                  . 006EF8 47F0 B176
         B     DEFIN6                    . 006EFC 47F0 B1C4
S4$06F00 C     0,YSP                     . 006F00 5900 A5E0
         BE    DEFIN4                    . 006F04 4780 B136
         LA    14,S4$06F2C               . 006F08 41E0 B1A2
         STM   11,14,104(12)             . 006F0C 90BE C068
         LR    13,12                     . 006F10 18DC
         LD    0,YSPPTR                  . 006F12 6800 9F68
         STD   0,120(12)                 . 006F16 600C 0078
         LA    12,24(12)                 . 006F1A 41CC 0018
         C     12,@@STACKT               . 006F1E 59C0 A828
         BH    OVER                      . 006F22 4720 9664
         L     11,@@GENVAR               . 006F26 58B0 A830
         BR    11                        . 006F2A 07FB
S4$06F2C STD   0,XPTR                    . 006F2C 6000 A410
         STD   0,104(12)                 . 006F30 600C 0068
         AR    12,8                      . 006F34 1AC8
         C     12,@@STACKT               . 006F36 59C0 A828
         BH    OVER                      . 006F3A 4720 9664
         L     1,YCL                     . 006F3E 5810 A420
         LA    1,1(1)                    . 006F42 4111 0001
         ST    1,YCL                     . 006F46 5010 A420
         B     DEFIN4                    . 006F4A 47F0 B136
                                                             SPACE
* DEFIN6 LEQLC YSP,0,,DEFIN9
*      INCRA   YCL,1               Increment argument count
*      RCALL   XPTR,GENVAR,(YSPPTR)
*                                  Generate variable for argument
*      PUSH    XPTR                Save argument
                                                             SPACE
DEFIN6   C     0,YSP                     . 006F4E 5900 A5E0
         BE    DEFIN9                    . 006F52 4780 B20E
         L     1,YCL                     . 006F56 5810 A420
         LA    1,1(1)                    . 006F5A 4111 0001
         ST    1,YCL                     . 006F5E 5010 A420
         LA    14,S4$06F86               . 006F62 41E0 B1FC
         STM   11,14,104(12)             . 006F66 90BE C068
         LR    13,12                     . 006F6A 18DC
         LD    0,YSPPTR                  . 006F6C 6800 9F68
         STD   0,120(12)                 . 006F70 600C 0078
         LA    12,24(12)                 . 006F74 41CC 0018
         C     12,@@STACKT               . 006F78 59C0 A828
         BH    OVER                      . 006F7C 4720 9664
         L     11,@@GENVAR               . 006F80 58B0 A830
         BR    11                        . 006F84 07FB
S4$06F86 STD   0,XPTR                    . 006F86 6000 A410
         STD   0,104(12)                 . 006F8A 600C 0068
         AR    12,8                      . 006F8E 1AC8
         C     12,@@STACKT               . 006F90 59C0 A828
         BH    OVER                      . 006F94 4720 9664
                                                             SPACE
* DEFIN9 SETVA DEFCL,YCL
                                                             SPACE
DEFIN9   MVC   DEFCL$5(3),YCL$1          . 006F98 D202 9F35 A421
                                                             SPACE
* DEFIN8 FSHRTN XSP,1
*      STREAM  YSP,XSP,VARATB,PROTER,DEF10
*                                  Break out local arguments
*      AEQLC   STYPE,CMATYP,PROTER Verify comma
*      LEQLC   YSP,0,,DEFIN8       Check for null argument
*      RCALL   XPTR,GENVAR,(YSPPTR)
*                                  Generate variable
*      PUSH    XPTR                Save local argument
*      INCRA   YCL,1               Increment total count
*      BRANCH  DEFIN8              Continue
                                                             SPACE
DEFIN8   LM    1,2,XSP                   . 006F9E 9812 A5D0
         BCTR  1,0                            DECREMENT                *
                                         . 006FA2 0610
         LA    2,1(2)                    . 006FA4 4122 0001
         STM   1,2,XSP                   . 006FA8 9012 A5D0
         L     15,@@STREAM               . 006FAC 58F0 A840
         LA    1,YSP                     . 006FB0 4110 A5E0
         LA    2,XSP                     . 006FB4 4120 A5D0
         L     3,@@VARATB                . 006FB8 5830 A9C4
         BALR  14,15                          CALL                     *
                                         . 006FBC 05EF
         B     PROTER                    . 006FBE 47F0 966C
         B     DEF10                     . 006FC2 47F0 B296
         LA    6,2                       . 006FC6 4160 0002
         C     6,STYPE                   . 006FCA 5960 9F08
         BNE   PROTER                    . 006FCE 4770 966C
         C     0,YSP                     . 006FD2 5900 A5E0
         BE    DEFIN8                    . 006FD6 4780 B214
         LA    14,S4$06FFE               . 006FDA 41E0 B274
         STM   11,14,104(12)             . 006FDE 90BE C068
         LR    13,12                     . 006FE2 18DC
         LD    0,YSPPTR                  . 006FE4 6800 9F68
         STD   0,120(12)                 . 006FE8 600C 0078
         LA    12,24(12)                 . 006FEC 41CC 0018
         C     12,@@STACKT               . 006FF0 59C0 A828
         BH    OVER                      . 006FF4 4720 9664
         L     11,@@GENVAR               . 006FF8 58B0 A830
         BR    11                        . 006FFC 07FB
S4$06FFE STD   0,XPTR                    . 006FFE 6000 A410
         STD   0,104(12)                 . 007002 600C 0068
         AR    12,8                      . 007006 1AC8
         C     12,@@STACKT               . 007008 59C0 A828
         BH    OVER                      . 00700C 4720 9664
         L     1,YCL                     . 007010 5810 A420
         LA    1,1(1)                    . 007014 4111 0001
         ST    1,YCL                     . 007018 5010 A420
         B     DEFIN8                    . 00701C 47F0 B214
                                                             SPACE
* DEF10 LEQLC  YSP,0,,DEF11        Check for null argument
*      RCALL   XPTR,GENVAR,YSPPTR  Generate variable
*      PUSH    XPTR                Save argument
*      INCRA   YCL,1               Increment total count
                                                             SPACE
DEF10    C     0,YSP                     . 007020 5900 A5E0
         BE    DEF11                     . 007024 4780 B2E0
         LA    14,S4$0704C               . 007028 41E0 B2C2
         STM   11,14,104(12)             . 00702C 90BE C068
         LR    13,12                     . 007030 18DC
         LD    0,YSPPTR                  . 007032 6800 9F68
         STD   0,120(12)                 . 007036 600C 0078
         LA    12,24(12)                 . 00703A 41CC 0018
         C     12,@@STACKT               . 00703E 59C0 A828
         BH    OVER                      . 007042 4720 9664
         L     11,@@GENVAR               . 007046 58B0 A830
         BR    11                        . 00704A 07FB
S4$0704C STD   0,XPTR                    . 00704C 6000 A410
         STD   0,104(12)                 . 007050 600C 0068
         AR    12,8                      . 007054 1AC8
         C     12,@@STACKT               . 007056 59C0 A828
         BH    OVER                      . 00705A 4720 9664
         L     1,YCL                     . 00705E 5810 A420
         LA    1,1(1)                    . 007062 4111 0001
         ST    1,YCL                     . 007066 5010 A420
                                                             SPACE
* DEF11 INCRA  YCL,2               Increment for name and label
*      MULTC   XCL,YCL,DESCR       Convert to address units
*      SETVC   XCL,B               Insert block data type
*      RCALL   XPTR,BLOCK,XCL      Allocate block for definition
*      PUTDC   ZCL,0,DEFCL         Point to procedure descriptor
*      PUTDC   ZCL,DESCR,XPTR      Insert definition block
*      SUM     XPTR,XPTR,XCL       Compute end of block
                                                             SPACE
DEF11    L     1,YCL                     . 00706A 5810 A420
         LA    15,2(1)                   . 00706E 41F1 0002
         ST    15,YCL                    . 007072 50F0 A420
         SLA   15,3                      . 007076 8BF0 0003
         STM   15,0,XCL                  . 00707A 90F0 A408
         MVC   XCL$5(3),@@B              . 00707E D202 A40D AA6C
         LA    14,S4$070A8               . 007084 41E0 B31E
         STM   11,14,104(12)             . 007088 90BE C068
         LR    13,12                     . 00708C 18DC
         LD    0,XCL                     . 00708E 6800 A408
         STD   0,120(12)                 . 007092 600C 0078
         LA    12,24(12)                 . 007096 41CC 0018
         C     12,@@STACKT               . 00709A 59C0 A828
         BH    OVER                      . 00709E 4720 9664
         L     11,@@BLOCK                . 0070A2 58B0 A82C
         BR    11                        . 0070A6 07FB
S4$070A8 STD   0,XPTR                    . 0070A8 6000 A410
         L     1,ZCL                     . 0070AC 5810 A438
         LD    0,DEFCL                   . 0070B0 6800 9F30
         STD   0,0(1)                    . 0070B4 6001 0000
         LD    0,XPTR                    . 0070B8 6800 A410
         STD   0,8(1)                    . 0070BC 6001 0008
         L     1,XPTR                    . 0070C0 5810 A410
         A     1,XCL                     . 0070C4 5A10 A408
         ST    1,XPTR                    . 0070C8 5010 A410
                                                             SPACE
* DEF12 DECRA  XPTR,DESCR          Decrement pointer
*      POP     YPTR                Restore argument
*      PUTDC   XPTR,DESCR,YPTR     Insert in definition block
*      DECRA   YCL,1               Decrement total count
*      AEQLC   YCL,0,DEF12,RETNUL  Check for end
DEF12    L     1,XPTR                    . 0070CC 5810 A410
         SR    1,8                       . 0070D0 1B18
         ST    1,XPTR                    . 0070D2 5010 A410
         LD    0,96(12)                  . 0070D6 680C 0060
         STD   0,YPTR                    . 0070DA 6000 A428
         SR    12,8                      . 0070DE 1BC8
         STD   0,8(1)                    . 0070E0 6001 0008
         L     1,YCL                     . 0070E4 5810 A420
         BCTR  1,0                            DECREMENT                *
                                         . 0070E8 0610
         ST    1,YCL                     . 0070EA 5010 A420
         CR    0,1                       . 0070EE 1901
         BNE   DEF12                     . 0070F0 4770 B342
         BE    RETNUL                    . 0070F4 4780 9018
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Invocation of Defined Function
*
                                                             SPACE
* DEFFNC PROC  ,                   Procedure to invoke defined function
*      SETAV   XCL,INCL            Get number of arguments in call
*      MOVD    WCL,XCL             Save copy
*      MOVD    YCL,INCL            Save function descriptor
*      PSTACK  YPTR                Post stack position
*      PUSH    NULVCL              Save null value for function name
                                                             SPACE
         USING DEFFNC,11                 .
DEFFNC   L     15,INCL$4                 . 0070F8 58F0 9E9C
         LA    15,0(15)                  . 0070FC 41FF 0000
         STM   15,0,XCL                  . 007100 90F0 A408
         STM   15,0,WCL                  . 007104 90F0 A3F8
         LD    0,INCL                    . 007108 6800 9E98
         STD   0,YCL                     . 00710C 6000 A420
         LA    15,88(12)                 . 007110 41FC 0058
         STM   15,0,YPTR                 . 007114 90F0 A428
         LD    0,NULVCL                  . 007118 6800 9ED0
         STD   0,104(12)                 . 00711C 600C 0068
         AR    12,8                      . 007120 1AC8
         C     12,@@STACKT               . 007122 59C0 A828
         BH    OVER                      . 007126 4720 9664
                                                             SPACE
* DEFF1 INCRA  OCICL,DESCR         Increment offset
*      GETD    XPTR,OCBSCL,OCICL   Get object code descriptor
*      TESTF   XPTR,FNC,,DEFFC     Check for function descriptor
                                                             SPACE
DEFF1    L     1,OCICL                   . 00712A 5810 9ED8
         AR    1,8                       . 00712E 1A18
         ST    1,OCICL                   . 007130 5010 9ED8
         L     2,OCBSCL                  . 007134 5820 A470
         LD    0,0(1,2)                  . 007138 6801 2000
         STD   0,XPTR                    . 00713C 6000 A410
         TM    XPTR$4,X'04'              . 007140 9104 A414
         BO    DEFFC                     . 007144 4710 B6D4
                                                             SPACE
* DEFF2 AEQLC  INSW,0,,DEFF14      Check &INPUT
*      LOCAPV  ZPTR,INATL,XPTR,DEFF14
*                                  Look for input association
*      GETDC   ZPTR,ZPTR,DESCR     Get association
*      PUSH    (XCL,WCL,YCL,YPTR)  Save relevant descriptors
*      RCALL   XPTR,PUTIN,(ZPTR,XPTR),FAIL
*                                  Perform input
*      POP     (YPTR,YCL,WCL,XCL)  Restore descriptors
*      BRANCH  DEFF3               Join processing
                                                             SPACE
DEFF2    C     0,INSW                    . 007148 5900 9858
         BE    DEFF14                    . 00714C 4780 B10C
         L     15,INATL                  . 007150 58F0 A300
         L     5,4(15)                   . 007154 585F 0004
         LA    5,0(5,15)                 . 007158 4155 F000
         LR    4,8                       . 00715C 1848
         SR    5,4                       . 00715E 1B54
         AR    4,8                       . 007160 1A48
S4$07162 CLC   16(8,15),XPTR             . 007162 D507 F010 A410
         BE    S4$07174                  . 007168 4780 B07C
         BXLE  15,4,S4$07162             . 00716C 87F4 B06A
         B     DEFF14                    . 007170 47F0 B10C
S4$07174 LD    0,8(15)                   . 007174 680F 0008
         STD   0,ZPTR                    . 007178 6000 A440
         LD    0,XCL                     . 00717C 6800 A408
         STD   0,104(12)                 . 007180 600C 0068
         LD    0,WCL                     . 007184 6800 A3F8
         STD   0,112(12)                 . 007188 600C 0070
         LD    0,YCL                     . 00718C 6800 A420
         STD   0,120(12)                 . 007190 600C 0078
         LD    0,YPTR                    . 007194 6800 A428
         STD   0,128(12)                 . 007198 600C 0080
         LA    12,32(12)                 . 00719C 41CC 0020
         C     12,@@STACKT               . 0071A0 59C0 A828
         BH    OVER                      . 0071A4 4720 9664
         LA    14,S4$071D4               . 0071A8 41E0 B0DC
         STM   11,14,104(12)             . 0071AC 90BE C068
         LR    13,12                     . 0071B0 18DC
         LD    0,ZPTR                    . 0071B2 6800 A440
         STD   0,128(12)                 . 0071B6 600C 0080
         LD    0,XPTR                    . 0071BA 6800 A410
         STD   0,120(12)                 . 0071BE 600C 0078
         LA    12,32(12)                 . 0071C2 41CC 0020
         C     12,@@STACKT               . 0071C6 59C0 A828
         BH    OVER                      . 0071CA 4720 9664
         L     11,@@PUTIN                . 0071CE 58B0 A920
         BR    11                        . 0071D2 07FB
S4$071D4 STD   0,XPTR                    . 0071D4 6000 A410
         B     FAIL                      . 0071D8 47F0 9010
         LD    0,96(12)                  . 0071DC 680C 0060
         STD   0,YPTR                    . 0071E0 6000 A428
         LD    0,88(12)                  . 0071E4 680C 0058
         STD   0,YCL                     . 0071E8 6000 A420
         LD    0,80(12)                  . 0071EC 680C 0050
         STD   0,WCL                     . 0071F0 6000 A3F8
         LD    0,72(12)                  . 0071F4 680C 0048
         STD   0,XCL                     . 0071F8 6000 A408
         S     12,@@2M16                 . 0071FC 5BC0 A9C8
         B     DEFF3                     . 007200 47F0 B118
                                                             SPACE
* DEFF14 GETDC XPTR,XPTR,DESCR     Get value
                                                             SPACE
DEFF14   L     1,XPTR                    . 007204 5810 A410
         LD    0,8(1)                    . 007208 6801 0008
         STD   0,XPTR                    . 00720C 6000 A410
                                                             SPACE
* DEFF3 PUSH   XPTR                Save value
*      DECRA   XCL,1               Decrement argument count
*      ACOMPC  XCL,0,DEFF1,,INTR10 Check for end
*      GETDC   XCL,YCL,0           Get expected number of arguments
*      SETAV   XCL,XCL             Insert in A-field
                                                             SPACE
DEFF3    LD    0,XPTR                    . 007210 6800 A410
         STD   0,104(12)                 . 007214 600C 0068
         AR    12,8                      . 007218 1AC8
         C     12,@@STACKT               . 00721A 59C0 A828
         BH    OVER                      . 00721E 4720 9664
         L     1,XCL                     . 007222 5810 A408
         BCTR  1,0                            DECREMENT                *
                                         . 007226 0610
         ST    1,XCL                     . 007228 5010 A408
         CR    0,1                       . 00722C 1901
         BL    DEFF1                     . 00722E 4740 B032
         BH    S4$010                    . 007232 4720 95AC
         L     1,YCL                     . 007236 5810 A420
         LD    0,0(1)                    . 00723A 6801 0000
         STD   0,XCL                     . 00723E 6000 A408
         L     15,XCL$4                  . 007242 58F0 A40C
         LA    15,0(15)                  . 007246 41FF 0000
         STM   15,0,XCL                  . 00724A 90F0 A408
                                                             SPACE
* DEFF4 ACOMP  WCL,XCL,DEFF9,DEFF5 Compare given and expected
*      PUSH    NULVCL              Not enough, save null string
*      INCRA   WCL,1               Increment count
*      BRANCH  DEFF4               Continue
                                                             SPACE
DEFF4    L     1,WCL                     . 00724E 5810 A3F8
         C     1,XCL                     . 007252 5910 A408
         BH    DEFF9                     . 007256 4720 B184
         BE    DEFF5                     . 00725A 4780 B19C
         LD    0,NULVCL                  . 00725E 6800 9ED0
         STD   0,104(12)                 . 007262 600C 0068
         AR    12,8                      . 007266 1AC8
         C     12,@@STACKT               . 007268 59C0 A828
         BH    OVER                      . 00726C 4720 9664
         LA    1,1(1)                    . 007270 4111 0001
         ST    1,WCL                     . 007274 5010 A3F8
         B     DEFF4                     . 007278 47F0 B156
                                                             SPACE
* DEFF9 POP    ZCL                 Throw away extra argument
*      DECRA   WCL,1               Decrement count
*      BRANCH  DEFF4               Continue
                                                             SPACE
DEFF9    LD    0,96(12)                  . 00727C 680C 0060
         STD   0,ZCL                     . 007280 6000 A438
         SR    12,8                      . 007284 1BC8
         L     1,WCL                     . 007286 5810 A3F8
         BCTR  1,0                            DECREMENT                *
                                         . 00728A 0610
         ST    1,WCL                     . 00728C 5010 A3F8
         B     DEFF4                     . 007290 47F0 B156
                                                             SPACE
* DEFF5 GETDC  ZCL,YCL,DESCR       Get definition block
*      MOVD    XPTR,ZCL            Save copy
*      GETSIZ  WCL,ZCL             Get size of block
*      SUM     WPTR,ZCL,WCL        Compute pointer to end
*      INCRA   XCL,1               Increment for function name
                                                             SPACE
DEFF5    L     1,YCL                     . 007294 5810 A420
         LD    0,8(1)                    . 007298 6801 0008
         STD   0,ZCL                     . 00729C 6000 A438
         STD   0,XPTR                    . 0072A0 6000 A410
         L     15,ZCL                    . 0072A4 58F0 A438
         L     15,4(15)                  . 0072A8 58FF 0004
         LA    15,0(15)                  . 0072AC 41FF 0000
         STM   15,0,WCL                  . 0072B0 90F0 A3F8
         LM    1,2,ZCL                   . 0072B4 9812 A438
         AR    1,15                      . 0072B8 1A1F
         STM   1,2,WPTR                  . 0072BA 9012 A400
         L     1,XCL                     . 0072BE 5810 A408
         LA    1,1(1)                    . 0072C2 4111 0001
         ST    1,XCL                     . 0072C6 5010 A408
                                                             SPACE
* DEFF8 INCRA  XPTR,DESCR          Increment pointer to block
*      INCRA   YPTR,DESCR          Adjust stack pointer
*      GETDC   ZPTR,XPTR,DESCR     Get argument name
*      GETDC   TPTR,ZPTR,DESCR     Get current argument value
*      GETDC   ATPTR,YPTR,DESCR    Get value from stack
*      PUTDC   ZPTR,DESCR,ATPTR    Assign to argument name
*      PUTDC   YPTR,DESCR,TPTR     Put current argument on stack
*      DECRA   XCL,1               Decrement count
*      ACOMPC  XCL,0,DEFF8,,INTR10 Check for end
                                                             SPACE
DEFF8    L     1,XPTR                    . 0072CA 5810 A410
         AR    1,8                       . 0072CE 1A18
         ST    1,XPTR                    . 0072D0 5010 A410
         L     3,YPTR                    . 0072D4 5830 A428
         AR    3,8                       . 0072D8 1A38
         ST    3,YPTR                    . 0072DA 5030 A428
         LM    1,2,8(1)                  . 0072DE 9812 1008
         STM   1,2,ZPTR                  . 0072E2 9012 A440
         LD    0,8(1)                    . 0072E6 6801 0008
         STD   0,TPTR                    . 0072EA 6000 A3D0
         LD    0,8(3)                    . 0072EE 6803 0008
         STD   0,ATPTR                   . 0072F2 6000 A378
         L     1,ZPTR                    . 0072F6 5810 A440
         STD   0,8(1)                    . 0072FA 6001 0008
         LD    0,TPTR                    . 0072FE 6800 A3D0
         STD   0,8(3)                    . 007302 6003 0008
         L     1,XCL                     . 007306 5810 A408
         BCTR  1,0                            DECREMENT                *
                                         . 00730A 0610
         ST    1,XCL                     . 00730C 5010 A408
         CR    0,1                       . 007310 1901
         BL    DEFF8                     . 007312 4740 B1D2
         BH    S4$010                    . 007316 4720 95AC
                                                             SPACE
* DEFF10 INCRA XPTR,DESCR          Increment pointer to block
*      AEQL    XPTR,WPTR,,DEFFGO
*      GETDC   ZPTR,XPTR,DESCR     Get argument name from block
*      GETDC   TPTR,ZPTR,DESCR     Get current value of argument
*      PUSH    TPTR                Save current value
*      PUTDC   ZPTR,DESCR,NULVCL   Assign null value to local
*      BRANCH  DEFF10              Continue
                                                             SPACE
DEFF10   L     1,XPTR                    . 00731A 5810 A410
         AR    1,8                       . 00731E 1A18
         ST    1,XPTR                    . 007320 5010 A410
         C     1,WPTR                    . 007324 5910 A400
         BE    DEFFGO                    . 007328 4780 B25E
         LM    1,2,8(1)                  . 00732C 9812 1008
         STM   1,2,ZPTR                  . 007330 9012 A440
         LD    0,8(1)                    . 007334 6801 0008
         STD   0,TPTR                    . 007338 6000 A3D0
         STD   0,104(12)                 . 00733C 600C 0068
         AR    12,8                      . 007340 1AC8
         C     12,@@STACKT               . 007342 59C0 A828
         BH    OVER                      . 007346 4720 9664
         LD    0,NULVCL                  . 00734A 6800 9ED0
         STD   0,8(1)                    . 00734E 6001 0008
         B     DEFF10                    . 007352 47F0 B222
                                                             SPACE
* DEFFGO PUSH  (FRTNCL,STNOCL,OCICL,OCBSCL,ZCL,ZCL)
*                                  Save system state
*      GETDC   XCL,ZCL,DESCR       Get entry label
*      AEQLIC  XCL,ATTRIB,0,,UNDFFE                             E3.0.2
*      GETDC   OCBSCL,XCL,ATTRIB                                E3.0.2
*      ACOMPC  TRACL,0,,DEFF18,DEFF18
*                                  Check &FTRACE
*      DECRA   TRACL,1             Decrement &FTRACE
*      GETDC   ATPTR,ZCL,2*DESCR   Get function name
*      PUSH    ZCL                 Save definition block
*      RCALL   ,FENTR2,(ATPTR),(INTR10,INTR10)
*                                  Perform function trace
*      POP     ZCL                 Restore definition block
                                                             SPACE
DEFFGO   LD    0,FRTNCL                  . 007356 6800 9E88
         STD   0,104(12)                 . 00735A 600C 0068
         LD    0,STNOCL                  . 00735E 6800 9990
         STD   0,112(12)                 . 007362 600C 0070
         LD    0,OCICL                   . 007366 6800 9ED8
         STD   0,120(12)                 . 00736A 600C 0078
         LD    0,OCBSCL                  . 00736E 6800 A470
         STD   0,128(12)                 . 007372 600C 0080
         LD    0,ZCL                     . 007376 6800 A438
         STD   0,136(12)                 . 00737A 600C 0088
         STD   0,144(12)                 . 00737E 600C 0090
         LA    12,48(12)                 . 007382 41CC 0030
         C     12,@@STACKT               . 007386 59C0 A828
         BH    OVER                      . 00738A 4720 9664
         L     1,ZCL                     . 00738E 5810 A438
         LM    1,2,8(1)                  . 007392 9812 1008
         STM   1,2,XCL                   . 007396 9012 A408
         C     0,16(,1)                  . 00739A 5900 1010
         BE    UNDFFE                    . 00739E 4780 96A4
         LM    1,2,16(1)                 . 0073A2 9812 1010
         STM   1,2,OCBSCL                . 0073A6 9012 A470
         C     0,TRACL                   . 0073AA 5900 9878
         BNL   DEFF18                    . 0073AE 47B0 B31C
         L     1,TRACL                   . 0073B2 5810 9878
         BCTR  1,0                            DECREMENT                *
                                         . 0073B6 0610
         ST    1,TRACL                   . 0073B8 5010 9878
         L     1,ZCL                     . 0073BC 5810 A438
         LD    0,16(1)                   . 0073C0 6801 0010
         STD   0,ATPTR                   . 0073C4 6000 A378
         LD    0,ZCL                     . 0073C8 6800 A438
         STD   0,104(12)                 . 0073CC 600C 0068
         AR    12,8                      . 0073D0 1AC8
         C     12,@@STACKT               . 0073D2 59C0 A828
         BH    OVER                      . 0073D6 4720 9664
         LA    14,S4$073FE               . 0073DA 41E0 B306
         STM   11,14,104(12)             . 0073DE 90BE C068
         LR    13,12                     . 0073E2 18DC
         LD    0,ATPTR                   . 0073E4 6800 A378
         STD   0,120(12)                 . 0073E8 600C 0078
         LA    12,24(12)                 . 0073EC 41CC 0018
         C     12,@@STACKT               . 0073F0 59C0 A828
         BH    OVER                      . 0073F4 4720 9664
         L     11,@@FENTR2               . 0073F8 58B0 A9CC
         BR    11                        . 0073FC 07FB
S4$073FE SR    0,0                       . 0073FE 1B00
         SR    0,0                       . 007400 1B00
         B     S4$010                    . 007402 47F0 95AC
         B     S4$010                    . 007406 47F0 95AC
         LD    0,96(12)                  . 00740A 680C 0060
         STD   0,ZCL                     . 00740E 6000 A438
         SR    12,8                      . 007412 1BC8
                                                             SPACE
* DEFF18 ACOMPC TRAPCL,0,,DEFF19,DEFF19
*                                  Check &TRACE
*      GETDC   ATPTR,ZCL,2*DESCR   Get function name
*      LOCAPT  ATPTR,TFENTL,ATPTR,DEFF19
*                                  Check for CALL trace
*      PUSH    (OCBSCL,ZCL)        Save object code base and block
*      RCALL   ,TRPHND,ATPTR       Perform trace                E3.3.1
*      POP     (ZCL,OCBSCL)        Restore base and block
                                                             SPACE
DEFF18   C     0,TRAPCL                  . 007414 5900 9818
         BNL   DEFF19                    . 007418 47B0 B3B0
         L     1,ZCL                     . 00741C 5810 A438
         LD    0,16(1)                   . 007420 6801 0010
         STD   0,ATPTR                   . 007424 6000 A378
         L     15,TFENTL                 . 007428 58F0 A330
         L     5,4(15)                   . 00742C 585F 0004
         LA    5,0(5,15)                 . 007430 4155 F000
         LR    4,8                       . 007434 1848
         SR    5,4                       . 007436 1B54
         AR    4,8                       . 007438 1A48
S4$0743A CLC   8(8,15),ATPTR             . 00743A D507 F008 A378
         BE    S4$0744C                  . 007440 4780 B354
         BXLE  15,4,S4$0743A             . 007444 87F4 B342
         B     DEFF19                    . 007448 47F0 B3B0
S4$0744C STM   15,0,ATPTR                . 00744C 90F0 A378
         LD    0,OCBSCL                  . 007450 6800 A470
         STD   0,104(12)                 . 007454 600C 0068
         LD    0,ZCL                     . 007458 6800 A438
         STD   0,112(12)                 . 00745C 600C 0070
         LA    12,16(12)                 . 007460 41CC 0010
         C     12,@@STACKT               . 007464 59C0 A828
         BH    OVER                      . 007468 4720 9664
         LA    14,S4$0748C               . 00746C 41E0 B394
         STM   11,14,104(12)             . 007470 90BE C068
         LR    13,12                     . 007474 18DC
         STM   15,0,120(12)              . 007476 90F0 C078
         LA    12,24(12)                 . 00747A 41CC 0018
         C     12,@@STACKT               . 00747E 59C0 A828
         BH    OVER                      . 007482 4720 9664
         L     11,@@TRPHND               . 007486 58B0 A918
         BR    11                        . 00748A 07FB
S4$0748C SR    0,0                       . 00748C 1B00
         SR    0,0                       . 00748E 1B00
         LA    0,0                       . 007490 4100 0000
         LD    0,96(12)                  . 007494 680C 0060
         STD   0,ZCL                     . 007498 6000 A438
         LD    0,88(12)                  . 00749C 680C 0058
         STD   0,OCBSCL                  . 0074A0 6000 A470
         SR    12,8                      . 0074A4 1BC8
         SR    12,8                      . 0074A6 1BC8
                                                             SPACE
* DEFF19 INCRA LVLCL,1             Increment &FNCLEVEL
*      ACOMPC  TRAPCL,0,,DEFF15,DEFF15
*                                  Check &TRACE
*      LOCAPT  ATPTR,TKEYL,FNCLKY,DEFF15
*                                  Look for KEYWORD trace
*      RCALL   ,TRPHND,ATPTR       Perform trace                E3.3.1
                                                             SPACE
DEFF19   L     1,LVLCL                   . 0074A8 5810 99C0
         LA    1,1(1)                    . 0074AC 4111 0001
         ST    1,LVLCL                   . 0074B0 5010 99C0
         C     0,TRAPCL                  . 0074B4 5900 9818
         BNL   DEFF15                    . 0074B8 47B0 B414
         L     15,TKEYL                  . 0074BC 58F0 A350
         L     5,4(15)                   . 0074C0 585F 0004
         LA    5,0(5,15)                 . 0074C4 4155 F000
         LR    4,8                       . 0074C8 1848
         SR    5,4                       . 0074CA 1B54
         AR    4,8                       . 0074CC 1A48
S4$074CE CLC   8(8,15),FNCLKY            . 0074CE D507 F008 99C8
         BE    S4$074E0                  . 0074D4 4780 B3E8
         BXLE  15,4,S4$074CE             . 0074D8 87F4 B3D6
         B     DEFF15                    . 0074DC 47F0 B414
S4$074E0 STM   15,0,ATPTR                . 0074E0 90F0 A378
         LA    14,S4$07504               . 0074E4 41E0 B40C
         STM   11,14,104(12)             . 0074E8 90BE C068
         LR    13,12                     . 0074EC 18DC
         STM   15,0,120(12)              . 0074EE 90F0 C078
         LA    12,24(12)                 . 0074F2 41CC 0018
         C     12,@@STACKT               . 0074F6 59C0 A828
         BH    OVER                      . 0074FA 4720 9664
         L     11,@@TRPHND               . 0074FE 58B0 A918
         BR    11                        . 007502 07FB
S4$07504 SR    0,0                       . 007504 1B00
         SR    0,0                       . 007506 1B00
         LA    0,0                       . 007508 4100 0000
                                                             SPACE
* DEFF15 SETAC OCICL,0             Zero offset
*      RCALL   ,INTERP,,(DEFFF,DEFFNR)
*                                  Call interpreter
*      MOVD    RETPCL,RETCL        Set &RTNTYPE to RETURN
                                                             SPACE
DEFF15   ST    0,OCICL                   . 00750C 5000 9ED8
         LA    14,S4$0752C               . 007510 41E0 B434
         STM   11,14,104(12)             . 007514 90BE C068
         LR    13,12                     . 007518 18DC
         LA    12,16(12)                 . 00751A 41CC 0010
         C     12,@@STACKT               . 00751E 59C0 A828
         BH    OVER                      . 007522 4720 9664
         L     11,@@INTERP               . 007526 58B0 A85C
         BR    11                        . 00752A 07FB
S4$0752C SR    0,0                       . 00752C 1B00
         SR    0,0                       . 00752E 1B00
         B     DEFFF                     . 007530 47F0 B6C8
         B     DEFFNR                    . 007534 47F0 B780
         LD    0,RETCL                   . 007538 6800 A540
         STD   0,RETPCL                  . 00753C 6000 9980
                                                             SPACE
* DEFFS1 POP   ZCL                 Restore definition block
*      ACOMPC  TRACL,0,,DEFF20,DEFF20
*                                  Check &FTRACE
*      DECRA   TRACL,1             Decrement &FTRACE
*      GETDC   ATPTR,ZCL,2*DESCR   Get function name
*      PUSH    ZCL                 Save definition block
*      RCALL   ,FNEXT2,(ATPTR),(INTR10,INTR10)
*                                  Perform function trace
*      POP     ZCL                 Restore definition block
                                                             SPACE
DEFFS1   LD    0,96(12)                  . 007540 680C 0060
         STD   0,ZCL                     . 007544 6000 A438
         SR    12,8                      . 007548 1BC8
         C     0,TRACL                   . 00754A 5900 9878
         BNL   DEFF20                    . 00754E 47B0 B4B4
         L     1,TRACL                   . 007552 5810 9878
         BCTR  1,0                            DECREMENT                *
                                         . 007556 0610
         ST    1,TRACL                   . 007558 5010 9878
         L     1,ZCL                     . 00755C 5810 A438
         LD    2,16(1)                   . 007560 6821 0010
         STD   2,ATPTR                   . 007564 6020 A378
         STD   0,104(12)                 . 007568 600C 0068
         AR    12,8                      . 00756C 1AC8
         C     12,@@STACKT               . 00756E 59C0 A828
         BH    OVER                      . 007572 4720 9664
         LA    14,S4$07596               . 007576 41E0 B49E
         STM   11,14,104(12)             . 00757A 90BE C068
         LR    13,12                     . 00757E 18DC
         STD   2,120(12)                 . 007580 602C 0078
         LA    12,24(12)                 . 007584 41CC 0018
         C     12,@@STACKT               . 007588 59C0 A828
         BH    OVER                      . 00758C 4720 9664
         L     11,@@FNEXT2               . 007590 58B0 A9D0
         BR    11                        . 007594 07FB
S4$07596 SR    0,0                       . 007596 1B00
         SR    0,0                       . 007598 1B00
         B     S4$010                    . 00759A 47F0 95AC
         B     S4$010                    . 00759E 47F0 95AC
         LD    0,96(12)                  . 0075A2 680C 0060
         STD   0,ZCL                     . 0075A6 6000 A438
         SR    12,8                      . 0075AA 1BC8
                                                             SPACE
* DEFF20 ACOMPC TRAPCL,0,,DEFFS2,DEFFS2
*                                  Check &TRACE
*      GETDC   ATPTR,ZCL,2*DESCR   Get function name
*      LOCAPT  ATPTR,TFEXTL,ATPTR,DEFFS2
*                                  Check for RETURN trace
*      PUSH    (RETPCL,ZCL)        Save return and block
*      RCALL   ,TRPHND,ATPTR       Perform trace                E3.3.1
*      POP     (ZCL,RETPCL)        Restore block and return
                                                             SPACE
DEFF20   C     0,TRAPCL                  . 0075AC 5900 9818
         BNL   DEFFS2                    . 0075B0 47B0 B548
         L     1,ZCL                     . 0075B4 5810 A438
         LD    0,16(1)                   . 0075B8 6801 0010
         STD   0,ATPTR                   . 0075BC 6000 A378
         L     15,TFEXTL                 . 0075C0 58F0 A340
         L     5,4(15)                   . 0075C4 585F 0004
         LA    5,0(5,15)                 . 0075C8 4155 F000
         LR    4,8                       . 0075CC 1848
         SR    5,4                       . 0075CE 1B54
         AR    4,8                       . 0075D0 1A48
S4$075D2 CLC   8(8,15),ATPTR             . 0075D2 D507 F008 A378
         BE    S4$075E4                  . 0075D8 4780 B4EC
         BXLE  15,4,S4$075D2             . 0075DC 87F4 B4DA
         B     DEFFS2                    . 0075E0 47F0 B548
S4$075E4 STM   15,0,ATPTR                . 0075E4 90F0 A378
         LD    0,RETPCL                  . 0075E8 6800 9980
         STD   0,104(12)                 . 0075EC 600C 0068
         LD    0,ZCL                     . 0075F0 6800 A438
         STD   0,112(12)                 . 0075F4 600C 0070
         LA    12,16(12)                 . 0075F8 41CC 0010
         C     12,@@STACKT               . 0075FC 59C0 A828
         BH    OVER                      . 007600 4720 9664
         LA    14,S4$07624               . 007604 41E0 B52C
         STM   11,14,104(12)             . 007608 90BE C068
         LR    13,12                     . 00760C 18DC
         STM   15,0,120(12)              . 00760E 90F0 C078
         LA    12,24(12)                 . 007612 41CC 0018
         C     12,@@STACKT               . 007616 59C0 A828
         BH    OVER                      . 00761A 4720 9664
         L     11,@@TRPHND               . 00761E 58B0 A918
         BR    11                        . 007622 07FB
S4$07624 SR    0,0                       . 007624 1B00
         SR    0,0                       . 007626 1B00
         LA    0,0                       . 007628 4100 0000
         LD    0,96(12)                  . 00762C 680C 0060
         STD   0,ZCL                     . 007630 6000 A438
         LD    0,88(12)                  . 007634 680C 0058
         STD   0,RETPCL                  . 007638 6000 9980
         SR    12,8                      . 00763C 1BC8
         SR    12,8                      . 00763E 1BC8
                                                             SPACE
* DEFFS2 DECRA LVLCL,1             Decrement &FNCLEVEL
*      ACOMPC  TRAPCL,0,,DEFF17,DEFF17
*                                  Check &TRACE
*      LOCAPT  ATPTR,TKEYL,FNCLKY,DEFF17
*                                  Check for KEYWORD trace
*      PUSH    (RETPCL,ZCL)        Save return and block
*      RCALL   ,TRPHND,ATPTR       Perform trace                E3.3.1
*      POP     (ZCL,RETPCL)        Restore block and return
                                                             SPACE
DEFFS2   L     1,LVLCL                   . 007640 5810 99C0
         BCTR  1,0                            DECREMENT                *
                                         . 007644 0610
         ST    1,LVLCL                   . 007646 5010 99C0
         C     0,TRAPCL                  . 00764A 5900 9818
         BNL   DEFF17                    . 00764E 47B0 B5DA
         L     15,TKEYL                  . 007652 58F0 A350
         L     5,4(15)                   . 007656 585F 0004
         LA    5,0(5,15)                 . 00765A 4155 F000
         LR    4,8                       . 00765E 1848
         SR    5,4                       . 007660 1B54
         AR    4,8                       . 007662 1A48
S4$07664 CLC   8(8,15),FNCLKY            . 007664 D507 F008 99C8
         BE    S4$07676                  . 00766A 4780 B57E
         BXLE  15,4,S4$07664             . 00766E 87F4 B56C
         B     DEFF17                    . 007672 47F0 B5DA
S4$07676 STM   15,0,ATPTR                . 007676 90F0 A378
         LD    0,RETPCL                  . 00767A 6800 9980
         STD   0,104(12)                 . 00767E 600C 0068
         LD    0,ZCL                     . 007682 6800 A438
         STD   0,112(12)                 . 007686 600C 0070
         LA    12,16(12)                 . 00768A 41CC 0010
         C     12,@@STACKT               . 00768E 59C0 A828
         BH    OVER                      . 007692 4720 9664
         LA    14,S4$076B6               . 007696 41E0 B5BE
         STM   11,14,104(12)             . 00769A 90BE C068
         LR    13,12                     . 00769E 18DC
         STM   15,0,120(12)              . 0076A0 90F0 C078
         LA    12,24(12)                 . 0076A4 41CC 0018
         C     12,@@STACKT               . 0076A8 59C0 A828
         BH    OVER                      . 0076AC 4720 9664
         L     11,@@TRPHND               . 0076B0 58B0 A918
         BR    11                        . 0076B4 07FB
S4$076B6 SR    0,0                       . 0076B6 1B00
         SR    0,0                       . 0076B8 1B00
         LA    0,0                       . 0076BA 4100 0000
         LD    0,96(12)                  . 0076BE 680C 0060
         STD   0,ZCL                     . 0076C2 6000 A438
         LD    0,88(12)                  . 0076C6 680C 0058
         STD   0,RETPCL                  . 0076CA 6000 9980
         SR    12,8                      . 0076CE 1BC8
         SR    12,8                      . 0076D0 1BC8
                                                             SPACE
* DEFF17 POP   (ZCL,OCBSCL,OCICL,STNOCL,FRTNCL)
*                                  Restore system state
*      GETSIZ  WCL,ZCL             Get size of definition block
*      DECRA   WCL,DESCR           Decrement pointer
*      ACOMPC  WCL,0,,INTR10,INTR10
*                                  Check for end
*      SUM     WPTR,ZCL,WCL        Compute pointer to last descriptor
*      MOVD    YPTR,ZCL            Save pointer to block
*      INCRA   YPTR,DESCR          Increment pointer
*      GETDC   ZPTR,YPTR,DESCR     Get function name
*      GETDC   ZPTR,ZPTR,DESCR     Get value to be returned
                                                             SPACE
DEFF17   LD    0,96(12)                  . 0076D2 680C 0060
         STD   0,ZCL                     . 0076D6 6000 A438
         LD    0,88(12)                  . 0076DA 680C 0058
         STD   0,OCBSCL                  . 0076DE 6000 A470
         LD    0,80(12)                  . 0076E2 680C 0050
         STD   0,OCICL                   . 0076E6 6000 9ED8
         LD    0,72(12)                  . 0076EA 680C 0048
         STD   0,STNOCL                  . 0076EE 6000 9990
         LD    0,64(12)                  . 0076F2 680C 0040
         STD   0,FRTNCL                  . 0076F6 6000 9E88
         S     12,@@5XDESC               . 0076FA 5BC0 A998
         L     15,ZCL                    . 0076FE 58F0 A438
         L     15,4(15)                  . 007702 58FF 0004
         LA    15,0(15)                  . 007706 41FF 0000
         SR    15,8                      . 00770A 1BF8
         STM   15,0,WCL                  . 00770C 90F0 A3F8
         CR    0,15                      . 007710 190F
         BNL   S4$010                    . 007712 47B0 95AC
         LM    1,2,ZCL                   . 007716 9812 A438
         A     1,WCL                     . 00771A 5A10 A3F8
         STM   1,2,WPTR                  . 00771E 9012 A400
         LM    1,2,ZCL                   . 007722 9812 A438
         STM   1,2,YPTR                  . 007726 9012 A428
         AR    1,8                       . 00772A 1A18
         ST    1,YPTR                    . 00772C 5010 A428
         LM    1,2,8(1)                  . 007730 9812 1008
         STM   1,2,ZPTR                  . 007734 9012 A440
         LD    0,8(1)                    . 007738 6801 0008
         STD   0,ZPTR                    . 00773C 6000 A440
                                                             SPACE
* DEFF6 POP    XPTR                Get old value
*      GETDC   YPTR,WPTR,DESCR     Get argument name
*      PUTDC   YPTR,DESCR,XPTR     Restore old value
*      DECRA   WPTR,DESCR          Decrement pointer
*      AEQL    WPTR,ZCL,DEFF6      Check for end
*      DEQL    RETPCL,FRETCL,,FAIL Check for FRETURN
*      DEQL    RETPCL,NRETCL,RTZPTR
*                                  Check for NRETURN
*      MOVD    XPTR,ZPTR           Move name to correct descriptor
*      VEQLC   XPTR,S,,DEFFVX      Check for natural variable
*      VEQLC   XPTR,I,,GENVIX      Convert integer
*      VEQLC   XPTR,N,,RTXNAM      Check for created variable
*      VEQLC   XPTR,K,NONAME,RTXNAM
*                                  Check for keyword variable
                                                             SPACE
DEFF6    LD    0,96(12)                  . 007740 680C 0060
         STD   0,XPTR                    . 007744 6000 A410
         SR    12,8                      . 007748 1BC8
         L     1,WPTR                    . 00774A 5810 A400
         LM    1,2,8(1)                  . 00774E 9812 1008
         STM   1,2,YPTR                  . 007752 9012 A428
         STD   0,8(1)                    . 007756 6001 0008
         L     1,WPTR                    . 00775A 5810 A400
         SR    1,8                       . 00775E 1B18
         ST    1,WPTR                    . 007760 5010 A400
         C     1,ZCL                     . 007764 5910 A438
         BNE   DEFF6                     . 007768 4770 B648
         CLC   RETPCL(8),FRETCL          . 00776C D507 9980 A530
         BE    FAIL                      . 007772 4780 9010
         CLC   RETPCL(8),NRETCL          . 007776 D507 9980 A538
         BNE   RTZPTR                    . 00777C 4770 9074
         LD    0,ZPTR                    . 007780 6800 A440
         STD   0,XPTR                    . 007784 6000 A410
         CLC   XPTR$5(3),@@S             . 007788 D502 A415 AA7B
         BE    DEFFVX                    . 00778E 4780 B6BC
         CLC   XPTR$5(3),@@I             . 007792 D502 A415 AA84
         BE    GENVIX                    . 007798 4780 90FE
         CLC   XPTR$5(3),@@N             . 00779C D502 A415 AA8D
         BE    RTXNAM                    . 0077A2 4780 9038
         CLC   XPTR$5(3),@@K             . 0077A6 D502 A415 AA8A
         BNE   NONAME                    . 0077AC 4770 9654
         BE    RTXNAM                    . 0077B0 4780 9038
                                                             SPACE
* DEFFVX AEQLC XPTR,0,RTXNAM,NONAME
*                                  Check for null string
                                                             SPACE
DEFFVX   C     0,XPTR                    . 0077B4 5900 A410
         BNE   RTXNAM                    . 0077B8 4770 9038
         BE    NONAME                    . 0077BC 4780 9654
                                                             SPACE
* DEFFF MOVD   RETPCL,FRETCL       Set up FRETURN
*      BRANCH  DEFFS1              Join processing
                                                             SPACE
DEFFF    LD    0,FRETCL                  . 0077C0 6800 A530
         STD   0,RETPCL                  . 0077C4 6000 9980
         B     DEFFS1                    . 0077C8 47F0 B448
                                                             SPACE
* DEFFC PUSH   (XCL,WCL,YCL,YPTR)  Save relevant descriptors
*      RCALL   XPTR,INVOKE,(XPTR),(FAIL,DEFFN)
*                                  Evaluate argument
*      POP     (YPTR,YCL,WCL,XCL)  Restore relevant variables
*      BRANCH  DEFF3               Join processing
                                                             SPACE
DEFFC    LD    0,XCL                     . 0077CC 6800 A408
         STD   0,104(12)                 . 0077D0 600C 0068
         LD    0,WCL                     . 0077D4 6800 A3F8
         STD   0,112(12)                 . 0077D8 600C 0070
         LD    0,YCL                     . 0077DC 6800 A420
         STD   0,120(12)                 . 0077E0 600C 0078
         LD    0,YPTR                    . 0077E4 6800 A428
         STD   0,128(12)                 . 0077E8 600C 0080
         LA    12,32(12)                 . 0077EC 41CC 0020
         C     12,@@STACKT               . 0077F0 59C0 A828
         BH    OVER                      . 0077F4 4720 9664
         LA    14,S4$0781C               . 0077F8 41E0 B724
         STM   11,14,104(12)             . 0077FC 90BE C068
         LR    13,12                     . 007800 18DC
         LD    0,XPTR                    . 007802 6800 A410
         STD   0,120(12)                 . 007806 600C 0078
         LA    12,24(12)                 . 00780A 41CC 0018
         C     12,@@STACKT               . 00780E 59C0 A828
         BH    OVER                      . 007812 4720 9664
         L     11,@@INVOKE               . 007816 58B0 A91C
         BR    11                        . 00781A 07FB
S4$0781C STD   0,XPTR                    . 00781C 6000 A410
         B     FAIL                      . 007820 47F0 9010
         B     DEFFN                     . 007824 47F0 B758
         LD    0,96(12)                  . 007828 680C 0060
         STD   0,YPTR                    . 00782C 6000 A428
         LD    0,88(12)                  . 007830 680C 0058
         STD   0,YCL                     . 007834 6000 A420
         LD    0,80(12)                  . 007838 680C 0050
         STD   0,WCL                     . 00783C 6000 A3F8
         LD    0,72(12)                  . 007840 680C 0048
         STD   0,XCL                     . 007844 6000 A408
         S     12,@@2M16                 . 007848 5BC0 A9C8
         B     DEFF3                     . 00784C 47F0 B118
                                                             SPACE
* DEFFN POP    (YPTR,YCL,WCL,XCL)  Restore relevant variables
*      BRANCH  DEFF2               Join processing
                                                             SPACE
DEFFN    LD    0,96(12)                  . 007850 680C 0060
         STD   0,YPTR                    . 007854 6000 A428
         LD    0,88(12)                  . 007858 680C 0058
         STD   0,YCL                     . 00785C 6000 A420
         LD    0,80(12)                  . 007860 680C 0050
         STD   0,WCL                     . 007864 6000 A3F8
         LD    0,72(12)                  . 007868 680C 0048
         STD   0,XCL                     . 00786C 6000 A408
         S     12,@@2M16                 . 007870 5BC0 A9C8
         B     DEFF2                     . 007874 47F0 B050
                                                             SPACE
* DEFFNR MOVD  RETPCL,NRETCL       Set up NRETURN
*      BRANCH  DEFFS1              Join processing
DEFFNR   LD    0,NRETCL                  . 007878 6800 A538
         STD   0,RETPCL                  . 00787C 6000 9980
         B     DEFFS1                    . 007880 47F0 B448
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'External Functions'
*
*      LOAD(P)
*
                                                             SPACE
* LOAD PROC    ,                   LOAD(P)
*      RCALL   XPTR,VARVAL,,FAIL   Get prototype
*      PUSH    XPTR                Save prototype
*      RCALL   WPTR,VARVAL,,FAIL   Get library name
*      LOCSP   VSP,WPTR            Get specifier for library
*      POP     XPTR                Restore prototypr
*      LOCSP   XSP,XPTR            Get specifier for prototype
*      STREAM  YSP,XSP,VARATB,PROTER,PROTER
*                                  Get function name from prototype
*      AEQLC   STYPE,LPTYP,PROTER  Verify left parenthesis
*      RCALL   XPTR,GENVAR,YSPPTR  Generate variable for function
*      RCALL   ZCL,FINDEX,XPTR     Find function
*      MOVD    YCL,ZEROCL          Set argument count to zero
                                                             SPACE
         USING LOAD,11                   .
LOAD     LA    14,S4$078A0               . 007884 41E0 B01C
         STM   11,14,104(12)             . 007888 90BE C068
         LR    13,12                     . 00788C 18DC
         LA    12,16(12)                 . 00788E 41CC 0010
         C     12,@@STACKT               . 007892 59C0 A828
         BH    OVER                      . 007896 4720 9664
         L     11,@@VARVAL               . 00789A 58B0 A9C0
         BR    11                        . 00789E 07FB
S4$078A0 STD   0,XPTR                    . 0078A0 6000 A410
         B     FAIL                      . 0078A4 47F0 9010
         LD    0,XPTR                    . 0078A8 6800 A410
         STD   0,104(12)                 . 0078AC 600C 0068
         AR    12,8                      . 0078B0 1AC8
         C     12,@@STACKT               . 0078B2 59C0 A828
         BH    OVER                      . 0078B6 4720 9664
         LA    14,S4$078D6               . 0078BA 41E0 B052
         STM   11,14,104(12)             . 0078BE 90BE C068
         LR    13,12                     . 0078C2 18DC
         LA    12,16(12)                 . 0078C4 41CC 0010
         C     12,@@STACKT               . 0078C8 59C0 A828
         BH    OVER                      . 0078CC 4720 9664
         L     11,@@VARVAL               . 0078D0 58B0 A9C0
         BR    11                        . 0078D4 07FB
S4$078D6 STD   0,WPTR                    . 0078D6 6000 A400
         B     FAIL                      . 0078DA 47F0 9010
         LM    3,4,WPTR                  . 0078DE 9834 A400
         CR    0,3                       . 0078E2 1903
         BNE   S4$078F0                  . 0078E4 4770 B06C
         ST    0,VSP                     . 0078E8 5000 A5C0
         B     S4$07900                  . 0078EC 47F0 B07C
S4$078F0 L     1,4(3)                    . 0078F0 5813 0004
         LA    1,0(1)                    . 0078F4 4111 0000
         LA    2,32                      . 0078F8 4120 0020
         STM   1,4,VSP                   . 0078FC 9014 A5C0
S4$07900 LD    0,96(12)                  . 007900 680C 0060
         STD   0,XPTR                    . 007904 6000 A410
         SR    12,8                      . 007908 1BC8
         LM    3,4,XPTR                  . 00790A 9834 A410
         CR    0,3                       . 00790E 1903
         BNE   S4$0791C                  . 007910 4770 B098
         ST    0,XSP                     . 007914 5000 A5D0
         B     S4$0792C                  . 007918 47F0 B0A8
S4$0791C L     1,4(3)                    . 00791C 5813 0004
         LA    1,0(1)                    . 007920 4111 0000
         LA    2,32                      . 007924 4120 0020
         STM   1,4,XSP                   . 007928 9014 A5D0
S4$0792C L     15,@@STREAM               . 00792C 58F0 A840
         LA    1,YSP                     . 007930 4110 A5E0
         LA    2,XSP                     . 007934 4120 A5D0
         L     3,@@VARATB                . 007938 5830 A9C4
         BALR  14,15                          CALL                     *
                                         . 00793C 05EF
         B     PROTER                    . 00793E 47F0 966C
         B     PROTER                    . 007942 47F0 966C
         LA    6,1                       . 007946 4160 0001
         C     6,STYPE                   . 00794A 5960 9F08
         BNE   PROTER                    . 00794E 4770 966C
         LA    14,S4$07976               . 007952 41E0 B0F2
         STM   11,14,104(12)             . 007956 90BE C068
         LR    13,12                     . 00795A 18DC
         LD    0,YSPPTR                  . 00795C 6800 9F68
         STD   0,120(12)                 . 007960 600C 0078
         LA    12,24(12)                 . 007964 41CC 0018
         C     12,@@STACKT               . 007968 59C0 A828
         BH    OVER                      . 00796C 4720 9664
         L     11,@@GENVAR               . 007970 58B0 A830
         BR    11                        . 007974 07FB
S4$07976 STD   0,XPTR                    . 007976 6000 A410
         LA    14,S4$0799A               . 00797A 41E0 B116
         STM   11,14,104(12)             . 00797E 90BE C068
         LR    13,12                     . 007982 18DC
         STD   0,120(12)                 . 007984 600C 0078
         LA    12,24(12)                 . 007988 41CC 0018
         C     12,@@STACKT               . 00798C 59C0 A828
         BH    OVER                      . 007990 4720 9664
         L     11,@@FINDEX               . 007994 58B0 A8F4
         BR    11                        . 007998 07FB
S4$0799A STD   0,ZCL                     . 00799A 6000 A438
         LD    0,ZEROCL                  . 00799E 6800 9C90
         STD   0,YCL                     . 0079A2 6000 A420
                                                             SPACE
* LOAD4 FSHRTN XSP,1               Remove break character
*      STREAM  ZSP,XSP,VARATB,LOAD1,PROTER
*                                  Break out argument
*      SELBRA  STYPE,(PROTER,,LOAD6)
*                                  Branch on break type
*      RCALL   XPTR,GENVAR,ZSPPTR  Generate variable for data type
*      LOCAPV  XPTR,DTATL,XPTR,LOAD9
*                                  Look up data type
*      GETDC   XPTR,XPTR,DESCR     Extract data type code
*      PUSH    XPTR                Save data type code
                                                             SPACE
LOAD4    LM    1,2,XSP                   . 0079A6 9812 A5D0
         BCTR  1,0                            DECREMENT                *
                                         . 0079AA 0610
         LA    2,1(2)                    . 0079AC 4122 0001
         STM   1,2,XSP                   . 0079B0 9012 A5D0
         L     15,@@STREAM               . 0079B4 58F0 A840
         LA    1,ZSP                     . 0079B8 4110 A5F0
         LA    2,XSP                     . 0079BC 4120 A5D0
         L     3,@@VARATB                . 0079C0 5830 A9C4
         BALR  14,15                          CALL                     *
                                         . 0079C4 05EF
         B     LOAD1                     . 0079C6 47F0 B38E
         B     PROTER                    . 0079CA 47F0 966C
         L     1,STYPE                   . 0079CE 5810 9F08
         SLA   1,2                       . 0079D2 8B10 0002
S4$079D6 B     S4$079D6(1)               . 0079D6 47F1 B152
         B     PROTER                    . 0079DA 47F0 966C
         B     S4$079E6                  . 0079DE 47F0 B162
         B     LOAD6                     . 0079E2 47F0 B1D4
S4$079E6 LA    14,S4$07A0A               . 0079E6 41E0 B186
         STM   11,14,104(12)             . 0079EA 90BE C068
         LR    13,12                     . 0079EE 18DC
         LD    0,ZSPPTR                  . 0079F0 6800 9F70
         STD   0,120(12)                 . 0079F4 600C 0078
         LA    12,24(12)                 . 0079F8 41CC 0018
         C     12,@@STACKT               . 0079FC 59C0 A828
         BH    OVER                      . 007A00 4720 9664
         L     11,@@GENVAR               . 007A04 58B0 A830
         BR    11                        . 007A08 07FB
S4$07A0A STD   0,XPTR                    . 007A0A 6000 A410
         L     15,DTATL                  . 007A0E 58F0 A2F0
         L     5,4(15)                   . 007A12 585F 0004
         LA    5,0(5,15)                 . 007A16 4155 F000
         LR    4,8                       . 007A1A 1848
         SR    5,4                       . 007A1C 1B54
         AR    4,8                       . 007A1E 1A48
S4$07A20 CLC   16(8,15),XPTR             . 007A20 D507 F010 A410
         BE    S4$07A32                  . 007A26 4780 B1AE
         BXLE  15,4,S4$07A20             . 007A2A 87F4 B19C
         B     LOAD9                     . 007A2E 47F0 B378
S4$07A32 LD    0,8(15)                   . 007A32 680F 0008
         STD   0,XPTR                    . 007A36 6000 A410
         STD   0,104(12)                 . 007A3A 600C 0068
         AR    12,8                      . 007A3E 1AC8
         C     12,@@STACKT               . 007A40 59C0 A828
         BH    OVER                      . 007A44 4720 9664
                                                             SPACE
* LOAD10 INCRA YCL,1               Increment count of arguments
*      BRANCH  LOAD4               Continue
                                                             SPACE
LOAD10   L     1,YCL                     . 007A48 5810 A420
         LA    1,1(1)                    . 007A4C 4111 0001
         ST    1,YCL                     . 007A50 5010 A420
         B     LOAD4                     . 007A54 47F0 B122
                                                             SPACE
* LOAD6 INCRA  YCL,1               Count last argument
*      RCALL   XPTR,GENVAR,ZSPPTR  Generate variable for data type
*      LOCAPV  XPTR,DTATL,XPTR,LOAD11
*                                  Look up data type
*      GETDC   XPTR,XPTR,DESCR     Get data type code
*      PUSH    XPTR                Save data type code
                                                             SPACE
LOAD6    L     1,YCL                     . 007A58 5810 A420
         LA    1,1(1)                    . 007A5C 4111 0001
         ST    1,YCL                     . 007A60 5010 A420
         LA    14,S4$07A88               . 007A64 41E0 B204
         STM   11,14,104(12)             . 007A68 90BE C068
         LR    13,12                     . 007A6C 18DC
         LD    0,ZSPPTR                  . 007A6E 6800 9F70
         STD   0,120(12)                 . 007A72 600C 0078
         LA    12,24(12)                 . 007A76 41CC 0018
         C     12,@@STACKT               . 007A7A 59C0 A828
         BH    OVER                      . 007A7E 4720 9664
         L     11,@@GENVAR               . 007A82 58B0 A830
         BR    11                        . 007A86 07FB
S4$07A88 STD   0,XPTR                    . 007A88 6000 A410
         L     15,DTATL                  . 007A8C 58F0 A2F0
         L     5,4(15)                   . 007A90 585F 0004
         LA    5,0(5,15)                 . 007A94 4155 F000
         LR    4,8                       . 007A98 1848
         SR    5,4                       . 007A9A 1B54
         AR    4,8                       . 007A9C 1A48
S4$07A9E CLC   16(8,15),XPTR             . 007A9E D507 F010 A410
         BE    S4$07AB0                  . 007AA4 4780 B22C
         BXLE  15,4,S4$07A9E             . 007AA8 87F4 B21A
         B     LOAD11                    . 007AAC 47F0 B3D6
S4$07AB0 LD    0,8(15)                   . 007AB0 680F 0008
         STD   0,XPTR                    . 007AB4 6000 A410
         STD   0,104(12)                 . 007AB8 600C 0068
         AR    12,8                      . 007ABC 1AC8
         C     12,@@STACKT               . 007ABE 59C0 A828
         BH    OVER                      . 007AC2 4720 9664
                                                             SPACE
* LOAD13 FSHRTN XSP,1              Delete right parenthesis
*      RCALL   XPTR,GENVAR,XSPPTR  Generate variable for target
*      LOCAPV  XPTR,DTATL,XPTR,LOAD7
*                                  Look up data type
*      GETDC   XPTR,XPTR,DESCR     Get data type code
*      PUSH    XPTR                Save data type code
                                                             SPACE
LOAD13   LM    1,2,XSP                   . 007AC6 9812 A5D0
         BCTR  1,0                            DECREMENT                *
                                         . 007ACA 0610
         LA    2,1(2)                    . 007ACC 4122 0001
         STM   1,2,XSP                   . 007AD0 9012 A5D0
         LA    14,S4$07AF8               . 007AD4 41E0 B274
         STM   11,14,104(12)             . 007AD8 90BE C068
         LR    13,12                     . 007ADC 18DC
         LD    0,XSPPTR                  . 007ADE 6800 9F60
         STD   0,120(12)                 . 007AE2 600C 0078
         LA    12,24(12)                 . 007AE6 41CC 0018
         C     12,@@STACKT               . 007AEA 59C0 A828
         BH    OVER                      . 007AEE 4720 9664
         L     11,@@GENVAR               . 007AF2 58B0 A830
         BR    11                        . 007AF6 07FB
S4$07AF8 STD   0,XPTR                    . 007AF8 6000 A410
         L     15,DTATL                  . 007AFC 58F0 A2F0
         L     5,4(15)                   . 007B00 585F 0004
         LA    5,0(5,15)                 . 007B04 4155 F000
         LR    4,8                       . 007B08 1848
         SR    5,4                       . 007B0A 1B54
         AR    4,8                       . 007B0C 1A48
S4$07B0E CLC   16(8,15),XPTR             . 007B0E D507 F010 A410
         BE    S4$07B20                  . 007B14 4780 B29C
         BXLE  15,4,S4$07B0E             . 007B18 87F4 B28A
         B     LOAD7                     . 007B1C 47F0 B362
S4$07B20 LD    0,8(15)                   . 007B20 680F 0008
         STD   0,XPTR                    . 007B24 6000 A410
         STD   0,104(12)                 . 007B28 600C 0068
         AR    12,8                      . 007B2C 1AC8
         C     12,@@STACKT               . 007B2E 59C0 A828
         BH    OVER                      . 007B32 4720 9664
                                                             SPACE
* LOAD8 SETVA  LODCL,YCL           Insert number of arguments
*      INCRA   YCL,1               Increment count
*      MULTC   XCL,YCL,DESCR       Convert to address units
*      INCRA   XCL,DESCR           Add space for entry point
*      SETVC   XCL,B               Insert BLOCK data type
*      RCALL   XPTR,BLOCK,XCL      Allocate block for definition
*      PUTDC   ZCL,0,LODCL         Insert procedure descriptor
*      PUTDC   ZCL,DESCR,XPTR      Insert definition block
*      SUM     XPTR,XPTR,XCL       Compute pointer to end of block
                                                             SPACE
LOAD8    MVC   LODCL$5(3),YCL$1          . 007B36 D202 9F45 A421
         L     15,YCL                    . 007B3C 58F0 A420
         LA    15,1(15)                  . 007B40 41FF 0001
         ST    15,YCL                    . 007B44 50F0 A420
         SLA   15,3                      . 007B48 8BF0 0003
         AR    15,8                      . 007B4C 1AF8
         STM   15,0,XCL                  . 007B4E 90F0 A408
         MVC   XCL$5(3),@@B              . 007B52 D202 A40D AA6C
         LA    14,S4$07B78               . 007B58 41E0 B2F4
         STM   11,14,104(12)             . 007B5C 90BE C068
         LR    13,12                     . 007B60 18DC
         STM   15,0,120(12)              . 007B62 90F0 C078
         LA    12,24(12)                 . 007B66 41CC 0018
         C     12,@@STACKT               . 007B6A 59C0 A828
         BH    OVER                      . 007B6E 4720 9664
         L     11,@@BLOCK                . 007B72 58B0 A82C
         BR    11                        . 007B76 07FB
S4$07B78 STD   0,XPTR                    . 007B78 6000 A410
         L     1,ZCL                     . 007B7C 5810 A438
         LD    0,LODCL                   . 007B80 6800 9F40
         STD   0,0(1)                    . 007B84 6001 0000
         LM    3,4,XPTR                  . 007B88 9834 A410
         STM   3,4,8(1)                  . 007B8C 9034 1008
         A     3,XCL                     . 007B90 5A30 A408
         ST    3,XPTR                    . 007B94 5030 A410
                                                             SPACE
* LOAD12 DECRA XPTR,DESCR          Decrement pointer
*      POP     YPTR                Restore data type
*      PUTDC   XPTR,DESCR,YPTR     Insert in block
*      DECRA   YCL,1               Decrement count
*      ACOMPC  YCL,0,LOAD12        Check for end
*      LOAD    YPTR,YSP,VSP,FAIL   Load external function
*      PUTDC   XPTR,0,YPTR         Insert entry point
*      BRANCH  RETNUL              Return null string as value
                                                             SPACE
LOAD12   L     1,XPTR                    . 007B98 5810 A410
         SR    1,8                       . 007B9C 1B18
         ST    1,XPTR                    . 007B9E 5010 A410
         LD    0,96(12)                  . 007BA2 680C 0060
         STD   0,YPTR                    . 007BA6 6000 A428
         SR    12,8                      . 007BAA 1BC8
         STD   0,8(1)                    . 007BAC 6001 0008
         L     1,YCL                     . 007BB0 5810 A420
         BCTR  1,0                            DECREMENT                *
                                         . 007BB4 0610
         ST    1,YCL                     . 007BB6 5010 A420
         CR    0,1                       . 007BBA 1901
         BL    LOAD12                    . 007BBC 4740 B314
         L     15,@@LOADER               . 007BC0 58F0 A9D4
         LA    1,YSP                     . 007BC4 4110 A5E0
         LA    2,VSP                     . 007BC8 4120 A5C0
         BALR  14,15                          CALL                     *
                                         . 007BCC 05EF
         ST    2,YPTR                    . 007BCE 5020 A428
         ST    0,YPTR$4                  . 007BD2 5000 A42C
         L     1,XPTR                    . 007BD6 5810 A410
         LD    0,YPTR                    . 007BDA 6800 A428
         STD   0,0(1)                    . 007BDE 6001 0000
         B     RETNUL                    . 007BE2 47F0 9018
                                                             SPACE
* LOAD7 PUSH   ZEROCL              Save 0 for unspecified type
*      BRANCH  LOAD8               Continue
                                                             SPACE
LOAD7    LD    0,ZEROCL                  . 007BE6 6800 9C90
         STD   0,104(12)                 . 007BEA 600C 0068
         AR    12,8                      . 007BEE 1AC8
         C     12,@@STACKT               . 007BF0 59C0 A828
         BH    OVER                      . 007BF4 4720 9664
         B     LOAD8                     . 007BF8 47F0 B2B2
                                                             SPACE
* LOAD9 PUSH   ZEROCL              Save 0 for unspecified type
*      BRANCH  LOAD10              Continue
                                                             SPACE
LOAD9    LD    0,ZEROCL                  . 007BFC 6800 9C90
         STD   0,104(12)                 . 007C00 600C 0068
         AR    12,8                      . 007C04 1AC8
         C     12,@@STACKT               . 007C06 59C0 A828
         BH    OVER                      . 007C0A 4720 9664
         B     LOAD10                    . 007C0E 47F0 B1C4
                                                             SPACE
* LOAD1 PUSH   ZEROCL              Save 0 for unspecified type
*      SETSP   TSP,XSP             Set up break check
*      SETLC   TSP,1               Set length to 1
*      INCRA   YCL,1
*      LEXCMP  TSP,RPRNSP,LOAD4,LOAD13,LOAD4
                                                             SPACE
LOAD1    LD    0,ZEROCL                  . 007C12 6800 9C90
         STD   0,104(12)                 . 007C16 600C 0068
         AR    12,8                      . 007C1A 1AC8
         C     12,@@STACKT               . 007C1C 59C0 A828
         BH    OVER                      . 007C20 4720 9664
         LM    1,4,XSP                   . 007C24 9814 A5D0
         STM   1,4,TSP                   . 007C28 9014 A5A0
         LA    1,1                       . 007C2C 4110 0001
         ST    1,TSP                     . 007C30 5010 A5A0
         L     2,YCL                     . 007C34 5820 A420
         AR    2,1                       . 007C38 1A21
         ST    2,YCL                     . 007C3A 5020 A420
         LM    2,4,TSP                   . 007C3E 9824 A5A0
         LM    5,7,RPRNSP                . 007C42 9857 A178
         CR    2,5                       . 007C46 1925
         BNE   LOAD10                    . 007C48 4770 B1C4
         L     15,@@SPECEQ               . 007C4C 58F0 A890
         BALR  14,15                          CALL                     *
                                         . 007C50 05EF
         B     LOAD4                     . 007C52 47F0 B122
         B     LOAD13                    . 007C56 47F0 B242
                                                             SPACE
* LOAD11 PUSH  ZEROCL              Save 0 for unspecified type
*      BRANCH  LOAD13              Continue
LOAD11   LD    0,ZEROCL                  . 007C5A 6800 9C90
         STD   0,104(12)                 . 007C5E 600C 0068
         AR    12,8                      . 007C62 1AC8
         C     12,@@STACKT               . 007C64 59C0 A828
         BH    OVER                      . 007C68 4720 9664
         B     LOAD13                    . 007C6C 47F0 B242
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      UNLOAD(F)
*
                                                             SPACE
* UNLOAD PROC  ,                   UNLOAD(F)
*      RCALL   XPTR,VARVAL,,FAIL   Get function name
*      RCALL   ZCL,FINDEX,XPTR     Locate function descriptor
*      PUTDC   ZCL,0,UNDFCL        Undefine function
*      LOCSP   XSP,XPTR            Get specifier
*      UNLOAD  XSP                 Unload external definition
*      BRANCH  RETNUL              Return
         USING UNLOAD,11                 .
UNLOAD   LA    14,S4$07C8C               . 007C70 41E0 B01C
         STM   11,14,104(12)             . 007C74 90BE C068
         LR    13,12                     . 007C78 18DC
         LA    12,16(12)                 . 007C7A 41CC 0010
         C     12,@@STACKT               . 007C7E 59C0 A828
         BH    OVER                      . 007C82 4720 9664
         L     11,@@VARVAL               . 007C86 58B0 A9C0
         BR    11                        . 007C8A 07FB
S4$07C8C STD   0,XPTR                    . 007C8C 6000 A410
         B     FAIL                      . 007C90 47F0 9010
         LA    14,S4$07CB8               . 007C94 41E0 B048
         STM   11,14,104(12)             . 007C98 90BE C068
         LR    13,12                     . 007C9C 18DC
         LD    0,XPTR                    . 007C9E 6800 A410
         STD   0,120(12)                 . 007CA2 600C 0078
         LA    12,24(12)                 . 007CA6 41CC 0018
         C     12,@@STACKT               . 007CAA 59C0 A828
         BH    OVER                      . 007CAE 4720 9664
         L     11,@@FINDEX               . 007CB2 58B0 A8F4
         BR    11                        . 007CB6 07FB
S4$07CB8 STD   0,ZCL                     . 007CB8 6000 A438
         L     1,ZCL                     . 007CBC 5810 A438
         LD    0,UNDFCL                  . 007CC0 6800 9F50
         STD   0,0(1)                    . 007CC4 6001 0000
         LM    3,4,XPTR                  . 007CC8 9834 A410
         CR    0,3                       . 007CCC 1903
         BNE   S4$07CDA                  . 007CCE 4770 B06A
         ST    0,XSP                     . 007CD2 5000 A5D0
         B     S4$07CEA                  . 007CD6 47F0 B07A
S4$07CDA L     1,4(3)                    . 007CDA 5813 0004
         LA    1,0(1)                    . 007CDE 4111 0000
         LA    2,32                      . 007CE2 4120 0020
         STM   1,4,XSP                   . 007CE6 9014 A5D0
S4$07CEA LA    1,XSP                     . 007CEA 4110 A5D0
         L     15,@@UNLODR               . 007CEE 58F0 A9D8
         BALR  14,15                          CALL                     *
                                         . 007CF2 05EF
         B     RETNUL                    . 007CF4 47F0 9018
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Linkage to External Functions
*
                                                             SPACE
* LNKFNC PROC  ,                   Procedure to link to externals
*      SETAV   XCL,INCL            Get actual number of arguments
*      MOVD    YCL,INCL            Save function descriptor
*      SETAV   WCL,YCL                                          E3.9.1
*      GETDC   ZCL,YCL,DESCR       Get definition block
*      PSTACK  YPTR                Post stack position
*      SETAC   TCL,2*DESCR         Set offset for first argument
                                                             SPACE
         USING LNKFNC,11                 .
LNKFNC   L     15,INCL$4                 . 007CF8 58F0 9E9C
         LA    15,0(15)                  . 007CFC 41FF 0000
         STM   15,0,XCL                  . 007D00 90F0 A408
         LD    0,XCL                     . 007D04 6800 A408
         STD   0,WCL                     . 007D08 6000 A3F8
         LM    1,2,INCL                  . 007D0C 9812 9E98
         STM   1,2,YCL                   . 007D10 9012 A420
         LD    0,8(1)                    . 007D14 6801 0008
         STD   0,ZCL                     . 007D18 6000 A438
         LA    15,88(12)                 . 007D1C 41FC 0058
         STM   15,0,YPTR                 . 007D20 90F0 A428
         L     1,@@TEN                   . 007D24 5810 A9DC
         ST    1,TCL                     . 007D28 5010 A3D8
                                                             SPACE
* LNKF1 PUSH   (XCL,ZCL,TCL,YPTR,WCL,YCL)
*                                  Save working descriptors
*      RCALL   XPTR,ARGVAL,,FAIL   Evaluate argument
*      POP     (YCL,WCL,YPTR,TCL,ZCL,XCL)
*                                  Restore working descriptors
*      DECRA   WCL,1                                            E3.9.1
*      ACOMPC  WCL,0,,,LNKF8                                    E3.9.1
                                                             SPACE
LNKF1    LD    0,XCL                     . 007D2C 6800 A408
         STD   0,104(12)                 . 007D30 600C 0068
         LD    0,ZCL                     . 007D34 6800 A438
         STD   0,112(12)                 . 007D38 600C 0070
         LD    0,TCL                     . 007D3C 6800 A3D8
         STD   0,120(12)                 . 007D40 600C 0078
         LD    0,YPTR                    . 007D44 6800 A428
         STD   0,128(12)                 . 007D48 600C 0080
         LD    0,WCL                     . 007D4C 6800 A3F8
         STD   0,136(12)                 . 007D50 600C 0088
         LD    0,YCL                     . 007D54 6800 A420
         STD   0,144(12)                 . 007D58 600C 0090
         LA    12,48(12)                 . 007D5C 41CC 0030
         C     12,@@STACKT               . 007D60 59C0 A828
         BH    OVER                      . 007D64 4720 9664
         LA    14,S4$07D84               . 007D68 41E0 B08C
         STM   11,14,104(12)             . 007D6C 90BE C068
         LR    13,12                     . 007D70 18DC
         LA    12,16(12)                 . 007D72 41CC 0010
         C     12,@@STACKT               . 007D76 59C0 A828
         BH    OVER                      . 007D7A 4720 9664
         L     11,@@ARGVAL               . 007D7E 58B0 A914
         BR    11                        . 007D82 07FB
S4$07D84 STD   0,XPTR                    . 007D84 6000 A410
         B     FAIL                      . 007D88 47F0 9010
         LD    0,96(12)                  . 007D8C 680C 0060
         STD   0,YCL                     . 007D90 6000 A420
         LD    0,88(12)                  . 007D94 680C 0058
         STD   0,WCL                     . 007D98 6000 A3F8
         LD    0,80(12)                  . 007D9C 680C 0050
         STD   0,YPTR                    . 007DA0 6000 A428
         LD    0,72(12)                  . 007DA4 680C 0048
         STD   0,TCL                     . 007DA8 6000 A3D8
         LD    0,64(12)                  . 007DAC 680C 0040
         STD   0,ZCL                     . 007DB0 6000 A438
         LD    0,56(12)                  . 007DB4 680C 0038
         STD   0,XCL                     . 007DB8 6000 A408
         S     12,@@6XDESC               . 007DBC 5BC0 A928
                                                             SPACE
* LNKF7 GETD   ZPTR,ZCL,TCL        Get data type required
*      VEQLC   ZPTR,0,,LNKF6       Check for possible conversion
*      VEQL    ZPTR,XPTR,,LNKF6    Skip if data types the same
*      SETAV   DTCL,XPTR           Data type of argument
*      MOVV    DTCL,ZPTR           Data type required
*      DEQL    DTCL,VIDTP,,LNKVI   STRING-INTEGER
*      DEQL    DTCL,IVDTP,,LNKIV   INTEGER-STRING
*      DEQL    DTCL,RIDTP,,LNKRI   REAL-INTEGER
*      DEQL    DTCL,IRDTP,,LNKIR   INTEGER-REAL
*      DEQL    DTCL,RVDTP,,LNKRV   REAL-STRING
*      DEQL    DTCL,VRDTP,INTR1,LNKVR
*                                  STRING-REAL
                                                             SPACE
LNKF7    L     1,TCL                     . 007DC0 5810 A3D8
         L     2,ZCL                     . 007DC4 5820 A438
         LD    0,0(1,2)                  . 007DC8 6801 2000
         STD   0,ZPTR                    . 007DCC 6000 A440
         CLC   ZPTR$5(3),@@0             . 007DD0 D502 A445 AA78
         BE    LNKF6                     . 007DD6 4780 B2BE
         CLC   ZPTR$5(3),XPTR$5          . 007DDA D502 A445 A415
         BE    LNKF6                     . 007DE0 4780 B2BE
         L     15,XPTR$4                 . 007DE4 58F0 A414
         LA    15,0(15)                  . 007DE8 41FF 0000
         STM   15,0,DTCL                 . 007DEC 90F0 9E40
         MVC   DTCL$5(3),ZPTR$5          . 007DF0 D202 9E45 A445
         CLC   DTCL(8),VIDTP             . 007DF6 D507 9E40 9B48
         BE    LNKVI                     . 007DFC 4780 B268
         CLC   DTCL(8),IVDTP             . 007E00 D507 9E40 9AF0
         BE    LNKIV                     . 007E06 4780 B13E
         CLC   DTCL(8),RIDTP             . 007E0A D507 9E40 9B10
         BE    LNKRI                     . 007E10 4780 B16A
         CLC   DTCL(8),IRDTP             . 007E14 D507 9E40 9AE8
         BE    LNKIR                     . 007E1A 4780 B1B4
         CLC   DTCL(8),RVDTP             . 007E1E D507 9E40 9B28
         BE    LNKRV                     . 007E24 4780 B22E
         CLC   DTCL(8),VRDTP             . 007E28 D507 9E40 9B58
         BNE   INTR1                     . 007E2E 4770 95FC
         BE    LNKVR                     . 007E32 4780 B1D8
                                                             SPACE
* LNKIV RCALL  XPTR,GNVARI,XPTR,LNKF6
*                                  Convert INTEGER to STRING
                                                             SPACE
LNKIV    LA    14,S4$07E5A               . 007E36 41E0 B162
         STM   11,14,104(12)             . 007E3A 90BE C068
         LR    13,12                     . 007E3E 18DC
         LD    0,XPTR                    . 007E40 6800 A410
         STD   0,120(12)                 . 007E44 600C 0078
         LA    12,24(12)                 . 007E48 41CC 0018
         C     12,@@STACKT               . 007E4C 59C0 A828
         BH    OVER                      . 007E50 4720 9664
         L     11,@@GNVARI               . 007E54 58B0 A94C
         BR    11                        . 007E58 07FB
S4$07E5A STD   0,XPTR                    . 007E5A 6000 A410
         B     LNKF6                     . 007E5E 47F0 B2BE
                                                             SPACE
* LNKRI RLINT  XPTR,XPTR,INTR1,LNKF6
*                                  Convert REAL to INTEGER
                                                             SPACE
LNKRI    SDR   2,2                       . 007E62 2B22
         LE    2,XPTR                    . 007E64 7820 A410
         TM    XPTR,X'40'                . 007E68 9140 A410
         BNO   S4$07E76                  . 007E6C 47E0 B17E
         LTDR  2,2                       . 007E70 2222
         BNZ   S4$07E7E                  . 007E72 4770 B186
S4$07E76 ST    0,XPTR                    . 007E76 5000 A410
         B     S4$07EA0                  . 007E7A 47F0 B1A8
S4$07E7E CE    2,MAXINT                  . 007E7E 7920 A7A8
         BH    INTR1                     . 007E82 4720 95FC
         LPDR  4,2                       . 007E86 2042
         AW    4,BIGZIP                  . 007E88 6E40 A7A0
         STD   4,REALB                   . 007E8C 6040 A788
         L     2,REALB$4                 . 007E90 5820 A78C
         LTDR  2,2                       . 007E94 2222
         BNM   S4$07E9C                  . 007E96 47B0 B1A4
         LNR   2,2                       . 007E9A 1122
S4$07E9C ST    2,XPTR                    . 007E9C 5020 A410
S4$07EA0 LA    2,6                       . 007EA0 4120 0006
         ST    2,XPTR$4                  . 007EA4 5020 A414
         B     LNKF6                     . 007EA8 47F0 B2BE
                                                             SPACE
* LNKIR INTRL  XPTR,XPTR           Convert INTEGER to REAL
*      BRANCH  LNKF6
                                                             SPACE
LNKIR    L     2,XPTR                    . 007EAC 5820 A410
         AL    2,BIG2$4                  . 007EB0 5E20 A79C
         ST    2,REALBB$4                . 007EB4 5020 A794
         LD    2,REALBB                  . 007EB8 6820 A790
         SD    2,BIG2                    . 007EBC 6B20 A798
         STE   2,XPTR                    . 007EC0 7020 A410
         LA    2,7                       . 007EC4 4120 0007
         ST    2,XPTR$4                  . 007EC8 5020 A414
         B     LNKF6                     . 007ECC 47F0 B2BE
                                                             SPACE
* LNKVR LOCSP  XSP,XPTR            Get specifier
*      SPCINT  XPTR,XSP,,LNKIR     Convert STRING to INTEGER
*      SPREAL  XPTR,XSP,INTR1,LNKF6
*                                  Convert STRING to REAL
                                                             SPACE
LNKVR    LM    3,4,XPTR                  . 007ED0 9834 A410
         CR    0,3                       . 007ED4 1903
         BNE   S4$07EE2                  . 007ED6 4770 B1EA
         ST    0,XSP                     . 007EDA 5000 A5D0
         B     S4$07EF2                  . 007EDE 47F0 B1FA
S4$07EE2 L     1,4(3)                    . 007EE2 5813 0004
         LA    1,0(1)                    . 007EE6 4111 0000
         LA    2,32                      . 007EEA 4120 0020
         STM   1,4,XSP                   . 007EEE 9014 A5D0
S4$07EF2 L     15,@@DECBIN               . 007EF2 58F0 A8EC
         LA    1,XPTR                    . 007EF6 4110 A410
         LA    2,XSP                     . 007EFA 4120 A5D0
         BALR  14,15                          CALL                     *
                                         . 007EFE 05EF
         B     S4$07F08                  . 007F00 47F0 B210
         B     LNKIR                     . 007F04 47F0 B1B4
S4$07F08 L     15,@@SPREAL               . 007F08 58F0 A8F0
         LA    1,XPTR                    . 007F0C 4110 A410
         LM    2,4,XSP                   . 007F10 9824 A5D0
         BALR  14,15                          CALL                     *
                                         . 007F14 05EF
         B     INTR1                     . 007F16 47F0 95FC
         LA    2,7                       . 007F1A 4120 0007
         ST    2,XPTR$4                  . 007F1E 5020 A414
         B     LNKF6                     . 007F22 47F0 B2BE
                                                             SPACE
* LNKRV REALST XSP,XPTR
*      RCALL   XPTR,GENVAR,XSPPTR,LNKF6
                                                             SPACE
LNKRV    L     15,@@REALST               . 007F26 58F0 A86C
         LA    5,XSP                     . 007F2A 4150 A5D0
         LE    2,XPTR                    . 007F2E 7820 A410
         BALR  14,15                          CALL                     *
                                         . 007F32 05EF
         LA    14,S4$07F58               . 007F34 41E0 B260
         STM   11,14,104(12)             . 007F38 90BE C068
         LR    13,12                     . 007F3C 18DC
         LD    0,XSPPTR                  . 007F3E 6800 9F60
         STD   0,120(12)                 . 007F42 600C 0078
         LA    12,24(12)                 . 007F46 41CC 0018
         C     12,@@STACKT               . 007F4A 59C0 A828
         BH    OVER                      . 007F4E 4720 9664
         L     11,@@GENVAR               . 007F52 58B0 A830
         BR    11                        . 007F56 07FB
S4$07F58 STD   0,XPTR                    . 007F58 6000 A410
         B     LNKF6                     . 007F5C 47F0 B2BE
                                                             SPACE
* LNKVI LOCSP  XSP,XPTR            Get specifier
*      SPCINT  XPTR,XSP,,LNKF6     Convert to INTEGER
*      SPREAL  XPTR,XSP,INTR1,LNKRI
*                                  Convert STRING to REAL
                                                             SPACE
LNKVI    LM    3,4,XPTR                  . 007F60 9834 A410
         CR    0,3                       . 007F64 1903
         BNE   S4$07F72                  . 007F66 4770 B27A
         ST    0,XSP                     . 007F6A 5000 A5D0
         B     S4$07F82                  . 007F6E 47F0 B28A
S4$07F72 L     1,4(3)                    . 007F72 5813 0004
         LA    1,0(1)                    . 007F76 4111 0000
         LA    2,32                      . 007F7A 4120 0020
         STM   1,4,XSP                   . 007F7E 9014 A5D0
S4$07F82 L     15,@@DECBIN               . 007F82 58F0 A8EC
         LA    1,XPTR                    . 007F86 4110 A410
         LA    2,XSP                     . 007F8A 4120 A5D0
         BALR  14,15                          CALL                     *
                                         . 007F8E 05EF
         B     S4$07F98                  . 007F90 47F0 B2A0
         B     LNKF6                     . 007F94 47F0 B2BE
S4$07F98 L     15,@@SPREAL               . 007F98 58F0 A8F0
         LA    1,XPTR                    . 007F9C 4110 A410
         LM    2,4,XSP                   . 007FA0 9824 A5D0
         BALR  14,15                          CALL                     *
                                         . 007FA4 05EF
         B     INTR1                     . 007FA6 47F0 95FC
         LA    2,7                       . 007FAA 4120 0007
         ST    2,XPTR$4                  . 007FAE 5020 A414
         B     LNKRI                     . 007FB2 47F0 B16A
                                                             SPACE
* LNKF6 INCRA  TCL,DESCR           Increment offset
*      PUSH    XPTR                Save argument
                                                             SPACE
LNKF6    L     1,TCL                     . 007FB6 5810 A3D8
         AR    1,8                       . 007FBA 1A18
         ST    1,TCL                     . 007FBC 5010 A3D8
         LD    0,XPTR                    . 007FC0 6800 A410
         STD   0,104(12)                 . 007FC4 600C 0068
         AR    12,8                      . 007FC8 1AC8
         C     12,@@STACKT               . 007FCA 59C0 A828
         BH    OVER                      . 007FCE 4720 9664
                                                             SPACE
* LNKF8 DECRA  XCL,1                                            E3.9.1
*      ACOMPC  XCL,0,LNKF1                                      E3.9.1
*      GETDC   WPTR,YCL,0          Get procedure descriptor
*      SETAV   WPTR,WPTR           Get argument count required
                                                             SPACE
LNKF8    L     1,XCL                     . 007FD2 5810 A408
         BCTR  1,0                            DECREMENT                *
                                         . 007FD6 0610
         ST    1,XCL                     . 007FD8 5010 A408
         CR    0,1                       . 007FDC 1901
         BL    LNKF1                     . 007FDE 4740 B034
         BH    LNKF4                     . 007FE2 4720 B306
         L     1,YCL                     . 007FE6 5810 A420
         LD    0,0(1)                    . 007FEA 6801 0000
         STD   0,WPTR                    . 007FEE 6000 A400
         L     15,WPTR$4                 . 007FF2 58F0 A404
         LA    15,0(15)                  . 007FF6 41FF 0000
         STM   15,0,WPTR                 . 007FFA 90F0 A400
                                                             SPACE
* LNKF4 ACOMPC WCL,0,,LNKF5,LNKF5                               E3.9.1
*      PUSH    NULVCL                                           E3.9.1
*      DECRA   WCL,1               Decrement argument count
*      BRANCH  LNKF4               Continue
                                                             SPACE
LNKF4    L     1,WCL                     . 007FFE 5810 A3F8
         C     1,WPTR                    . 008002 5910 A400
         BH    LNKF9                     . 008006 4720 B32A
         BE    LNKF5                     . 00800A 4780 B342
         LD    0,NULVCL                  . 00800E 6800 9ED0
         STD   0,XPTR                    . 008012 6000 A410
         LA    1,1(1)                    . 008016 4111 0001
         ST    1,WCL                     . 00801A 5010 A3F8
         B     LNKF7                     . 00801E 47F0 B0C8
LNKF9    LD    0,96(12)                  . 008022 680C 0060
         STD   0,ZPTR                    . 008026 6000 A440
         SR    12,8                      . 00802A 1BC8
         L     1,WCL                     . 00802C 5810 A3F8
         BCTR  1,0                            DECREMENT                *
                                         . 008030 0610
         ST    1,WCL                     . 008032 5010 A3F8
         B     LNKF4                     . 008036 47F0 B306
                                                             SPACE
* LNKF5 GETSIZ WCL,ZCL             Get size of definition block
*      SUM     XPTR,ZCL,WCL        Compute pointer to end
*      GETDC   ZPTR,XPTR,0         Get data target descriptor
*      GETDC   ZCL,ZCL,DESCR       Get function address
*      INCRA   YPTR,2*DESCR        Get pointer to argument list
*      LINK    ZPTR,YPTR,WPTR,ZCL,FAIL
*                                  Link to external function
*      VEQLC   ZPTR,L,RTZPTR       Check for linked string
*      GETSPC  ZSP,ZPTR,0          Get specifier
*      BRANCH  GENVRZ              Go generate variable
LNKF5    L     15,ZCL                    . 00803A 58F0 A438
         L     15,4(15)                  . 00803E 58FF 0004
         LA    15,0(15)                  . 008042 41FF 0000
         STM   15,0,WCL                  . 008046 90F0 A3F8
         LM    1,2,ZCL                   . 00804A 9812 A438
         AR    1,15                      . 00804E 1A1F
         STM   1,2,XPTR                  . 008050 9012 A410
         LD    0,0(1)                    . 008054 6801 0000
         STD   0,ZPTR                    . 008058 6000 A440
         L     1,ZCL                     . 00805C 5810 A438
         LD    0,8(1)                    . 008060 6801 0008
         STD   0,ZCL                     . 008064 6000 A438
         L     1,YPTR                    . 008068 5810 A428
         LA    1,16(1)                   . 00806C 4111 0010
         ST    1,YPTR                    . 008070 5010 A428
         L     2,WPTR                    . 008074 5820 A400
         LA    3,ZPTR                    . 008078 4130 A440
         L     4,ZCL                     . 00807C 5840 A438
         L     15,@@LINKER               . 008080 58F0 A9E0
         BALR  14,15                          CALL                     *
                                         . 008084 05EF
         B     FAIL                      . 008086 47F0 9010
         CLC   ZPTR$5(3),@@L             . 00808A D502 A445 AA90
         BNE   RTZPTR                    . 008090 4770 9074
         L     1,ZPTR                    . 008094 5810 A440
         LM    1,4,0(1)                  . 008098 9814 1000
         STM   1,4,ZSP                   . 00809C 9014 A5F0
         B     GENVRZ                    . 0080A0 47F0 90D2
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Arrays, Tables, and Defined Data Objects'
*
*      ARRAY(P,V)
*
                                                             SPACE
* ARRAY PROC   ,                   ARRAY(P,V)
*      RCALL   XPTR,VARVAL,,FAIL   Get prototype
*      PUSH    XPTR                Save prototype
*      RCALL   TPTR,ARGVAL,,FAIL   Get initial value for array elements
*      POP     XPTR                Restore prototype
*      SETAC   ARRMRK,0            Clear prototype analysis switch
*      MOVD    WCL,ZEROCL          Initialize dimensionality to zero
*      MOVD    XCL,ONECL           Initialize size to one
*      LOCSP   XSP,XPTR            Get specifier to prototype
*      PUSH    XPTR                Save prototype for later insertion
                                                             SPACE
         USING ARRAY,11                  .
ARRAY    LA    14,S4$080C0               . 0080A4 41E0 B01C
         STM   11,14,104(12)             . 0080A8 90BE C068
         LR    13,12                     . 0080AC 18DC
         LA    12,16(12)                 . 0080AE 41CC 0010
         C     12,@@STACKT               . 0080B2 59C0 A828
         BH    OVER                      . 0080B6 4720 9664
         L     11,@@VARVAL               . 0080BA 58B0 A9C0
         BR    11                        . 0080BE 07FB
S4$080C0 STD   0,XPTR                    . 0080C0 6000 A410
         B     FAIL                      . 0080C4 47F0 9010
         LD    0,XPTR                    . 0080C8 6800 A410
         STD   0,104(12)                 . 0080CC 600C 0068
         AR    12,8                      . 0080D0 1AC8
         C     12,@@STACKT               . 0080D2 59C0 A828
         BH    OVER                      . 0080D6 4720 9664
         LA    14,S4$080F6               . 0080DA 41E0 B052
         STM   11,14,104(12)             . 0080DE 90BE C068
         LR    13,12                     . 0080E2 18DC
         LA    12,16(12)                 . 0080E4 41CC 0010
         C     12,@@STACKT               . 0080E8 59C0 A828
         BH    OVER                      . 0080EC 4720 9664
         L     11,@@ARGVAL               . 0080F0 58B0 A914
         BR    11                        . 0080F4 07FB
S4$080F6 STD   0,TPTR                    . 0080F6 6000 A3D0
         B     FAIL                      . 0080FA 47F0 9010
         LD    0,96(12)                  . 0080FE 680C 0060
         STD   0,XPTR                    . 008102 6000 A410
         SR    12,8                      . 008106 1BC8
         ST    0,ARRMRK                  . 008108 5000 9BA0
         LD    0,ZEROCL                  . 00810C 6800 9C90
         STD   0,WCL                     . 008110 6000 A3F8
         LD    0,ONECL                   . 008114 6800 9C68
         STD   0,XCL                     . 008118 6000 A408
         LM    3,4,XPTR                  . 00811C 9834 A410
         CR    0,3                       . 008120 1903
         BNE   S4$0812E                  . 008122 4770 B08A
         ST    0,XSP                     . 008126 5000 A5D0
         B     S4$0813E                  . 00812A 47F0 B09A
S4$0812E L     1,4(3)                    . 00812E 5813 0004
         LA    1,0(1)                    . 008132 4111 0000
         LA    2,32                      . 008136 4120 0020
         STM   1,4,XSP                   . 00813A 9014 A5D0
S4$0813E LD    0,XPTR                    . 00813E 6800 A410
         STD   0,104(12)                 . 008142 600C 0068
         AR    12,8                      . 008146 1AC8
         C     12,@@STACKT               . 008148 59C0 A828
         BH    OVER                      . 00814C 4720 9664
                                                             SPACE
* ARRAY1 STREAM YSP,XSP,NUMBTB,PROTER,ARROT1                    E3.5.1
*      SPCINT  YCL,YSP,PROTER      Convert string to integer
*      SELBRA  STYPE,(,ARRAY3)     Branch on colon or comma
*      FSHRTN  XSP,1               Delete colon
*      STREAM  ZSP,XSP,NUMBTB,PROTER,ARROT2
*      SPCINT  ZCL,ZSP,PROTER      Convert upper bound to integer
*      SELBRA  STYPE,(PROTER,ARRAY5)
*                                  Verify break character
                                                             SPACE
ARRAY1   C     0,ARRMRK                  . 008150 5900 9BA0
         BNE   ARRAY7                    . 008154 4770 B1FE
         L     15,@@STREAM               . 008158 58F0 A840
         LA    1,YSP                     . 00815C 4110 A5E0
         LA    2,XSP                     . 008160 4120 A5D0
         L     3,@@NUMBTB                . 008164 5830 A9E4
         BALR  14,15                          CALL                     *
                                         . 008168 05EF
         B     PROTER                    . 00816A 47F0 966C
         B     ARROT1                    . 00816E 47F0 B1C2
         L     15,@@DECBIN               . 008172 58F0 A8EC
         LA    1,YCL                     . 008176 4110 A420
         LA    2,YSP                     . 00817A 4120 A5E0
         BALR  14,15                          CALL                     *
                                         . 00817E 05EF
         B     PROTER                    . 008180 47F0 966C
         L     1,STYPE                   . 008184 5810 9F08
         SLA   1,2                       . 008188 8B10 0002
S4$0818C B     S4$0818C(1)               . 00818C 47F1 B0E8
         B     S4$08198                  . 008190 47F0 B0F4
         B     ARRAY3                    . 008194 47F0 B142
S4$08198 LM    1,2,XSP                   . 008198 9812 A5D0
         BCTR  1,0                            DECREMENT                *
                                         . 00819C 0610
         LA    2,1(2)                    . 00819E 4122 0001
         STM   1,2,XSP                   . 0081A2 9012 A5D0
         L     15,@@STREAM               . 0081A6 58F0 A840
         LA    1,ZSP                     . 0081AA 4110 A5F0
         LA    2,XSP                     . 0081AE 4120 A5D0
         L     3,@@NUMBTB                . 0081B2 5830 A9E4
         BALR  14,15                          CALL                     *
                                         . 0081B6 05EF
         B     PROTER                    . 0081B8 47F0 966C
         B     ARROT2                    . 0081BC 47F0 B1E0
         L     15,@@DECBIN               . 0081C0 58F0 A8EC
         LA    1,ZCL                     . 0081C4 4110 A438
         LA    2,ZSP                     . 0081C8 4120 A5F0
         BALR  14,15                          CALL                     *
                                         . 0081CC 05EF
         B     PROTER                    . 0081CE 47F0 966C
         L     1,STYPE                   . 0081D2 5810 9F08
         SLA   1,2                       . 0081D6 8B10 0002
S4$081DA B     S4$081DA(1)               . 0081DA 47F1 B136
         B     PROTER                    . 0081DE 47F0 966C
         B     ARRAY5                    . 0081E2 47F0 B15E
                                                             SPACE
* ARRAY3 ACOMPC YCL,0,,PROTER,PROTER
*                                  Single number must be positive
*      MOVD    ZCL,YCL             Move to copy
*      SETAC   YCL,1               Set lower bound to default of one
*      BRANCH  ARRAY6
                                                             SPACE
ARRAY3   C     0,YCL                     . 0081E6 5900 A420
         BNL   PROTER                    . 0081EA 47B0 966C
         LD    0,YCL                     . 0081EE 6800 A420
         STD   0,ZCL                     . 0081F2 6000 A438
         LA    1,1                       . 0081F6 4110 0001
         ST    1,YCL                     . 0081FA 5010 A420
         B     ARRAY6                    . 0081FE 47F0 B178
                                                             SPACE
* ARRAY5 SUBTRT ZCL,ZCL,YCL        Compute difference
*      SUM     ZCL,ZCL,ONECL       Add one
*      ACOMPC  ZCL,0,,,PROTER
                                                             SPACE
ARRAY5   L     1,ZCL                     . 008202 5810 A438
         S     1,YCL                     . 008206 5B10 A420
         ST    1,ZCL                     . 00820A 5010 A438
         A     1,ONECL                   . 00820E 5A10 9C68
         ST    1,ZCL                     . 008212 5010 A438
         CR    0,1                       . 008216 1901
         BH    PROTER                    . 008218 4720 966C
                                                             SPACE
* ARRAY6 SETVA YCL,ZCL             Insert width of dimension
*      PUSH    YCL                 Save dimension information
*      MULT    XCL,XCL,ZCL,PROTER  Compute size of array to this point
*      INCRA   WCL,1               Increase count of dimensions
*      AEQLC   ARRMRK,0,ARRAY7                                  E3.5.1
*      FSHRTN  XSP,1               Remove break character
*      BRANCH  ARRAY1
                                                             SPACE
ARRAY6   MVC   YCL$5(3),ZCL$1            . 00821C D202 A425 A439
         LD    0,YCL                     . 008222 6800 A420
         STD   0,104(12)                 . 008226 600C 0068
         AR    12,8                      . 00822A 1AC8
         C     12,@@STACKT               . 00822C 59C0 A828
         BH    OVER                      . 008230 4720 9664
         L     3,XCL                     . 008234 5830 A408
         M     2,ZCL                     . 008238 5C20 A438
         ST    3,XCL                     . 00823C 5030 A408
         SLDA  2,32                      . 008240 8F20 0020
         BO    PROTER                    . 008244 4710 966C
         L     1,WCL                     . 008248 5810 A3F8
         LA    1,1(1)                    . 00824C 4111 0001
         ST    1,WCL                     . 008250 5010 A3F8
         LM    1,2,XSP                   . 008254 9812 A5D0
         BCTR  1,0                            DECREMENT                *
                                         . 008258 0610
         LA    2,1(2)                    . 00825A 4122 0001
         STM   1,2,XSP                   . 00825E 9012 A5D0
         B     ARRAY1                    . 008262 47F0 B0AC
                                                             SPACE
* ARROT1 SETAC ARRMRK,1            On run out, mark end of prototype
*      SPCINT  YCL,YSP,PROTER,ARRAY3
*                                  Convert string to integer
                                                             SPACE
ARROT1   LA    1,1                       . 008266 4110 0001
         ST    1,ARRMRK                  . 00826A 5010 9BA0
         L     15,@@DECBIN               . 00826E 58F0 A8EC
         LA    1,YCL                     . 008272 4110 A420
         LA    2,YSP                     . 008276 4120 A5E0
         BALR  14,15                          CALL                     *
                                         . 00827A 05EF
         B     PROTER                    . 00827C 47F0 966C
         B     ARRAY3                    . 008280 47F0 B142
                                                             SPACE
* ARROT2 SETAC ARRMRK,1            On run out, mark end of prototype
*      SPCINT  ZCL,ZSP,PROTER,ARRAY5
*                                  Convert string to integer
                                                             SPACE
ARROT2   LA    1,1                       . 008284 4110 0001
         ST    1,ARRMRK                  . 008288 5010 9BA0
         L     15,@@DECBIN               . 00828C 58F0 A8EC
         LA    1,ZCL                     . 008290 4110 A438
         LA    2,ZSP                     . 008294 4120 A5F0
         BALR  14,15                          CALL                     *
                                         . 008298 05EF
         B     PROTER                    . 00829A 47F0 966C
         B     ARRAY5                    . 00829E 47F0 B15E
                                                             SPACE
* ARRAY7 SUM   ZCL,XCL,WCL         Add dimensionality to array size
*      INCRA   ZCL,2               Add two for heading information
*      MULTC   ZCL,ZCL,DESCR       Convert to address units
*      SETVC   ZCL,A               Insert ARRAY data type
*      RCALL   ZPTR,BLOCK,ZCL      Allocate block for array structure
*      MOVD    XPTR,ZPTR           Save copy
*      SUM     WPTR,XPTR,ZCL       Get pointer to last descriptor
*      PUTDC   ZPTR,2*DESCR,WCL    Insert dimensionality
*      INCRA   XPTR,DESCR          Update working pointer
                                                             SPACE
ARRAY7   LM    1,2,XCL                   . 0082A2 9812 A408
         A     1,WCL                     . 0082A6 5A10 A3F8
         STM   1,2,ZCL                   . 0082AA 9012 A438
         LA    15,2(1)                   . 0082AE 41F1 0002
         SLA   15,3                      . 0082B2 8BF0 0003
         STM   15,0,ZCL                  . 0082B6 90F0 A438
         MVC   ZCL$5(3),@@A              . 0082BA D202 A43D AA6F
         LA    14,S4$082E4               . 0082C0 41E0 B240
         STM   11,14,104(12)             . 0082C4 90BE C068
         LR    13,12                     . 0082C8 18DC
         LD    0,ZCL                     . 0082CA 6800 A438
         STD   0,120(12)                 . 0082CE 600C 0078
         LA    12,24(12)                 . 0082D2 41CC 0018
         C     12,@@STACKT               . 0082D6 59C0 A828
         BH    OVER                      . 0082DA 4720 9664
         L     11,@@BLOCK                . 0082DE 58B0 A82C
         BR    11                        . 0082E2 07FB
S4$082E4 STD   0,ZPTR                    . 0082E4 6000 A440
         STD   0,XPTR                    . 0082E8 6000 A410
         LM    1,2,XPTR                  . 0082EC 9812 A410
         A     1,ZCL                     . 0082F0 5A10 A438
         STM   1,2,WPTR                  . 0082F4 9012 A400
         L     1,ZPTR                    . 0082F8 5810 A440
         LD    0,WCL                     . 0082FC 6800 A3F8
         STD   0,16(1)                   . 008300 6001 0010
         L     1,XPTR                    . 008304 5810 A410
         AR    1,8                       . 008308 1A18
         ST    1,XPTR                    . 00830A 5010 A410
                                                             SPACE
* ARRAY8 INCRA XPTR,DESCR          Update working pointer for another
*      POP     YPTR                Restore index pair
*      PUTDC   XPTR,DESCR,YPTR     Insert in structure
*      DECRA   WCL,1               Decrement dimensionality
*      ACOMPC  WCL,0,ARRAY8,ARRFIL Check for last one
                                                             SPACE
ARRAY8   L     1,XPTR                    . 00830E 5810 A410
         AR    1,8                       . 008312 1A18
         ST    1,XPTR                    . 008314 5010 A410
         LD    0,96(12)                  . 008318 680C 0060
         STD   0,YPTR                    . 00831C 6000 A428
         SR    12,8                      . 008320 1BC8
         STD   0,8(1)                    . 008322 6001 0008
         L     1,WCL                     . 008326 5810 A3F8
         BCTR  1,0                            DECREMENT                *
                                         . 00832A 0610
         ST    1,WCL                     . 00832C 5010 A3F8
         CR    0,1                       . 008330 1901
         BL    ARRAY8                    . 008332 4740 B26A
         BE    ARRFIL                    . 008336 4780 B2A2
                                                             SPACE
* ARRAY9 PUTDC XPTR,DESCR,TPTR     Insert initial value
                                                             SPACE
ARRAY9   L     1,XPTR                    . 00833A 5810 A410
         LD    0,TPTR                    . 00833E 6800 A3D0
         STD   0,8(1)                    . 008342 6001 0008
                                                             SPACE
* ARRFIL INCRA XPTR,DESCR          Update working pointer
*      ACOMP   XPTR,WPTR,INTR10,,ARRAY9
*                                  Check for end
*      POP     WPTR                RESTORE PROTOTYPE            E3.10.1
*      PUTDC   ZPTR,DESCR,WPTR     RETURN POINTER TO ARRAY      E3.10.1
*      BRANCH  RTZPTR              Return pointer to array structure
ARRFIL   L     1,XPTR                    . 008346 5810 A410
         AR    1,8                       . 00834A 1A18
         ST    1,XPTR                    . 00834C 5010 A410
         C     1,WPTR                    . 008350 5910 A400
         BH    S4$010                    . 008354 4720 95AC
         BL    ARRAY9                    . 008358 4740 B296
         LD    0,96(12)                  . 00835C 680C 0060
         STD   0,YPTR                    . 008360 6000 A428
         SR    12,8                      . 008364 1BC8
         L     1,ZPTR                    . 008366 5810 A440
         STD   0,8(1)                    . 00836A 6001 0008
         B     RTZPTR                    . 00836E 47F0 9074
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      TABLE(N,M)
*
                                                             SPACE
* ASSOC PROC   ,                   TABLE(N,M)
*      RCALL   XPTR,INTVAL,,FAIL   Get table size
*      PUSH    XPTR                Save size
*      RCALL   WPTR,INTVAL,,FAIL   Get secondary allocation
*      MULT    ZPTR,WPTR,DSCRTW,SIZERR                          E3.10.4
*      INCRA   ZPTR,2*DESCR                                     E3.10.4
*      ACOMP   ZPTR,SIZLMT,SIZERR,SIZERR                        E3.10.4
*      POP     XPTR                Restore size
*      ACOMPC  XPTR,0,ASSOC1,,LENERR
*      SETAC   XPTR,EXTSIZ
                                                             SPACE
         USING ASSOC,11                  .
ASSOC    LA    14,S4$0838E               . 008372 41E0 B01C
         STM   11,14,104(12)             . 008376 90BE C068
         LR    13,12                     . 00837A 18DC
         LA    12,16(12)                 . 00837C 41CC 0010
         C     12,@@STACKT               . 008380 59C0 A828
         BH    OVER                      . 008384 4720 9664
         L     11,@@INTVAL               . 008388 58B0 A9E8
         BR    11                        . 00838C 07FB
S4$0838E STD   0,XPTR                    . 00838E 6000 A410
         B     FAIL                      . 008392 47F0 9010
         LD    0,XPTR                    . 008396 6800 A410
         STD   0,104(12)                 . 00839A 600C 0068
         AR    12,8                      . 00839E 1AC8
         C     12,@@STACKT               . 0083A0 59C0 A828
         BH    OVER                      . 0083A4 4720 9664
         LA    14,S4$083C4               . 0083A8 41E0 B052
         STM   11,14,104(12)             . 0083AC 90BE C068
         LR    13,12                     . 0083B0 18DC
         LA    12,16(12)                 . 0083B2 41CC 0010
         C     12,@@STACKT               . 0083B6 59C0 A828
         BH    OVER                      . 0083BA 4720 9664
         L     11,@@INTVAL               . 0083BE 58B0 A9E8
         BR    11                        . 0083C2 07FB
S4$083C4 STD   0,WPTR                    . 0083C4 6000 A400
         B     FAIL                      . 0083C8 47F0 9010
         LD    0,96(12)                  . 0083CC 680C 0060
         STD   0,XPTR                    . 0083D0 6000 A410
         SR    12,8                      . 0083D4 1BC8
         C     0,XPTR                    . 0083D6 5900 A410
         BL    ASSOC1                    . 0083DA 4740 B078
         BH    LENERR                    . 0083DE 4720 963C
         L     1,@@EXTSIZ                . 0083E2 5810 A9EC
         ST    1,XPTR                    . 0083E6 5010 A410
                                                             SPACE
* ASSOC1 INCRA XPTR,1                                           E3.2.3
*      MULTC   XPTR,XPTR,2*DESCR                                E3.2.3
*      ACOMPC  WPTR,0,ASSOC4,,LENERR
*      SETAC   WPTR,EXTSIZ
                                                             SPACE
ASSOC1   L     1,XPTR                    . 0083EA 5810 A410
         LA    1,1(1)                    . 0083EE 4111 0001
         LA    15,16                     . 0083F2 41F0 0010
         MR    14,1                      . 0083F6 1CE1
         STM   15,0,XPTR                 . 0083F8 90F0 A410
         C     0,WPTR                    . 0083FC 5900 A400
         BL    ASSOC4                    . 008400 4740 B09E
         BH    LENERR                    . 008404 4720 963C
         L     1,@@EXTSIZ                . 008408 5810 A9EC
         ST    1,WPTR                    . 00840C 5010 A400
                                                             SPACE
* ASSOC4 INCRA WPTR,1                                           E3.2.3
*      MULTC   WPTR,WPTR,2*DESCR                                E3.2.3
*      SETVC   XPTR,T                                           E3.2.3
                                                             SPACE
ASSOC4   L     1,WPTR                    . 008410 5810 A400
         LA    1,1(1)                    . 008414 4111 0001
         LA    15,16                     . 008418 41F0 0010
         MR    14,1                      . 00841C 1CE1
         STM   15,0,WPTR                 . 00841E 90F0 A400
         MVC   XPTR$5(3),@@T             . 008422 D202 A415 AA72
                                                             SPACE
* ASSOCE PROC  ASSOC                                            E3.2.3
*      RCALL   ZPTR,BLOCK,XPTR                                  E3.2.3
*      PUTD    ZPTR,XPTR,ONECL                                  E3.2.3
*      DECRA   XPTR,DESCR                                       E3.2.3
*      PUTD    ZPTR,XPTR,WPTR                                   E3.2.3
                                                             SPACE
ASSOCE   L     11,ASSCFN                 . 008428 58B0 AAF8
         LA    14,S4$08450               . 00842C 41E0 B0DE
         STM   11,14,104(12)             . 008430 90BE C068
         LR    13,12                     . 008434 18DC
         LD    0,XPTR                    . 008436 6800 A410
         STD   0,120(12)                 . 00843A 600C 0078
         LA    12,24(12)                 . 00843E 41CC 0018
         C     12,@@STACKT               . 008442 59C0 A828
         BH    OVER                      . 008446 4720 9664
         L     11,@@BLOCK                . 00844A 58B0 A82C
         BR    11                        . 00844E 07FB
S4$08450 STD   0,ZPTR                    . 008450 6000 A440
         L     1,XPTR                    . 008454 5810 A410
         L     2,ZPTR                    . 008458 5820 A440
         LD    0,ONECL                   . 00845C 6800 9C68
         STD   0,0(1,2)                  . 008460 6001 2000
         SR    1,8                       . 008464 1B18
         ST    1,XPTR                    . 008466 5010 A410
         L     2,ZPTR                    . 00846A 5820 A440
         LD    0,WPTR                    . 00846E 6800 A400
         STD   0,0(1,2)                  . 008472 6001 2000
                                                             SPACE
* ASSOC2 DECRA XPTR,2*DESCR                                     E3.2.3
*      PUTD    ZPTR,XPTR,NULVCL                                 E3.2.3
*      AEQLC   XPTR,DESCR,ASSOC2,RTZPTR                         E3.2.3
ASSOC2   L     1,XPTR                    . 008476 5810 A410
         SR    1,8                       . 00847A 1B18
         SR    1,8                       . 00847C 1B18
         ST    1,XPTR                    . 00847E 5010 A410
         L     2,ZPTR                    . 008482 5820 A440
         LD    0,NULVCL                  . 008486 6800 9ED0
         STD   0,0(1,2)                  . 00848A 6001 2000
         CR    8,1                       . 00848E 1981
         BNE   ASSOC2                    . 008490 4770 B104
         DC    X'47809074A445AA72'       . 008494 47809074A445AA72
P@BR     L     1,ZPTR                    . 00849C 5810 A440
         LD    0,YPTR                    . 0084A0 6800 A428
         STD   0,8(1)                    . 0084A4 6001 0008
         LD    0,WPTR                    . 0084A8 6800 A400
         STD   0,16(1)                   . 0084AC 6001 0010
         B     RTZPTR                    . 0084B0 47F0 9074
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      DATA(P)
*
                                                             SPACE
* DATDEF PROC  ,                   DATA(P)
*      RCALL   XPTR,VARVAL,,FAIL   Get prototype
*      SETAC   DATACL,0            Initialize prototype switch
*      LOCSP   XSP,XPTR            Get specifier
*      STREAM  YSP,XSP,VARATB,PROTER,PROTER
*                                  Break out data type name
*      AEQLC   STYPE,LPTYP,PROTER  Verify left parenthesis
*      RCALL   XPTR,GENVAR,(YSPPTR)
*                                  Generate variable for name
*      RCALL   ZCL,FINDEX,(XPTR)   Find function descriptor
*      INCRV   DATSEG,1            Increment data type code
*      VEQLC   DATSEG,DATSIZ,,INTR27
*                                  Check against limit
*      MOVD    YCL,ZEROCL          Initialize count of fields
*      RCALL   DTATL,AUGATL,(DTATL,DATSEG,XPTR)
*                                  Augment data type pair list
*      PSTACK  WPTR                Post stack position
*      PUSH    (DATSEG,XPTR)       Save code and name
                                                             SPACE
         USING DATDEF,11                 .
DATDEF   LA    14,S4$084D0               . 0084B4 41E0 B01C
         STM   11,14,104(12)             . 0084B8 90BE C068
         LR    13,12                     . 0084BC 18DC
         LA    12,16(12)                 . 0084BE 41CC 0010
         C     12,@@STACKT               . 0084C2 59C0 A828
         BH    OVER                      . 0084C6 4720 9664
         L     11,@@VARVAL               . 0084CA 58B0 A9C0
         BR    11                        . 0084CE 07FB
S4$084D0 STD   0,XPTR                    . 0084D0 6000 A410
         B     FAIL                      . 0084D4 47F0 9010
         ST    0,CNSLCL                  . 0084D8 5000 9BB0
         LM    3,4,XPTR                  . 0084DC 9834 A410
         CR    0,3                       . 0084E0 1903
         BNE   S4$084EE                  . 0084E2 4770 B03A
         ST    0,XSP                     . 0084E6 5000 A5D0
         B     S4$084FE                  . 0084EA 47F0 B04A
S4$084EE L     1,4(3)                    . 0084EE 5813 0004
         LA    1,0(1)                    . 0084F2 4111 0000
         LA    2,32                      . 0084F6 4120 0020
         STM   1,4,XSP                   . 0084FA 9014 A5D0
S4$084FE L     15,@@STREAM               . 0084FE 58F0 A840
         LA    1,YSP                     . 008502 4110 A5E0
         LA    2,XSP                     . 008506 4120 A5D0
         L     3,@@VARATB                . 00850A 5830 A9C4
         BALR  14,15                          CALL                     *
                                         . 00850E 05EF
         B     PROTER                    . 008510 47F0 966C
         B     PROTER                    . 008514 47F0 966C
         LA    6,1                       . 008518 4160 0001
         C     6,STYPE                   . 00851C 5960 9F08
         BNE   PROTER                    . 008520 4770 966C
         LA    14,S4$08548               . 008524 41E0 B094
         STM   11,14,104(12)             . 008528 90BE C068
         LR    13,12                     . 00852C 18DC
         LD    0,YSPPTR                  . 00852E 6800 9F68
         STD   0,120(12)                 . 008532 600C 0078
         LA    12,24(12)                 . 008536 41CC 0018
         C     12,@@STACKT               . 00853A 59C0 A828
         BH    OVER                      . 00853E 4720 9664
         L     11,@@GENVAR               . 008542 58B0 A830
         BR    11                        . 008546 07FB
S4$08548 STD   0,XPTR                    . 008548 6000 A410
         LA    14,S4$0856C               . 00854C 41E0 B0B8
         STM   11,14,104(12)             . 008550 90BE C068
         LR    13,12                     . 008554 18DC
         STD   0,120(12)                 . 008556 600C 0078
         LA    12,24(12)                 . 00855A 41CC 0018
         C     12,@@STACKT               . 00855E 59C0 A828
         BH    OVER                      . 008562 4720 9664
         L     11,@@FINDEX               . 008566 58B0 A8F4
         BR    11                        . 00856A 07FB
S4$0856C STD   0,ZCL                     . 00856C 6000 A438
         L     6,DATSEG$4                . 008570 5860 9E34
         LA    6,1(6)                    . 008574 4166 0001
         STH   6,DATSEG$6                . 008578 4060 9E36
         CLC   DATSEG$5(3),@@DATSIZ      . 00857C D502 9E35 AA93
         BE    INTR27                    . 008582 4780 961C
         LD    0,ZEROCL                  . 008586 6800 9C90
         STD   0,YCL                     . 00858A 6000 A420
         LA    14,S4$085C2               . 00858E 41E0 B10E
         STM   11,14,104(12)             . 008592 90BE C068
         LR    13,12                     . 008596 18DC
         LD    0,DTATL                   . 008598 6800 A2F0
         STD   0,136(12)                 . 00859C 600C 0088
         LD    0,DATSEG                  . 0085A0 6800 9E30
         STD   0,128(12)                 . 0085A4 600C 0080
         LD    0,XPTR                    . 0085A8 6800 A410
         STD   0,120(12)                 . 0085AC 600C 0078
         LA    12,40(12)                 . 0085B0 41CC 0028
         C     12,@@STACKT               . 0085B4 59C0 A828
         BH    OVER                      . 0085B8 4720 9664
         L     11,@@AUGATL               . 0085BC 58B0 A878
         BR    11                        . 0085C0 07FB
S4$085C2 STD   0,DTATL                   . 0085C2 6000 A2F0
         LA    15,96(12)                 . 0085C6 41FC 0060
         STM   15,0,WPTR                 . 0085CA 90F0 A400
         LD    0,DATSEG                  . 0085CE 6800 9E30
         STD   0,104(12)                 . 0085D2 600C 0068
         LD    0,XPTR                    . 0085D6 6800 A410
         STD   0,112(12)                 . 0085DA 600C 0070
         LA    12,16(12)                 . 0085DE 41CC 0010
         C     12,@@STACKT               . 0085E2 59C0 A828
         BH    OVER                      . 0085E6 4720 9664
                                                             SPACE
* DAT03 FSHRTN XSP,1               Delete break character
*      AEQLC   DATACL,0,DAT5       Check for prototype end
*      STREAM  YSP,XSP,VARATB,PROTER,PROTER
*                                  Break out field
*      SELBRA  STYPE,(PROTER,,DAT06)
                                                             SPACE
DAT03    LM    1,2,XSP                   . 0085EA 9812 A5D0
         BCTR  1,0                            DECREMENT                *
                                         . 0085EE 0610
         LA    2,1(2)                    . 0085F0 4122 0001
         STM   1,2,XSP                   . 0085F4 9012 A5D0
         C     0,CNSLCL                  . 0085F8 5900 9BB0
         BNE   DAT5                      . 0085FC 4770 B25E
         L     15,@@STREAM               . 008600 58F0 A840
         LA    1,YSP                     . 008604 4110 A5E0
         LA    2,XSP                     . 008608 4120 A5D0
         L     3,@@VARATB                . 00860C 5830 A9C4
         BALR  14,15                          CALL                     *
                                         . 008610 05EF
         B     PROTER                    . 008612 47F0 966C
         B     PROTER                    . 008616 47F0 966C
         L     1,STYPE                   . 00861A 5810 9F08
         SLA   1,2                       . 00861E 8B10 0002
S4$08622 B     S4$08622(1)               . 008622 47F1 B16E
         B     PROTER                    . 008626 47F0 966C
         B     DAT04                     . 00862A 47F0 B17E
         B     DAT06                     . 00862E 47F0 B252
                                                             SPACE
* DAT04 LEQLC  YSP,0,,DAT03        Check for zero length
*      RCALL   XPTR,GENVAR,YSPPTR  Generate variable
*      PUSH    XPTR                Save field name
*      RCALL   XCL,FINDEX,(XPTR)   Find function descriptor for field
*      GETDC   WCL,XCL,0           Get procedure descriptor
*      DEQL    WCL,FLDCL,DAT6      Check for FIELD procedure
*      GETDC   ZPTR,XCL,DESCR      Get field definition block
*      MULTC   TCL,YCL,DESCR
*      RCALL   ZPTR,AUGATL,(ZPTR,DATSEG,TCL)
                                                             SPACE
DAT04    C     0,YSP                     . 008632 5900 A5E0
         BE    DAT03                     . 008636 4780 B136
         LA    14,S4$0865E               . 00863A 41E0 B1AA
         STM   11,14,104(12)             . 00863E 90BE C068
         LR    13,12                     . 008642 18DC
         LD    0,YSPPTR                  . 008644 6800 9F68
         STD   0,120(12)                 . 008648 600C 0078
         LA    12,24(12)                 . 00864C 41CC 0018
         C     12,@@STACKT               . 008650 59C0 A828
         BH    OVER                      . 008654 4720 9664
         L     11,@@GENVAR               . 008658 58B0 A830
         BR    11                        . 00865C 07FB
S4$0865E STD   0,XPTR                    . 00865E 6000 A410
         STD   0,104(12)                 . 008662 600C 0068
         AR    12,8                      . 008666 1AC8
         C     12,@@STACKT               . 008668 59C0 A828
         BH    OVER                      . 00866C 4720 9664
         LA    14,S4$08690               . 008670 41E0 B1DC
         STM   11,14,104(12)             . 008674 90BE C068
         LR    13,12                     . 008678 18DC
         STD   0,120(12)                 . 00867A 600C 0078
         LA    12,24(12)                 . 00867E 41CC 0018
         C     12,@@STACKT               . 008682 59C0 A828
         BH    OVER                      . 008686 4720 9664
         L     11,@@FINDEX               . 00868A 58B0 A8F4
         BR    11                        . 00868E 07FB
S4$08690 STD   0,XCL                     . 008690 6000 A408
         L     1,XCL                     . 008694 5810 A408
         LD    0,0(1)                    . 008698 6801 0000
         STD   0,WCL                     . 00869C 6000 A3F8
         CLC   WCL(8),FLDCL              . 0086A0 D507 A3F8 9F38
         BNE   S4$08790                  . 0086A6 4770 B2DC
         LD    0,8(1)                    . 0086AA 6801 0008
         STD   0,ZPTR                    . 0086AE 6000 A440
         LA    14,S4$086E6               . 0086B2 41E0 B232
         STM   11,14,104(12)             . 0086B6 90BE C068
         LR    13,12                     . 0086BA 18DC
         STD   0,136(12)                 . 0086BC 600C 0088
         LD    0,DATSEG                  . 0086C0 6800 9E30
         STD   0,128(12)                 . 0086C4 600C 0080
         LM    1,2,YCL                   . 0086C8 9812 A420
         SLA   1,3                       . 0086CC 8B10 0003
         STM   1,2,120(12)               . 0086D0 9012 C078
         LA    12,40(12)                 . 0086D4 41CC 0028
         C     12,@@STACKT               . 0086D8 59C0 A828
         BH    OVER                      . 0086DC 4720 9664
         L     11,@@AUGATL               . 0086E0 58B0 A878
         BR    11                        . 0086E4 07FB
S4$086E6 STD   0,ZPTR                    . 0086E6 6000 A440
                                                             SPACE
* DAT7 PUTDC   XCL,DESCR,ZPTR      Insert new definition block
*      INCRA   YCL,1
*      BRANCH  DAT03               Continue
                                                             SPACE
DAT7     L     1,XCL                     . 0086EA 5810 A408
         LD    0,ZPTR                    . 0086EE 6800 A440
         STD   0,8(1)                    . 0086F2 6001 0008
         L     1,YCL                     . 0086F6 5810 A420
         LA    1,1(1)                    . 0086FA 4111 0001
         ST    1,YCL                     . 0086FE 5010 A420
         B     DAT03                     . 008702 47F0 B136
                                                             SPACE
* DAT06 SETAC  DATACL,1            Note end of prototype analysis
*      BRANCH  DAT04               Join field processing
                                                             SPACE
DAT06    LA    1,1                       . 008706 4110 0001
         ST    1,CNSLCL                  . 00870A 5010 9BB0
         B     DAT04                     . 00870E 47F0 B17E
                                                             SPACE
* DAT5 LEQLC   XSP,0,PROTER        Verify prototype consumption
*      AEQLC   YCL,0,,PROTER                                    E3.1.2
*      SETVA   DATCL,YCL           Insert field count for data function
*      PUTDC   ZCL,0,DATCL         Insert new procedure descriptor
*      MULTC   YCL,YCL,DESCR
*      INCRA   YCL,2*DESCR         Add two for the number and name
*      MOVV    YCL,DATSEG          Insert defined data code
*      RCALL   ZPTR,BLOCK,YCL      Allocate definition block
*      INCRA   WPTR,DESCR                                       E3.0.3
*      MOVBLK  ZPTR,WPTR,YCL       Copy from stack into block
*      PUTDC   ZCL,DESCR,ZPTR      Insert definition block
*      BRANCH  RETNUL              Return null value
                                                             SPACE
DAT5     CR    0,1                       . 008712 1901
         BNE   PROTER                    . 008714 4770 966C
         L     1,YCL                     . 008718 5810 A420
         CR    0,1                       . 00871C 1901
         BE    PROTER                    . 00871E 4780 966C
         MVC   DATCL$5(3),YCL$1          . 008722 D202 9F2D A421
         L     2,ZCL                     . 008728 5820 A438
         LD    0,DATCL                   . 00872C 6800 9F28
         STD   0,0(2)                    . 008730 6002 0000
         SLA   1,3                       . 008734 8B10 0003
         LA    1,16(1)                   . 008738 4111 0010
         L     2,DATSEG$4                . 00873C 5820 9E34
         LA    14,S4$08766               . 008740 41E0 B2B2
         STM   11,14,104(12)             . 008744 90BE C068
         LR    13,12                     . 008748 18DC
         STM   1,2,120(12)               . 00874A 9012 C078
         ST    1,YCL                     . 00874E 5010 A420
         SR    0,0                       . 008752 1B00
         LA    12,24(12)                 . 008754 41CC 0018
         C     12,@@STACKT               . 008758 59C0 A828
         BH    OVER                      . 00875C 4720 9664
         L     11,@@BLOCK                . 008760 58B0 A82C
         BR    11                        . 008764 07FB
S4$08766 STD   0,ZPTR                    . 008766 6000 A440
         L     6,ZPTR                    . 00876A 5860 A440
         L     4,WPTR                    . 00876E 5840 A400
         AR    4,8                       . 008772 1A48
         AR    6,8                       . 008774 1A68
         L     3,YCL                     . 008776 5830 A420
         L     15,@@MOVTST               . 00877A 58F0 A864
         BALR  14,15                          CALL                     *
                                         . 00877E 05EF
         L     1,ZCL                     . 008780 5810 A438
         LD    0,ZPTR                    . 008784 6800 A440
         STD   0,8(1)                    . 008788 6001 0008
         B     RETNUL                    . 00878C 47F0 9018
S4$08790 L     1,XCL                     . 008790 5810 A408
         LD    0,FLDCL                   . 008794 6800 9F38
         STD   0,0(1)                    . 008798 6001 0000
         LA    14,DAT6                   . 00879C 41E0 B30C
         STM   11,14,104(12)             . 0087A0 90BE C068
         LR    13,12                     . 0087A4 18DC
         LD    0,TWOCL                   . 0087A6 6800 A720
         STD   0,120(12)                 . 0087AA 600C 0078
         LA    12,24(12)                 . 0087AE 41CC 0018
         C     12,@@STACKT               . 0087B2 59C0 A828
         BH    OVER                      . 0087B6 4720 9664
         L     11,@@BLOCK                . 0087BA 58B0 A82C
         BR    11                        . 0087BE 07FB
                                                             SPACE
* DAT6 PUTDC   XCL,0,FLDCL         Insert FIELD procedure descriptor
*      RCALL   ZPTR,BLOCK,TWOCL    Allocate definition block
*      PUTDC   ZPTR,DESCR,DATSEG   Insert data type code
*      MULTC   TCL,YCL,DESCR
*      PUTDC   ZPTR,2*DESCR,TCL
*      BRANCH  DAT7                Join processing
DAT6     STD   0,ZPTR                    . 0087C0 6000 A440
         L     1,ZPTR                    . 0087C4 5810 A440
         LD    0,DATSEG                  . 0087C8 6800 9E30
         STD   0,8(1)                    . 0087CC 6001 0008
         LM    2,3,YCL                   . 0087D0 9823 A420
         SLA   2,3                       . 0087D4 8B20 0003
         STM   2,3,16(1)                 . 0087D8 9023 1010
         B     DAT7                      . 0087DC 47F0 B236
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      PROTOTYPE(A)
*
                                                             SPACE
* PROTO PROC   ,                   PROTOTYPE(A)
*      RCALL   XPTR,ARGVAL,,FAIL   Get argument
*      VEQLC   XPTR,A,NONARY       Verify ARRAY
*      GETDC   ZPTR,XPTR,DESCR     Get prototype
*      BRANCH  RTZPTR              Return
         USING PROTO,11                  .
PROTO    LA    14,S4$087FC               . 0087E0 41E0 B01C
         STM   11,14,104(12)             . 0087E4 90BE C068
         LR    13,12                     . 0087E8 18DC
         LA    12,16(12)                 . 0087EA 41CC 0010
         C     12,@@STACKT               . 0087EE 59C0 A828
         BH    OVER                      . 0087F2 4720 9664
         L     11,@@ARGVAL               . 0087F6 58B0 A914
         BR    11                        . 0087FA 07FB
S4$087FC STD   0,XPTR                    . 0087FC 6000 A410
         B     FAIL                      . 008800 47F0 9010
         CLC   XPTR$5(3),@@A             . 008804 D502 A415 AA6F
         BNE   NONARY                    . 00880A 4770 965C
         L     1,XPTR                    . 00880E 5810 A410
         LD    0,8(1)                    . 008812 6801 0008
         STD   0,ZPTR                    . 008816 6000 A440
         B     RTZPTR                    . 00881A 47F0 9074
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Array and Table References
*
                                                             SPACE
* ITEM PROC    ,                   Array or table reference
*      SETAV   XCL,INCL            Get argument count
*      DECRA   XCL,1               Skip referenced object
*      PUSH    XCL                 Save count
*      RCALL   YCL,ARGVAL,,FAIL    Get referenced object
*      POP     XCL                 Restore count
*      VEQLC   YCL,A,,ARYAD3       ARRAY is acceptable
*      VEQLC   YCL,T,NONARY,ASSCR  TABLE is acceptable
                                                             SPACE
         USING ITEM,11                   .
ITEM     L     15,INCL$4                 . 00881E 58F0 9E9C
         LA    15,0(15)                  . 008822 41FF 0000
         BCTR  15,0                           DECREMENT                *
                                         . 008826 06F0
         STM   15,0,XCL                  . 008828 90F0 A408
         STM   15,0,104(12)              . 00882C 90F0 C068
         AR    12,8                      . 008830 1AC8
         C     12,@@STACKT               . 008832 59C0 A828
         BH    OVER                      . 008836 4720 9664
         LA    14,S4$08856               . 00883A 41E0 B038
         STM   11,14,104(12)             . 00883E 90BE C068
         LR    13,12                     . 008842 18DC
         LA    12,16(12)                 . 008844 41CC 0010
         C     12,@@STACKT               . 008848 59C0 A828
         BH    OVER                      . 00884C 4720 9664
         L     11,@@ARGVAL               . 008850 58B0 A914
         BR    11                        . 008854 07FB
S4$08856 STD   0,YCL                     . 008856 6000 A420
         B     FAIL                      . 00885A 47F0 9010
         LD    0,96(12)                  . 00885E 680C 0060
         STD   0,XCL                     . 008862 6000 A408
         SR    12,8                      . 008866 1BC8
         CLC   YCL$5(3),@@A              . 008868 D502 A425 AA6F
         BE    ARYAD3                    . 00886E 4780 B062
         CLC   YCL$5(3),@@T              . 008872 D502 A425 AA72
         BNE   NONARY                    . 008878 4770 965C
         BE    ASSCR                     . 00887C 4780 B1FE
                                                             SPACE
* ARYAD3 MOVD  WCL,XCL             Save copy of argument count
                                                             SPACE
ARYAD3   LD    0,XCL                     . 008880 6800 A408
         STD   0,WCL                     . 008884 6000 A3F8
                                                             SPACE
* ARYAD1 ACOMPC XCL,0,,ARYAD2,ARYAD2
*                                  Count down on arguments
*      PUSH    (XCL,WCL,YCL)       Save
*      RCALL   XPTR,INTVAL,,FAIL   Get index
*      POP     (YCL,WCL,XCL)       Restore saved descriptors
*      PUSH    XPTR                Save index
*      DECRA   XCL,1               Decrement argument count
*      BRANCH  ARYAD1
                                                             SPACE
ARYAD1   C     0,XCL                     . 008888 5900 A408
         BNL   ARYAD2                    . 00888C 47B0 B0F6
         LD    0,XCL                     . 008890 6800 A408
         STD   0,104(12)                 . 008894 600C 0068
         LD    0,WCL                     . 008898 6800 A3F8
         STD   0,112(12)                 . 00889C 600C 0070
         LD    0,YCL                     . 0088A0 6800 A420
         STD   0,120(12)                 . 0088A4 600C 0078
         LA    12,24(12)                 . 0088A8 41CC 0018
         C     12,@@STACKT               . 0088AC 59C0 A828
         BH    OVER                      . 0088B0 4720 9664
         LA    14,S4$088D0               . 0088B4 41E0 B0B2
         STM   11,14,104(12)             . 0088B8 90BE C068
         LR    13,12                     . 0088BC 18DC
         LA    12,16(12)                 . 0088BE 41CC 0010
         C     12,@@STACKT               . 0088C2 59C0 A828
         BH    OVER                      . 0088C6 4720 9664
         L     11,@@INTVAL               . 0088CA 58B0 A9E8
         BR    11                        . 0088CE 07FB
S4$088D0 STD   0,XPTR                    . 0088D0 6000 A410
S4$088D4 B     FAIL                      . 0088D4 47F0 9010
         LD    0,96(12)                  . 0088D8 680C 0060
         STD   0,YCL                     . 0088DC 6000 A420
         LD    0,88(12)                  . 0088E0 680C 0058
         STD   0,WCL                     . 0088E4 6000 A3F8
         LD    0,80(12)                  . 0088E8 680C 0050
         STD   0,XCL                     . 0088EC 6000 A408
         S     12,@@3MDESC               . 0088F0 5BC0 A860
         LD    0,XPTR                    . 0088F4 6800 A410
         STD   0,104(12)                 . 0088F8 600C 0068
         AR    12,8                      . 0088FC 1AC8
         C     12,@@STACKT               . 0088FE 59C0 A828
         BH    OVER                      . 008902 4720 9664
         L     1,XCL                     . 008906 5810 A408
         BCTR  1,0                            DECREMENT                *
                                         . 00890A 0610
         ST    1,XCL                     . 00890C 5010 A408
         B     ARYAD1                    . 008910 47F0 B06A
                                                             SPACE
* ARYAD2 MOVD  ZPTR,ZEROCL         Initialize offset to zero
*      GETDC   ZCL,YCL,2*DESCR     Get number of dimensions
*      MULTC   YPTR,ZCL,DESCR      Convert to addressing units
*      SUM     YPTR,YCL,YPTR       Add base and offset
*      INCRA   YPTR,2*DESCR        Add two for heading
                                                             SPACE
ARYAD2   LD    0,ZEROCL                  . 008914 6800 9C90
         STD   0,ZPTR                    . 008918 6000 A440
         L     1,YCL                     . 00891C 5810 A420
         LD    0,16(1)                   . 008920 6801 0010
         STD   0,ZCL                     . 008924 6000 A438
         LR    15,8                      . 008928 18F8
         M     14,ZCL                    . 00892A 5CE0 A438
         STM   15,0,YPTR                 . 00892E 90F0 A428
         LM    1,2,YCL                   . 008932 9812 A420
         AR    1,15                      . 008936 1A1F
         STM   1,2,YPTR                  . 008938 9012 A428
         LA    1,16(1)                   . 00893C 4111 0010
         ST    1,YPTR                    . 008940 5010 A428
                                                             SPACE
* ARYAD7 ACOMP WCL,ZCL,ARGNER,ARYAD9
*                                  Compare given and required number
*      PUSH    ZEROCL              If too few, supply a zero
*      INCRA   WCL,1               Increment and loop
*      BRANCH  ARYAD7
                                                             SPACE
ARYAD7   L     1,WCL                     . 008944 5810 A3F8
         C     1,ZCL                     . 008948 5910 A438
         BH    ARGNER                    . 00894C 4720 95A0
         BE    ARYAD9                    . 008950 4780 B154
         LD    0,ZEROCL                  . 008954 6800 9C90
         STD   0,104(12)                 . 008958 600C 0068
         AR    12,8                      . 00895C 1AC8
         C     12,@@STACKT               . 00895E 59C0 A828
         BH    OVER                      . 008962 4720 9664
         LA    1,1(1)                    . 008966 4111 0001
         ST    1,WCL                     . 00896A 5010 A3F8
         B     ARYAD7                    . 00896E 47F0 B126
                                                             SPACE
* ARYAD9 INCRA YCL,2*DESCR
*      GETDC   WPTR,YCL,DESCR      Get index pair
*      SETAV   TPTR,WPTR           Get extent of dimension
                                                             SPACE
ARYAD9   L     1,YCL                     . 008972 5810 A420
         LA    1,16(1)                   . 008976 4111 0010
         ST    1,YCL                     . 00897A 5010 A420
         LD    0,8(1)                    . 00897E 6801 0008
         STD   0,WPTR                    . 008982 6000 A400
         L     15,WPTR$4                 . 008986 58F0 A404
         LA    15,0(15)                  . 00898A 41FF 0000
         STM   15,0,TPTR                 . 00898E 90F0 A3D0
                                                             SPACE
* ARYA11 POP   XPTR                Get index value
*      SUBTRT  XPTR,XPTR,WPTR      Compute differnece from lower bound
*      ACOMPC  XPTR,0,,,FAIL       If less than zero, out of bounds
*      ACOMP   XPTR,TPTR,FAIL,FAIL If greater than extent, out of bound
*      SUM     XPTR,ZPTR,XPTR      Else add to evolving sum
*      DECRA   ZCL,1               Decrement dimension count
*      ACOMPC  ZCL,0,,ARYA12       Get out if done
*      INCRA   YCL,DESCR           Adjust bas pointer
*      GETDC   WPTR,YCL,DESCR      Get index pair
*      SETAV   TPTR,WPTR           Get extent of dimension
*      MULT    ZPTR,XPTR,TPTR      Multiply for next dimension
*      BRANCH  ARYA11              Continue with next dimension
                                                             SPACE
ARYA11   LD    0,96(12)                  . 008992 680C 0060
         STD   0,XPTR                    . 008996 6000 A410
         SR    12,8                      . 00899A 1BC8
         L     1,XPTR                    . 00899C 5810 A410
         S     1,WPTR                    . 0089A0 5B10 A400
         ST    1,XPTR                    . 0089A4 5010 A410
         CR    0,1                       . 0089A8 1901
         BH    FAIL                      . 0089AA 4720 9010
         C     1,TPTR                    . 0089AE 5910 A3D0
         BNL   FAIL                      . 0089B2 47B0 9010
         LM    1,2,ZPTR                  . 0089B6 9812 A440
         A     1,XPTR                    . 0089BA 5A10 A410
         STM   1,2,XPTR                  . 0089BE 9012 A410
         L     1,ZCL                     . 0089C2 5810 A438
         BCTR  1,0                            DECREMENT                *
                                         . 0089C6 0610
         ST    1,ZCL                     . 0089C8 5010 A438
         CR    0,1                       . 0089CC 1901
         BE    ARYA12                    . 0089CE 4780 B1E0
         L     1,YCL                     . 0089D2 5810 A420
         AR    1,8                       . 0089D6 1A18
         ST    1,YCL                     . 0089D8 5010 A420
         LD    0,8(1)                    . 0089DC 6801 0008
         STD   0,WPTR                    . 0089E0 6000 A400
         L     15,WPTR$4                 . 0089E4 58F0 A404
         LA    15,0(15)                  . 0089E8 41FF 0000
         STM   15,0,TPTR                 . 0089EC 90F0 A3D0
         LM    3,4,XPTR                  . 0089F0 9834 A410
         MR    2,15                      . 0089F4 1C2F
         STM   3,4,ZPTR                  . 0089F6 9034 A440
         B     ARYA11                    . 0089FA 47F0 B174
                                                             SPACE
* ARYA12 MULTC XPTR,XPTR,DESCR     Expand offset into addressing units
*      SUM     XPTR,YPTR,XPTR      Add to adjusted base
                                                             SPACE
ARYA12   LR    15,8                      . 0089FE 18F8
         M     14,XPTR                   . 008A00 5CE0 A410
         STM   15,0,XPTR                 . 008A04 90F0 A410
         LM    1,2,YPTR                  . 008A08 9812 A428
         AR    1,15                      . 008A0C 1A1F
         STM   1,2,XPTR                  . 008A0E 9012 A410
                                                             SPACE
* ARYA10 SETVC XPTR,N              Insert NAME data type
*      BRANCH  RTXNAM              Return interior pointer
                                                             SPACE
ARYA10   MVC   XPTR$5(3),@@N             . 008A12 D202 A415 AA8D
         B     RTXNAM                    . 008A18 47F0 9038
                                                             SPACE
* ASSCR AEQLC  XCL,1,ARGNER        Only one argument for tables
*      PUSH    YCL                 Save pointer to object
*      RCALL   YPTR,ARGVAL,,FAIL   Evaluate argument
*      POP     XPTR                                             E3.2.3
                                                             SPACE
ASSCR    LA    6,1                       . 008A1C 4160 0001
         C     6,XCL                     . 008A20 5960 A408
         BNE   ARGNER                    . 008A24 4770 95A0
         LD    0,YCL                     . 008A28 6800 A420
         STD   0,104(12)                 . 008A2C 600C 0068
         AR    12,8                      . 008A30 1AC8
         C     12,@@STACKT               . 008A32 59C0 A828
         BH    OVER                      . 008A36 4720 9664
         LA    14,S4$08A56               . 008A3A 41E0 B238
         STM   11,14,104(12)             . 008A3E 90BE C068
         LR    13,12                     . 008A42 18DC
         LA    12,16(12)                 . 008A44 41CC 0010
         C     12,@@STACKT               . 008A48 59C0 A828
         BH    OVER                      . 008A4C 4720 9664
         L     11,@@ARGVAL               . 008A50 58B0 A914
         BR    11                        . 008A54 07FB
S4$08A56 STD   0,YPTR                    . 008A56 6000 A428
         B     FAIL                      . 008A5A 47F0 9010
         LD    0,96(12)                  . 008A5E 680C 0060
         STD   0,XPTR                    . 008A62 6000 A410
         SR    12,8                      . 008A66 1BC8
                                                             SPACE
* ASSCR5 LOCAPV WPTR,XPTR,YPTR,,ASSCR4                          E3.2.3
*      LOCAPV  WPTR,XPTR,ZEROCL,ASSCR2
*                                  Look for item with null value
                                                             SPACE
ASSCR5   L     15,XPTR                   . 008A68 58F0 A410
         L     5,4(15)                   . 008A6C 585F 0004
         LA    5,0(5,15)                 . 008A70 4155 F000
         LR    4,8                       . 008A74 1848
         SR    5,4                       . 008A76 1B54
         AR    4,8                       . 008A78 1A48
         LR    3,15                      . 008A7A 183F
         LR    2,5                       . 008A7C 1825
         LR    1,4                       . 008A7E 1814
S4$08A80 CLC   16(8,15),YPTR             . 008A80 D507 F010 A428
         BE    S4$08A92                  . 008A86 4780 B274
         BXLE  15,4,S4$08A80             . 008A8A 87F4 B262
         B     S4$08A9A                  . 008A8E 47F0 B27C
S4$08A92 STM   15,0,WPTR                 . 008A92 90F0 A400
         B     ASSCR4                    . 008A96 47F0 B298
S4$08A9A LR    15,3                      . 008A9A 18F3
         LR    5,2                       . 008A9C 1852
         LR    4,1                       . 008A9E 1841
S4$08AA0 CLC   16(8,15),ZEROCL           . 008AA0 D507 F010 9C90
         BE    S4$08AB2                  . 008AA6 4780 B294
         BXLE  15,4,S4$08AA0             . 008AAA 87F4 B282
         B     ASSCR2                    . 008AAE 47F0 B2A8
S4$08AB2 STM   15,0,WPTR                 . 008AB2 90F0 A400
                                                             SPACE
* ASSCR4 MOVA  XPTR,WPTR
*      PUTDC   XPTR,2*DESCR,YPTR                                E3.2.3
*      BRANCH  ARYA10              Join array reference exit
                                                             SPACE
ASSCR4   ST    15,XPTR                   . 008AB6 50F0 A410
         LD    0,YPTR                    . 008ABA 6800 A428
         STD   0,16(15)                  . 008ABE 600F 0010
         B     ARYA10                    . 008AC2 47F0 B1F4
                                                             SPACE
* ASSCR2 GETSIZ TCL,XPTR                                        E3.2.3
*      GETD    ZPTR,XPTR,TCL                                    E3.2.3
*      AEQLC   ZPTR,1,,ASSCR3                                   E3.2.3
*      MOVD    XPTR,ZPTR                                        E3.2.3
*      BRANCH  ASSCR5                                           E3.2.3
                                                             SPACE
ASSCR2   L     15,4(3)                   . 008AC6 58F3 0004
         LA    15,0(15)                  . 008ACA 41FF 0000
         STM   15,0,TCL                  . 008ACE 90F0 A3D8
         LD    0,0(15,3)                 . 008AD2 680F 3000
         STD   0,ZPTR                    . 008AD6 6000 A440
         LA    6,1                       . 008ADA 4160 0001
         C     6,ZPTR                    . 008ADE 5960 A440
         BE    ASSCR3                    . 008AE2 4780 B2D0
         STD   0,XPTR                    . 008AE6 6000 A410
         B     ASSCR5                    . 008AEA 47F0 B24A
                                                             SPACE
* ASSCR3 DECRA TCL,DESCR                                        E3.2.3
*      GETD    WPTR,XPTR,TCL                                    E3.2.3
*      PUSH    (XPTR,TCL,YPTR)                                  E3.2.3
*      MOVD    XPTR,WPTR                                        E3.2.3
*      RCALL   ZPTR,ASSOCE,,(INTR10,INTR10)                     E3.2.3
*      POP     (YPTR,TCL,XPTR)                                  E3.2.3
*      SETVC   ZPTR,B                                           E3.2.3
*      INCRA   TCL,DESCR                                        E3.2.3
*      PUTD    XPTR,TCL,ZPTR                                    E3.2.3
*      PUTDC   ZPTR,2*DESCR,YPTR                                E3.2.3
*      MOVD    XPTR,ZPTR                                        E3.2.3
*      BRANCH  ARYA10                                           E3.2.3
ASSCR3   LM    1,2,TCL                   . 008AEE 9812 A3D8
         SR    1,8                       . 008AF2 1B18
         ST    1,TCL                     . 008AF4 5010 A3D8
         L     3,XPTR                    . 008AF8 5830 A410
         LD    0,0(1,3)                  . 008AFC 6801 3000
         STD   0,WPTR                    . 008B00 6000 A400
         LD    2,XPTR                    . 008B04 6820 A410
         STD   2,104(12)                 . 008B08 602C 0068
         STM   1,2,112(12)               . 008B0C 9012 C070
         LD    2,YPTR                    . 008B10 6820 A428
         STD   2,120(12)                 . 008B14 602C 0078
         LA    12,24(12)                 . 008B18 41CC 0018
         C     12,@@STACKT               . 008B1C 59C0 A828
         BH    OVER                      . 008B20 4720 9664
         STD   0,XPTR                    . 008B24 6000 A410
         LA    14,S4$08B46               . 008B28 41E0 B328
         STM   11,14,104(12)             . 008B2C 90BE C068
         LR    13,12                     . 008B30 18DC
         LA    12,16(12)                 . 008B32 41CC 0010
         C     12,@@STACKT               . 008B36 59C0 A828
         BH    OVER                      . 008B3A 4720 9664
         L     11,ASSCFN                 . 008B3E 58B0 AAF8
         B     S4$088D4                  . 008B42 47F0 B0B6
S4$08B46 STD   0,ZPTR                    . 008B46 6000 A440
         B     S4$010                    . 008B4A 47F0 95AC
         B     S4$010                    . 008B4E 47F0 95AC
         LD    0,96(12)                  . 008B52 680C 0060
         STD   0,YPTR                    . 008B56 6000 A428
         LD    0,88(12)                  . 008B5A 680C 0058
         STD   0,TCL                     . 008B5E 6000 A3D8
         LD    0,80(12)                  . 008B62 680C 0050
         STD   0,XPTR                    . 008B66 6000 A410
         L     12,@@3MDESC               . 008B6A 58C0 A860
         MVC   ZPTR$5(3),@@B             . 008B6E D202 A445 AA6C
         L     1,TCL                     . 008B74 5810 A3D8
         AR    1,8                       . 008B78 1A18
         ST    1,TCL                     . 008B7A 5010 A3D8
         L     2,XPTR                    . 008B7E 5820 A410
         LD    0,ZPTR                    . 008B82 6800 A440
         STD   0,0(1,2)                  . 008B86 6001 2000
         L     1,ZPTR                    . 008B8A 5810 A440
         LD    2,YPTR                    . 008B8E 6820 A428
         STD   2,16(1)                   . 008B92 6021 0010
         STD   0,XPTR                    . 008B96 6000 A410
         B     ARYA10                    . 008B9A 47F0 B1F4
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Defined Object Creation
*
                                                             SPACE
* DEFDAT PROC  ,                   Procedure to create defined objects
*      SETAV   XCL,INCL            Get given number of arguments
*      MOVD    WCL,XCL             Save a copy
*      MOVD    YCL,INCL            Save function descriptor
*      PSTACK  YPTR                Post stack position
                                                             SPACE
         USING DEFDAT,11                 .
DEFDAT   L     15,INCL$4                 . 008B9E 58F0 9E9C
         LA    15,0(15)                  . 008BA2 41FF 0000
         STM   15,0,XCL                  . 008BA6 90F0 A408
         LD    0,XCL                     . 008BAA 6800 A408
         STD   0,WCL                     . 008BAE 6000 A3F8
         LD    0,INCL                    . 008BB2 6800 9E98
         STD   0,YCL                     . 008BB6 6000 A420
         LA    15,88(12)                 . 008BBA 41FC 0058
         STM   15,0,YPTR                 . 008BBE 90F0 A428
                                                             SPACE
* DEFD1 INCRA  OCICL,DESCR         Increment offset
*      GETD    XPTR,OCBSCL,OCICL   Get object code descriptor
*      TESTF   XPTR,FNC,,DEFDC     Check for function
                                                             SPACE
DEFD1    L     1,OCICL                   . 008BC2 5810 9ED8
         AR    1,8                       . 008BC6 1A18
         ST    1,OCICL                   . 008BC8 5010 9ED8
         L     2,OCBSCL                  . 008BCC 5820 A470
         LD    0,0(1,2)                  . 008BD0 6801 2000
         STD   0,XPTR                    . 008BD4 6000 A410
         TM    XPTR$4,X'04'              . 008BD8 9104 A414
         BO    DEFDC                     . 008BDC 4710 B1D6
                                                             SPACE
* DEFD2 AEQLC  INSW,0,,DEFD8       Check &INPUT
*      LOCAPV  ZPTR,INATL,XPTR,DEFD8
*                                  Look for input association
*      GETDC   ZPTR,ZPTR,DESCR     Get association
*      PUSH    (XCL,WCL,YCL,YPTR)  Save relevant descriptors
*      RCALL   XPTR,PUTIN,(ZPTR,XPTR),FAIL
*      POP     (YPTR,YCL,WCL,XCL)  Restore relevant descriptors
*      BRANCH  DEFD3               Join main processing
                                                             SPACE
DEFD2    C     0,INSW                    . 008BE0 5900 9858
         BE    DEFD8                     . 008BE4 4780 B0FA
         L     15,INATL                  . 008BE8 58F0 A300
         L     5,4(15)                   . 008BEC 585F 0004
         LA    5,0(5,15)                 . 008BF0 4155 F000
         LR    4,8                       . 008BF4 1848
         SR    5,4                       . 008BF6 1B54
         AR    4,8                       . 008BF8 1A48
S4$08BFA CLC   16(8,15),XPTR             . 008BFA D507 F010 A410
         BE    S4$08C0C                  . 008C00 4780 B06E
         BXLE  15,4,S4$08BFA             . 008C04 87F4 B05C
         B     DEFD8                     . 008C08 47F0 B0FA
S4$08C0C LM    1,2,8(15)                 . 008C0C 9812 F008
         STM   1,2,ZPTR                  . 008C10 9012 A440
         LD    0,XCL                     . 008C14 6800 A408
         STD   0,104(12)                 . 008C18 600C 0068
         LD    0,WCL                     . 008C1C 6800 A3F8
         STD   0,112(12)                 . 008C20 600C 0070
         LD    0,YCL                     . 008C24 6800 A420
         STD   0,120(12)                 . 008C28 600C 0078
         LD    0,YPTR                    . 008C2C 6800 A428
         STD   0,128(12)                 . 008C30 600C 0080
         LA    12,32(12)                 . 008C34 41CC 0020
         C     12,@@STACKT               . 008C38 59C0 A828
         BH    OVER                      . 008C3C 4720 9664
         LA    14,S4$08C68               . 008C40 41E0 B0CA
         STM   11,14,104(12)             . 008C44 90BE C068
         LR    13,12                     . 008C48 18DC
         STM   1,2,128(12)               . 008C4A 9012 C080
         LD    0,XPTR                    . 008C4E 6800 A410
         STD   0,120(12)                 . 008C52 600C 0078
         LA    12,32(12)                 . 008C56 41CC 0020
         C     12,@@STACKT               . 008C5A 59C0 A828
         BH    OVER                      . 008C5E 4720 9664
         L     11,@@PUTIN                . 008C62 58B0 A920
         BR    11                        . 008C66 07FB
S4$08C68 STD   0,XPTR                    . 008C68 6000 A410
         B     FAIL                      . 008C6C 47F0 9010
         LD    0,96(12)                  . 008C70 680C 0060
         STD   0,YPTR                    . 008C74 6000 A428
         LD    0,88(12)                  . 008C78 680C 0058
         STD   0,YCL                     . 008C7C 6000 A420
         LD    0,80(12)                  . 008C80 680C 0050
         STD   0,WCL                     . 008C84 6000 A3F8
         LD    0,72(12)                  . 008C88 680C 0048
         STD   0,XCL                     . 008C8C 6000 A408
         S     12,@@2M16                 . 008C90 5BC0 A9C8
         B     DEFD3                     . 008C94 47F0 B106
                                                             SPACE
* DEFD8 GETDC  XPTR,XPTR,DESCR     Get value
                                                             SPACE
DEFD8    L     1,XPTR                    . 008C98 5810 A410
         LD    0,8(1)                    . 008C9C 6801 0008
         STD   0,XPTR                    . 008CA0 6000 A410
                                                             SPACE
* DEFD3 PUSH   XPTR                Save value
*      DECRA   XCL,1               Decrement argument count
*      ACOMPC  XCL,0,DEFD1,,INTR10 Check for end
*      GETDC   XCL,YCL,0           Get procedure descriptor
*      SETAV   XCL,XCL             Get number of arguments expected
                                                             SPACE
DEFD3    LD    0,XPTR                    . 008CA4 6800 A410
         STD   0,104(12)                 . 008CA8 600C 0068
         AR    12,8                      . 008CAC 1AC8
         C     12,@@STACKT               . 008CAE 59C0 A828
         BH    OVER                      . 008CB2 4720 9664
         L     1,XCL                     . 008CB6 5810 A408
         BCTR  1,0                            DECREMENT                *
                                         . 008CBA 0610
         ST    1,XCL                     . 008CBC 5010 A408
         CR    0,1                       . 008CC0 1901
         BL    DEFD1                     . 008CC2 4740 B024
         BH    S4$010                    . 008CC6 4720 95AC
         L     1,YCL                     . 008CCA 5810 A420
         LD    0,0(1)                    . 008CCE 6801 0000
         STD   0,XCL                     . 008CD2 6000 A408
         L     15,XCL$4                  . 008CD6 58F0 A40C
         LA    15,0(15)                  . 008CDA 41FF 0000
         STM   15,0,XCL                  . 008CDE 90F0 A408
                                                             SPACE
* DEFD4 ACOMP  WCL,XCL,DEFD5,DEFD5 Compare given with expected
*      PUSH    NULVCL              Save null for omitted argument
*      INCRA   WCL,1               Increment count
*      BRANCH  DEFD4               Continue
                                                             SPACE
DEFD4    L     1,WCL                     . 008CE2 5810 A3F8
         C     1,XCL                     . 008CE6 5910 A408
         BNL   DEFD5                     . 008CEA 47B0 B16E
         LD    0,NULVCL                  . 008CEE 6800 9ED0
         STD   0,104(12)                 . 008CF2 600C 0068
         AR    12,8                      . 008CF6 1AC8
         C     12,@@STACKT               . 008CF8 59C0 A828
         BH    OVER                      . 008CFC 4720 9664
         LA    1,1(1)                    . 008D00 4111 0001
         ST    1,WCL                     . 008D04 5010 A3F8
         B     DEFD4                     . 008D08 47F0 B144
                                                             SPACE
* DEFD5 GETDC  WCL,YCL,DESCR       Get definition block
*      MULTC   XCL,XCL,DESCR
*      MOVV    XCL,WCL             Insert data type code
*      RCALL   ZPTR,BLOCK,XCL      Allocate block for data object
*      INCRA   YPTR,DESCR          Adjust stack position
*      MOVBLK  ZPTR,YPTR,XCL       Move values into block
*      BRANCH  RTZPTR              Return new object
                                                             SPACE
DEFD5    L     1,YCL                     . 008D0C 5810 A420
         LD    0,8(1)                    . 008D10 6801 0008
         STD   0,WCL                     . 008D14 6000 A3F8
         L     1,XCL                     . 008D18 5810 A408
         SLA   1,3                       . 008D1C 8B10 0003
         ST    1,XCL                     . 008D20 5010 A408
         MVC   XCL$5(3),WCL$5            . 008D24 D202 A40D A3FD
         LA    14,S4$08D4E               . 008D2A 41E0 B1B0
         STM   11,14,104(12)             . 008D2E 90BE C068
         LR    13,12                     . 008D32 18DC
         LD    0,XCL                     . 008D34 6800 A408
         STD   0,120(12)                 . 008D38 600C 0078
         LA    12,24(12)                 . 008D3C 41CC 0018
         C     12,@@STACKT               . 008D40 59C0 A828
         BH    OVER                      . 008D44 4720 9664
         L     11,@@BLOCK                . 008D48 58B0 A82C
         BR    11                        . 008D4C 07FB
S4$08D4E STD   0,ZPTR                    . 008D4E 6000 A440
         L     1,YPTR                    . 008D52 5810 A428
         AR    1,8                       . 008D56 1A18
         ST    1,YPTR                    . 008D58 5010 A428
         L     6,ZPTR                    . 008D5C 5860 A440
         LR    4,1                       . 008D60 1841
         AR    4,8                       . 008D62 1A48
         AR    6,8                       . 008D64 1A68
         L     3,XCL                     . 008D66 5830 A408
         L     15,@@MOVTST               . 008D6A 58F0 A864
         BALR  14,15                          CALL                     *
                                         . 008D6E 05EF
         B     RTZPTR                    . 008D70 47F0 9074
                                                             SPACE
* DEFDC PUSH   (XCL,WCL,YCL,YPTR)  Save relevant descriptors
*      RCALL   XPTR,INVOKE,(XPTR),(FAIL,DEFDN)
*      POP     (YPTR,YCL,WCL,XCL)  Restore relevant descriptors
*      BRANCH  DEFD3               Join main processing
                                                             SPACE
DEFDC    LD    0,XCL                     . 008D74 6800 A408
         STD   0,104(12)                 . 008D78 600C 0068
         LD    0,WCL                     . 008D7C 6800 A3F8
         STD   0,112(12)                 . 008D80 600C 0070
         LD    0,YCL                     . 008D84 6800 A420
         STD   0,120(12)                 . 008D88 600C 0078
         LD    0,YPTR                    . 008D8C 6800 A428
         STD   0,128(12)                 . 008D90 600C 0080
         LA    12,32(12)                 . 008D94 41CC 0020
         C     12,@@STACKT               . 008D98 59C0 A828
         BH    OVER                      . 008D9C 4720 9664
         LA    14,S4$08DC4               . 008DA0 41E0 B226
         STM   11,14,104(12)             . 008DA4 90BE C068
         LR    13,12                     . 008DA8 18DC
         LD    0,XPTR                    . 008DAA 6800 A410
         STD   0,120(12)                 . 008DAE 600C 0078
         LA    12,24(12)                 . 008DB2 41CC 0018
         C     12,@@STACKT               . 008DB6 59C0 A828
         BH    OVER                      . 008DBA 4720 9664
         L     11,@@INVOKE               . 008DBE 58B0 A91C
         BR    11                        . 008DC2 07FB
S4$08DC4 STD   0,XPTR                    . 008DC4 6000 A410
         B     FAIL                      . 008DC8 47F0 9010
         B     DEFDN                     . 008DCC 47F0 B25A
         LD    0,96(12)                  . 008DD0 680C 0060
         STD   0,YPTR                    . 008DD4 6000 A428
         LD    0,88(12)                  . 008DD8 680C 0058
         STD   0,YCL                     . 008DDC 6000 A420
         LD    0,80(12)                  . 008DE0 680C 0050
         STD   0,WCL                     . 008DE4 6000 A3F8
         LD    0,72(12)                  . 008DE8 680C 0048
         STD   0,XCL                     . 008DEC 6000 A408
         S     12,@@2M16                 . 008DF0 5BC0 A9C8
         B     DEFD3                     . 008DF4 47F0 B106
                                                             SPACE
* DEFDN POP    (YPTR,YCL,WCL,XCL)  Restore relevant descriptors
*      BRANCH  DEFD2               Join main processing
DEFDN    LD    0,96(12)                  . 008DF8 680C 0060
         STD   0,YPTR                    . 008DFC 6000 A428
         LD    0,88(12)                  . 008E00 680C 0058
         STD   0,YCL                     . 008E04 6000 A420
         LD    0,80(12)                  . 008E08 680C 0050
         STD   0,WCL                     . 008E0C 6000 A3F8
         LD    0,72(12)                  . 008E10 680C 0048
         STD   0,XCL                     . 008E14 6000 A408
         S     12,@@2M16                 . 008E18 5BC0 A9C8
         B     DEFD2                     . 008E1C 47F0 B042
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Fields of Defined Data Objects
*
                                                             SPACE
* FIELD PROC   ,                   Field function procedure
*      PUSH    INCL                Save function descriptor
*      RCALL   XPTR,ARGVAL,,FAIL   Get value
*      DEQL    XPTR,NULVCL,,NONAME Check for null value
*      POP     YCL                 Restore function descriptor
*      VEQLC   XPTR,I,FIELD1       Check for INTEGER
*      RCALL   XPTR,GNVARI,XPTR    Convert INTEGER to STRING
                                                             SPACE
         USING FIELD,11                  .
FIELD    LD    0,INCL                    . 008E20 6800 9E98
         STD   0,104(12)                 . 008E24 600C 0068
         AR    12,8                      . 008E28 1AC8
         C     12,@@STACKT               . 008E2A 59C0 A828
         BH    OVER                      . 008E2E 4720 9664
         LA    14,S4$08E4E               . 008E32 41E0 B02E
         STM   11,14,104(12)             . 008E36 90BE C068
         LR    13,12                     . 008E3A 18DC
         LA    12,16(12)                 . 008E3C 41CC 0010
         C     12,@@STACKT               . 008E40 59C0 A828
         BH    OVER                      . 008E44 4720 9664
         L     11,@@ARGVAL               . 008E48 58B0 A914
         BR    11                        . 008E4C 07FB
S4$08E4E STD   0,XPTR                    . 008E4E 6000 A410
         B     FAIL                      . 008E52 47F0 9010
         CLC   XPTR(8),NULVCL            . 008E56 D507 A410 9ED0
         BE    NONAME                    . 008E5C 4780 9654
         LD    0,96(12)                  . 008E60 680C 0060
         STD   0,YCL                     . 008E64 6000 A420
         SR    12,8                      . 008E68 1BC8
         CLC   XPTR$5(3),@@I             . 008E6A D502 A415 AA84
         BNE   FIELD1                    . 008E70 4770 B07C
         LA    14,S4$08E98               . 008E74 41E0 B078
         STM   11,14,104(12)             . 008E78 90BE C068
         LR    13,12                     . 008E7C 18DC
         LD    0,XPTR                    . 008E7E 6800 A410
         STD   0,120(12)                 . 008E82 600C 0078
         LA    12,24(12)                 . 008E86 41CC 0018
         C     12,@@STACKT               . 008E8A 59C0 A828
         BH    OVER                      . 008E8E 4720 9664
         L     11,@@GNVARI               . 008E92 58B0 A94C
         BR    11                        . 008E96 07FB
S4$08E98 STD   0,XPTR                    . 008E98 6000 A410
                                                             SPACE
* FIELD1 MOVV  DT1CL,XPTR          Set up data type
*      GETDC   YPTR,YCL,DESCR      Get definition block
*      LOCAPT  ZCL,YPTR,DT1CL,INTR1
*                                  Look for data type offset
*      GETDC   ZCL,ZCL,2*DESCR     Get offset
*      SUM     XPTR,XPTR,ZCL       Compute field position
*      SETVC   XPTR,N              Insert NAME data type
*      BRANCH  RTXNAM              Return name
FIELD1   MVC   DT1CL$5(3),XPTR$5         . 008E9C D202 9E4D A415
         L     1,YCL                     . 008EA2 5810 A420
         LD    0,8(1)                    . 008EA6 6801 0008
         STD   0,YPTR                    . 008EAA 6000 A428
         L     15,YPTR                   . 008EAE 58F0 A428
         L     5,4(15)                   . 008EB2 585F 0004
         LA    5,0(5,15)                 . 008EB6 4155 F000
         LR    4,8                       . 008EBA 1848
         SR    5,4                       . 008EBC 1B54
         AR    4,8                       . 008EBE 1A48
S4$08EC0 CLC   8(8,15),DT1CL             . 008EC0 D507 F008 9E48
         BE    S4$08ED2                  . 008EC6 4780 B0B2
         BXLE  15,4,S4$08EC0             . 008ECA 87F4 B0A0
         B     INTR1                     . 008ECE 47F0 95FC
S4$08ED2 LD    0,16(15)                  . 008ED2 680F 0010
         STD   0,ZCL                     . 008ED6 6000 A438
         L     1,XPTR                    . 008EDA 5810 A410
         A     1,ZCL                     . 008EDE 5A10 A438
         ST    1,XPTR                    . 008EE2 5010 A410
         MVC   XPTR$5(3),@@N             . 008EE6 D202 A415 AA8D
         B     RTXNAM                    . 008EEC 47F0 9038
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Input and Output'
*
*      INPUT(V,U,L)
*
                                                             SPACE
* READ PROC    ,                   INPUT(V,U,L)
*      RCALL   XPTR,IND,,FAIL      Get variable
*      PUSH    XPTR                Save variable
*      RCALL   YPTR,INTVAL,,FAIL   Get unit
*      PUSH    YPTR                Save unit
*      RCALL   ZPTR,INTVAL,,FAIL   Get length
*      POP     (YPTR,XPTR)         Restore unit and variable
*      ACOMPC  YPTR,0,,READ5,UNTERR
*                                  Check for defaulted unit
                                                             SPACE
         USING READ,11                   .
READ     LA    14,S4$08F0C               . 008EF0 41E0 B01C
         STM   11,14,104(12)             . 008EF4 90BE C068
         LR    13,12                     . 008EF8 18DC
         LA    12,16(12)                 . 008EFA 41CC 0010
         C     12,@@STACKT               . 008EFE 59C0 A828
         BH    OVER                      . 008F02 4720 9664
         L     11,@@IND                  . 008F06 58B0 A9F0
         BR    11                        . 008F0A 07FB
S4$08F0C STD   0,XPTR                    . 008F0C 6000 A410
         B     FAIL                      . 008F10 47F0 9010
         LD    0,XPTR                    . 008F14 6800 A410
         STD   0,104(12)                 . 008F18 600C 0068
         AR    12,8                      . 008F1C 1AC8
         C     12,@@STACKT               . 008F1E 59C0 A828
         BH    OVER                      . 008F22 4720 9664
         LA    14,S4$08F42               . 008F26 41E0 B052
         STM   11,14,104(12)             . 008F2A 90BE C068
         LR    13,12                     . 008F2E 18DC
         LA    12,16(12)                 . 008F30 41CC 0010
         C     12,@@STACKT               . 008F34 59C0 A828
         BH    OVER                      . 008F38 4720 9664
         L     11,@@INTVAL               . 008F3C 58B0 A9E8
         BR    11                        . 008F40 07FB
S4$08F42 STD   0,YPTR                    . 008F42 6000 A428
         B     FAIL                      . 008F46 47F0 9010
         LD    0,YPTR                    . 008F4A 6800 A428
         STD   0,104(12)                 . 008F4E 600C 0068
         AR    12,8                      . 008F52 1AC8
         C     12,@@STACKT               . 008F54 59C0 A828
         BH    OVER                      . 008F58 4720 9664
         LA    14,S4$08F78               . 008F5C 41E0 B088
         STM   11,14,104(12)             . 008F60 90BE C068
         LR    13,12                     . 008F64 18DC
         LA    12,16(12)                 . 008F66 41CC 0010
         C     12,@@STACKT               . 008F6A 59C0 A828
         BH    OVER                      . 008F6E 4720 9664
         L     11,@@INTVAL               . 008F72 58B0 A9E8
         BR    11                        . 008F76 07FB
S4$08F78 STD   0,ZPTR                    . 008F78 6000 A440
         B     FAIL                      . 008F7C 47F0 9010
         LD    0,96(12)                  . 008F80 680C 0060
         STD   0,YPTR                    . 008F84 6000 A428
         LD    0,88(12)                  . 008F88 680C 0058
         STD   0,XPTR                    . 008F8C 6000 A410
         SR    12,8                      . 008F90 1BC8
         SR    12,8                      . 008F92 1BC8
         C     0,YPTR                    . 008F94 5900 A428
         BE    READ5                     . 008F98 4780 B19C
         BH    UNTERR                    . 008F9C 4720 96B4
                                                             SPACE
* READ6 ACOMPC ZPTR,0,READ2,,LENERR
*                                  Check for defaulted length
*      LOCAPT  TPTR,INSATL,YPTR,READ4
*                                  Look for default length
                                                             SPACE
READ6    C     0,ZPTR                    . 008FA0 5900 A440
         BL    READ2                     . 008FA4 4740 B15C
         BH    LENERR                    . 008FA8 4720 963C
         L     15,INSATL                 . 008FAC 58F0 9A38
         L     5,4(15)                   . 008FB0 585F 0004
         LA    5,0(5,15)                 . 008FB4 4155 F000
         LR    4,8                       . 008FB8 1848
         SR    5,4                       . 008FBA 1B54
         AR    4,8                       . 008FBC 1A48
S4$08FBE CLC   8(8,15),YPTR              . 008FBE D507 F008 A428
         BE    S4$08FD0                  . 008FC4 4780 B0E0
         BXLE  15,4,S4$08FBE             . 008FC8 87F4 B0CE
         B     READ4                     . 008FCC 47F0 B154
S4$08FD0 STM   15,0,TPTR                 . 008FD0 90F0 A3D0
                                                             SPACE
* READ3 LOCAPV ZPTR,INATL,XPTR,READ1
*                                  Look for existing association
*      PUTDC   ZPTR,DESCR,TPTR     Inset input block
*      BRANCH  RETNUL              Return
                                                             SPACE
READ3    L     15,INATL                  . 008FD4 58F0 A300
         L     5,4(15)                   . 008FD8 585F 0004
         LA    5,0(5,15)                 . 008FDC 4155 F000
         LR    4,8                       . 008FE0 1848
         SR    5,4                       . 008FE2 1B54
         AR    4,8                       . 008FE4 1A48
S4$08FE6 CLC   16(8,15),XPTR             . 008FE6 D507 F010 A410
         BE    S4$08FF8                  . 008FEC 4780 B108
         BXLE  15,4,S4$08FE6             . 008FF0 87F4 B0F6
         B     READ1                     . 008FF4 47F0 B118
S4$08FF8 STM   15,0,ZPTR                 . 008FF8 90F0 A440
         LD    0,TPTR                    . 008FFC 6800 A3D0
         STD   0,8(15)                   . 009000 600F 0008
         B     RETNUL                    . 009004 47F0 9018
                                                             SPACE
* READ1 RCALL  INATL,AUGATL,(INATL,TPTR,XPTR),RETNUL
                                                             SPACE
READ1    LA    14,S4$0903C               . 009008 41E0 B14C
         STM   11,14,104(12)             . 00900C 90BE C068
         LR    13,12                     . 009010 18DC
         LD    0,INATL                   . 009012 6800 A300
         STD   0,136(12)                 . 009016 600C 0088
         LD    0,TPTR                    . 00901A 6800 A3D0
         STD   0,128(12)                 . 00901E 600C 0080
         LD    0,XPTR                    . 009022 6800 A410
         STD   0,120(12)                 . 009026 600C 0078
         LA    12,40(12)                 . 00902A 41CC 0028
         C     12,@@STACKT               . 00902E 59C0 A828
         BH    OVER                      . 009032 4720 9664
         L     11,@@AUGATL               . 009036 58B0 A878
         BR    11                        . 00903A 07FB
S4$0903C STD   0,INATL                   . 00903C 6000 A300
         B     RETNUL                    . 009040 47F0 9018
                                                             SPACE
* READ4 MOVD   ZPTR,DFLSIZ         Set standard default
                                                             SPACE
READ4    LD    0,DFLSIZ                  . 009044 6800 9A48
         STD   0,ZPTR                    . 009048 6000 A440
                                                             SPACE
* READ2 RCALL  TPTR,BLOCK,IOBLSZ   Allocate block
*      PUTDC   TPTR,DESCR,YPTR     Insert unit
*      PUTDC   TPTR,2*DESCR,ZPTR   Insert format
*      BRANCH  READ3               Rejoin processing
                                                             SPACE
READ2    LA    14,S4$09070               . 00904C 41E0 B180
         STM   11,14,104(12)             . 009050 90BE C068
         LR    13,12                     . 009054 18DC
         LD    0,IOBLSZ                  . 009056 6800 9C40
         STD   0,120(12)                 . 00905A 600C 0078
         LA    12,24(12)                 . 00905E 41CC 0018
         C     12,@@STACKT               . 009062 59C0 A828
         BH    OVER                      . 009066 4720 9664
         L     11,@@BLOCK                . 00906A 58B0 A82C
         BR    11                        . 00906E 07FB
S4$09070 STD   0,TPTR                    . 009070 6000 A3D0
         L     1,TPTR                    . 009074 5810 A3D0
         LD    0,YPTR                    . 009078 6800 A428
         STD   0,8(1)                    . 00907C 6001 0008
         LD    0,ZPTR                    . 009080 6800 A440
         STD   0,16(1)                   . 009084 6001 0010
         B     READ3                     . 009088 47F0 B0E4
                                                             SPACE
* READ5 SETAC  YPTR,UNITI          Set up default unit
*      BRANCH  READ6               Join processing
READ5    L     1,@@UNITI                 . 00908C 5810 A9F4
         ST    1,YPTR                    . 009090 5010 A428
         B     READ6                     . 009094 47F0 B0B0
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      OUTPUT(V,U,F)
*
                                                             SPACE
* PRINT PROC   ,                   OUTPUT(V,U,F)
*      RCALL   XPTR,IND,,FAIL      Get variable
*      PUSH    XPTR                Save variable
*      RCALL   YPTR,INTVAL,,FAIL   Get unit
*      PUSH    YPTR                Save unit
*      RCALL   ZPTR,VARVAL,,FAIL   Get format
*      POP     (YPTR,XPTR)         Restore unit and variable
*      ACOMPC  YPTR,0,,PRINT5,UNTERR
                                                             SPACE
         USING PRINT,11                  .
PRINT    LA    14,S4$090B4               . 009098 41E0 B01C
         STM   11,14,104(12)             . 00909C 90BE C068
         LR    13,12                     . 0090A0 18DC
         LA    12,16(12)                 . 0090A2 41CC 0010
         C     12,@@STACKT               . 0090A6 59C0 A828
         BH    OVER                      . 0090AA 4720 9664
         L     11,@@IND                  . 0090AE 58B0 A9F0
         BR    11                        . 0090B2 07FB
S4$090B4 STD   0,XPTR                    . 0090B4 6000 A410
         B     FAIL                      . 0090B8 47F0 9010
         LD    0,XPTR                    . 0090BC 6800 A410
         STD   0,104(12)                 . 0090C0 600C 0068
         AR    12,8                      . 0090C4 1AC8
         C     12,@@STACKT               . 0090C6 59C0 A828
         BH    OVER                      . 0090CA 4720 9664
         LA    14,S4$090EA               . 0090CE 41E0 B052
         STM   11,14,104(12)             . 0090D2 90BE C068
         LR    13,12                     . 0090D6 18DC
         LA    12,16(12)                 . 0090D8 41CC 0010
         C     12,@@STACKT               . 0090DC 59C0 A828
         BH    OVER                      . 0090E0 4720 9664
         L     11,@@INTVAL               . 0090E4 58B0 A9E8
         BR    11                        . 0090E8 07FB
S4$090EA STD   0,YPTR                    . 0090EA 6000 A428
         B     FAIL                      . 0090EE 47F0 9010
         LD    0,YPTR                    . 0090F2 6800 A428
         STD   0,104(12)                 . 0090F6 600C 0068
         AR    12,8                      . 0090FA 1AC8
         C     12,@@STACKT               . 0090FC 59C0 A828
         BH    OVER                      . 009100 4720 9664
         LA    14,S4$09120               . 009104 41E0 B088
         STM   11,14,104(12)             . 009108 90BE C068
         LR    13,12                     . 00910C 18DC
         LA    12,16(12)                 . 00910E 41CC 0010
         C     12,@@STACKT               . 009112 59C0 A828
         BH    OVER                      . 009116 4720 9664
         L     11,@@VARVAL               . 00911A 58B0 A9C0
         BR    11                        . 00911E 07FB
S4$09120 STD   0,ZPTR                    . 009120 6000 A440
         B     FAIL                      . 009124 47F0 9010
         LD    0,96(12)                  . 009128 680C 0060
         STD   0,YPTR                    . 00912C 6000 A428
         LD    0,88(12)                  . 009130 680C 0058
         STD   0,XPTR                    . 009134 6000 A410
         SR    12,8                      . 009138 1BC8
         SR    12,8                      . 00913A 1BC8
         C     0,YPTR                    . 00913C 5900 A428
         BE    PRINT5                    . 009140 4780 B198
         BH    UNTERR                    . 009144 4720 96B4
                                                             SPACE
* PRINT6 AEQLC ZPTR,0,PRINT2       Check for defaulted format
*      LOCAPT  TPTR,OTSATL,YPTR,PRINT4
*                                  Insert length
                                                             SPACE
PRINT6   C     0,ZPTR                    . 009148 5900 A440
         BNE   PRINT2                    . 00914C 4770 B158
         L     15,OTSATL                 . 009150 58F0 9A10
         L     5,4(15)                   . 009154 585F 0004
         LA    5,0(5,15)                 . 009158 4155 F000
         LR    4,8                       . 00915C 1848
         SR    5,4                       . 00915E 1B54
         AR    4,8                       . 009160 1A48
S4$09162 CLC   8(8,15),YPTR              . 009162 D507 F008 A428
         BE    S4$09174                  . 009168 4780 B0DC
         BXLE  15,4,S4$09162             . 00916C 87F4 B0CA
         B     PRINT4                    . 009170 47F0 B150
S4$09174 STM   15,0,TPTR                 . 009174 90F0 A3D0
                                                             SPACE
* PRINT3 LOCAPV ZPTR,OUTATL,XPTR,PRINT1
*                                  Look for output association
*      PUTDC   ZPTR,DESCR,TPTR     Insert output block
*      BRANCH  RETNUL              Return
                                                             SPACE
PRINT3   L     15,OUTATL                 . 009178 58F0 A308
         L     5,4(15)                   . 00917C 585F 0004
         LA    5,0(5,15)                 . 009180 4155 F000
         LR    4,8                       . 009184 1848
         SR    5,4                       . 009186 1B54
         AR    4,8                       . 009188 1A48
S4$0918A CLC   16(8,15),XPTR             . 00918A D507 F010 A410
         BE    S4$0919C                  . 009190 4780 B104
         BXLE  15,4,S4$0918A             . 009194 87F4 B0F2
         B     PRINT1                    . 009198 47F0 B114
S4$0919C STM   15,0,ZPTR                 . 00919C 90F0 A440
         LD    0,TPTR                    . 0091A0 6800 A3D0
         STD   0,8(15)                   . 0091A4 600F 0008
         B     RETNUL                    . 0091A8 47F0 9018
                                                             SPACE
* PRINT1 RCALL OUTATL,AUGATL,(OUTATL,TPTR,XPTR),RETNUL
*                                  Add new association pair
                                                             SPACE
PRINT1   LA    14,S4$091E0               . 0091AC 41E0 B148
         STM   11,14,104(12)             . 0091B0 90BE C068
         LR    13,12                     . 0091B4 18DC
         LD    0,OUTATL                  . 0091B6 6800 A308
         STD   0,136(12)                 . 0091BA 600C 0088
         LD    0,TPTR                    . 0091BE 6800 A3D0
         STD   0,128(12)                 . 0091C2 600C 0080
         LD    0,XPTR                    . 0091C6 6800 A410
         STD   0,120(12)                 . 0091CA 600C 0078
         LA    12,40(12)                 . 0091CE 41CC 0028
         C     12,@@STACKT               . 0091D2 59C0 A828
         BH    OVER                      . 0091D6 4720 9664
         L     11,@@AUGATL               . 0091DA 58B0 A878
         BR    11                        . 0091DE 07FB
S4$091E0 STD   0,OUTATL                  . 0091E0 6000 A308
         B     RETNUL                    . 0091E4 47F0 9018
                                                             SPACE
* PRINT4 MOVD  ZPTR,DFLFST         Set up standard default
                                                             SPACE
PRINT4   LD    0,DFLFST                  . 0091E8 6800 A518
         STD   0,ZPTR                    . 0091EC 6000 A440
                                                             SPACE
* PRINT2 RCALL TPTR,BLOCK,IOBLSZ   Allocate block
*      PUTDC   TPTR,DESCR,YPTR     Insert unit
*      PUTDC   TPTR,2*DESCR,ZPTR   Insert format
*      BRANCH  PRINT3              Rejoin processing
                                                             SPACE
PRINT2   LA    14,S4$09214               . 0091F0 41E0 B17C
         STM   11,14,104(12)             . 0091F4 90BE C068
         LR    13,12                     . 0091F8 18DC
         LD    0,IOBLSZ                  . 0091FA 6800 9C40
         STD   0,120(12)                 . 0091FE 600C 0078
         LA    12,24(12)                 . 009202 41CC 0018
         C     12,@@STACKT               . 009206 59C0 A828
         BH    OVER                      . 00920A 4720 9664
         L     11,@@BLOCK                . 00920E 58B0 A82C
         BR    11                        . 009212 07FB
S4$09214 STD   0,TPTR                    . 009214 6000 A3D0
         L     1,TPTR                    . 009218 5810 A3D0
         LD    0,YPTR                    . 00921C 6800 A428
         STD   0,8(1)                    . 009220 6001 0008
         LD    0,ZPTR                    . 009224 6800 A440
         STD   0,16(1)                   . 009228 6001 0010
         B     PRINT3                    . 00922C 47F0 B0E0
                                                             SPACE
* PRINT5 SETAC YPTR,UNITO          Set default unit
*      BRANCH  PRINT6              Join processing
PRINT5   L     1,@@UNIT0                 . 009230 5810 A9F8
         ST    1,YPTR                    . 009234 5010 A428
         B     PRINT6                    . 009238 47F0 B0B0
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      BACKSPACE(U), ENDFILE(U), and REWIND(U)
*
                                                             SPACE
* BKSPCE PROC  ,                   BACKSPACE(N)
*      SETAC   SCL,1               Indicate backspace
*      BRANCH  IOOP
                                                             SPACE
         USING BKSPCE,11                 .
BKSPCE   LA    1,1                       . 00923C 4110 0001
         ST    1,SCL                     . 009240 5010 9EF8
         B     IOOP                      . 009244 47F0 B028
                                                             SPACE
* ENFILE PROC  BKSPCE              ENDFILE(N)
*      SETAC   SCL,2               Indicate end of file
*      BRANCH  IOOP
                                                             SPACE
ENFILE   L     11,@@BKSPCE               . 009248 58B0 A9FC
         LA    1,2                       . 00924C 4110 0002
         ST    1,SCL                     . 009250 5010 9EF8
         B     IOOP                      . 009254 47F0 B028
                                                             SPACE
* REWIND PROC  BKSPCE              REWIND(N)
*      SETAC   SCL,3               Indicate rewind
                                                             SPACE
REWIND   L     11,@@BKSPCE               . 009258 58B0 A9FC
         LA    1,3                       . 00925C 4110 0003
         ST    1,SCL                     . 009260 5010 9EF8
                                                             SPACE
* IOOP PUSH    SCL                 Push indicator
*      RCALL   XCL,INTVAL,,FAIL    Evaluate integer argument
*      ACOMPC  XCL,0,,UNTERR,UNTERR
*                                  Reject negative or zero
*      POP     SCL                 Restore indicator
*      SELBRA  SCL,(,EOP,ROP)      Select operation
*      BKSPCE  XCL                 Backspace unit
*      BRANCH  RETNUL
                                                             SPACE
IOOP     LD    0,SCL                     . 009264 6800 9EF8
         STD   0,104(12)                 . 009268 600C 0068
         AR    12,8                      . 00926C 1AC8
         C     12,@@STACKT               . 00926E 59C0 A828
         BH    OVER                      . 009272 4720 9664
         LA    14,S4$09292               . 009276 41E0 B056
         STM   11,14,104(12)             . 00927A 90BE C068
         LR    13,12                     . 00927E 18DC
         LA    12,16(12)                 . 009280 41CC 0010
         C     12,@@STACKT               . 009284 59C0 A828
         BH    OVER                      . 009288 4720 9664
         L     11,@@INTVAL               . 00928C 58B0 A9E8
         BR    11                        . 009290 07FB
S4$09292 STD   0,XCL                     . 009292 6000 A408
         B     FAIL                      . 009296 47F0 9010
         C     0,XCL                     . 00929A 5900 A408
         BNL   UNTERR                    . 00929E 47B0 96B4
         LD    0,96(12)                  . 0092A2 680C 0060
         STD   0,SCL                     . 0092A6 6000 9EF8
         SR    12,8                      . 0092AA 1BC8
         L     1,SCL                     . 0092AC 5810 9EF8
         SLA   1,2                       . 0092B0 8B10 0002
S4$092B4 B     S4$092B4(1)               . 0092B4 47F1 B078
         B     EOP                       . 0092B8 47F0 B088
         B     ROP                       . 0092BC 47F0 B098
         B     S4$092E4                  . 0092C0 47F0 B0A8
                                                             SPACE
* EOP  ENFILE  XCL                 End file unit
*      BRANCH  RETNUL
                                                             SPACE
EOP      L     15,@@IBCOM#               . 0092C4 58F0 A814
         BAL   14,40(15)                      CALL                     *
                                         . 0092C8 45EF 0028
         DC    X'01'                     . 0092CC 01
         DC    AL3(XCL)                  . 0092CD 00DA58
         B     RETNUL                    . 0092D0 47F0 9018
                                                             SPACE
* ROP  REWIND  XCL                 Rewind unit
*      BRANCH  RETNUL
ROP      L     15,@@IBCOM#               . 0092D4 58F0 A814
         BAL   14,48(15)                      CALL                     *
                                         . 0092D8 45EF 0030
         DC    X'01'                     . 0092DC 01
         DC    AL3(XCL)                  . 0092DD 00DA58
         B     RETNUL                    . 0092E0 47F0 9018
S4$092E4 L     15,@@IBCOM#               . 0092E4 58F0 A814
         BAL   14,44(15)                      CALL                     *
                                         . 0092E8 45EF 002C
         DC    X'01'                     . 0092EC 01
         DC    AL3(XCL)                  . 0092ED 00DA58
         B     RETNUL                    . 0092F0 47F0 9018
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      DETACH(N)
*
                                                             SPACE
* DETACH PROC  ,                   DETACH(N)
*      RCALL   XPTR,IND,,FAIL      Get name of variable
*      LOCAPV  ZPTR,INATL,XPTR,DTCH1
*                                  Look for input association
*      PUTDC   ZPTR,DESCR,ZEROCL   Delete association if there is one
*      PUTDC   ZPTR,2*DESCR,ZEROCL Clear association pointer also
                                                             SPACE
         USING DETACH,11                 .
DETACH   LA    14,S4$09310               . 0092F4 41E0 B01C
         STM   11,14,104(12)             . 0092F8 90BE C068
         LR    13,12                     . 0092FC 18DC
         LA    12,16(12)                 . 0092FE 41CC 0010
         C     12,@@STACKT               . 009302 59C0 A828
         BH    OVER                      . 009306 4720 9664
         L     11,@@IND                  . 00930A 58B0 A9F0
         BR    11                        . 00930E 07FB
S4$09310 STD   0,XPTR                    . 009310 6000 A410
         B     FAIL                      . 009314 47F0 9010
         L     15,INATL                  . 009318 58F0 A300
         L     5,4(15)                   . 00931C 585F 0004
         LA    5,0(5,15)                 . 009320 4155 F000
         LR    4,8                       . 009324 1848
         SR    5,4                       . 009326 1B54
         AR    4,8                       . 009328 1A48
S4$0932A CLC   16(8,15),XPTR             . 00932A D507 F010 A410
         BE    S4$0933C                  . 009330 4780 B048
         BXLE  15,4,S4$0932A             . 009334 87F4 B036
         B     DTCH1                     . 009338 47F0 B058
S4$0933C STM   15,0,ZPTR                 . 00933C 90F0 A440
         LD    0,ZEROCL                  . 009340 6800 9C90
         STD   0,8(15)                   . 009344 600F 0008
         STD   0,16(15)                  . 009348 600F 0010
                                                             SPACE
* DTCH1 LOCAPV ZPTR,OUTATL,XPTR,RETNUL
*                                  Look for output association
*      PUTDC   ZPTR,DESCR,ZEROCL   Delete association is there is one
*      PUTDC   ZPTR,2*DESCR,ZEROCL Clear association pointer also
*      BRANCH  RETNUL              Return null value
DTCH1    L     15,OUTATL                 . 00934C 58F0 A308
         L     5,4(15)                   . 009350 585F 0004
         LA    5,0(5,15)                 . 009354 4155 F000
         LR    4,8                       . 009358 1848
         SR    5,4                       . 00935A 1B54
         AR    4,8                       . 00935C 1A48
S4$0935E CLC   16(8,15),XPTR             . 00935E D507 F010 A410
         BE    S4$09370                  . 009364 4780 B07C
         BXLE  15,4,S4$0935E             . 009368 87F4 B06A
         B     RETNUL                    . 00936C 47F0 9018
S4$09370 STM   15,0,ZPTR                 . 009370 90F0 A440
         LD    0,ZEROCL                  . 009374 6800 9C90
         STD   0,8(15)                   . 009378 600F 0008
         STD   0,16(15)                  . 00937C 600F 0010
         B     RETNUL                    . 009380 47F0 9018
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Input Procedure
*
                                                             SPACE
* PUTIN PROC   ,                   Input procedure
*      POP     (IO1PTR,IO2PTR)     Restore block and variable
*      GETDC   IO3PTR,IO1PTR,DESCR Get unit
*      GETDC   IO1PTR,IO1PTR,2*DESCR
*                                  Get length
*      RCALL   IO4PTR,CONVAR,(IO1PTR)
*                                  Get space for string
*      LOCSP   IOSP,IO4PTR         Get specifier
*      INCRA   RSTAT,1             Increment count of reads
*      STREAD  IOSP,IO3PTR,FAIL,COMP5
*                                  Perform read
*      AEQLC   TRIMCL,0,,PUTIN1    Check &INPUT
*      TRIMSP  IOSP,IOSP           Trim string
*      GETLG   IO1PTR,IOSP         Get length
                                                             SPACE
         USING PUTIN,11                  .
PUTIN    LD    0,96(12)                  . 009384 680C 0060
         STD   0,IO1PTR                  . 009388 6000 A398
         LD    0,88(12)                  . 00938C 680C 0058
         STD   0,IO2PTR                  . 009390 6000 A390
         SR    12,8                      . 009394 1BC8
         SR    12,8                      . 009396 1BC8
         L     1,IO1PTR                  . 009398 5810 A398
         LD    0,8(1)                    . 00939C 6801 0008
         STD   0,IO3PTR                  . 0093A0 6000 A3B0
         LM    1,2,16(1)                 . 0093A4 9812 1010
         STM   1,2,IO1PTR                . 0093A8 9012 A398
         C     1,MLENCL                  . 0093AC 5910 9848
         BH    INTR8                     . 0093B0 4720 9614
         LA    14,S4$093D8               . 0093B4 41E0 B054
         STM   11,14,104(12)             . 0093B8 90BE C068
         LR    13,12                     . 0093BC 18DC
         LD    0,IO1PTR                  . 0093BE 6800 A398
         STD   0,120(12)                 . 0093C2 600C 0078
         LA    12,24(12)                 . 0093C6 41CC 0018
         C     12,@@STACKT               . 0093CA 59C0 A828
         BH    OVER                      . 0093CE 4720 9664
         L     11,@@CONVAR               . 0093D2 58B0 A96C
         BR    11                        . 0093D6 07FB
S4$093D8 STD   0,IO4PTR                  . 0093D8 6000 A3B8
         LM    3,4,IO4PTR                . 0093DC 9834 A3B8
         CR    0,3                       . 0093E0 1903
         BNE   S4$093EE                  . 0093E2 4770 B06A
         ST    0,IOSP                    . 0093E6 5000 A570
         B     S4$093FE                  . 0093EA 47F0 B07A
S4$093EE L     1,4(3)                    . 0093EE 5813 0004
         LA    1,0(1)                    . 0093F2 4111 0000
         LA    2,32                      . 0093F6 4120 0020
         STM   1,4,IOSP                  . 0093FA 9014 A570
S4$093FE L     1,RSTAT                   . 0093FE 5810 9B78
         LA    1,1(1)                    . 009402 4111 0001
         ST    1,RSTAT                   . 009406 5010 9B78
         L     15,@@STREAD               . 00940A 58F0 A83C
         LA    1,IOSP                    . 00940E 4110 A570
         LA    2,IO3PTR                  . 009412 4120 A3B0
         BALR  14,15                          CALL                     *
                                         . 009416 05EF
         B     FAIL                      . 009418 47F0 9010
         B     COMP5                     . 00941C 47F0 95B4
         C     0,TRIMCL                  . 009420 5900 9808
         BE    S4$09454                  . 009424 4780 B0D0
         LM    1,4,IOSP                  . 009428 9814 A570
         LA    5,0(2,3)                  . 00942C 4152 3000
         LA    6,0(1,5)                  . 009430 4161 5000
S4$09434 BCTR  6,0                            DECREMENT                *
                                         . 009434 0660
         CR    6,5                       . 009436 1965
         BL    PUTIN1                    . 009438 4740 B0C0
         CLI   0(6),X'40'                . 00943C 9540 6000
         BE    S4$09434                  . 009440 4780 B0B0
                                                             SPACE
* PUTIN1 GETLG IO1PTR,IOSP         Get length
*      RCALL   IO1PTR,GNVARS,IO1PTR
*      PUTDC   IO2PTR,DESCR,IO1PTR Assign value
*      RRTURN  IO1PTR,2            Return value
*      SPCINT  IO1PTR,XSP,INTR1,PUTIN2                          E3.10.2
PUTIN1   SR    6,5                       . 009444 1B65
         LA    1,1(6)                    . 009446 4116 0001
         STM   1,4,IOSP                  . 00944A 9014 A570
         LR    15,1                      . 00944E 18F1
         STM   15,0,IO1PTR               . 009450 90F0 A398
S4$09454 LA    14,S4$09478               . 009454 41E0 B0F4
         STM   11,14,104(12)             . 009458 90BE C068
         LR    13,12                     . 00945C 18DC
         LD    0,IO1PTR                  . 00945E 6800 A398
         STD   0,120(12)                 . 009462 600C 0078
         LA    12,24(12)                 . 009466 41CC 0018
         C     12,@@STACKT               . 00946A 59C0 A828
         BH    OVER                      . 00946E 4720 9664
         L     11,@@GNVARS               . 009472 58B0 A970
         BR    11                        . 009476 07FB
S4$09478 STD   0,IO1PTR                  . 009478 6000 A398
         L     1,IO2PTR                  . 00947C 5810 A390
         STD   0,8(1)                    . 009480 6001 0008
         LM    11,14,104(13)             . 009484 98BE D068
         EX    0,0(14)                   . 009488 440E 0000
         B     8(14)                     . 00948C 47FE 0008
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Output Procedure
*
                                                             SPACE
* PUTOUT PROC  ,                   Output procedure
*      POP     (IO1PTR,IO2PTR)     Restore block and value
*      VEQLC   IO2PTR,S,,PUTV      Is value STRING?
*      VEQLC   IO2PTR,I,,PUTI      Is value INTEGER?
*      RCALL   IO2PTR,DTREP,IO2PTR Get data type representation
*      GETSPC  IOSP,IO2PTR,0       Get specifier
*      BRANCH  PUTVU               Join processing
                                                             SPACE
         USING PUTOUT,11                 .
PUTOUT   LD    0,96(12)                  . 009490 680C 0060
         STD   0,IO1PTR                  . 009494 6000 A398
         LD    0,88(12)                  . 009498 680C 0058
         STD   0,IO2PTR                  . 00949C 6000 A390
         SR    12,8                      . 0094A0 1BC8
         SR    12,8                      . 0094A2 1BC8
         CLC   IO2PTR$5(3),@@S           . 0094A4 D502 A395 AA7B
         BE    PUTV                      . 0094AA 4780 B05C
         CLC   IO2PTR$5(3),@@I           . 0094AE D502 A395 AA84
         BE    PUTI                      . 0094B4 4780 B0A0
         LA    14,S4$094D8               . 0094B8 41E0 B048
         STM   11,14,104(12)             . 0094BC 90BE C068
         LR    13,12                     . 0094C0 18DC
         STD   0,120(12)                 . 0094C2 600C 0078
         LA    12,24(12)                 . 0094C6 41CC 0018
         C     12,@@STACKT               . 0094CA 59C0 A828
         BH    OVER                      . 0094CE 4720 9664
         L     11,@@DTREP                . 0094D2 58B0 AA00
         BR    11                        . 0094D6 07FB
S4$094D8 STD   0,IO2PTR                  . 0094D8 6000 A390
         L     1,IO2PTR                  . 0094DC 5810 A390
         LM    1,4,0(1)                  . 0094E0 9814 1000
         STM   1,4,IOSP                  . 0094E4 9014 A570
         B     PUTVU                     . 0094E8 47F0 B07E
                                                             SPACE
* PUTV LOCSP   IOSP,IO2PTR         Get specifier
                                                             SPACE
PUTV     LM    3,4,IO2PTR                . 0094EC 9834 A390
         CR    0,3                       . 0094F0 1903
         BNE   S4$094FE                  . 0094F2 4770 B06E
         ST    0,IOSP                    . 0094F6 5000 A570
         B     PUTVU                     . 0094FA 47F0 B07E
S4$094FE L     1,4(3)                    . 0094FE 5813 0004
         LA    1,0(1)                    . 009502 4111 0000
         LA    2,32                      . 009506 4120 0020
         STM   1,4,IOSP                  . 00950A 9014 A570
                                                             SPACE
* PUTVU STPRNT IOKEY,IO1PTR,IOSP   Perform print
*      INCRA   WSTAT,1             Increment count of writes
*      BRANCH  RTN1                Return
                                                             SPACE
PUTVU    L     15,@@STPRNT               . 00950E 58F0 A838
         LA    1,IOKEY                   . 009512 4110 9EA0
         LA    2,IO1PTR                  . 009516 4120 A398
         LA    3,IOSP                    . 00951A 4130 A570
         BALR  14,15                          CALL                     *
                                         . 00951E 05EF
         L     1,WSTAT                   . 009520 5810 9B88
         LA    1,1(1)                    . 009524 4111 0001
         ST    1,WSTAT                   . 009528 5010 9B88
         B     FAIL                      . 00952C 47F0 9010
                                                             SPACE
* PUTI INTSPC  IOSP,IO2PTR         Convert INTEGER to STRING
*      BRANCH  PUTVU               Rejoin processing
PUTI     L     15,@@BDSPEC               . 009530 58F0 A874
         LA    1,IOSP                    . 009534 4110 A570
         LA    2,IO2PTR                  . 009538 4120 A390
         BALR  14,15                          CALL                     *
                                         . 00953C 05EF
         B     PUTVU                     . 00953E 47F0 B07E
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Tracing Procedures and Functions'
*
*      TRACE(V,R,T,F)
*
                                                             SPACE
* TRACE PROC   ,                   TRACE(V,R,T,F)
*      RCALL   XPTR,IND,,FAIL      Get name of variable
*      PUSH    XPTR                Save name
*      RCALL   YPTR,VARVAL,,FAIL   Get trace type
*      PUSH    YPTR                Save type
*      RCALL   WPTR,ARGVAL,,FAIL   Get tag
*      PUSH    WPTR                Save tag
*      RCALL   ZPTR,VARVAL,,FAIL   Get trace function
*      POP     (WPTR,YPTR,XPTR)    Restore saved arguments
*      DEQL    YPTR,NULVCL,TRAC5   Is type defaulted??
*      MOVD    YPTR,VALTRS         Set up VALUE default
                                                             SPACE
         USING TRACE,11                  .
TRACE    LA    14,S4$0955E               . 009542 41E0 B01C
         STM   11,14,104(12)             . 009546 90BE C068
         LR    13,12                     . 00954A 18DC
         LA    12,16(12)                 . 00954C 41CC 0010
         C     12,@@STACKT               . 009550 59C0 A828
         BH    OVER                      . 009554 4720 9664
         L     11,@@IND                  . 009558 58B0 A9F0
         BR    11                        . 00955C 07FB
S4$0955E STD   0,XPTR                    . 00955E 6000 A410
         B     FAIL                      . 009562 47F0 9010
         LD    0,XPTR                    . 009566 6800 A410
         STD   0,104(12)                 . 00956A 600C 0068
         AR    12,8                      . 00956E 1AC8
         C     12,@@STACKT               . 009570 59C0 A828
         BH    OVER                      . 009574 4720 9664
         LA    14,S4$09594               . 009578 41E0 B052
         STM   11,14,104(12)             . 00957C 90BE C068
         LR    13,12                     . 009580 18DC
         LA    12,16(12)                 . 009582 41CC 0010
         C     12,@@STACKT               . 009586 59C0 A828
         BH    OVER                      . 00958A 4720 9664
         L     11,@@VARVAL               . 00958E 58B0 A9C0
         BR    11                        . 009592 07FB
S4$09594 STD   0,YPTR                    . 009594 6000 A428
         B     FAIL                      . 009598 47F0 9010
         LD    0,YPTR                    . 00959C 6800 A428
         STD   0,104(12)                 . 0095A0 600C 0068
         AR    12,8                      . 0095A4 1AC8
         C     12,@@STACKT               . 0095A6 59C0 A828
         BH    OVER                      . 0095AA 4720 9664
         LA    14,S4$095CA               . 0095AE 41E0 B088
         STM   11,14,104(12)             . 0095B2 90BE C068
         LR    13,12                     . 0095B6 18DC
         LA    12,16(12)                 . 0095B8 41CC 0010
         C     12,@@STACKT               . 0095BC 59C0 A828
         BH    OVER                      . 0095C0 4720 9664
         L     11,@@ARGVAL               . 0095C4 58B0 A914
         BR    11                        . 0095C8 07FB
S4$095CA STD   0,WPTR                    . 0095CA 6000 A400
         B     FAIL                      . 0095CE 47F0 9010
         LD    0,WPTR                    . 0095D2 6800 A400
         STD   0,104(12)                 . 0095D6 600C 0068
         AR    12,8                      . 0095DA 1AC8
         C     12,@@STACKT               . 0095DC 59C0 A828
         BH    OVER                      . 0095E0 4720 9664
         LA    14,S4$09600               . 0095E4 41E0 B0BE
         STM   11,14,104(12)             . 0095E8 90BE C068
         LR    13,12                     . 0095EC 18DC
         LA    12,16(12)                 . 0095EE 41CC 0010
         C     12,@@STACKT               . 0095F2 59C0 A828
         BH    OVER                      . 0095F6 4720 9664
         L     11,@@VARVAL               . 0095FA 58B0 A9C0
         BR    11                        . 0095FE 07FB
S4$09600 STD   0,ZPTR                    . 009600 6000 A440
         B     FAIL                      . 009604 47F0 9010
         LD    0,96(12)                  . 009608 680C 0060
         STD   0,WPTR                    . 00960C 6000 A400
         LD    0,88(12)                  . 009610 680C 0058
         STD   0,YPTR                    . 009614 6000 A428
         LD    0,80(12)                  . 009618 680C 0050
         STD   0,XPTR                    . 00961C 6000 A410
         S     12,@@3MDESC               . 009620 5BC0 A860
         CLC   YPTR(8),NULVCL            . 009624 D507 A428 9ED0
         BNE   TRAC5                     . 00962A 4770 B0F4
         LD    0,VALTRS                  . 00962E 6800 9A60
         STD   0,YPTR                    . 009632 6000 A428
                                                             SPACE
* TRAC5 LOCAPV YPTR,TRATL,YPTR,TRAC1
*                                  Look for trace type
*      GETDC   YPTR,YPTR,DESCR     Get sub pair list
                                                             SPACE
TRAC5    L     15,TRATL                  . 009636 58F0 9F90
         L     5,4(15)                   . 00963A 585F 0004
         LA    5,0(5,15)                 . 00963E 4155 F000
         LR    4,8                       . 009642 1848
         SR    5,4                       . 009644 1B54
         AR    4,8                       . 009646 1A48
S4$09648 CLC   16(8,15),YPTR             . 009648 D507 F010 A428
         BE    S4$0965A                  . 00964E 4780 B118
         BXLE  15,4,S4$09648             . 009652 87F4 B106
         B     TRAC1                     . 009656 47F0 B260
S4$0965A LD    0,8(15)                   . 00965A 680F 0008
         STD   0,YPTR                    . 00965E 6000 A428
                                                             SPACE
* TRACEP PROC  TRACE               Subentry for TRACE
*      GETDC   TPTR,YPTR,DESCR     Get default function
*      DEQL    ZPTR,NULVCL,,TRAC2  Check for null
*      RCALL   TPTR,FINDEX,(ZPTR)  Locate function descriptor
                                                             SPACE
TRACEP   L     11,@@TRACE                . 009662 58B0 AA04
         L     1,YPTR                    . 009666 5810 A428
         LD    0,8(1)                    . 00966A 6801 0008
         STD   0,TPTR                    . 00966E 6000 A3D0
         CLC   ZPTR(8),NULVCL            . 009672 D507 A440 9ED0
         BE    TRAC2                     . 009678 4780 B162
         LA    14,S4$096A0               . 00967C 41E0 B15E
         STM   11,14,104(12)             . 009680 90BE C068
         LR    13,12                     . 009684 18DC
         LD    0,ZPTR                    . 009686 6800 A440
         STD   0,120(12)                 . 00968A 600C 0078
         LA    12,24(12)                 . 00968E 41CC 0018
         C     12,@@STACKT               . 009692 59C0 A828
         BH    OVER                      . 009696 4720 9664
         L     11,@@FINDEX               . 00969A 58B0 A8F4
         BR    11                        . 00969E 07FB
S4$096A0 STD   0,TPTR                    . 0096A0 6000 A3D0
                                                             SPACE
* TRAC2 SETAC  XSIZ,5*DESCR                                     V3.7
*      SETVC   XSIZ,C              Insert CODE data type
*      RCALL   XCL,BLOCK,XSIZ      Allocate block for code
*      MOVBLK  XCL,TRCBLK,XSIZ                                  V3.7
*      SETVC   TPTR,2              Set up 2 arguments
*      PUTDC   XCL,1*DESCR,TPTR    Insert function descriptor
*      PUTDC   XCL,3*DESCR,XPTR    Insert name to be traced
*      PUTDC   XCL,5*DESCR,WPTR    Insert tag
*      GETDC   TPTR,YPTR,0         Make entry for proper attribute
*      AEQLC   TPTR,0,,TRAC4
*      LOCAPT  TPTR,TPTR,XPTR,TRAC3
*                                  Locate trace
*      PUTDC   TPTR,2*DESCR,XCL    Insert new code block
*      BRANCH  RETNUL              Return
                                                             SPACE
TRAC2    L     1,@@DESCR7                . 0096A4 5810 AA08
         ST    1,XSIZ                    . 0096A8 5010 A418
         MVC   XSIZ$5(3),@@C             . 0096AC D202 A41D AA7E
         LA    14,S4$096D6               . 0096B2 41E0 B194
         STM   11,14,104(12)             . 0096B6 90BE C068
         LR    13,12                     . 0096BA 18DC
         LD    0,XSIZ                    . 0096BC 6800 A418
         STD   0,120(12)                 . 0096C0 600C 0078
         LA    12,24(12)                 . 0096C4 41CC 0018
         C     12,@@STACKT               . 0096C8 59C0 A828
         BH    OVER                      . 0096CC 4720 9664
         L     11,@@BLOCK                . 0096D0 58B0 A82C
         BR    11                        . 0096D4 07FB
S4$096D6 STD   0,XCL                     . 0096D6 6000 A408
         L     6,XCL                     . 0096DA 5860 A408
         L     4,TRSKEL                  . 0096DE 5840 9C98
         AR    4,8                       . 0096E2 1A48
         AR    6,8                       . 0096E4 1A68
         L     3,XSIZ                    . 0096E6 5830 A418
         L     15,@@MOVTST               . 0096EA 58F0 A864
         BALR  14,15                          CALL                     *
                                         . 0096EE 05EF
         MVC   TPTR$5(3),@@2             . 0096F0 D202 A3D5 AA96
         L     1,XCL                     . 0096F6 5810 A408
         LD    0,TPTR                    . 0096FA 6800 A3D0
         STD   0,8(1)                    . 0096FE 6001 0008
         LD    0,XPTR                    . 009702 6800 A410
         STD   0,24(1)                   . 009706 6001 0018
         LD    0,WPTR                    . 00970A 6800 A400
         STD   0,40(1)                   . 00970E 6001 0028
         L     1,YPTR                    . 009712 5810 A428
         LD    0,0(1)                    . 009716 6801 0000
         STD   0,TPTR                    . 00971A 6000 A3D0
         C     0,TPTR                    . 00971E 5900 A3D0
         BE    TRAC4                     . 009722 4780 B2A6
         L     15,TPTR                   . 009726 58F0 A3D0
         L     5,4(15)                   . 00972A 585F 0004
         LA    5,0(5,15)                 . 00972E 4155 F000
         LR    4,8                       . 009732 1848
         SR    5,4                       . 009734 1B54
         AR    4,8                       . 009736 1A48
S4$09738 CLC   8(8,15),XPTR              . 009738 D507 F008 A410
         BE    S4$0974A                  . 00973E 4780 B208
         BXLE  15,4,S4$09738             . 009742 87F4 B1F6
         B     TRAC3                     . 009746 47F0 B218
S4$0974A STM   15,0,TPTR                 . 00974A 90F0 A3D0
         LD    0,XCL                     . 00974E 6800 A408
         STD   0,16(15)                  . 009752 600F 0010
         B     RETNUL                    . 009756 47F0 9018
                                                             SPACE
* TRAC3 RCALL  TPTR,AUGATL,(TPTR,XPTR,XCL)
*                                  Augment pair list for new entry
                                                             SPACE
TRAC3    LA    14,S4$0978E               . 00975A 41E0 B24C
         STM   11,14,104(12)             . 00975E 90BE C068
         LR    13,12                     . 009762 18DC
         LD    0,TPTR                    . 009764 6800 A3D0
         STD   0,136(12)                 . 009768 600C 0088
         LD    0,XPTR                    . 00976C 6800 A410
         STD   0,128(12)                 . 009770 600C 0080
         LD    0,XCL                     . 009774 6800 A408
         STD   0,120(12)                 . 009778 600C 0078
         LA    12,40(12)                 . 00977C 41CC 0028
         C     12,@@STACKT               . 009780 59C0 A828
         BH    OVER                      . 009784 4720 9664
         L     11,@@AUGATL               . 009788 58B0 A878
         BR    11                        . 00978C 07FB
S4$0978E STD   0,TPTR                    . 00978E 6000 A3D0
                                                             SPACE
* TRAC6 PUTDC  YPTR,0,TPTR         Link in new pair list
*      BRANCH  RETNUL              Return
                                                             SPACE
TRAC6    L     1,YPTR                    . 009792 5810 A428
         LD    0,TPTR                    . 009796 6800 A3D0
         STD   0,0(1)                    . 00979A 6001 0000
         B     RETNUL                    . 00979E 47F0 9018
                                                             SPACE
* TRAC1 DEQL   YPTR,FUNTCL,INTR30  Is type FUNCTION?
*      MOVD    YPTR,TFNCLP         Set up CALL trace
*      RCALL   ,TRACEP,,(INTR10,INTR10)
*                                  Call subentry to do it
*      MOVD    YPTR,TFNRLP         Set up RETURN trace
*      BRANCH  TRACEP              Branch to subentry to do it
                                                             SPACE
TRAC1    CLC   YPTR(8),FUNTCL            . 0097A2 D507 A428 A548
         BNE   INTR30                    . 0097A8 4770 9624
         LD    0,TFNCLP                  . 0097AC 6800 9A78
         STD   0,YPTR                    . 0097B0 6000 A428
         LA    14,S4$097D0               . 0097B4 41E0 B28E
         STM   11,14,104(12)             . 0097B8 90BE C068
         LR    13,12                     . 0097BC 18DC
         LA    12,16(12)                 . 0097BE 41CC 0010
         C     12,@@STACKT               . 0097C2 59C0 A828
         BH    OVER                      . 0097C6 4720 9664
         L     11,@@TRACEP               . 0097CA 58B0 AA0C
         BR    11                        . 0097CE 07FB
S4$097D0 SR    0,0                       . 0097D0 1B00
         SR    0,0                       . 0097D2 1B00
         B     S4$010                    . 0097D4 47F0 95AC
         B     S4$010                    . 0097D8 47F0 95AC
         LD    0,TFNRLP                  . 0097DC 6800 9A88
         STD   0,YPTR                    . 0097E0 6000 A428
         B     TRACEP                    . 0097E4 47F0 B120
                                                             SPACE
* TRAC4 RCALL  TPTR,BLOCK,TWOCL    Allocate new pair list
*      PUTDC   TPTR,DESCR,XPTR     Insert name to be traced
*      PUTDC   TPTR,2*DESCR,XCL    Insert pointer to pseudo-code
*      BRANCH  TRAC6
TRAC4    LA    14,S4$0980C               . 0097E8 41E0 B2CA
         STM   11,14,104(12)             . 0097EC 90BE C068
         LR    13,12                     . 0097F0 18DC
         LD    0,TWOCL                   . 0097F2 6800 A720
         STD   0,120(12)                 . 0097F6 600C 0078
         LA    12,24(12)                 . 0097FA 41CC 0018
         C     12,@@STACKT               . 0097FE 59C0 A828
         BH    OVER                      . 009802 4720 9664
         L     11,@@BLOCK                . 009806 58B0 A82C
         BR    11                        . 00980A 07FB
S4$0980C STD   0,TPTR                    . 00980C 6000 A3D0
         L     1,TPTR                    . 009810 5810 A3D0
         LD    0,XPTR                    . 009814 6800 A410
         STD   0,8(1)                    . 009818 6001 0008
         LD    0,XCL                     . 00981C 6800 A408
         STD   0,16(1)                   . 009820 6001 0010
         B     TRAC6                     . 009824 47F0 B250
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      STOPTR(N,T)
*
                                                             SPACE
* STOPTR PROC  ,                   STOPTR(T,R)
*      RCALL   XPTR,IND,,FAIL      Get name of variable
*      PUSH    XPTR                Save name
*      RCALL   YPTR,VARVAL,,FAIL   Get trace respect
*      POP     XPTR
*      DEQL    YPTR,NULVCL,STOPT2  Check for defaulted respect
*      MOVD    YPTR,VALTRS         Set up VALUE as default
                                                             SPACE
         USING STOPTR,11                 .
STOPTR   LA    14,S4$09844               . 009828 41E0 B01C
         STM   11,14,104(12)             . 00982C 90BE C068
         LR    13,12                     . 009830 18DC
         LA    12,16(12)                 . 009832 41CC 0010
         C     12,@@STACKT               . 009836 59C0 A828
         BH    OVER                      . 00983A 4720 9664
         L     11,@@IND                  . 00983E 58B0 A9F0
         BR    11                        . 009842 07FB
S4$09844 STD   0,XPTR                    . 009844 6000 A410
         B     FAIL                      . 009848 47F0 9010
         LD    0,XPTR                    . 00984C 6800 A410
         STD   0,104(12)                 . 009850 600C 0068
         AR    12,8                      . 009854 1AC8
         C     12,@@STACKT               . 009856 59C0 A828
         BH    OVER                      . 00985A 4720 9664
         LA    14,S4$0987A               . 00985E 41E0 B052
         STM   11,14,104(12)             . 009862 90BE C068
         LR    13,12                     . 009866 18DC
         LA    12,16(12)                 . 009868 41CC 0010
         C     12,@@STACKT               . 00986C 59C0 A828
         BH    OVER                      . 009870 4720 9664
         L     11,@@VARVAL               . 009874 58B0 A9C0
         BR    11                        . 009878 07FB
S4$0987A STD   0,YPTR                    . 00987A 6000 A428
         B     FAIL                      . 00987E 47F0 9010
         LD    0,96(12)                  . 009882 680C 0060
         STD   0,XPTR                    . 009886 6000 A410
         SR    12,8                      . 00988A 1BC8
         CLC   YPTR(8),NULVCL            . 00988C D507 A428 9ED0
         BNE   STOPT2                    . 009892 4770 B076
         LD    0,VALTRS                  . 009896 6800 9A60
         STD   0,YPTR                    . 00989A 6000 A428
                                                             SPACE
* STOPT2 LOCAPV YPTR,TRATL,YPTR,STOPT1
*                                  Look for trace respect
*      GETDC   YPTR,YPTR,DESCR     Get pointer to trace list
                                                             SPACE
STOPT2   L     15,TRATL                  . 00989E 58F0 9F90
         L     5,4(15)                   . 0098A2 585F 0004
         LA    5,0(5,15)                 . 0098A6 4155 F000
         LR    4,8                       . 0098AA 1848
         SR    5,4                       . 0098AC 1B54
         AR    4,8                       . 0098AE 1A48
S4$098B0 CLC   16(8,15),YPTR             . 0098B0 D507 F010 A428
         BE    S4$098C2                  . 0098B6 4780 B09A
         BXLE  15,4,S4$098B0             . 0098BA 87F4 B088
         B     STOPT1                    . 0098BE 47F0 B0EA
S4$098C2 LD    0,8(15)                   . 0098C2 680F 0008
         STD   0,YPTR                    . 0098C6 6000 A428
                                                             SPACE
* STOPTP PROC  STOPTR              Subentry for FUNCTION
*      GETDC   YPTR,YPTR,0         Get trace list
*      LOCAPT  YPTR,YPTR,XPTR,FAIL Look for traced variable
*      PUTDC   YPTR,DESCR,ZEROCL   Zero the entry
*      PUTDC   YPTR,2*DESCR,ZEROCL Overwrite trace
*      BRANCH  RETNUL              Return
                                                             SPACE
STOPTP   L     11,@@STOPTR               . 0098CA 58B0 AA10
         L     1,YPTR                    . 0098CE 5810 A428
         LD    0,0(1)                    . 0098D2 6801 0000
         STD   0,YPTR                    . 0098D6 6000 A428
         L     15,YPTR                   . 0098DA 58F0 A428
         L     5,4(15)                   . 0098DE 585F 0004
         LA    5,0(5,15)                 . 0098E2 4155 F000
         LR    4,8                       . 0098E6 1848
         SR    5,4                       . 0098E8 1B54
         AR    4,8                       . 0098EA 1A48
S4$098EC CLC   8(8,15),XPTR              . 0098EC D507 F008 A410
         BE    S4$098FE                  . 0098F2 4780 B0D6
         BXLE  15,4,S4$098EC             . 0098F6 87F4 B0C4
         B     FAIL                      . 0098FA 47F0 9010
S4$098FE STM   15,0,YPTR                 . 0098FE 90F0 A428
         LD    0,ZEROCL                  . 009902 6800 9C90
         STD   0,8(15)                   . 009906 600F 0008
         STD   0,16(15)                  . 00990A 600F 0010
         B     RETNUL                    . 00990E 47F0 9018
                                                             SPACE
* STOPT1 DEQL  YPTR,FUNTCL,INTR30  Check for FUNCTION
*      MOVD    YPTR,TFNCLP         Set up CALL
*      RCALL   ,STOPTP,,(FAIL,INTR10)
*                                  Call subprocedure
*      MOVD    YPTR,TFNRLP         Set up RETURN
*      BRANCH  STOPTP              Branch to subentry
STOPT1   CLC   YPTR(8),FUNTCL            . 009912 D507 A428 A548
         BNE   INTR30                    . 009918 4770 9624
         LD    0,TFNCLP                  . 00991C 6800 9A78
         STD   0,YPTR                    . 009920 6000 A428
         LA    14,S4$09940               . 009924 41E0 B118
         STM   11,14,104(12)             . 009928 90BE C068
         LR    13,12                     . 00992C 18DC
         LA    12,16(12)                 . 00992E 41CC 0010
         C     12,@@STACKT               . 009932 59C0 A828
         BH    OVER                      . 009936 4720 9664
         L     11,@@STOPTP               . 00993A 58B0 AA14
         BR    11                        . 00993E 07FB
S4$09940 SR    0,0                       . 009940 1B00
         SR    0,0                       . 009942 1B00
         B     FAIL                      . 009944 47F0 9010
         B     S4$010                    . 009948 47F0 95AC
         LD    0,TFNRLP                  . 00994C 6800 9A88
         STD   0,YPTR                    . 009950 6000 A428
         B     STOPTP                    . 009954 47F0 B0A2
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Call Tracing
*
                                                             SPACE
* FENTR PROC   ,                   Procedure to trace on CALL
*      RCALL   WPTR,VARVAL,,FAIL   Get argument
                                                             SPACE
         USING FENTR,11                  .
FENTR    LA    14,S4$09974               . 009958 41E0 B01C
         STM   11,14,104(12)             . 00995C 90BE C068
         LR    13,12                     . 009960 18DC
         LA    12,16(12)                 . 009962 41CC 0010
         C     12,@@STACKT               . 009966 59C0 A828
         BH    OVER                      . 00996A 4720 9664
         L     11,@@VARVAL               . 00996E 58B0 A9C0
         BR    11                        . 009972 07FB
S4$09974 STD   0,WPTR                    . 009974 6000 A400
         B     FAIL                      . 009978 47F0 9010
                                                             SPACE
* FENTR3 SETLC PROTSP,0            Clear specifier
*      APDSP   PROTSP,TRSTSP       Append trace message
*      INTSPC  XSP,STNOCL          Convert &STNO to string
*      APDSP   PROTSP,XSP          Append &STNO
*      APDSP   PROTSP,COLSP        Append colon
*      APDSP   PROTSP,TRLVSP       Append level message
*      INTSPC  XSP,LVLCL           Convert &FNCLEVEL to string
*      APDSP   PROTSP,XSP          Append &FNCLEVEL
*      APDSP   PROTSP,TRCLSP       Append call message
*      LOCSP   XSP,WPTR            Get specifier for argument
*      GETLG   TCL,XSP             Get length
*      ACOMPC  TCL,BUFLEN,FXOVR,FXOVR
*                                  Check for excessively long string
*      APDSP   PROTSP,XSP          Append function name
*      APDSP   PROTSP,LPRNSP       Append left parenthesis
*      SETAC   WCL,0               Set argument count to 0
                                                             SPACE
FENTR3   ST    0,PROTSP                  . 00997C 5000 A068
         L     15,@@APDSP                . 009980 58F0 A870
         LA    2,PROTSP                  . 009984 4120 A068
         LM    3,5,TRSTSP                . 009988 9835 A1B8
         BALR  14,15                          CALL                     *
                                         . 00998C 05EF
         L     15,@@BDSPEC               . 00998E 58F0 A874
         LA    1,XSP                     . 009992 4110 A5D0
         LA    2,STNOCL                  . 009996 4120 9990
         BALR  14,15                          CALL                     *
                                         . 00999A 05EF
         L     15,@@APDSP                . 00999C 58F0 A870
         LA    2,PROTSP                  . 0099A0 4120 A068
         LM    3,5,XSP                   . 0099A4 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 0099A8 05EF
         LA    2,PROTSP                  . 0099AA 4120 A068
         LM    3,5,COLSP                 . 0099AE 9835 A038
         BALR  14,15                          CALL                     *
                                         . 0099B2 05EF
         LA    2,PROTSP                  . 0099B4 4120 A068
         LM    3,5,TRLVSP                . 0099B8 9835 A1A8
         BALR  14,15                          CALL                     *
                                         . 0099BC 05EF
         L     15,@@BDSPEC               . 0099BE 58F0 A874
         LA    1,XSP                     . 0099C2 4110 A5D0
         LA    2,LVLCL                   . 0099C6 4120 99C0
         BALR  14,15                          CALL                     *
                                         . 0099CA 05EF
         L     15,@@APDSP                . 0099CC 58F0 A870
         LA    2,PROTSP                  . 0099D0 4120 A068
         LM    3,5,XSP                   . 0099D4 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 0099D8 05EF
         LA    2,PROTSP                  . 0099DA 4120 A068
         LM    3,5,TRCLSP                . 0099DE 9835 A198
         BALR  14,15                          CALL                     *
                                         . 0099E2 05EF
         LM    3,4,WPTR                  . 0099E4 9834 A400
         CR    0,3                       . 0099E8 1903
         BNE   S4$099F6                  . 0099EA 4770 B09E
         ST    0,XSP                     . 0099EE 5000 A5D0
         B     S4$09A06                  . 0099F2 47F0 B0AE
S4$099F6 L     1,4(3)                    . 0099F6 5813 0004
         LA    1,0(1)                    . 0099FA 4111 0000
         LA    2,32                      . 0099FE 4120 0020
         STM   1,4,XSP                   . 009A02 9014 A5D0
S4$09A06 L     15,XSP                    . 009A06 58F0 A5D0
         STM   15,0,TCL                  . 009A0A 90F0 A3D8
         LA    1,1544                    . 009A0E 4110 0608
         CR    1,15                      . 009A12 191F
         BNH   FXOVR                     . 009A14 47D0 B2C8
         L     15,@@APDSP                . 009A18 58F0 A870
         LA    2,PROTSP                  . 009A1C 4120 A068
         LM    3,5,XSP                   . 009A20 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 009A24 05EF
         LA    2,PROTSP                  . 009A26 4120 A068
         LM    3,5,LPRNSP                . 009A2A 9835 A158
         BALR  14,15                          CALL                     *
                                         . 009A2E 05EF
         ST    0,WCL                     . 009A30 5000 A3F8
                                                             SPACE
* FNTRLP INCRA WCL,1               Increment argument count
*      RCALL   ZPTR,ARGINT,(WPTR,WCL),(FENTR4,INTR10)
*                                  Get argument
*      GETDC   ZPTR,ZPTR,DESCR     Get value
*      VEQLC   ZPTR,S,,DEFTV       Is it STRING?
*      VEQLC   ZPTR,I,,DEFTI       Is it INTEGER?
*      RCALL   A2PTR,DTREP,ZPTR    Get data type representation
*      GETSPC  XSP,A2PTR,0         Get specifier
*      GETLG   SCL,XSP             Get length
*      SUM     TCL,TCL,SCL         Total length
*      ACOMPC  TCL,BUFLEN,FXOVR,FXOVR
*                                  Check for excessively long string
                                                             SPACE
FNTRLP   L     1,WCL                     . 009A34 5810 A3F8
         LA    1,1(1)                    . 009A38 4111 0001
         ST    1,WCL                     . 009A3C 5010 A3F8
         LA    14,S4$09A6C               . 009A40 41E0 B114
         STM   11,14,104(12)             . 009A44 90BE C068
         LR    13,12                     . 009A48 18DC
         LD    0,WPTR                    . 009A4A 6800 A400
         STD   0,128(12)                 . 009A4E 600C 0080
         LD    0,WCL                     . 009A52 6800 A3F8
         STD   0,120(12)                 . 009A56 600C 0078
         LA    12,32(12)                 . 009A5A 41CC 0020
         C     12,@@STACKT               . 009A5E 59C0 A828
         BH    OVER                      . 009A62 4720 9664
         L     11,@@ARGINT               . 009A66 58B0 AA18
         BR    11                        . 009A6A 07FB
S4$09A6C STD   0,ZPTR                    . 009A6C 6000 A440
         B     FENTR4                    . 009A70 47F0 B226
         B     S4$010                    . 009A74 47F0 95AC
         L     1,ZPTR                    . 009A78 5810 A440
         LD    0,8(1)                    . 009A7C 6801 0008
         STD   0,ZPTR                    . 009A80 6000 A440
         CLC   ZPTR$5(3),@@S             . 009A84 D502 A445 AA7B
         BE    DEFTV                     . 009A8A 4780 B1B0
         CLC   ZPTR$5(3),@@I             . 009A8E D502 A445 AA84
         BE    DEFTI                     . 009A94 4780 B19E
         LA    14,S4$09AB8               . 009A98 41E0 B160
         STM   11,14,104(12)             . 009A9C 90BE C068
         LR    13,12                     . 009AA0 18DC
         STD   0,120(12)                 . 009AA2 600C 0078
         LA    12,24(12)                 . 009AA6 41CC 0018
         C     12,@@STACKT               . 009AAA 59C0 A828
         BH    OVER                      . 009AAE 4720 9664
         L     11,@@DTREP                . 009AB2 58B0 AA00
         BR    11                        . 009AB6 07FB
S4$09AB8 STD   0,A2PTR                   . 009AB8 6000 A368
         L     1,A2PTR                   . 009ABC 5810 A368
         LM    1,4,0(1)                  . 009AC0 9814 1000
         STM   1,4,XSP                   . 009AC4 9014 A5D0
         LR    15,1                      . 009AC8 18F1
         STM   15,0,SCL                  . 009ACA 90F0 9EF8
         L     1,TCL                     . 009ACE 5810 A3D8
         A     1,SCL                     . 009AD2 5A10 9EF8
         ST    1,TCL                     . 009AD6 5010 A3D8
         LA    2,1544                    . 009ADA 4120 0608
         CR    2,1                       . 009ADE 1921
         BNH   FXOVR                     . 009AE0 47D0 B2C8
                                                             SPACE
* DEFTIA APDSP PROTSP,XSP          Append value
*      BRANCH  DEFDTT              Continue with next argument
                                                             SPACE
DEFTIA   L     15,@@APDSP                . 009AE4 58F0 A870
         LA    2,PROTSP                  . 009AE8 4120 A068
         LM    3,5,XSP                   . 009AEC 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 009AF0 05EF
         B     DEFDTT                    . 009AF2 47F0 B214
                                                             SPACE
* DEFTI INTSPC XSP,ZPTR            Convert INTEGER to STRING
*      BRANCH  DEFTIA              Rejoin processing
                                                             SPACE
DEFTI    L     15,@@BDSPEC               . 009AF6 58F0 A874
         LA    1,XSP                     . 009AFA 4110 A5D0
         LA    2,ZPTR                    . 009AFE 4120 A440
         BALR  14,15                          CALL                     *
                                         . 009B02 05EF
         B     DEFTIA                    . 009B04 47F0 B18C
                                                             SPACE
* DEFTV LOCSP  XSP,ZPTR            Get specifier
*      GETLG   SCL,XSP             Get length
*      SUM     TCL,TCL,SCL         Get total length
*      ACOMPC  TCL,BUFLEN,FXOVR,FXOVR
*                                  Check for excessively long string
*      APDSP   PROTSP,QTSP         Append quote
*      APDSP   PROTSP,XSP          Append value
*      APDSP   PROTSP,QTSP         Append quote
                                                             SPACE
DEFTV    LM    3,4,ZPTR                  . 009B08 9834 A440
         CR    0,3                       . 009B0C 1903
         BNE   S4$09B1A                  . 009B0E 4770 B1C2
         ST    0,XSP                     . 009B12 5000 A5D0
         B     S4$09B2A                  . 009B16 47F0 B1D2
S4$09B1A L     1,4(3)                    . 009B1A 5813 0004
         LA    1,0(1)                    . 009B1E 4111 0000
         LA    2,32                      . 009B22 4120 0020
         STM   1,4,XSP                   . 009B26 9014 A5D0
S4$09B2A L     15,XSP                    . 009B2A 58F0 A5D0
         STM   15,0,SCL                  . 009B2E 90F0 9EF8
         L     1,TCL                     . 009B32 5810 A3D8
         A     1,SCL                     . 009B36 5A10 9EF8
         ST    1,TCL                     . 009B3A 5010 A3D8
         LA    1,1544                    . 009B3E 4110 0608
         C     1,TCL                     . 009B42 5910 A3D8
         BNH   FXOVR                     . 009B46 47D0 B2C8
         L     15,@@APDSP                . 009B4A 58F0 A870
         LA    2,PROTSP                  . 009B4E 4120 A068
         LM    3,5,QTSP                  . 009B52 9835 A078
         BALR  14,15                          CALL                     *
                                         . 009B56 05EF
         LA    2,PROTSP                  . 009B58 4120 A068
         LM    3,5,XSP                   . 009B5C 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 009B60 05EF
         LA    2,PROTSP                  . 009B62 4120 A068
         LM    3,5,QTSP                  . 009B66 9835 A078
         BALR  14,15                          CALL                     *
                                         . 009B6A 05EF
                                                             SPACE
* DEFDTT APDSP PROTSP,CMASP        Append comma
*      BRANCH  FNTRLP              Continue processing
                                                             SPACE
DEFDTT   L     15,@@APDSP                . 009B6C 58F0 A870
         LA    2,PROTSP                  . 009B70 4120 A068
         LM    3,5,CMASP                 . 009B74 9835 A0E8
         BALR  14,15                          CALL                     *
                                         . 009B78 05EF
         B     FNTRLP                    . 009B7A 47F0 B0DC
                                                             SPACE
* FENTR4 AEQLC WCL,1,,FENTR5       Leave paren if no arguments
*      SHORTN  PROTSP,1            Delete last comma
                                                             SPACE
FENTR4   LA    6,1                       . 009B7E 4160 0001
         C     6,WCL                     . 009B82 5960 A3F8
         BE    FENTR5                    . 009B86 4780 B23C
         L     1,PROTSP                  . 009B8A 5810 A068
         BCTR  1,0                            DECREMENT                *
                                         . 009B8E 0610
         ST    1,PROTSP                  . 009B90 5010 A068
                                                             SPACE
* FENTR5 APDSP PROTSP,RPRNSP       Append right parenthesis
*      MSTIME  ZPTR                Get time
*      SUBTRT  ZPTR,ZPTR,ETMCL     Compute elapsed time
*      INTSPC  XSP,ZPTR            Convert to STRING
*      APDSP   PROTSP,ETIMSP       Append time message
*      APDSP   PROTSP,XSP          Append time
*      STPRNT  IOKEY,OUTBLK,PROTSP Print trace message
*      BRANCH  RTNUL3              Return
                                                             SPACE
FENTR5   L     15,@@APDSP                . 009B94 58F0 A870
         LA    2,PROTSP                  . 009B98 4120 A068
         LM    3,5,RPRNSP                . 009B9C 9835 A178
         BALR  14,15                          CALL                     *
                                         . 009BA0 05EF
         STM   13,1,AISAVE               . 009BA2 90D1 A770
         L     13,@@SAVSAV               . 009BA6 58D0 A810
         SR    1,1                       . 009BAA 1B11
         SVC   46                             TIMER                    *
                                         . 009BAC 0A2E
         L     3,MAXTIM                  . 009BAE 5830 A750
         SR    3,0                       . 009BB2 1B30
         M     2,@@F26                   . 009BB4 5C20 A820
         D     2,@@F1000                 . 009BB8 5D20 A824
         ST    3,ZPTR                    . 009BBC 5030 A440
         LM    13,1,AISAVE               . 009BC0 98D1 A770
         ST    0,ZPTR$4                  . 009BC4 5000 A444
         LR    1,3                       . 009BC8 1813
         S     1,ETMCL                   . 009BCA 5B10 9E68
         ST    1,ZPTR                    . 009BCE 5010 A440
         L     15,@@BDSPEC               . 009BD2 58F0 A874
         LA    1,XSP                     . 009BD6 4110 A5D0
         LA    2,ZPTR                    . 009BDA 4120 A440
         BALR  14,15                          CALL                     *
                                         . 009BDE 05EF
         L     15,@@APDSP                . 009BE0 58F0 A870
         LA    2,PROTSP                  . 009BE4 4120 A068
         LM    3,5,ETIMSP                . 009BE8 9835 A118
         BALR  14,15                          CALL                     *
                                         . 009BEC 05EF
         LA    2,PROTSP                  . 009BEE 4120 A068
         LM    3,5,XSP                   . 009BF2 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 009BF6 05EF
         L     15,@@STPRNT               . 009BF8 58F0 A838
         LA    1,IOKEY                   . 009BFC 4110 9EA0
         LA    2,OUTBLK                  . 009C00 4120 9C70
         LA    3,PROTSP                  . 009C04 4130 A068
         BALR  14,15                          CALL                     *
                                         . 009C08 05EF
         B     RTNUL3                    . 009C0A 47F0 9030
                                                             SPACE
* FENTR2 PROC  FENTR               Standard entry
*      POP     WPTR                Restore function name
*      BRANCH  FENTR3
                                                             SPACE
FENTR2   L     11,@@FENTR                . 009C0E 58B0 AA1C
         LD    0,96(12)                  . 009C12 680C 0060
         STD   0,WPTR                    . 009C16 6000 A400
         SR    12,8                      . 009C1A 1BC8
         B     FENTR3                    . 009C1C 47F0 B024
                                                             SPACE
* FXOVR OUTPUT OUTPUT,PRTOVF       Print error message
*      BRANCH  RTNUL3              Return
FXOVR    STM   13,1,AISAVE               . 009C20 90D1 A770
         L     13,@@SAVSAV               . 009C24 58D0 A810
         L     15,@@IBCOM#               . 009C28 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 009C2C 45EF 0004
         DC    X'01'                     . 009C30 01
         DC    AL3(OUTPUT)               . 009C31 00D068
         DC    X'01'                     . 009C34 01
         DC    AL3(PRTOVF)               . 009C35 0142AF
         BAL   14,16(15)                      CALL                     *
                                         . 009C38 45EF 0010
         LM    13,1,AISAVE               . 009C3C 98D1 A770
         B     RTNUL3                    . 009C40 47F0 9030
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Keyword and Label Tracing
*
                                                             SPACE
* KEYTR PROC   ,                   Procedure to trace keywords
*      SETAC   FNVLCL,1            Set entry indicator
*      RCALL   WPTR,VARVAL,,FAIL   Get keyword
*      LOCSP   XSP,WPTR            Get specifier
*      RCALL   YCL,KEYT,(WPTR),(INTR10,)
*                                  Get value of keyword
                                                             SPACE
         USING KEYTR,11                  .
KEYTR    LA    1,1                       . 009C44 4110 0001
         ST    1,XXXXCL                  . 009C48 5010 9BB8
         LA    14,S4$09C68               . 009C4C 41E0 B024
         STM   11,14,104(12)             . 009C50 90BE C068
         LR    13,12                     . 009C54 18DC
         LA    12,16(12)                 . 009C56 41CC 0010
         C     12,@@STACKT               . 009C5A 59C0 A828
         BH    OVER                      . 009C5E 4720 9664
         L     11,@@VARVAL               . 009C62 58B0 A9C0
         BR    11                        . 009C66 07FB
S4$09C68 STD   0,WPTR                    . 009C68 6000 A400
         B     FAIL                      . 009C6C 47F0 9010
         LM    3,4,WPTR                  . 009C70 9834 A400
         CR    0,3                       . 009C74 1903
         BNE   S4$09C82                  . 009C76 4770 B03E
         ST    0,XSP                     . 009C7A 5000 A5D0
         B     S4$09C92                  . 009C7E 47F0 B04E
S4$09C82 L     1,4(3)                    . 009C82 5813 0004
         LA    1,0(1)                    . 009C86 4111 0000
         LA    2,32                      . 009C8A 4120 0020
         STM   1,4,XSP                   . 009C8E 9014 A5D0
S4$09C92 LA    14,S4$09CB6               . 009C92 41E0 B072
         STM   11,14,104(12)             . 009C96 90BE C068
         LR    13,12                     . 009C9A 18DC
         LD    0,WPTR                    . 009C9C 6800 A400
         STD   0,120(12)                 . 009CA0 600C 0078
         LA    12,24(12)                 . 009CA4 41CC 0018
         C     12,@@STACKT               . 009CA8 59C0 A828
         BH    OVER                      . 009CAC 4720 9664
         L     11,@@KEYT                 . 009CB0 58B0 AA20
         BR    11                        . 009CB4 07FB
S4$09CB6 STD   0,YCL                     . 009CB6 6000 A420
         B     S4$010                    . 009CBA 47F0 95AC
         B     KEYTR3                    . 009CBE 47F0 B07E
                                                             SPACE
* KEYTR3 SETLC PROTSP,0            Clear specifier
*      APDSP   PROTSP,TRSTSP       Append trace message
*      INTSPC  TSP,STNOCL          Convert &STNO to string
*      APDSP   PROTSP,TSP          Append &STNO
*      APDSP   PROTSP,COLSP        Append colon
*      AEQLC   FNVLCL,0,,KEYTR4    Check entry indicator
*      APDSP   PROTSP,AMPSP        Append ampersand
                                                             SPACE
KEYTR3   ST    0,PROTSP                  . 009CC2 5000 A068
         L     15,@@APDSP                . 009CC6 58F0 A870
         LA    2,PROTSP                  . 009CCA 4120 A068
         LM    3,5,TRSTSP                . 009CCE 9835 A1B8
         BALR  14,15                          CALL                     *
                                         . 009CD2 05EF
         L     15,@@BDSPEC               . 009CD4 58F0 A874
         LA    1,TSP                     . 009CD8 4110 A5A0
         LA    2,STNOCL                  . 009CDC 4120 9990
         BALR  14,15                          CALL                     *
                                         . 009CE0 05EF
         L     15,@@APDSP                . 009CE2 58F0 A870
         LA    2,PROTSP                  . 009CE6 4120 A068
         LM    3,5,TSP                   . 009CEA 9835 A5A0
         BALR  14,15                          CALL                     *
                                         . 009CEE 05EF
         LA    2,PROTSP                  . 009CF0 4120 A068
         LM    3,5,COLSP                 . 009CF4 9835 A038
         BALR  14,15                          CALL                     *
                                         . 009CF8 05EF
         C     0,XXXXCL                  . 009CFA 5900 9BB8
         BE    KEYTR4                    . 009CFE 4780 B0C8
         LA    2,PROTSP                  . 009D02 4120 A068
         LM    3,5,AMPSP                 . 009D06 9835 A018
         BALR  14,15                          CALL                     *
                                         . 009D0A 05EF
                                                             SPACE
* KEYTR4 APDSP PROTSP,XSP          Append name of keyword
*      APDSP   PROTSP,BLSP         Append blank
*      AEQLC   FNVLCL,0,,KEYTR5    Check entry indicator
*      INTSPC  YSP,YCL             Convert keyword value to string
*      APDSP   PROTSP,EQLSP        Append equal sign
                                                             SPACE
KEYTR4   L     15,@@APDSP                . 009D0C 58F0 A870
         LA    2,PROTSP                  . 009D10 4120 A068
         LM    3,5,XSP                   . 009D14 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 009D18 05EF
         LA    2,PROTSP                  . 009D1A 4120 A068
         LM    3,5,BLSP                  . 009D1E 9835 A0C8
         BALR  14,15                          CALL                     *
                                         . 009D22 05EF
         C     0,XXXXCL                  . 009D24 5900 9BB8
         BE    KEYTR5                    . 009D28 4780 B104
         L     15,@@BDSPEC               . 009D2C 58F0 A874
         LA    1,YSP                     . 009D30 4110 A5E0
         LA    2,YCL                     . 009D34 4120 A420
         BALR  14,15                          CALL                     *
                                         . 009D38 05EF
         L     15,@@APDSP                . 009D3A 58F0 A870
         LA    2,PROTSP                  . 009D3E 4120 A068
         LM    3,5,EQLSP                 . 009D42 9835 A108
         BALR  14,15                          CALL                     *
                                         . 009D46 05EF
                                                             SPACE
* KEYTR5 APDSP PROTSP,YSP          Append value
*      MSTIME  YPTR                Get time
*      SUBTRT  YPTR,YPTR,ETMCL     Compute elapsed time
*      INTSPC  XSP,YPTR            Convert time to string
*      APDSP   PROTSP,ETIMSP       Append time message
*      APDSP   PROTSP,XSP          Append time
*      STPRNT  IOKEY,OUTBLK,PROTSP Print trace message
*      BRANCH  RTN2                Return
                                                             SPACE
KEYTR5   L     15,@@APDSP                . 009D48 58F0 A870
         LA    2,PROTSP                  . 009D4C 4120 A068
         LM    3,5,YSP                   . 009D50 9835 A5E0
         BALR  14,15                          CALL                     *
                                         . 009D54 05EF
         STM   13,1,AISAVE               . 009D56 90D1 A770
         L     13,@@SAVSAV               . 009D5A 58D0 A810
         SR    1,1                       . 009D5E 1B11
         SVC   46                             TIMER                    *
                                         . 009D60 0A2E
         L     3,MAXTIM                  . 009D62 5830 A750
         SR    3,0                       . 009D66 1B30
         M     2,@@F26                   . 009D68 5C20 A820
         D     2,@@F1000                 . 009D6C 5D20 A824
         ST    3,YPTR                    . 009D70 5030 A428
         LM    13,1,AISAVE               . 009D74 98D1 A770
         ST    0,YPTR$4                  . 009D78 5000 A42C
         LR    1,3                       . 009D7C 1813
         S     1,ETMCL                   . 009D7E 5B10 9E68
         ST    1,YPTR                    . 009D82 5010 A428
         L     15,@@BDSPEC               . 009D86 58F0 A874
         LA    1,XSP                     . 009D8A 4110 A5D0
         LA    2,YPTR                    . 009D8E 4120 A428
         BALR  14,15                          CALL                     *
                                         . 009D92 05EF
         L     15,@@APDSP                . 009D94 58F0 A870
         LA    2,PROTSP                  . 009D98 4120 A068
         LM    3,5,ETIMSP                . 009D9C 9835 A118
         BALR  14,15                          CALL                     *
                                         . 009DA0 05EF
         LA    2,PROTSP                  . 009DA2 4120 A068
         LM    3,5,XSP                   . 009DA6 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 009DAA 05EF
         L     15,@@STPRNT               . 009DAC 58F0 A838
         LA    1,IOKEY                   . 009DB0 4110 9EA0
         LA    2,OUTBLK                  . 009DB4 4120 9C70
         LA    3,PROTSP                  . 009DB8 4130 A068
         BALR  14,15                          CALL                     *
                                         . 009DBC 05EF
         B     RTN2                      . 009DBE 47F0 9028
                                                             SPACE
* LABTR PROC   KEYTR               Procedure to trace labels
*      SETAC   FNVLCL,0            Set entry indicator
*      RCALL   YPTR,VARVAL,,FAIL   Get label name
*      LOCSP   YSP,YPTR            Get specifier
*      SETSP   XSP,XFERSP          Set up message specifier
*      BRANCH  KEYTR3              Join common processing
LABTR    L     11,@@KEYTR                . 009DC2 58B0 AA24
         ST    0,XXXXCL                  . 009DC6 5000 9BB8
         LA    14,S4$09DE6               . 009DCA 41E0 B1A2
         STM   11,14,104(12)             . 009DCE 90BE C068
         LR    13,12                     . 009DD2 18DC
         LA    12,16(12)                 . 009DD4 41CC 0010
         C     12,@@STACKT               . 009DD8 59C0 A828
         BH    OVER                      . 009DDC 4720 9664
         L     11,@@VARVAL               . 009DE0 58B0 A9C0
         BR    11                        . 009DE4 07FB
S4$09DE6 STD   0,YPTR                    . 009DE6 6000 A428
         B     FAIL                      . 009DEA 47F0 9010
         LM    3,4,YPTR                  . 009DEE 9834 A428
         CR    0,3                       . 009DF2 1903
         BNE   S4$09E00                  . 009DF4 4770 B1BC
         ST    0,YSP                     . 009DF8 5000 A5E0
         B     S4$09E10                  . 009DFC 47F0 B1CC
S4$09E00 L     1,4(3)                    . 009E00 5813 0004
         LA    1,0(1)                    . 009E04 4111 0000
         LA    2,32                      . 009E08 4120 0020
         STM   1,4,YSP                   . 009E0C 9014 A5E0
S4$09E10 LM    1,4,XFERSP                . 009E10 9814 A1D8
         STM   1,4,XSP                   . 009E14 9014 A5D0
         B     KEYTR3                    . 009E18 47F0 B07E
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Trace Handler
*
                                                             SPACE
* TRPHND PROC  ,                   Trace handling procedure
*      POP     ATPTR               Restore trace
*      DECRA   TRAPCL,1            Decrement &TRACE
*      PUSH    (LSTNCL,STNOCL,FRTNCL,OCBSCL,OCICL,TRAPCL,TRACL)
*                                  Save system descriptors
*      GETDC   OCBSCL,ATPTR,2*DESCR    NEW CODE BASE
*                                  Get new code base
*      SETAC   OCICL,DESCR         Set up offset
*      GETD    XPTR,OCBSCL,OCICL   Get function descriptor
*      SETAC   TRAPCL,0            Set &TRACE to 0
*      SETAC   TRACL,0             Set &FTRACE to 0
*      RCALL   ,INVOKE,XPTR,(,)    Evaluate function            E3.3.1
*      POP     (TRACL,TRAPCL,OCICL,OCBSCL,FRTNCL,STNOCL,LSTNCL)
*                                  Restore system descriptors
*      BRANCH  RTN1                                             E3.3.1
         USING TRPHND,11                 .
TRPHND   LD    0,96(12)                  . 009E1C 680C 0060
         STD   0,ATPTR                   . 009E20 6000 A378
         SR    12,8                      . 009E24 1BC8
         LM    1,2,TRAPCL                . 009E26 9812 9818
         BCTR  1,0                            DECREMENT                *
                                         . 009E2A 0610
         STM   1,2,TRAPCL                . 009E2C 9012 9818
         LD    0,LSTNCL                  . 009E30 6800 9970
         STD   0,104(12)                 . 009E34 600C 0068
         LD    0,STNOCL                  . 009E38 6800 9990
         STD   0,112(12)                 . 009E3C 600C 0070
         LD    0,FRTNCL                  . 009E40 6800 9E88
         STD   0,120(12)                 . 009E44 600C 0078
         LD    0,OCBSCL                  . 009E48 6800 A470
         STD   0,128(12)                 . 009E4C 600C 0080
         LD    0,OCICL                   . 009E50 6800 9ED8
         STD   0,136(12)                 . 009E54 600C 0088
         STM   1,2,144(12)               . 009E58 9012 C090
         LD    0,TRACL                   . 009E5C 6800 9878
         STD   0,152(12)                 . 009E60 600C 0098
         LA    12,56(12)                 . 009E64 41CC 0038
         C     12,@@STACKT               . 009E68 59C0 A828
         BH    OVER                      . 009E6C 4720 9664
         L     1,ATPTR                   . 009E70 5810 A378
         LD    0,16(1)                   . 009E74 6801 0010
         STD   0,OCBSCL                  . 009E78 6000 A470
         L     1,@@DESCR                 . 009E7C 5810 A87C
         ST    1,OCICL                   . 009E80 5010 9ED8
         L     2,OCBSCL                  . 009E84 5820 A470
         LD    0,0(1,2)                  . 009E88 6801 2000
         STD   0,XPTR                    . 009E8C 6000 A410
         ST    0,TRAPCL                  . 009E90 5000 9818
         ST    0,TRACL                   . 009E94 5000 9878
         LA    14,S4$09EB8               . 009E98 41E0 B09C
         STM   11,14,104(12)             . 009E9C 90BE C068
         LR    13,12                     . 009EA0 18DC
         STD   0,120(12)                 . 009EA2 600C 0078
         LA    12,24(12)                 . 009EA6 41CC 0018
         C     12,@@STACKT               . 009EAA 59C0 A828
         BH    OVER                      . 009EAE 4720 9664
         L     11,@@INVOKE               . 009EB2 58B0 A91C
         BR    11                        . 009EB6 07FB
S4$09EB8 SR    0,0                       . 009EB8 1B00
         SR    0,0                       . 009EBA 1B00
         B     S4$09EC4                  . 009EBC 47F0 B0A8
         B     S4$09EC4                  . 009EC0 47F0 B0A8
S4$09EC4 LD    0,96(12)                  . 009EC4 680C 0060
         STD   0,TRACL                   . 009EC8 6000 9878
         LD    0,88(12)                  . 009ECC 680C 0058
         STD   0,TRAPCL                  . 009ED0 6000 9818
         LD    0,80(12)                  . 009ED4 680C 0050
         STD   0,OCICL                   . 009ED8 6000 9ED8
         LD    0,72(12)                  . 009EDC 680C 0048
         STD   0,OCBSCL                  . 009EE0 6000 A470
         LD    0,64(12)                  . 009EE4 680C 0040
         STD   0,FRTNCL                  . 009EE8 6000 9E88
         LD    0,56(12)                  . 009EEC 680C 0038
         STD   0,STNOCL                  . 009EF0 6000 9990
         LD    0,48(12)                  . 009EF4 680C 0030
         STD   0,LSTNCL                  . 009EF8 6000 9970
         S     12,@@K7M8R                . 009EFC 5BC0 AA28
         B     FAIL                      . 009F00 47F0 9010
         LD    0,96(12)                  . 009F04 680C 0060
         STD   0,TRACL                   . 009F08 6000 9878
         LD    0,88(12)                  . 009F0C 680C 0058
         STD   0,TRAPCL                  . 009F10 6000 9818
         LD    0,80(12)                  . 009F14 680C 0050
         STD   0,OCICL                   . 009F18 6000 9ED8
         LD    0,72(12)                  . 009F1C 680C 0048
         STD   0,OCBSCL                  . 009F20 6000 A470
         LD    0,64(12)                  . 009F24 680C 0040
         STD   0,FRTNCL                  . 009F28 6000 9E88
         LD    0,56(12)                  . 009F2C 680C 0038
         STD   0,STNOCL                  . 009F30 6000 9990
         LD    0,48(12)                  . 009F34 680C 0030
         STD   0,LSTNCL                  . 009F38 6000 9970
         S     12,@@K7M8R                . 009F3C 5BC0 AA28
         B     FAIL                      . 009F40 47F0 9010
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Value Tracing
*
                                                             SPACE
* VALTR PROC   ,                   Tracing procedures
*      SETAC   FNVLCL,1            Note entry
                                                             SPACE
         USING VALTR,11                  .
VALTR    LA    1,1                       . 009F44 4110 0001
         ST    1,XXXXCL                  . 009F48 5010 9BB8
                                                             SPACE
* VALTR2 RCALL XPTR,IND,,FAIL      Get variable to be traced
*      PUSH    XPTR                Save name
*      RCALL   ZPTR,VARVAL,,FAIL   Get tag
*      POP     XPTR                Restore variable
                                                             SPACE
VALTR2   LA    14,S4$09F68               . 009F4C 41E0 B024
         STM   11,14,104(12)             . 009F50 90BE C068
         LR    13,12                     . 009F54 18DC
         LA    12,16(12)                 . 009F56 41CC 0010
         C     12,@@STACKT               . 009F5A 59C0 A828
         BH    OVER                      . 009F5E 4720 9664
         L     11,@@IND                  . 009F62 58B0 A9F0
         BR    11                        . 009F66 07FB
S4$09F68 STD   0,XPTR                    . 009F68 6000 A410
         B     FAIL                      . 009F6C 47F0 9010
         LD    0,XPTR                    . 009F70 6800 A410
         STD   0,104(12)                 . 009F74 600C 0068
         AR    12,8                      . 009F78 1AC8
         C     12,@@STACKT               . 009F7A 59C0 A828
         BH    OVER                      . 009F7E 4720 9664
         LA    14,S4$09F9E               . 009F82 41E0 B05A
         STM   11,14,104(12)             . 009F86 90BE C068
         LR    13,12                     . 009F8A 18DC
         LA    12,16(12)                 . 009F8C 41CC 0010
         C     12,@@STACKT               . 009F90 59C0 A828
         BH    OVER                      . 009F94 4720 9664
         L     11,@@VARVAL               . 009F98 58B0 A9C0
         BR    11                        . 009F9C 07FB
S4$09F9E STD   0,ZPTR                    . 009F9E 6000 A440
         B     FAIL                      . 009FA2 47F0 9010
         LD    0,96(12)                  . 009FA6 680C 0060
         STD   0,XPTR                    . 009FAA 6000 A410
         SR    12,8                      . 009FAE 1BC8
                                                             SPACE
* VALTR4 SETLC TRACSP,0            Clear specifier
*      APDSP   TRACSP,TRSTSP       Append trace message
*      INTSPC  XSP,STNOCL          Convert &STNO to string
*      APDSP   TRACSP,XSP          Append &STNO
*      APDSP   TRACSP,COLSP        Append colon
*      AEQLC   FNVLCL,0,,FNEXT1    Check entry indicator
*      VEQLC   XPTR,S,DEFDT        Is variable a string?
                                                             SPACE
VALTR4   ST    0,TRACSP                  . 009FB0 5000 A098
         L     15,@@APDSP                . 009FB4 58F0 A870
         LA    2,TRACSP                  . 009FB8 4120 A098
         LM    3,5,TRSTSP                . 009FBC 9835 A1B8
         BALR  14,15                          CALL                     *
                                         . 009FC0 05EF
         L     15,@@BDSPEC               . 009FC2 58F0 A874
         LA    1,XSP                     . 009FC6 4110 A5D0
         LA    2,STNOCL                  . 009FCA 4120 9990
         BALR  14,15                          CALL                     *
                                         . 009FCE 05EF
         L     15,@@APDSP                . 009FD0 58F0 A870
         LA    2,TRACSP                  . 009FD4 4120 A098
         LM    3,5,XSP                   . 009FD8 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 009FDC 05EF
         LA    2,TRACSP                  . 009FDE 4120 A098
         LM    3,5,COLSP                 . 009FE2 9835 A038
         BALR  14,15                          CALL                     *
                                         . 009FE6 05EF
         C     0,XXXXCL                  . 009FE8 5900 9BB8
         BE    FNEXT1                    . 009FEC 4780 B274
         CLC   XPTR$5(3),@@S             . 009FF0 D502 A415 AA7B
         BNE   DEFDT                     . 009FF6 4770 B242
                                                             SPACE
* VALTR3 LOCSP XSP,XPTR            Get specifier
*      GETLG   TCL,XSP             Get length
*      ACOMPC  TCL,BUFLEN,VXOVR,VXOVR
*                                  Check for excessively long name
                                                             SPACE
VALTR3   LM    3,4,XPTR                  . 009FFA 9834 A410
         CR    0,3                       . 009FFE 1903
         BNE   S4$0A00C                  . 00A000 4770 B0C8
         ST    0,XSP                     . 00A004 5000 A5D0
         B     S4$0A01C                  . 00A008 47F0 B0D8
S4$0A00C L     1,4(3)                    . 00A00C 5813 0004
         LA    1,0(1)                    . 00A010 4111 0000
         LA    2,32                      . 00A014 4120 0020
         STM   1,4,XSP                   . 00A018 9014 A5D0
S4$0A01C L     15,XSP                    . 00A01C 58F0 A5D0
         STM   15,0,TCL                  . 00A020 90F0 A3D8
         LA    1,1544                    . 00A024 4110 0608
         CR    1,15                      . 00A028 191F
         BNH   VXOVR                     . 00A02A 47D0 B356
                                                             SPACE
* VALTR1 APDSP TRACSP,XSP          Append name of variable
*      APDSP   TRACSP,BLEQSP       Append ' = '
*      GETDC   YPTR,XPTR,DESCR     Get value of traced variable
*      VEQLC   YPTR,S,,TRV         Is it STRING?
*      VEQLC   YPTR,I,,TRI         Is it INTEGER?
*      RCALL   XPTR,DTREP,YPTR     Else get data type representation
*      GETSPC  XSP,XPTR,0          Get specifier
                                                             SPACE
VALTR1   L     15,@@APDSP                . 00A02E 58F0 A870
         LA    2,TRACSP                  . 00A032 4120 A098
         LM    3,5,XSP                   . 00A036 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 00A03A 05EF
         LA    2,TRACSP                  . 00A03C 4120 A098
         LM    3,5,BLEQSP                . 00A040 9835 A0D8
         BALR  14,15                          CALL                     *
                                         . 00A044 05EF
         L     1,XPTR                    . 00A046 5810 A410
         LD    0,8(1)                    . 00A04A 6801 0008
         STD   0,YPTR                    . 00A04E 6000 A428
         CLC   YPTR$5(3),@@S             . 00A052 D502 A42D AA7B
         BE    TRV                       . 00A058 4780 B164
         CLC   YPTR$5(3),@@I             . 00A05C D502 A42D AA84
         BE    TRI                       . 00A062 4780 B230
         LA    14,S4$0A086               . 00A066 41E0 B142
         STM   11,14,104(12)             . 00A06A 90BE C068
         LR    13,12                     . 00A06E 18DC
         STD   0,120(12)                 . 00A070 600C 0078
         LA    12,24(12)                 . 00A074 41CC 0018
         C     12,@@STACKT               . 00A078 59C0 A828
         BH    OVER                      . 00A07C 4720 9664
         L     11,@@DTREP                . 00A080 58B0 AA00
         BR    11                        . 00A084 07FB
S4$0A086 STD   0,XPTR                    . 00A086 6000 A410
         L     1,XPTR                    . 00A08A 5810 A410
         LM    1,4,0(1)                  . 00A08E 9814 1000
         STM   1,4,XSP                   . 00A092 9014 A5D0
                                                             SPACE
* TRI2 APDSP   TRACSP,XSP          Append value
*      BRANCH  TRPRT               Join common processing
                                                             SPACE
TRI2     L     15,@@APDSP                . 00A096 58F0 A870
         LA    2,TRACSP                  . 00A09A 4120 A098
         LM    3,5,XSP                   . 00A09E 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 00A0A2 05EF
         B     TRPRT                     . 00A0A4 47F0 B1C4
                                                             SPACE
* TRV  LOCSP   XSP,YPTR            Get specifier
*      GETLG   SCL,XSP             Get length
*      SUM     TCL,TCL,SCL         Compute total length
*      ACOMPC  TCL,BUFLEN,VXOVR,VXOVR
*                                  Check for excessively long message
*      APDSP   TRACSP,QTSP         Append quote
*      APDSP   TRACSP,XSP          Append string
*      APDSP   TRACSP,QTSP         Append quote
                                                             SPACE
TRV      LM    3,4,YPTR                  . 00A0A8 9834 A428
         CR    0,3                       . 00A0AC 1903
         BNE   S4$0A0BA                  . 00A0AE 4770 B176
         ST    0,XSP                     . 00A0B2 5000 A5D0
         B     S4$0A0CA                  . 00A0B6 47F0 B186
S4$0A0BA L     1,4(3)                    . 00A0BA 5813 0004
         LA    1,0(1)                    . 00A0BE 4111 0000
         LA    2,32                      . 00A0C2 4120 0020
         STM   1,4,XSP                   . 00A0C6 9014 A5D0
S4$0A0CA L     15,XSP                    . 00A0CA 58F0 A5D0
         STM   15,0,SCL                  . 00A0CE 90F0 9EF8
         L     1,TCL                     . 00A0D2 5810 A3D8
         AR    1,15                      . 00A0D6 1A1F
         ST    1,TCL                     . 00A0D8 5010 A3D8
         LA    2,1544                    . 00A0DC 4120 0608
         CR    2,1                       . 00A0E0 1921
         BNH   VXOVR                     . 00A0E2 47D0 B356
         L     15,@@APDSP                . 00A0E6 58F0 A870
         LA    2,TRACSP                  . 00A0EA 4120 A098
         LM    3,5,QTSP                  . 00A0EE 9835 A078
         BALR  14,15                          CALL                     *
                                         . 00A0F2 05EF
         LA    2,TRACSP                  . 00A0F4 4120 A098
         LM    3,5,XSP                   . 00A0F8 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 00A0FC 05EF
         LA    2,TRACSP                  . 00A0FE 4120 A098
         LM    3,5,QTSP                  . 00A102 9835 A078
         BALR  14,15                          CALL                     *
                                         . 00A106 05EF
                                                             SPACE
* TRPRT MSTIME YPTR                Get time
*      SUBTRT  YPTR,YPTR,ETMCL     Compute time in interpreter
*      INTSPC  XSP,YPTR            Convert to STRING
*      APDSP   TRACSP,ETIMSP       Append time message
*      APDSP   TRACSP,XSP          Append time
*      STPRNT  IOKEY,OUTBLK,TRACSP Print trace message
*      BRANCH  RTNUL3              Return
                                                             SPACE
TRPRT    STM   13,1,AISAVE               . 00A108 90D1 A770
         L     13,@@SAVSAV               . 00A10C 58D0 A810
         SR    1,1                       . 00A110 1B11
         SVC   46                             TIMER                    *
                                         . 00A112 0A2E
         L     3,MAXTIM                  . 00A114 5830 A750
         SR    3,0                       . 00A118 1B30
         M     2,@@F26                   . 00A11A 5C20 A820
         D     2,@@F1000                 . 00A11E 5D20 A824
         ST    3,YPTR                    . 00A122 5030 A428
         LM    13,1,AISAVE               . 00A126 98D1 A770
         ST    0,YPTR$4                  . 00A12A 5000 A42C
         LR    1,3                       . 00A12E 1813
         S     1,ETMCL                   . 00A130 5B10 9E68
         ST    1,YPTR                    . 00A134 5010 A428
         L     15,@@BDSPEC               . 00A138 58F0 A874
         LA    1,XSP                     . 00A13C 4110 A5D0
         LA    2,YPTR                    . 00A140 4120 A428
         BALR  14,15                          CALL                     *
                                         . 00A144 05EF
         L     15,@@APDSP                . 00A146 58F0 A870
         LA    2,TRACSP                  . 00A14A 4120 A098
         LM    3,5,ETIMSP                . 00A14E 9835 A118
         BALR  14,15                          CALL                     *
                                         . 00A152 05EF
         LA    2,TRACSP                  . 00A154 4120 A098
         LM    3,5,XSP                   . 00A158 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 00A15C 05EF
         L     15,@@STPRNT               . 00A15E 58F0 A838
         LA    1,IOKEY                   . 00A162 4110 9EA0
         LA    2,OUTBLK                  . 00A166 4120 9C70
         LA    3,TRACSP                  . 00A16A 4130 A098
         BALR  14,15                          CALL                     *
                                         . 00A16E 05EF
         B     RTNUL3                    . 00A170 47F0 9030
                                                             SPACE
* TRI  INTSPC  XSP,YPTR            Convert INTEGER to STRING
*      BRANCH  TRI2                Join processing
                                                             SPACE
TRI      L     15,@@BDSPEC               . 00A174 58F0 A874
         LA    1,XSP                     . 00A178 4110 A5D0
         LA    2,YPTR                    . 00A17C 4120 A428
         BALR  14,15                          CALL                     *
                                         . 00A180 05EF
         B     TRI2                      . 00A182 47F0 B152
                                                             SPACE
* DEFDT LOCSP  XSP,ZPTR            Get specifier for tag
*      BRANCH  VALTR1              Join processing
                                                             SPACE
DEFDT    LM    3,4,ZPTR                  . 00A186 9834 A440
         CR    0,3                       . 00A18A 1903
         BNE   S4$0A198                  . 00A18C 4770 B254
         ST    0,XSP                     . 00A190 5000 A5D0
         B     S4$0A1A8                  . 00A194 47F0 B264
S4$0A198 L     1,4(3)                    . 00A198 5813 0004
         LA    1,0(1)                    . 00A19C 4111 0000
         LA    2,32                      . 00A1A0 4120 0020
         STM   1,4,XSP                   . 00A1A4 9014 A5D0
S4$0A1A8 B     VALTR1                    . 00A1A8 47F0 B0EA
                                                             SPACE
* FNEXTR PROC  VALTR               Return tracing procedure
*      SETAC   FNVLCL,0            Note entry
*      BRANCH  VALTR2              Join processing
                                                             SPACE
FNEXTR   L     11,@@VALTR                . 00A1AC 58B0 AA2C
         ST    0,XXXXCL                  . 00A1B0 5000 9BB8
         B     VALTR2                    . 00A1B4 47F0 B008
                                                             SPACE
* FNEXT1 APDSP TRACSP,TRLVSP       Append level message
*      MOVD    XCL,LVLCL           Copy &FNCLEVEL
*      DECRA   XCL,1               Decrement
*      INTSPC  XSP,XCL             Convert to STRING
*      APDSP   TRACSP,XSP          Append function level
*      APDSP   TRACSP,BLSP         Append blank
*      LOCSP   XSP,RETPCL          Get specifier for return
*      APDSP   TRACSP,XSP          Append return type
*      APDSP   TRACSP,OFSP         Append ' OF '
*      DEQL    RETPCL,FRETCL,VALTR3
*                                  Check for FRETURN
*      LOCSP   XSP,XPTR            Get specifier for function name
*      GETLG   TCL,XSP             Get length
*      ACOMPC  TCL,BUFLEN,VXOVR,VXOVR
*                                  Check for excessively long string
*      APDSP   TRACSP,XSP          Append name of function
*      BRANCH  TRPRT               Join common processing
                                                             SPACE
FNEXT1   L     15,@@APDSP                . 00A1B8 58F0 A870
         LA    2,TRACSP                  . 00A1BC 4120 A098
         LM    3,5,TRLVSP                . 00A1C0 9835 A1A8
         BALR  14,15                          CALL                     *
                                         . 00A1C4 05EF
         LM    1,2,LVLCL                 . 00A1C6 9812 99C0
         STM   1,2,XCL                   . 00A1CA 9012 A408
         BCTR  1,0                            DECREMENT                *
                                         . 00A1CE 0610
         ST    1,XCL                     . 00A1D0 5010 A408
         L     15,@@BDSPEC               . 00A1D4 58F0 A874
         LA    1,XSP                     . 00A1D8 4110 A5D0
         LA    2,XCL                     . 00A1DC 4120 A408
         BALR  14,15                          CALL                     *
                                         . 00A1E0 05EF
         L     15,@@APDSP                . 00A1E2 58F0 A870
         LA    2,TRACSP                  . 00A1E6 4120 A098
         LM    3,5,XSP                   . 00A1EA 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 00A1EE 05EF
         LA    2,TRACSP                  . 00A1F0 4120 A098
         LM    3,5,BLSP                  . 00A1F4 9835 A0C8
         BALR  14,15                          CALL                     *
                                         . 00A1F8 05EF
         LM    3,4,RETPCL                . 00A1FA 9834 9980
         CR    0,3                       . 00A1FE 1903
         BNE   S4$0A20C                  . 00A200 4770 B2C8
         ST    0,XSP                     . 00A204 5000 A5D0
         B     S4$0A21C                  . 00A208 47F0 B2D8
S4$0A20C L     1,4(3)                    . 00A20C 5813 0004
         LA    1,0(1)                    . 00A210 4111 0000
         LA    2,32                      . 00A214 4120 0020
         STM   1,4,XSP                   . 00A218 9014 A5D0
S4$0A21C L     15,@@APDSP                . 00A21C 58F0 A870
         LA    2,TRACSP                  . 00A220 4120 A098
         LM    3,5,XSP                   . 00A224 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 00A228 05EF
         LA    2,TRACSP                  . 00A22A 4120 A098
         LM    3,5,OFSP                  . 00A22E 9835 A168
         BALR  14,15                          CALL                     *
                                         . 00A232 05EF
         CLC   RETPCL(8),FRETCL          . 00A234 D507 9980 A530
         BNE   VALTR3                    . 00A23A 4770 B0B6
         LM    3,4,XPTR                  . 00A23E 9834 A410
         CR    0,3                       . 00A242 1903
         BNE   S4$0A250                  . 00A244 4770 B30C
         ST    0,XSP                     . 00A248 5000 A5D0
         B     S4$0A260                  . 00A24C 47F0 B31C
S4$0A250 L     1,4(3)                    . 00A250 5813 0004
         LA    1,0(1)                    . 00A254 4111 0000
         LA    2,32                      . 00A258 4120 0020
         STM   1,4,XSP                   . 00A25C 9014 A5D0
S4$0A260 L     15,XSP                    . 00A260 58F0 A5D0
         STM   15,0,TCL                  . 00A264 90F0 A3D8
         LA    1,1544                    . 00A268 4110 0608
         CR    1,15                      . 00A26C 191F
         BNH   VXOVR                     . 00A26E 47D0 B356
         L     15,@@APDSP                . 00A272 58F0 A870
         LA    2,TRACSP                  . 00A276 4120 A098
         LM    3,5,XSP                   . 00A27A 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 00A27E 05EF
         B     TRPRT                     . 00A280 47F0 B1C4
                                                             SPACE
* FNEXT2 PROC  VALTR               Note entry
*      SETAC   FNVLCL,0            Restore function name
*      POP     XPTR                Join common processing
*      BRANCH  VALTR4
                                                             SPACE
FNEXT2   L     11,@@VALTR                . 00A284 58B0 AA2C
         ST    0,XXXXCL                  . 00A288 5000 9BB8
         LD    0,96(12)                  . 00A28C 680C 0060
         STD   0,XPTR                    . 00A290 6000 A410
         SR    12,8                      . 00A294 1BC8
         B     VALTR4                    . 00A296 47F0 B06C
                                                             SPACE
* VXOVR OUTPUT OUTPUT,PRTOVF       Print error message
*      BRANCH  RTNUL3              Return
VXOVR    STM   13,1,AISAVE               . 00A29A 90D1 A770
         L     13,@@SAVSAV               . 00A29E 58D0 A810
         L     15,@@IBCOM#               . 00A2A2 58F0 A814
         NOPR  0                         . 00A2A6 0700
         BAL   14,4(15)                       CALL                     *
                                         . 00A2A8 45EF 0004
         DC    X'01'                     . 00A2AC 01
         DC    AL3(OUTPUT)               . 00A2AD 00D068
         DC    X'01'                     . 00A2B0 01
         DC    AL3(PRTOVF)               . 00A2B1 0142AF
         BAL   14,16(15)                      CALL                     *
                                         . 00A2B4 45EF 0010
         LM    13,1,AISAVE               . 00A2B8 98D1 A770
         B     RTNUL3                    . 00A2BC 47F0 9030
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Other Operations'
*
*      Assignment
*
                                                             SPACE
* ASGN PROC    ,                   X = Y
*      INCRA   OCICL,DESCR         Increment offset in object code
*      GETD    XPTR,OCBSCL,OCICL   Get object code descriptor
*      TESTF   XPTR,FNC,,ASGNC     Test for function descriptor
                                                             SPACE
         USING ASGN,11                   .
ASGN     L     1,OCICL                   . 00A2C0 5810 9ED8
         AR    1,8                       . 00A2C4 1A18
         ST    1,OCICL                   . 00A2C6 5010 9ED8
         L     2,OCBSCL                  . 00A2CA 5820 A470
         LD    0,0(1,2)                  . 00A2CE 6801 2000
         STD   0,XPTR                    . 00A2D2 6000 A410
         TM    XPTR$4,X'04'              . 00A2D6 9104 A414
         BO    ASGNC                     . 00A2DA 4710 B18C
                                                             SPACE
* ASGNV VEQLC  XPTR,K,,ASGNIC      Check for keyword subject
*      INCRA   OCICL,DESCR         Increment offset in object code
*      GETD    YPTR,OCBSCL,OCICL   Get object code descriptor
*      TESTF   YPTR,FNC,,ASGNCV    Test for function descriptor
                                                             SPACE
ASGNV    CLC   XPTR$5(3),@@K             . 00A2DE D502 A415 AA8A
         BE    ASGNIC                    . 00A2E4 4780 B21E
         L     1,OCICL                   . 00A2E8 5810 9ED8
         AR    1,8                       . 00A2EC 1A18
         ST    1,OCICL                   . 00A2EE 5010 9ED8
         L     2,OCBSCL                  . 00A2F2 5820 A470
         LD    0,0(1,2)                  . 00A2F6 6801 2000
         STD   0,YPTR                    . 00A2FA 6000 A428
         TM    YPTR$4,X'04'              . 00A2FE 9104 A42C
         BO    ASGNCV                    . 00A302 4710 B1C0
                                                             SPACE
* ASGNVN AEQLC INSW,0,,ASGNV1      Check &INPUT
*      LOCAPV  ZPTR,INATL,YPTR,ASGNV1
*                                  Look for input association
*      GETDC   ZPTR,ZPTR,DESCR     Get input association descriptor
*      RCALL   YPTR,PUTIN,(ZPTR,YPTR),(FAIL,ASGNVV)
                                                             SPACE
ASGNVN   C     0,INSW                    . 00A306 5900 9858
         BE    ASGNV1                    . 00A30A 4780 B0B4
         L     15,INATL                  . 00A30E 58F0 A300
         L     5,4(15)                   . 00A312 585F 0004
         LA    5,0(5,15)                 . 00A316 4155 F000
         LR    4,8                       . 00A31A 1848
         SR    5,4                       . 00A31C 1B54
         AR    4,8                       . 00A31E 1A48
S4$0A320 CLC   16(8,15),YPTR             . 00A320 D507 F010 A428
         BE    S4$0A332                  . 00A326 4780 B072
         BXLE  15,4,S4$0A320             . 00A32A 87F4 B060
         B     ASGNV1                    . 00A32E 47F0 B0B4
S4$0A332 STM   15,0,ZPTR                 . 00A332 90F0 A440
         LR    1,15                      . 00A336 181F
         LD    0,8(1)                    . 00A338 6801 0008
         STD   0,ZPTR                    . 00A33C 6000 A440
         LA    14,S4$0A368               . 00A340 41E0 B0A8
         STM   11,14,104(12)             . 00A344 90BE C068
         LR    13,12                     . 00A348 18DC
         STD   0,128(12)                 . 00A34A 600C 0080
         LD    0,YPTR                    . 00A34E 6800 A428
         STD   0,120(12)                 . 00A352 600C 0078
         LA    12,32(12)                 . 00A356 41CC 0020
         C     12,@@STACKT               . 00A35A 59C0 A828
         BH    OVER                      . 00A35E 4720 9664
         L     11,@@PUTIN                . 00A362 58B0 A920
         BR    11                        . 00A366 07FB
S4$0A368 STD   0,YPTR                    . 00A368 6000 A428
         B     FAIL                      . 00A36C 47F0 9010
         B     ASGNVV                    . 00A370 47F0 B0C0
                                                             SPACE
* ASGNV1 GETDC YPTR,YPTR,DESCR     Get value
                                                             SPACE
ASGNV1   L     1,YPTR                    . 00A374 5810 A428
         LD    0,8(1)                    . 00A378 6801 0008
         STD   0,YPTR                    . 00A37C 6000 A428
                                                             SPACE
* ASGNVV PUTDC XPTR,DESCR,YPTR     Perform assignment
*      AEQLC   OUTSW,0,,ASGN1      Check &OUTPUT
*      LOCAPV  ZPTR,OUTATL,XPTR,ASGN1
*                                  Look for output association
*      GETDC   ZPTR,ZPTR,DESCR     Get output association descriptor
*      RCALL   ,PUTOUT,(ZPTR,YPTR) Perform output
                                                             SPACE
ASGNVV   L     1,XPTR                    . 00A380 5810 A410
         LD    0,YPTR                    . 00A384 6800 A428
         STD   0,8(1)                    . 00A388 6001 0008
         C     0,OUTSW                   . 00A38C 5900 9838
         BE    ASGN1                     . 00A390 4780 B12C
         L     15,OUTATL                 . 00A394 58F0 A308
         L     5,4(15)                   . 00A398 585F 0004
         LA    5,0(5,15)                 . 00A39C 4155 F000
         LR    4,8                       . 00A3A0 1848
         SR    5,4                       . 00A3A2 1B54
         AR    4,8                       . 00A3A4 1A48
S4$0A3A6 CLC   16(8,15),XPTR             . 00A3A6 D507 F010 A410
         BE    S4$0A3B8                  . 00A3AC 4780 B0F8
         BXLE  15,4,S4$0A3A6             . 00A3B0 87F4 B0E6
         B     ASGN1                     . 00A3B4 47F0 B12C
S4$0A3B8 LD    0,8(15)                   . 00A3B8 680F 0008
         STD   0,ZPTR                    . 00A3BC 6000 A440
         LA    14,S4$0A3E8               . 00A3C0 41E0 B128
         STM   11,14,104(12)             . 00A3C4 90BE C068
         LR    13,12                     . 00A3C8 18DC
         STD   0,128(12)                 . 00A3CA 600C 0080
         LD    0,YPTR                    . 00A3CE 6800 A428
         STD   0,120(12)                 . 00A3D2 600C 0078
         LA    12,32(12)                 . 00A3D6 41CC 0020
         C     12,@@STACKT               . 00A3DA 59C0 A828
         BH    OVER                      . 00A3DE 4720 9664
         L     11,@@PUTOUT               . 00A3E2 58B0 A974
         BR    11                        . 00A3E6 07FB
S4$0A3E8 SR    0,0                       . 00A3E8 1B00
         SR    0,0                       . 00A3EA 1B00
                                                             SPACE
* ASGN1 ACOMPC TRAPCL,0,,RTNUL3,RTNUL3
*                                  Check &TRACE
*      LOCAPT  ATPTR,TVALL,XPTR,RTNUL3
*                                  Look for VALUE trace
*      RCALL   ,TRPHND,ATPTR,RTNUL3                             E3.3.1
                                                             SPACE
ASGN1    C     0,TRAPCL                  . 00A3EC 5900 9818
         BNL   RTNUL3                    . 00A3F0 47B0 9030
         L     15,TVALL                  . 00A3F4 58F0 A310
         L     5,4(15)                   . 00A3F8 585F 0004
         LA    5,0(5,15)                 . 00A3FC 4155 F000
         LR    4,8                       . 00A400 1848
         SR    5,4                       . 00A402 1B54
         AR    4,8                       . 00A404 1A48
S4$0A406 CLC   8(8,15),XPTR              . 00A406 D507 F008 A410
         BE    S4$0A418                  . 00A40C 4780 B158
         BXLE  15,4,S4$0A406             . 00A410 87F4 B146
         B     RTNUL3                    . 00A414 47F0 9030
S4$0A418 STM   15,0,ATPTR                . 00A418 90F0 A378
         LA    14,S4$0A440               . 00A41C 41E0 B180
         STM   11,14,104(12)             . 00A420 90BE C068
         LR    13,12                     . 00A424 18DC
         LD    0,ATPTR                   . 00A426 6800 A378
         STD   0,120(12)                 . 00A42A 600C 0078
         LA    12,24(12)                 . 00A42E 41CC 0018
         C     12,@@STACKT               . 00A432 59C0 A828
         BH    OVER                      . 00A436 4720 9664
         L     11,@@TRPHND               . 00A43A 58B0 A918
         BR    11                        . 00A43E 07FB
S4$0A440 SR    0,0                       . 00A440 1B00
         SR    0,0                       . 00A442 1B00
         B     RTNUL3                    . 00A444 47F0 9030
         B     RTNUL3                    . 00A448 47F0 9030
                                                             SPACE
* ASGNC RCALL  XPTR,INVOKE,(XPTR),(FAIL,ASGNV,NEMO)
                                                             SPACE
ASGNC    LA    14,S4$0A470               . 00A44C 41E0 B1B0
         STM   11,14,104(12)             . 00A450 90BE C068
         LR    13,12                     . 00A454 18DC
         LD    0,XPTR                    . 00A456 6800 A410
         STD   0,120(12)                 . 00A45A 600C 0078
         LA    12,24(12)                 . 00A45E 41CC 0018
         C     12,@@STACKT               . 00A462 59C0 A828
         BH    OVER                      . 00A466 4720 9664
         L     11,@@INVOKE               . 00A46A 58B0 A91C
         BR    11                        . 00A46E 07FB
S4$0A470 STD   0,XPTR                    . 00A470 6000 A410
         B     FAIL                      . 00A474 47F0 9010
         B     ASGNV                     . 00A478 47F0 B01E
         B     NEMO                      . 00A47C 47F0 964C
                                                             SPACE
* ASGNCV PUSH  XPTR                Save subject of assignment
*      RCALL   YPTR,INVOKE,(YPTR),(FAIL,ASGNVP)
                                                             SPACE
ASGNCV   LD    0,XPTR                    . 00A480 6800 A410
         STD   0,104(12)                 . 00A484 600C 0068
         AR    12,8                      . 00A488 1AC8
         C     12,@@STACKT               . 00A48A 59C0 A828
         BH    OVER                      . 00A48E 4720 9664
         LA    14,S4$0A4B6               . 00A492 41E0 B1F6
         STM   11,14,104(12)             . 00A496 90BE C068
         LR    13,12                     . 00A49A 18DC
         LD    0,YPTR                    . 00A49C 6800 A428
         STD   0,120(12)                 . 00A4A0 600C 0078
         LA    12,24(12)                 . 00A4A4 41CC 0018
         C     12,@@STACKT               . 00A4A8 59C0 A828
         BH    OVER                      . 00A4AC 4720 9664
         L     11,@@INVOKE               . 00A4B0 58B0 A91C
         BR    11                        . 00A4B4 07FB
S4$0A4B6 STD   0,YPTR                    . 00A4B6 6000 A428
         B     FAIL                      . 00A4BA 47F0 9010
         B     ASGNVP                    . 00A4BE 47F0 B210
                                                             SPACE
* ASGNCJ POP   XPTR                Restore subject
*      BRANCH  ASGNVV
                                                             SPACE
ASGNCJ   LD    0,96(12)                  . 00A4C2 680C 0060
         STD   0,XPTR                    . 00A4C6 6000 A410
         SR    12,8                      . 00A4CA 1BC8
         B     ASGNVV                    . 00A4CC 47F0 B0C0
                                                             SPACE
* ASGNVP POP   XPTR                Restore subject
*      BRANCH  ASGNVN
                                                             SPACE
ASGNVP   LD    0,96(12)                  . 00A4D0 680C 0060
         STD   0,XPTR                    . 00A4D4 6000 A410
         SR    12,8                      . 00A4D8 1BC8
         B     ASGNVN                    . 00A4DA 47F0 B046
                                                             SPACE
* ASGNIC PUSH  XPTR                Save subject of assignment
*      RCALL   YPTR,INTVAL,,(FAIL,ASGNCJ)
*                                  Get integer value for keyword
ASGNIC   LD    0,XPTR                    . 00A4DE 6800 A410
         STD   0,104(12)                 . 00A4E2 600C 0068
         AR    12,8                      . 00A4E6 1AC8
         C     12,@@STACKT               . 00A4E8 59C0 A828
         BH    OVER                      . 00A4EC 4720 9664
         LA    14,S4$0A50C               . 00A4F0 41E0 B24C
         STM   11,14,104(12)             . 00A4F4 90BE C068
         LR    13,12                     . 00A4F8 18DC
         LA    12,16(12)                 . 00A4FA 41CC 0010
         C     12,@@STACKT               . 00A4FE 59C0 A828
         BH    OVER                      . 00A502 4720 9664
         L     11,@@INTVAL               . 00A506 58B0 A9E8
         BR    11                        . 00A50A 07FB
S4$0A50C STD   0,YPTR                    . 00A50C 6000 A428
         B     FAIL                      . 00A510 47F0 9010
         B     ASGNCJ                    . 00A514 47F0 B202
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      X Y (concatenation)
*
                                                             SPACE
* CON  PROC    ,                   X Y (concatenation)
*      RCALL   ,XYARGS,,FAIL       Get two arguments
*      DEQL    XPTR,NULVCL,,RTYPTR If first is null, return second
*      DEQL    YPTR,NULVCL,,RTXPTR If second is null, return first
*      VEQLC   XPTR,S,,CON5        Is first STRING?
*      VEQLC   XPTR,P,,CON5        Is first PATTERN?
*      VEQLC   XPTR,I,,CON4I       Is first INTEGER?
*      VEQLC   XPTR,R,,CON4R       Is first REAL?
*      VEQLC   XPTR,E,INTR1        Is first EXPRESSION?
*      RCALL   TPTR,BLOCK,STARSZ   Allocate block for pattern
*      MOVBLK  TPTR,STRPAT,STARSZ  Set up pattern for expression
*      PUTDC   TPTR,4*DESCR,XPTR   Insert pointer to expression
*      MOVD    XPTR,TPTR           Set up as first argument
*      BRANCH  CON5
                                                             SPACE
         USING CON,11                    .
CON      LA    14,S4$0A534               . 00A518 41E0 B01C
         STM   11,14,104(12)             . 00A51C 90BE C068
         LR    13,12                     . 00A520 18DC
         LA    12,16(12)                 . 00A522 41CC 0010
         C     12,@@STACKT               . 00A526 59C0 A828
         BH    OVER                      . 00A52A 4720 9664
         L     11,@@XYARGS               . 00A52E 58B0 A93C
         BR    11                        . 00A532 07FB
S4$0A534 SR    0,0                       . 00A534 1B00
         SR    0,0                       . 00A536 1B00
         B     FAIL                      . 00A538 47F0 9010
         CLC   XPTR(8),NULVCL            . 00A53C D507 A410 9ED0
         BE    RTYPTR                    . 00A542 4780 9058
         CLC   YPTR(8),NULVCL            . 00A546 D507 A428 9ED0
         BE    RTXPTR                    . 00A54C 4780 9048
         CLC   XPTR$5(3),@@S             . 00A550 D502 A415 AA7B
         BE    CON5                      . 00A556 4780 B138
         CLC   XPTR$5(3),@@P             . 00A55A D502 A415 AA87
         BE    CON5                      . 00A560 4780 B138
         CLC   XPTR$5(3),@@I             . 00A564 D502 A415 AA84
         BE    CON4I                     . 00A56A 4780 B102
         CLC   XPTR$5(3),@@R             . 00A56E D502 A415 AA75
         BE    CON4R                     . 00A574 4780 B0C0
         CLC   XPTR$5(3),@@E             . 00A578 D502 A415 AA81
         BNE   INTR1                     . 00A57E 4770 95FC
         LA    14,S4$0A5A6               . 00A582 41E0 B08E
         STM   11,14,104(12)             . 00A586 90BE C068
         LR    13,12                     . 00A58A 18DC
         LD    0,STARSZ                  . 00A58C 6800 9C88
         STD   0,120(12)                 . 00A590 600C 0078
         LA    12,24(12)                 . 00A594 41CC 0018
         C     12,@@STACKT               . 00A598 59C0 A828
         BH    OVER                      . 00A59C 4720 9664
         L     11,@@BLOCK                . 00A5A0 58B0 A82C
         BR    11                        . 00A5A4 07FB
S4$0A5A6 STD   0,TPTR                    . 00A5A6 6000 A3D0
         L     6,TPTR                    . 00A5AA 5860 A3D0
         L     4,STRPAT                  . 00A5AE 5840 9CC8
         AR    4,8                       . 00A5B2 1A48
         AR    6,8                       . 00A5B4 1A68
         L     3,STARSZ                  . 00A5B6 5830 9C88
         L     15,@@MOVTST               . 00A5BA 58F0 A864
         BALR  14,15                          CALL                     *
                                         . 00A5BE 05EF
         L     1,TPTR                    . 00A5C0 5810 A3D0
         LD    0,XPTR                    . 00A5C4 6800 A410
         STD   0,32(1)                   . 00A5C8 6001 0020
         LD    0,TPTR                    . 00A5CC 6800 A3D0
         STD   0,XPTR                    . 00A5D0 6000 A410
         B     CON5                      . 00A5D4 47F0 B138
                                                             SPACE
* CON4R REALST REALSP,XPTR         Convert REAL to STRING
*      SETSP   XSP,REALSP          Set up specifier
*      RCALL   XPTR,GENVAR,XSPPTR,CON5
*                                  Generate variable
                                                             SPACE
CON4R    L     15,@@REALST               . 00A5D8 58F0 A86C
         LA    5,REALSP                  . 00A5DC 4150 A088
         LE    2,XPTR                    . 00A5E0 7820 A410
         BALR  14,15                          CALL                     *
                                         . 00A5E4 05EF
         LM    1,4,REALSP                . 00A5E6 9814 A088
         STM   1,4,XSP                   . 00A5EA 9014 A5D0
         LA    14,S4$0A612               . 00A5EE 41E0 B0FA
         STM   11,14,104(12)             . 00A5F2 90BE C068
         LR    13,12                     . 00A5F6 18DC
         LD    0,XSPPTR                  . 00A5F8 6800 9F60
         STD   0,120(12)                 . 00A5FC 600C 0078
         LA    12,24(12)                 . 00A600 41CC 0018
         C     12,@@STACKT               . 00A604 59C0 A828
         BH    OVER                      . 00A608 4720 9664
         L     11,@@GENVAR               . 00A60C 58B0 A830
         BR    11                        . 00A610 07FB
S4$0A612 STD   0,XPTR                    . 00A612 6000 A410
         B     CON5                      . 00A616 47F0 B138
                                                             SPACE
* CON4I INTSPC ZSP,XPTR            Convert INTEGER to STRING
*      RCALL   XPTR,GENVAR,(ZSPPTR)
*                                  Generate variable
                                                             SPACE
CON4I    L     15,@@BDSPEC               . 00A61A 58F0 A874
         LA    1,ZSP                     . 00A61E 4110 A5F0
         LA    2,XPTR                    . 00A622 4120 A410
         BALR  14,15                          CALL                     *
                                         . 00A626 05EF
         LA    14,S4$0A64C               . 00A628 41E0 B134
         STM   11,14,104(12)             . 00A62C 90BE C068
         LR    13,12                     . 00A630 18DC
         LD    0,ZSPPTR                  . 00A632 6800 9F70
         STD   0,120(12)                 . 00A636 600C 0078
         LA    12,24(12)                 . 00A63A 41CC 0018
         C     12,@@STACKT               . 00A63E 59C0 A828
         BH    OVER                      . 00A642 4720 9664
         L     11,@@GENVAR               . 00A646 58B0 A830
         BR    11                        . 00A64A 07FB
S4$0A64C STD   0,XPTR                    . 00A64C 6000 A410
                                                             SPACE
* CON5 VEQLC   YPTR,S,,CON7        Is second STRING?
*      VEQLC   YPTR,P,,CON7        Is second PATTERN?
*      VEQLC   YPTR,I,,CON5I       Is second INTEGER?
*      VEQLC   YPTR,R,,CON5R       Is second REAL?
*      VEQLC   YPTR,E,INTR1        Is second EXPRESSION?
*      RCALL   TPTR,BLOCK,STARSZ   Allocate block for pattern
*      MOVBLK  TPTR,STRPAT,STARSZ  Set up pattern for expression
*      PUTDC   TPTR,4*DESCR,YPTR   Insert pointer to expression
*      MOVD    YPTR,TPTR           Set up as second argument
*      BRANCH  CON7                Join processing
                                                             SPACE
CON5     CLC   YPTR$5(3),@@S             . 00A650 D502 A42D AA7B
         BE    CON7                      . 00A656 4780 B238
         CLC   YPTR$5(3),@@P             . 00A65A D502 A42D AA87
         BE    CON7                      . 00A660 4780 B238
         CLC   YPTR$5(3),@@I             . 00A664 D502 A42D AA84
         BE    CON5I                     . 00A66A 4780 B202
         CLC   YPTR$5(3),@@R             . 00A66E D502 A42D AA75
         BE    CON5R                     . 00A674 4780 B1C0
         CLC   YPTR$5(3),@@E             . 00A678 D502 A42D AA81
         BNE   INTR1                     . 00A67E 4770 95FC
         LA    14,S4$0A6A6               . 00A682 41E0 B18E
         STM   11,14,104(12)             . 00A686 90BE C068
         LR    13,12                     . 00A68A 18DC
         LD    0,STARSZ                  . 00A68C 6800 9C88
         STD   0,120(12)                 . 00A690 600C 0078
         LA    12,24(12)                 . 00A694 41CC 0018
         C     12,@@STACKT               . 00A698 59C0 A828
         BH    OVER                      . 00A69C 4720 9664
         L     11,@@BLOCK                . 00A6A0 58B0 A82C
         BR    11                        . 00A6A4 07FB
S4$0A6A6 STD   0,TPTR                    . 00A6A6 6000 A3D0
         L     6,TPTR                    . 00A6AA 5860 A3D0
         L     4,STRPAT                  . 00A6AE 5840 9CC8
         AR    4,8                       . 00A6B2 1A48
         AR    6,8                       . 00A6B4 1A68
         L     3,STARSZ                  . 00A6B6 5830 9C88
         L     15,@@MOVTST               . 00A6BA 58F0 A864
         BALR  14,15                          CALL                     *
                                         . 00A6BE 05EF
         L     1,TPTR                    . 00A6C0 5810 A3D0
         LD    0,YPTR                    . 00A6C4 6800 A428
         STD   0,32(1)                   . 00A6C8 6001 0020
         LD    0,TPTR                    . 00A6CC 6800 A3D0
         STD   0,YPTR                    . 00A6D0 6000 A428
         B     CON7                      . 00A6D4 47F0 B238
                                                             SPACE
* CON5R REALST REALSP,YPTR         Convert REAL to STRING
*      SETSP   YSP,REALSP          Set up sepcifier
*      RCALL   YPTR,GENVAR,YSPPTR,CON7
*                                  Generate variable
                                                             SPACE
CON5R    L     15,@@REALST               . 00A6D8 58F0 A86C
         LA    5,REALSP                  . 00A6DC 4150 A088
         LE    2,YPTR                    . 00A6E0 7820 A428
         BALR  14,15                          CALL                     *
                                         . 00A6E4 05EF
         LM    1,4,REALSP                . 00A6E6 9814 A088
         STM   1,4,YSP                   . 00A6EA 9014 A5E0
         LA    14,S4$0A712               . 00A6EE 41E0 B1FA
         STM   11,14,104(12)             . 00A6F2 90BE C068
         LR    13,12                     . 00A6F6 18DC
         LD    0,YSPPTR                  . 00A6F8 6800 9F68
         STD   0,120(12)                 . 00A6FC 600C 0078
         LA    12,24(12)                 . 00A700 41CC 0018
         C     12,@@STACKT               . 00A704 59C0 A828
         BH    OVER                      . 00A708 4720 9664
         L     11,@@GENVAR               . 00A70C 58B0 A830
         BR    11                        . 00A710 07FB
S4$0A712 STD   0,YPTR                    . 00A712 6000 A428
         B     CON7                      . 00A716 47F0 B238
                                                             SPACE
* CON5I INTSPC ZSP,YPTR            Convert INTEGER to STRING
*      RCALL   YPTR,GENVAR,(ZSPPTR)
*                                  Generate variable
                                                             SPACE
CON5I    L     15,@@BDSPEC               . 00A71A 58F0 A874
         LA    1,ZSP                     . 00A71E 4110 A5F0
         LA    2,YPTR                    . 00A722 4120 A428
         BALR  14,15                          CALL                     *
                                         . 00A726 05EF
         LA    14,S4$0A74C               . 00A728 41E0 B234
         STM   11,14,104(12)             . 00A72C 90BE C068
         LR    13,12                     . 00A730 18DC
         LD    0,ZSPPTR                  . 00A732 6800 9F70
         STD   0,120(12)                 . 00A736 600C 0078
         LA    12,24(12)                 . 00A73A 41CC 0018
         C     12,@@STACKT               . 00A73E 59C0 A828
         BH    OVER                      . 00A742 4720 9664
         L     11,@@GENVAR               . 00A746 58B0 A830
         BR    11                        . 00A74A 07FB
S4$0A74C STD   0,YPTR                    . 00A74C 6000 A428
                                                             SPACE
* CON7 SETAV   DTCL,XPTR           Get data type of first
*      MOVV    DTCL,YPTR           Get data type of second
*      DEQL    DTCL,VVDTP,,CONVV   Check for STRING-STRING
*      DEQL    DTCL,VPDTP,,CONVP   Check for STRING-PATTERN
*      DEQL    DTCL,PVDTP,,CONPV   Check for PATTERN-STRING
*      DEQL    DTCL,PPDTP,INTR1,CONPP
*                                  Check for PATTERN-PATTERN
                                                             SPACE
CON7     L     15,XPTR$4                 . 00A750 58F0 A414
         LA    15,0(15)                  . 00A754 41FF 0000
         STM   15,0,DTCL                 . 00A758 90F0 9E40
         MVC   DTCL$5(3),YPTR$5          . 00A75C D202 9E45 A42D
         CLC   DTCL(8),VVDTP             . 00A762 D507 9E40 9B60
         BE    CONVV                     . 00A768 4780 B276
         CLC   DTCL(8),VPDTP             . 00A76C D507 9E40 9B50
         BE    CONVP                     . 00A772 4780 B31C
         CLC   DTCL(8),PVDTP             . 00A776 D507 9E40 9B08
         BE    CONPV                     . 00A77C 4780 B422
         CLC   DTCL(8),PPDTP             . 00A780 D507 9E40 9B00
         BNE   INTR1                     . 00A786 4770 95FC
         BE    CONPP                     . 00A78A 4780 B380
                                                             SPACE
* CONVV LOCSP  XSP,XPTR            Specifier for first string
*      LOCSP   YSP,YPTR            Specifier for second string
*      GETLG   XCL,XSP             Length of first string
*      GETLG   YCL,YSP             Length of second string
*      SUM     XCL,XCL,YCL         Total length
*      ACOMP   XCL,MLENCL,INTR8    Check against &MAXLNGTH
*      RCALL   ZPTR,CONVAR,(XCL)   Allocate space for string
*      LOCSP   TSP,ZPTR            Get specifier to allocated space
*      SETLC   TSP,0               Clear length
*      APDSP   TSP,XSP             Move in first string
*      APDSP   TSP,YSP             Append second string
*      BRANCH  GENVSZ              Generate variable
                                                             SPACE
CONVV    LM    3,4,XPTR                  . 00A78E 9834 A410
         L     1,4(3)                    . 00A792 5813 0004
         LA    1,0(1)                    . 00A796 4111 0000
         LA    2,32                      . 00A79A 4120 0020
         STM   1,4,XSP                   . 00A79E 9014 A5D0
         LM    3,4,YPTR                  . 00A7A2 9834 A428
         L     1,4(3)                    . 00A7A6 5813 0004
         LA    1,0(1)                    . 00A7AA 4111 0000
         LA    2,32                      . 00A7AE 4120 0020
         STM   1,4,YSP                   . 00A7B2 9014 A5E0
         L     15,XSP                    . 00A7B6 58F0 A5D0
         STM   15,0,XCL                  . 00A7BA 90F0 A408
         L     15,YSP                    . 00A7BE 58F0 A5E0
         STM   15,0,YCL                  . 00A7C2 90F0 A420
         L     1,XCL                     . 00A7C6 5810 A408
         AR    1,15                      . 00A7CA 1A1F
         ST    1,XCL                     . 00A7CC 5010 A408
         C     1,MLENCL                  . 00A7D0 5910 9848
         BH    INTR8                     . 00A7D4 4720 9614
         LA    14,S4$0A7FC               . 00A7D8 41E0 B2E4
         STM   11,14,104(12)             . 00A7DC 90BE C068
         LR    13,12                     . 00A7E0 18DC
         LD    0,XCL                     . 00A7E2 6800 A408
         STD   0,120(12)                 . 00A7E6 600C 0078
         LA    12,24(12)                 . 00A7EA 41CC 0018
         C     12,@@STACKT               . 00A7EE 59C0 A828
         BH    OVER                      . 00A7F2 4720 9664
         L     11,@@CONVAR               . 00A7F6 58B0 A96C
         BR    11                        . 00A7FA 07FB
S4$0A7FC STD   0,ZPTR                    . 00A7FC 6000 A440
         LM    3,4,ZPTR                  . 00A800 9834 A440
         L     1,4(3)                    . 00A804 5813 0004
         LA    1,0(1)                    . 00A808 4111 0000
         LA    2,32                      . 00A80C 4120 0020
         STM   1,4,TSP                   . 00A810 9014 A5A0
         ST    0,TSP                     . 00A814 5000 A5A0
         L     15,@@APDSP                . 00A818 58F0 A870
         LA    2,TSP                     . 00A81C 4120 A5A0
         LM    3,5,XSP                   . 00A820 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 00A824 05EF
         LA    2,TSP                     . 00A826 4120 A5A0
         LM    3,5,YSP                   . 00A82A 9835 A5E0
         BALR  14,15                          CALL                     *
                                         . 00A82E 05EF
         B     GENVSZ                    . 00A830 47F0 90A6
                                                             SPACE
* CONVP LOCSP  TSP,XPTR            Specifier to string
*      GETLG   TMVAL,TSP           Get length of string
*      RCALL   TPTR,BLOCK,LNODSZ   Allocate block for pattern
*      MAKNOD  XPTR,TPTR,TMVAL,ZEROCL,CHRCL,XPTR
*                                  Construct pattern
                                                             SPACE
CONVP    LM    3,4,XPTR                  . 00A834 9834 A410
         L     1,4(3)                    . 00A838 5813 0004
         LA    1,0(1)                    . 00A83C 4111 0000
         LA    2,32                      . 00A840 4120 0020
         STM   1,4,TSP                   . 00A844 9014 A5A0
         L     15,TSP                    . 00A848 58F0 A5A0
         STM   15,0,TMVAL                . 00A84C 90F0 A3C8
         LA    14,S4$0A874               . 00A850 41E0 B35C
         STM   11,14,104(12)             . 00A854 90BE C068
         LR    13,12                     . 00A858 18DC
         LD    0,LNODSZ                  . 00A85A 6800 9C48
         STD   0,120(12)                 . 00A85E 600C 0078
         LA    12,24(12)                 . 00A862 41CC 0018
         C     12,@@STACKT               . 00A866 59C0 A828
         BH    OVER                      . 00A86A 4720 9664
         L     11,@@BLOCK                . 00A86E 58B0 A82C
         BR    11                        . 00A872 07FB
S4$0A874 STD   0,TPTR                    . 00A874 6000 A3D0
         LM    1,2,TPTR                  . 00A878 9812 A3D0
         LM    3,4,CHRCL                 . 00A87C 9834 9CF8
         LR    5,0                       . 00A880 1850
         LR    6,0                       . 00A882 1860
         L     7,TMVAL                   . 00A884 5870 A3C8
         STM   3,7,8(1)                  . 00A888 9037 1008
         LM    3,4,XPTR                  . 00A88C 9834 A410
         STM   3,4,32(1)                 . 00A890 9034 1020
         STM   1,2,XPTR                  . 00A894 9012 A410
                                                             SPACE
* CONPP GETSIZ XSIZ,XPTR           Get size of first pattern
*      GETSIZ  YSIZ,YPTR           Get size of second pattern
*      SUM     TSIZ,XSIZ,YSIZ      Compute total size required
*      SETVC   TSIZ,P              Insert PATTERN data type
*      RCALL   TPTR,BLOCK,TSIZ     Allocate block for new pattern
*      MOVD    ZPTR,TPTR           Save copy to return
*      LVALUE  TVAL,YPTR           Get least value for second pattern
*      CPYPAT  TPTR,XPTR,TVAL,ZEROCL,XSIZ,XSIZ
*                                  Copy in first pattern
*      CPYPAT  TPTR,YPTR,ZEROCL,XSIZ,ZEROCL,YSIZ
*                                  Copy in second pattern
*      BRANCH  RTZPTR              Return pattern as value
                                                             SPACE
CONPP    L     15,XPTR                   . 00A898 58F0 A410
         L     15,4(15)                  . 00A89C 58FF 0004
         LA    15,0(15)                  . 00A8A0 41FF 0000
         STM   15,0,XSIZ                 . 00A8A4 90F0 A418
         L     15,YPTR                   . 00A8A8 58F0 A428
         L     15,4(15)                  . 00A8AC 58FF 0004
         LA    15,0(15)                  . 00A8B0 41FF 0000
         STM   15,0,YSIZ                 . 00A8B4 90F0 A430
         LM    1,2,XSIZ                  . 00A8B8 9812 A418
         AR    1,15                      . 00A8BC 1A1F
         STM   1,2,TSIZ                  . 00A8BE 9012 A3E0
         MVC   TSIZ$5(3),@@P             . 00A8C2 D202 A3E5 AA87
         LA    14,S4$0A8EC               . 00A8C8 41E0 B3D4
         STM   11,14,104(12)             . 00A8CC 90BE C068
         LR    13,12                     . 00A8D0 18DC
         LD    0,TSIZ                    . 00A8D2 6800 A3E0
         STD   0,120(12)                 . 00A8D6 600C 0078
         LA    12,24(12)                 . 00A8DA 41CC 0018
         C     12,@@STACKT               . 00A8DE 59C0 A828
         BH    OVER                      . 00A8E2 4720 9664
         L     11,@@BLOCK                . 00A8E6 58B0 A82C
         BR    11                        . 00A8EA 07FB
S4$0A8EC STD   0,TPTR                    . 00A8EC 6000 A3D0
         STD   0,ZPTR                    . 00A8F0 6000 A440
         L     15,@@LVAL                 . 00A8F4 58F0 A95C
         LA    1,TVAL                    . 00A8F8 4110 A3E8
         L     2,YPTR                    . 00A8FC 5820 A428
         BALR  14,15                          CALL                     *
                                         . 00A900 05EF
         L     15,@@COPL                 . 00A902 58F0 A954
         LA    2,TPTR                    . 00A906 4120 A3D0
         L     3,XPTR                    . 00A90A 5830 A410
         L     4,TVAL                    . 00A90E 5840 A3E8
         LR    5,0                       . 00A912 1850
         L     6,XSIZ                    . 00A914 5860 A418
         LR    7,6                       . 00A918 1876
         BALR  14,15                          CALL                     *
                                         . 00A91A 05EF
         L     15,@@COPL                 . 00A91C 58F0 A954
         LA    2,TPTR                    . 00A920 4120 A3D0
         L     3,YPTR                    . 00A924 5830 A428
         LR    4,0                       . 00A928 1840
         L     5,XSIZ                    . 00A92A 5850 A418
         LR    6,0                       . 00A92E 1860
         L     7,YSIZ                    . 00A930 5870 A430
         BALR  14,15                          CALL                     *
                                         . 00A934 05EF
         B     RTZPTR                    . 00A936 47F0 9074
                                                             SPACE
* CONPV LOCSP  TSP,YPTR            Get specifier to string
*      GETLG   TMVAL,TSP           Get length of string
*      RCALL   TPTR,BLOCK,LNODSZ   Allocate block for pattern
*      MAKNOD  YPTR,TPTR,TMVAL,ZEROCL,CHRCL,YPTR
*                                  Construct pattern for string
*      BRANCH  CONPP               Join common processing
CONPV    LM    3,4,YPTR                  . 00A93A 9834 A428
         L     1,4(3)                    . 00A93E 5813 0004
         LA    1,0(1)                    . 00A942 4111 0000
         LA    2,32                      . 00A946 4120 0020
         STM   1,4,TSP                   . 00A94A 9014 A5A0
         L     15,TSP                    . 00A94E 58F0 A5A0
         STM   15,0,TMVAL                . 00A952 90F0 A3C8
         LA    14,S4$0A97A               . 00A956 41E0 B462
         STM   11,14,104(12)             . 00A95A 90BE C068
         LR    13,12                     . 00A95E 18DC
         LD    0,LNODSZ                  . 00A960 6800 9C48
         STD   0,120(12)                 . 00A964 600C 0078
         LA    12,24(12)                 . 00A968 41CC 0018
         C     12,@@STACKT               . 00A96C 59C0 A828
         BH    OVER                      . 00A970 4720 9664
         L     11,@@BLOCK                . 00A974 58B0 A82C
         BR    11                        . 00A978 07FB
S4$0A97A STD   0,TPTR                    . 00A97A 6000 A3D0
         LM    1,2,TPTR                  . 00A97E 9812 A3D0
         LM    3,4,CHRCL                 . 00A982 9834 9CF8
         LR    5,0                       . 00A986 1850
         LR    6,0                       . 00A988 1860
         L     7,TMVAL                   . 00A98A 5870 A3C8
         STM   3,7,8(1)                  . 00A98E 9037 1008
         LM    3,4,YPTR                  . 00A992 9834 A428
         STM   3,4,32(1)                 . 00A996 9034 1020
         STM   1,2,YPTR                  . 00A99A 9012 A428
         B     CONPP                     . 00A99E 47F0 B380
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Indirect Reference
*
                                                             SPACE
* IND  PROC    ,                   $X
*      RCALL   XPTR,ARGVAL,,FAIL   Get argument
*      VEQLC   XPTR,S,,INDV        STRING is acceptable
*      VEQLC   XPTR,N,,RTXNAM      NAME can be returned directly
*      VEQLC   XPTR,I,,GENVIX      Convert INTEGER
*      VEQLC   XPTR,K,INTR1,RTXNAM KEYWORD is like NAME
                                                             SPACE
         USING IND,11                    .
IND      LA    14,S4$0A9BE               . 00A9A2 41E0 B01C
         STM   11,14,104(12)             . 00A9A6 90BE C068
         LR    13,12                     . 00A9AA 18DC
         LA    12,16(12)                 . 00A9AC 41CC 0010
         C     12,@@STACKT               . 00A9B0 59C0 A828
         BH    OVER                      . 00A9B4 4720 9664
         L     11,@@ARGVAL               . 00A9B8 58B0 A914
         BR    11                        . 00A9BC 07FB
S4$0A9BE STD   0,XPTR                    . 00A9BE 6000 A410
         B     FAIL                      . 00A9C2 47F0 9010
         CLC   XPTR$5(3),@@S             . 00A9C6 D502 A415 AA7B
         BE    INDV                      . 00A9CC 4780 B050
         CLC   XPTR$5(3),@@N             . 00A9D0 D502 A415 AA8D
         BE    RTXNAM                    . 00A9D6 4780 9038
         CLC   XPTR$5(3),@@I             . 00A9DA D502 A415 AA84
         BE    GENVIX                    . 00A9E0 4780 90FE
         CLC   XPTR$5(3),@@K             . 00A9E4 D502 A415 AA8A
         BNE   INTR1                     . 00A9EA 4770 95FC
         BE    RTXNAM                    . 00A9EE 4780 9038
                                                             SPACE
* INDV AEQLC   XPTR,0,RTXNAM,NONAME
*                                  Be sure string is not null
INDV     C     0,XPTR                    . 00A9F2 5900 A410
         BNE   RTXNAM                    . 00A9F6 4770 9038
         BE    NONAME                    . 00A9FA 4780 9654
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Keywords
*
                                                             SPACE
* KEYWRD PROC  ,                   &X
*      INCRA   OCICL,DESCR         Increment offset
*      GETD    XPTR,OCBSCL,OCICL   Get object code descriptor
*      TESTF   XPTR,FNC,,KEYC      Check for function
                                                             SPACE
         USING KEYWRD,11                 .
KEYWRD   L     1,OCICL                   . 00A9FE 5810 9ED8
         AR    1,8                       . 00AA02 1A18
         ST    1,OCICL                   . 00AA04 5010 9ED8
         L     2,OCBSCL                  . 00AA08 5820 A470
         LD    0,0(1,2)                  . 00AA0C 6801 2000
         STD   0,XPTR                    . 00AA10 6000 A410
         TM    XPTR$4,X'04'              . 00AA14 9104 A414
         BO    KEYC                      . 00AA18 4710 B080
                                                             SPACE
* KEYN LOCAPV  XPTR,KNATL,XPTR,KEYV
*                                  Look up X on unprotected list
*      SETVC   XPTR,K              Set KEYWORD (NAME) data type
*      BRANCH  RTXNAM              Return by name
                                                             SPACE
KEYN     L     15,KNATL                  . 00AA1C 58F0 9F80
         L     5,4(15)                   . 00AA20 585F 0004
         LA    5,0(5,15)                 . 00AA24 4155 F000
         LR    4,8                       . 00AA28 1848
         SR    5,4                       . 00AA2A 1B54
         AR    4,8                       . 00AA2C 1A48
S4$0AA2E CLC   16(8,15),XPTR             . 00AA2E D507 F010 A410
         BE    S4$0AA40                  . 00AA34 4780 B042
         BXLE  15,4,S4$0AA2E             . 00AA38 87F4 B030
         B     KEYV                      . 00AA3C 47F0 B050
S4$0AA40 STM   15,0,XPTR                 . 00AA40 90F0 A410
         MVC   XPTR$5(3),@@K             . 00AA44 D202 A415 AA8A
         B     RTXNAM                    . 00AA4A 47F0 9038
                                                             SPACE
* KEYV LOCAPV  ATPTR,KVATL,XPTR,UNKNKW
*                                  Look up X on protected list
*      GETDC   ZPTR,ATPTR,DESCR    Get value
*      BRANCH  RTZPTR              Return by value
                                                             SPACE
KEYV     L     15,KVATL                  . 00AA4E 58F0 9F88
         L     5,4(15)                   . 00AA52 585F 0004
         LA    5,0(5,15)                 . 00AA56 4155 F000
         LR    4,8                       . 00AA5A 1848
         SR    5,4                       . 00AA5C 1B54
         AR    4,8                       . 00AA5E 1A48
S4$0AA60 CLC   16(8,15),XPTR             . 00AA60 D507 F010 A410
         BE    S4$0AA72                  . 00AA66 4780 B074
         BXLE  15,4,S4$0AA60             . 00AA6A 87F4 B062
         B     UNKNKW                    . 00AA6E 47F0 96AC
S4$0AA72 LD    0,8(15)                   . 00AA72 680F 0008
         STD   0,ZPTR                    . 00AA76 6000 A440
         B     RTZPTR                    . 00AA7A 47F0 9074
                                                             SPACE
* KEYC RCALL   XPTR,INVOKE,(XPTR),(FAIL,KEYN,NEMO)
*                                  Evaluate computed keyword
                                                             SPACE
KEYC     LA    14,S4$0AAA2               . 00AA7E 41E0 B0A4
         STM   11,14,104(12)             . 00AA82 90BE C068
         LR    13,12                     . 00AA86 18DC
         LD    0,XPTR                    . 00AA88 6800 A410
         STD   0,120(12)                 . 00AA8C 600C 0078
         LA    12,24(12)                 . 00AA90 41CC 0018
         C     12,@@STACKT               . 00AA94 59C0 A828
         BH    OVER                      . 00AA98 4720 9664
         L     11,@@INVOKE               . 00AA9C 58B0 A91C
         BR    11                        . 00AAA0 07FB
S4$0AAA2 STD   0,XPTR                    . 00AAA2 6000 A410
         B     FAIL                      . 00AAA6 47F0 9010
         B     KEYN                      . 00AAAA 47F0 B01E
         B     NEMO                      . 00AAAE 47F0 964C
                                                             SPACE
* KEYT PROC    KEYWRD              Procedure to get keyword for trace
*      POP     XPTR                Restore argument
*      BRANCH  KEYN
KEYT     L     11,@@KEYWRD               . 00AAB2 58B0 AA30
         LD    0,96(12)                  . 00AAB6 680C 0060
         STD   0,XPTR                    . 00AABA 6000 A410
         SR    12,8                      . 00AABE 1BC8
         B     KEYN                      . 00AAC0 47F0 B01E
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Literal Evaluation
*
*
                                                             SPACE
* LIT  PROC    ,                   'X'
*      INCRA   OCICL,DESCR         Increment offset
*      GETD    ZPTR,OCBSCL,OCICL   Get object code descriptor
*      BRANCH  RTZPTR              Return value
         USING LIT,11                    .
LIT      L     1,OCICL                   . 00AAC4 5810 9ED8
         AR    1,8                       . 00AAC8 1A18
         ST    1,OCICL                   . 00AACA 5010 9ED8
         L     2,OCBSCL                  . 00AACE 5820 A470
         LD    0,0(1,2)                  . 00AAD2 6801 2000
         STD   0,ZPTR                    . 00AAD6 6000 A440
         B     RTZPTR                    . 00AADA 47F0 9074
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Unary Name Operator
*
                                                             SPACE
* NAME PROC    ,                   .X
*      INCRA   OCICL,DESCR         Increment offset
*      GETD    ZPTR,OCBSCL,OCICL   Get object code descriptor
*      TESTF   ZPTR,FNC,RTZPTR     Test for function
*      RCALL   ZPTR,INVOKE,ZPTR,(FAIL,RTZPTR,NEMO)
*
*
         USING NAME,11                   .
NAME     L     1,OCICL                   . 00AADE 5810 9ED8
         AR    1,8                       . 00AAE2 1A18
         ST    1,OCICL                   . 00AAE4 5010 9ED8
         L     2,OCBSCL                  . 00AAE8 5820 A470
         LD    0,0(1,2)                  . 00AAEC 6801 2000
         STD   0,ZPTR                    . 00AAF0 6000 A440
         TM    ZPTR$4,X'04'              . 00AAF4 9104 A444
         BNO   RTZPTR                    . 00AAF8 47E0 9074
         LA    14,S4$0AB1C               . 00AAFC 41E0 B03E
         STM   11,14,104(12)             . 00AB00 90BE C068
         LR    13,12                     . 00AB04 18DC
         STD   0,120(12)                 . 00AB06 600C 0078
         LA    12,24(12)                 . 00AB0A 41CC 0018
         C     12,@@STACKT               . 00AB0E 59C0 A828
         BH    OVER                      . 00AB12 4720 9664
         L     11,@@INVOKE               . 00AB16 58B0 A91C
         BR    11                        . 00AB1A 07FB
S4$0AB1C STD   0,ZPTR                    . 00AB1C 6000 A440
         B     FAIL                      . 00AB20 47F0 9010
         B     RTZPTR                    . 00AB24 47F0 9074
         B     NEMO                      . 00AB28 47F0 964C
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Value Assignment in Pattern Matching
*
                                                             SPACE
* NMD  PROC    ,
*      MOVD    TCL,NHEDCL
                                                             SPACE
         USING NMD,11                    .
NMD      LD    0,NHEDCL                  . 00AB2C 6800 9EC0
         STD   0,TCL                     . 00AB30 6000 A3D8
                                                             SPACE
* NMD1 ACOMP   TCL,NAMICL,INTR13,RTN2
*                                  Check for end
*      SUM     TPTR,NBSPTR,TCL     Compute address
*      GETSPC  TSP,TPTR,DESCR      Get specifier
*      GETDC   TVAL,TPTR,DESCR+SPEC
*                                  get variable
*      GETLG   XCL,TSP             Get length
*      ACOMP   XCL,MLENCL,INTR8    Check &MAXLNGTH
*      VEQLC   TVAL,E,,NAMEXN      Is Variable EXPRESSION?
                                                             SPACE
NMD1     L     1,TCL                     . 00AB34 5810 A3D8
         C     1,NAMICL                  . 00AB38 5910 9EB8
         BH    S4$010                    . 00AB3C 4720 95AC
         BE    RTN2                      . 00AB40 4780 9028
         LM    1,2,NBSPTR                . 00AB44 9812 A460
         A     1,TCL                     . 00AB48 5A10 A3D8
         STM   1,2,TPTR                  . 00AB4C 9012 A3D0
         LM    1,4,8(1)                  . 00AB50 9814 1008
         STM   1,4,TSP                   . 00AB54 9014 A5A0
         L     1,TPTR                    . 00AB58 5810 A3D0
         LD    0,24(1)                   . 00AB5C 6801 0018
         STD   0,TVAL                    . 00AB60 6000 A3E8
         L     15,TSP                    . 00AB64 58F0 A5A0
         STM   15,0,XCL                  . 00AB68 90F0 A408
         C     15,MLENCL                 . 00AB6C 59F0 9848
         BH    INTR8                     . 00AB70 4720 9614
         CLC   TVAL$5(3),@@E             . 00AB74 D502 A3ED AA81
         BE    NAMEXN                    . 00AB7A 4780 B1B2
                                                             SPACE
* NMD5 VEQLC   TVAL,K,,NMDIC       Is variable KEYWORD?
*      RCALL   VVAL,GENVAR,(TSPPTR)
*                                  Generate string
                                                             SPACE
NMD5     CLC   TVAL$5(3),@@K             . 00AB7E D502 A3ED AA8A
         BE    NMDIC                     . 00AB84 4780 B19C
         LA    14,S4$0ABAC               . 00AB88 41E0 B080
         STM   11,14,104(12)             . 00AB8C 90BE C068
         LR    13,12                     . 00AB90 18DC
         LD    0,TSPPTR                  . 00AB92 6800 9F78
         STD   0,120(12)                 . 00AB96 600C 0078
         LA    12,24(12)                 . 00AB9A 41CC 0018
         C     12,@@STACKT               . 00AB9E 59C0 A828
         BH    OVER                      . 00ABA2 4720 9664
         L     11,@@GENVAR               . 00ABA6 58B0 A830
         BR    11                        . 00ABAA 07FB
S4$0ABAC STD   0,VVAL                    . 00ABAC 6000 A3F0
                                                             SPACE
* NMD4 PUTDC   TVAL,DESCR,VVAL     Assign value
*      AEQLC   OUTSW,0,,NMD3       Check &OUTPUT
*      LOCAPV  ZPTR,OUTATL,TVAL,NMD3
*                                  Look for output association
*      GETDC   ZPTR,ZPTR,DESCR     Get association
*      RCALL   ,PUTOUT,(ZPTR,VVAL) Perform output
                                                             SPACE
NMD4     L     1,TVAL                    . 00ABB0 5810 A3E8
         LD    0,VVAL                    . 00ABB4 6800 A3F0
         STD   0,8(1)                    . 00ABB8 6001 0008
         C     0,OUTSW                   . 00ABBC 5900 9838
         BE    NMD3                      . 00ABC0 4780 B0F0
         L     15,OUTATL                 . 00ABC4 58F0 A308
         L     5,4(15)                   . 00ABC8 585F 0004
         LA    5,0(5,15)                 . 00ABCC 4155 F000
         LR    4,8                       . 00ABD0 1848
         SR    5,4                       . 00ABD2 1B54
         AR    4,8                       . 00ABD4 1A48
S4$0ABD6 CLC   16(8,15),TVAL             . 00ABD6 D507 F010 A3E8
         BE    S4$0ABE8                  . 00ABDC 4780 B0BC
         BXLE  15,4,S4$0ABD6             . 00ABE0 87F4 B0AA
         B     NMD3                      . 00ABE4 47F0 B0F0
S4$0ABE8 LD    0,8(15)                   . 00ABE8 680F 0008
         STD   0,ZPTR                    . 00ABEC 6000 A440
         LA    14,S4$0AC18               . 00ABF0 41E0 B0EC
         STM   11,14,104(12)             . 00ABF4 90BE C068
         LR    13,12                     . 00ABF8 18DC
         STD   0,128(12)                 . 00ABFA 600C 0080
         LD    0,VVAL                    . 00ABFE 6800 A3F0
         STD   0,120(12)                 . 00AC02 600C 0078
         LA    12,32(12)                 . 00AC06 41CC 0020
         C     12,@@STACKT               . 00AC0A 59C0 A828
         BH    OVER                      . 00AC0E 4720 9664
         L     11,@@PUTOUT               . 00AC12 58B0 A974
         BR    11                        . 00AC16 07FB
S4$0AC18 SR    0,0                       . 00AC18 1B00
         SR    0,0                       . 00AC1A 1B00
                                                             SPACE
* NMD3 ACOMPC  TRAPCL,0,,NMD2,NMD2 Check &TRACE
*      LOCAPT  ATPTR,TVALL,TVAL,NMD2
*                                  Look for VALUE trace
*      PUSH    (TCL,NAMICL,NHEDCL) Save state
*      MOVD    NHEDCL,NAMICL       Set up new name list
*      RCALL   ,TRPHND,ATPTR       Perform trace                E3.3.1
*      POP     (NHEDCL,NAMICL,TCL) Restore state
                                                             SPACE
NMD3     C     0,TRAPCL                  . 00AC1C 5900 9818
         BNL   NMD2                      . 00AC20 47B0 B18C
         L     15,TVALL                  . 00AC24 58F0 A310
         L     5,4(15)                   . 00AC28 585F 0004
         LA    5,0(5,15)                 . 00AC2C 4155 F000
         LR    4,8                       . 00AC30 1848
         SR    5,4                       . 00AC32 1B54
         AR    4,8                       . 00AC34 1A48
S4$0AC36 CLC   8(8,15),TVAL              . 00AC36 D507 F008 A3E8
         BE    S4$0AC48                  . 00AC3C 4780 B11C
         BXLE  15,4,S4$0AC36             . 00AC40 87F4 B10A
         B     NMD2                      . 00AC44 47F0 B18C
S4$0AC48 LD    0,TCL                     . 00AC48 6800 A3D8
         STD   0,104(12)                 . 00AC4C 600C 0068
         LD    0,NAMICL                  . 00AC50 6800 9EB8
         STD   0,112(12)                 . 00AC54 600C 0070
         LD    0,NHEDCL                  . 00AC58 6800 9EC0
         STD   0,120(12)                 . 00AC5C 600C 0078
         LA    12,24(12)                 . 00AC60 41CC 0018
         C     12,@@STACKT               . 00AC64 59C0 A828
         BH    OVER                      . 00AC68 4720 9664
         LD    0,NAMICL                  . 00AC6C 6800 9EB8
         STD   0,NHEDCL                  . 00AC70 6000 9EC0
         LA    14,S4$0AC94               . 00AC74 41E0 B168
         STM   11,14,104(12)             . 00AC78 90BE C068
         LR    13,12                     . 00AC7C 18DC
         STM   15,0,120(12)              . 00AC7E 90F0 C078
         LA    12,24(12)                 . 00AC82 41CC 0018
         C     12,@@STACKT               . 00AC86 59C0 A828
         BH    OVER                      . 00AC8A 4720 9664
         L     11,@@TRPHND               . 00AC8E 58B0 A918
         BR    11                        . 00AC92 07FB
S4$0AC94 SR    0,0                       . 00AC94 1B00
         SR    0,0                       . 00AC96 1B00
         LA    0,0                       . 00AC98 4100 0000
         LD    0,96(12)                  . 00AC9C 680C 0060
         STD   0,NHEDCL                  . 00ACA0 6000 9EC0
         LD    0,88(12)                  . 00ACA4 680C 0058
         STD   0,NAMICL                  . 00ACA8 6000 9EB8
         LD    0,80(12)                  . 00ACAC 680C 0050
         STD   0,TCL                     . 00ACB0 6000 A3D8
         S     12,@@3MDESC               . 00ACB4 5BC0 A860
                                                             SPACE
* NMD2 INCRA   TCL,DESCR+SPEC      Move to next name
*      BRANCH  NMD1                Continue
                                                             SPACE
NMD2     L     1,TCL                     . 00ACB8 5810 A3D8
         LA    1,24(1)                   . 00ACBC 4111 0018
         ST    1,TCL                     . 00ACC0 5010 A3D8
         B     NMD1                      . 00ACC4 47F0 B008
                                                             SPACE
* NMDIC SPCINT VVAL,TSP,INTR1,NMD4 Convert to INTEGER
                                                             SPACE
NMDIC    L     15,@@DECBIN               . 00ACC8 58F0 A8EC
         LA    1,VVAL                    . 00ACCC 4110 A3F0
         LA    2,TSP                     . 00ACD0 4120 A5A0
         BALR  14,15                          CALL                     *
                                         . 00ACD4 05EF
         B     INTR1                     . 00ACD6 47F0 95FC
         B     NMD4                      . 00ACDA 47F0 B084
                                                             SPACE
* NAMEXN RCALL TVAL,EXPEVL,TVAL,(FAIL,NMD5,NEMO)                E3.10.5
*                                  Evaluate expression
NAMEXN   LA    14,S4$0AD02               . 00ACDE 41E0 B1D6
         STM   11,14,104(12)             . 00ACE2 90BE C068
         LR    13,12                     . 00ACE6 18DC
         LD    0,TVAL                    . 00ACE8 6800 A3E8
         STD   0,120(12)                 . 00ACEC 600C 0078
         LA    12,24(12)                 . 00ACF0 41CC 0018
         C     12,@@STACKT               . 00ACF4 59C0 A828
         BH    OVER                      . 00ACF8 4720 9664
         L     11,@@EXPEVL               . 00ACFC 58B0 A99C
         BR    11                        . 00AD00 07FB
S4$0AD02 STD   0,TVAL                    . 00AD02 6000 A3E8
         B     NMD2                      . 00AD06 47F0 B18C
         B     NMD5                      . 00AD0A 47F0 B052
         B     NEMO                      . 00AD0E 47F0 964C
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Unevaluated Expression
*
                                                             SPACE
* STR  PROC    ,                   *X
*      SUM     ZPTR,OCBSCL,OCICL   Compute position in code
*      RCALL   ,CODSKP,(ONECL)     Skip one nest
*      SETVC   ZPTR,E              Insert EXPRESSION data type
*      BRANCH  RTZPTR              Return pointer to code
         USING STR,11                    .
STR      LM    1,2,OCBSCL                . 00AD12 9812 A470
         A     1,OCICL                   . 00AD16 5A10 9ED8
         STM   1,2,ZPTR                  . 00AD1A 9012 A440
         LA    14,S4$0AD42               . 00AD1E 41E0 B030
         STM   11,14,104(12)             . 00AD22 90BE C068
         LR    13,12                     . 00AD26 18DC
         LD    0,ONECL                   . 00AD28 6800 9C68
         STD   0,120(12)                 . 00AD2C 600C 0078
         LA    12,24(12)                 . 00AD30 41CC 0018
         C     12,@@STACKT               . 00AD34 59C0 A828
         BH    OVER                      . 00AD38 4720 9664
         L     11,@@CODSKP               . 00AD3C 58B0 A868
         BR    11                        . 00AD40 07FB
S4$0AD42 SR    0,0                       . 00AD42 1B00
         SR    0,0                       . 00AD44 1B00
         MVC   ZPTR$5(3),@@E             . 00AD46 D202 A445 AA81
         B     RTZPTR                    . 00AD4C 47F0 9074
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Other Predicates'
*
*      DIFFER(X,Y)
*
                                                             SPACE
* DIFFER PROC  ,                   DIFFER(X,Y)
*      RCALL   ,XYARGS,,FAIL       Evaluate arguments
*      DEQL    XPTR,YPTR,RETNUL,FAIL
*                                  Compare them
         USING DIFFER,11                 .
DIFFER   LA    14,S4$0AD6C               . 00AD50 41E0 B01C
         STM   11,14,104(12)             . 00AD54 90BE C068
         LR    13,12                     . 00AD58 18DC
         LA    12,16(12)                 . 00AD5A 41CC 0010
         C     12,@@STACKT               . 00AD5E 59C0 A828
         BH    OVER                      . 00AD62 4720 9664
         L     11,@@XYARGS               . 00AD66 58B0 A93C
         BR    11                        . 00AD6A 07FB
S4$0AD6C SR    0,0                       . 00AD6C 1B00
         SR    0,0                       . 00AD6E 1B00
         B     FAIL                      . 00AD70 47F0 9010
         CLC   XPTR(8),YPTR              . 00AD74 D507 A410 A428
         BNE   RETNUL                    . 00AD7A 4770 9018
         BE    FAIL                      . 00AD7E 4780 9010
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      IDENT(X,Y)
*
                                                             SPACE
* IDENT PROC   ,                   IDENT(X,Y)
*      RCALL   ,XYARGS,,FAIL       Evaluate arguments
*      DEQL    XPTR,YPTR,FAIL,RETNUL
*                                  Compare arguments
         USING IDENT,11                  .
IDENT    LA    14,S4$0AD9E               . 00AD82 41E0 B01C
         STM   11,14,104(12)             . 00AD86 90BE C068
         LR    13,12                     . 00AD8A 18DC
         LA    12,16(12)                 . 00AD8C 41CC 0010
         C     12,@@STACKT               . 00AD90 59C0 A828
         BH    OVER                      . 00AD94 4720 9664
         L     11,@@XYARGS               . 00AD98 58B0 A93C
         BR    11                        . 00AD9C 07FB
S4$0AD9E SR    0,0                       . 00AD9E 1B00
         SR    0,0                       . 00ADA0 1B00
         B     FAIL                      . 00ADA2 47F0 9010
         CLC   XPTR(8),YPTR              . 00ADA6 D507 A410 A428
         BNE   FAIL                      . 00ADAC 4770 9010
         BE    RETNUL                    . 00ADB0 4780 9018
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      LGT(X,Y)
*
                                                             SPACE
* LGT  PROC    ,                   LGT(X,Y)
*      RCALL   XPTR,VARVAL,,FAIL   Evaluate first argument
*      PUSH    XPTR                Save first argument
*      RCALL   YPTR,VARVAL,,FAIL   Evaluate second argument
*      POP     XPTR                Restore first argument
*      AEQLC   XPTR,0,,FAIL        Null is not greater than anything
*      AEQLC   YPTR,0,,RETNUL      Similarly for second argument
*      LOCSP   XSP,XPTR            Get specifier to first argument
*      LOCSP   YSP,YPTR            Get specifier to second argument
*      LEXCMP  XSP,YSP,RETNUL,FAIL,FAIL
*                                  Compare lexically
         USING LGT,11                    .
LGT      LA    14,S4$0ADD0               . 00ADB4 41E0 B01C
         STM   11,14,104(12)             . 00ADB8 90BE C068
         LR    13,12                     . 00ADBC 18DC
         LA    12,16(12)                 . 00ADBE 41CC 0010
         C     12,@@STACKT               . 00ADC2 59C0 A828
         BH    OVER                      . 00ADC6 4720 9664
         L     11,@@VARVAL               . 00ADCA 58B0 A9C0
         BR    11                        . 00ADCE 07FB
S4$0ADD0 STD   0,XPTR                    . 00ADD0 6000 A410
         B     FAIL                      . 00ADD4 47F0 9010
         LD    0,XPTR                    . 00ADD8 6800 A410
         STD   0,104(12)                 . 00ADDC 600C 0068
         AR    12,8                      . 00ADE0 1AC8
         C     12,@@STACKT               . 00ADE2 59C0 A828
         BH    OVER                      . 00ADE6 4720 9664
         LA    14,S4$0AE06               . 00ADEA 41E0 B052
         STM   11,14,104(12)             . 00ADEE 90BE C068
         LR    13,12                     . 00ADF2 18DC
         LA    12,16(12)                 . 00ADF4 41CC 0010
         C     12,@@STACKT               . 00ADF8 59C0 A828
         BH    OVER                      . 00ADFC 4720 9664
         L     11,@@VARVAL               . 00AE00 58B0 A9C0
         BR    11                        . 00AE04 07FB
S4$0AE06 STD   0,YPTR                    . 00AE06 6000 A428
         B     FAIL                      . 00AE0A 47F0 9010
         LM    3,4,96(12)                . 00AE0E 9834 C060
         STM   3,4,XPTR                  . 00AE12 9034 A410
         SR    12,8                      . 00AE16 1BC8
         CR    0,3                       . 00AE18 1903
         BE    FAIL                      . 00AE1A 4780 9010
         C     0,YPTR                    . 00AE1E 5900 A428
         BE    RETNUL                    . 00AE22 4780 9018
         CR    0,3                       . 00AE26 1903
         BNE   S4$0AE34                  . 00AE28 4770 B080
         ST    0,XSP                     . 00AE2C 5000 A5D0
         B     S4$0AE44                  . 00AE30 47F0 B090
S4$0AE34 L     1,4(3)                    . 00AE34 5813 0004
         LA    1,0(1)                    . 00AE38 4111 0000
         LA    2,32                      . 00AE3C 4120 0020
         STM   1,4,XSP                   . 00AE40 9014 A5D0
S4$0AE44 LM    3,4,YPTR                  . 00AE44 9834 A428
         CR    0,3                       . 00AE48 1903
         BNE   S4$0AE56                  . 00AE4A 4770 B0A2
         ST    0,YSP                     . 00AE4E 5000 A5E0
         B     S4$0AE66                  . 00AE52 47F0 B0B2
S4$0AE56 L     1,4(3)                    . 00AE56 5813 0004
         LA    1,0(1)                    . 00AE5A 4111 0000
         LA    2,32                      . 00AE5E 4120 0020
         STM   1,4,YSP                   . 00AE62 9014 A5E0
S4$0AE66 LM    2,4,XSP                   . 00AE66 9824 A5D0
         LM    5,7,YSP                   . 00AE6A 9857 A5E0
         L     15,@@COMPLG               . 00AE6E 58F0 AA34
         BALR  14,15                          CALL                     *
                                         . 00AE72 05EF
         B     RETNUL                    . 00AE74 47F0 9018
         B     FAIL                      . 00AE78 47F0 9010
         B     FAIL                      . 00AE7C 47F0 9010
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Unary Negation Operator
*
                                                             SPACE
* NEG  PROC    ,                   \X
*      PUSH    (OCBSCL,OCICL)      Save object code position
*      RCALL   ,ARGVAL,,(,FAIL)    Fail on success
*      POP     (OCICL,OCBSCL)      Restore object code position
*      RCALL   ,CODSKP,(ONECL),RETNUL
*                                  Skip argument and return
         USING NEG,11                    .
NEG      LD    0,OCBSCL                  . 00AE80 6800 A470
         STD   0,104(12)                 . 00AE84 600C 0068
         LD    0,OCICL                   . 00AE88 6800 9ED8
         STD   0,112(12)                 . 00AE8C 600C 0070
         LA    12,16(12)                 . 00AE90 41CC 0010
         C     12,@@STACKT               . 00AE94 59C0 A828
         BH    OVER                      . 00AE98 4720 9664
         LA    14,S4$0AEB8               . 00AE9C 41E0 B038
         STM   11,14,104(12)             . 00AEA0 90BE C068
         LR    13,12                     . 00AEA4 18DC
         LA    12,16(12)                 . 00AEA6 41CC 0010
         C     12,@@STACKT               . 00AEAA 59C0 A828
         BH    OVER                      . 00AEAE 4720 9664
         L     11,@@ARGVAL               . 00AEB2 58B0 A914
         BR    11                        . 00AEB6 07FB
S4$0AEB8 SR    0,0                       . 00AEB8 1B00
         SR    0,0                       . 00AEBA 1B00
         B     S4$0AEC4                  . 00AEBC 47F0 B044
         B     FAIL                      . 00AEC0 47F0 9010
S4$0AEC4 LD    0,96(12)                  . 00AEC4 680C 0060
         STD   0,OCICL                   . 00AEC8 6000 9ED8
         LD    0,88(12)                  . 00AECC 680C 0058
         STD   0,OCBSCL                  . 00AED0 6000 A470
         SR    12,8                      . 00AED4 1BC8
         SR    12,8                      . 00AED6 1BC8
         LA    14,S4$0AEFC               . 00AED8 41E0 B07C
         STM   11,14,104(12)             . 00AEDC 90BE C068
         LR    13,12                     . 00AEE0 18DC
         LD    0,ONECL                   . 00AEE2 6800 9C68
         STD   0,120(12)                 . 00AEE6 600C 0078
         LA    12,24(12)                 . 00AEEA 41CC 0018
         C     12,@@STACKT               . 00AEEE 59C0 A828
         BH    OVER                      . 00AEF2 4720 9664
         L     11,@@CODSKP               . 00AEF6 58B0 A868
         BR    11                        . 00AEFA 07FB
S4$0AEFC SR    0,0                       . 00AEFC 1B00
         SR    0,0                       . 00AEFE 1B00
         B     RETNUL                    . 00AF00 47F0 9018
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      Unary Interrogation Operator
*
                                                             SPACE
* QUES PROC    ,                   ?X
*      RCALL   ,ARGVAL,,(FAIL,RETNUL)
*                                  Evaluate argument
         USING QUES,11                   .
QUES     LA    14,S4$0AF20               . 00AF04 41E0 B01C
         STM   11,14,104(12)             . 00AF08 90BE C068
         LR    13,12                     . 00AF0C 18DC
         LA    12,16(12)                 . 00AF0E 41CC 0010
         C     12,@@STACKT               . 00AF12 59C0 A828
         BH    OVER                      . 00AF16 4720 9664
         L     11,@@ARGVAL               . 00AF1A 58B0 A914
         BR    11                        . 00AF1E 07FB
S4$0AF20 SR    0,0                       . 00AF20 1B00
         SR    0,0                       . 00AF22 1B00
         B     FAIL                      . 00AF24 47F0 9010
         B     RETNUL                    . 00AF28 47F0 9018
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Other Functions'
*
*      APPLY(F,A1,...AN)
*
                                                             SPACE
* APPLY PROC   ,                   APPLY(F,A1,...,AN)
*      SETAV   XCL,INCL            Get count of arguments
*      DECRA   XCL,1               Decrement to skip function name
*      ACOMPC  XCL,1,,,ARGNER                                   E3.3.3
*      PUSH    XCL                 Save argument count
*      RCALL   XPTR,VARVAL,,FAIL   Get function name
*      POP     XCL                 Restore argument count
*      LOCAPV  XPTR,FNCPL,XPTR,UNDF
*                                  Locate function
*      GETDC   INCL,XPTR,DESCR     Get function descriptor
*      SETVA   INCL,XCL            Insert actual number of arguments
*      RCALL   ZPTR,INVOKE,(INCL),(FAIL,,RTZPTR)
*      MOVD    XPTR,ZPTR           Return by name
*      BRANCH  RTXNAM
         USING APPLY,11                  .
APPLY    L     15,INCL$4                 . 00AF2C 58F0 9E9C
         LA    15,0(15)                  . 00AF30 41FF 0000
         BCTR  15,0                           DECREMENT                *
                                         . 00AF34 06F0
         STM   15,0,XCL                  . 00AF36 90F0 A408
         CR    0,15                      . 00AF3A 190F
         BNL   ARGNER                    . 00AF3C 47B0 95A0
         STM   15,0,104(12)              . 00AF40 90F0 C068
         AR    12,8                      . 00AF44 1AC8
         C     12,@@STACKT               . 00AF46 59C0 A828
         BH    OVER                      . 00AF4A 4720 9664
         LA    14,S4$0AF6A               . 00AF4E 41E0 B03E
         STM   11,14,104(12)             . 00AF52 90BE C068
         LR    13,12                     . 00AF56 18DC
         LA    12,16(12)                 . 00AF58 41CC 0010
         C     12,@@STACKT               . 00AF5C 59C0 A828
         BH    OVER                      . 00AF60 4720 9664
         L     11,@@VARVAL               . 00AF64 58B0 A9C0
         BR    11                        . 00AF68 07FB
S4$0AF6A STD   0,XPTR                    . 00AF6A 6000 A410
         B     FAIL                      . 00AF6E 47F0 9010
         LD    0,96(12)                  . 00AF72 680C 0060
         STD   0,XCL                     . 00AF76 6000 A408
         SR    12,8                      . 00AF7A 1BC8
         L     15,FNCPL                  . 00AF7C 58F0 A2F8
         L     5,4(15)                   . 00AF80 585F 0004
         LA    5,0(5,15)                 . 00AF84 4155 F000
         LR    4,8                       . 00AF88 1848
         SR    5,4                       . 00AF8A 1B54
         AR    4,8                       . 00AF8C 1A48
S4$0AF8E CLC   16(8,15),XPTR             . 00AF8E D507 F010 A410
         BE    S4$0AFA0                  . 00AF94 4780 B074
         BXLE  15,4,S4$0AF8E             . 00AF98 87F4 B062
         B     UNDF                      . 00AF9C 47F0 969C
S4$0AFA0 STM   15,0,XPTR                 . 00AFA0 90F0 A410
         LD    0,8(15)                   . 00AFA4 680F 0008
         STD   0,INCL                    . 00AFA8 6000 9E98
         MVC   INCL$5(3),XCL$1           . 00AFAC D202 9E9D A409
         LA    14,S4$0AFD6               . 00AFB2 41E0 B0AA
         STM   11,14,104(12)             . 00AFB6 90BE C068
         LR    13,12                     . 00AFBA 18DC
         LD    0,INCL                    . 00AFBC 6800 9E98
         STD   0,120(12)                 . 00AFC0 600C 0078
         LA    12,24(12)                 . 00AFC4 41CC 0018
         C     12,@@STACKT               . 00AFC8 59C0 A828
         BH    OVER                      . 00AFCC 4720 9664
         L     11,@@INVOKE               . 00AFD0 58B0 A91C
         BR    11                        . 00AFD4 07FB
S4$0AFD6 STD   0,ZPTR                    . 00AFD6 6000 A440
         B     FAIL                      . 00AFDA 47F0 9010
         B     S4$0AFE6                  . 00AFDE 47F0 B0BA
         B     RTZPTR                    . 00AFE2 47F0 9074
S4$0AFE6 LD    0,ZPTR                    . 00AFE6 6800 A440
         STD   0,XPTR                    . 00AFEA 6000 A410
         B     RTXNAM                    . 00AFEE 47F0 9038
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      ARG(F,N), FIELD(F,N), and LOCAL(F,N)
*
                                                             SPACE
* ARG  PROC    ,                   ARG(F,N)
*      PUSH    (ONECL,DEFCL)       Save ARG indicators
*      BRANCH  ARG1                Join main processing
                                                             SPACE
         USING ARG,11                    .
ARG      LD    0,ONECL                   . 00AFF2 6800 9C68
         STD   0,104(12)                 . 00AFF6 600C 0068
         LD    0,DEFCL                   . 00AFFA 6800 9F30
         STD   0,112(12)                 . 00AFFE 600C 0070
         LA    12,16(12)                 . 00B002 41CC 0010
         C     12,@@STACKT               . 00B006 59C0 A828
         BH    OVER                      . 00B00A 4720 9664
         B     ARG1                      . 00B00E 47F0 B0A8
                                                             SPACE
* ARGINT PROC  ARG                 Procedure used for CALL tracing
*      POP     (XPTR,XCL)          Restore arguments
*      PUSH    (ONECL,DEFCL)       Save indicators
*      BRANCH  ARG2                Join processing
                                                             SPACE
ARGINT   L     11,@@ARG                  . 00B012 58B0 AA38
         LD    0,96(12)                  . 00B016 680C 0060
         STD   0,XPTR                    . 00B01A 6000 A410
         LD    0,88(12)                  . 00B01E 680C 0058
         STD   0,XCL                     . 00B022 6000 A408
         SR    12,8                      . 00B026 1BC8
         SR    12,8                      . 00B028 1BC8
         LD    0,ONECL                   . 00B02A 6800 9C68
         STD   0,104(12)                 . 00B02E 600C 0068
         LD    0,DEFCL                   . 00B032 6800 9F30
         STD   0,112(12)                 . 00B036 600C 0070
         LA    12,16(12)                 . 00B03A 41CC 0010
         C     12,@@STACKT               . 00B03E 59C0 A828
         BH    OVER                      . 00B042 4720 9664
         B     ARG2                      . 00B046 47F0 B116
                                                             SPACE
* LOCAL PROC   ARG                 LOCAL(F,N)
*      PUSH    (ONECL,ZEROCL,DEFCL)
*                                  Save LOCAL indicators
*      BRANCH  ARG1                Join main processing
                                                             SPACE
LOCAL    L     11,@@ARG                  . 00B04A 58B0 AA38
         LD    0,ONECL                   . 00B04E 6800 9C68
         STD   0,104(12)                 . 00B052 600C 0068
         LD    0,ZEROCL                  . 00B056 6800 9C90
         STD   0,112(12)                 . 00B05A 600C 0070
         LD    0,DEFCL                   . 00B05E 6800 9F30
         STD   0,120(12)                 . 00B062 600C 0078
         LA    12,24(12)                 . 00B066 41CC 0018
         C     12,@@STACKT               . 00B06A 59C0 A828
         BH    OVER                      . 00B06E 4720 9664
         B     ARG1                      . 00B072 47F0 B0A8
                                                             SPACE
* FIELDS PROC  ARG                 FIELD(F,N)
*      PUSH    (ZEROCL,ZEROCL,DATCL)
*                                  Save FIELD indicators
                                                             SPACE
FIELDS   L     11,@@ARG                  . 00B076 58B0 AA38
         LD    0,ZEROCL                  . 00B07A 6800 9C90
         STD   0,104(12)                 . 00B07E 600C 0068
         STD   0,112(12)                 . 00B082 600C 0070
         LD    0,DATCL                   . 00B086 6800 9F28
         STD   0,120(12)                 . 00B08A 600C 0078
         LA    12,24(12)                 . 00B08E 41CC 0018
         C     12,@@STACKT               . 00B092 59C0 A828
         BH    OVER                      . 00B096 4720 9664
                                                             SPACE
* ARG1 RCALL   XPTR,VARVAL,,FAIL   Get function name
*      PUSH    XPTR                Save function name
*      RCALL   XCL,INTVAL,,FAIL    Get number
*      ACOMP   ZEROCL,XCL,FAIL,FAIL
*                                  Verify positive number
*      POP     XPTR                Restore function name
                                                             SPACE
ARG1     LA    14,S4$0B0B6               . 00B09A 41E0 B0C4
         STM   11,14,104(12)             . 00B09E 90BE C068
         LR    13,12                     . 00B0A2 18DC
         LA    12,16(12)                 . 00B0A4 41CC 0010
         C     12,@@STACKT               . 00B0A8 59C0 A828
         BH    OVER                      . 00B0AC 4720 9664
         L     11,@@VARVAL               . 00B0B0 58B0 A9C0
         BR    11                        . 00B0B4 07FB
S4$0B0B6 STD   0,XPTR                    . 00B0B6 6000 A410
         B     FAIL                      . 00B0BA 47F0 9010
         LD    0,XPTR                    . 00B0BE 6800 A410
         STD   0,104(12)                 . 00B0C2 600C 0068
         AR    12,8                      . 00B0C6 1AC8
         C     12,@@STACKT               . 00B0C8 59C0 A828
         BH    OVER                      . 00B0CC 4720 9664
         LA    14,S4$0B0EC               . 00B0D0 41E0 B0FA
         STM   11,14,104(12)             . 00B0D4 90BE C068
         LR    13,12                     . 00B0D8 18DC
         LA    12,16(12)                 . 00B0DA 41CC 0010
         C     12,@@STACKT               . 00B0DE 59C0 A828
         BH    OVER                      . 00B0E2 4720 9664
         L     11,@@INTVAL               . 00B0E6 58B0 A9E8
         BR    11                        . 00B0EA 07FB
S4$0B0EC STD   0,XCL                     . 00B0EC 6000 A408
         B     FAIL                      . 00B0F0 47F0 9010
         LR    1,0                       . 00B0F4 1810
         C     1,XCL                     . 00B0F6 5910 A408
         BNL   FAIL                      . 00B0FA 47B0 9010
         LD    0,96(12)                  . 00B0FE 680C 0060
         STD   0,XPTR                    . 00B102 6000 A410
         SR    12,8                      . 00B106 1BC8
                                                             SPACE
* ARG2 LOCAPV  XPTR,FNCPL,XPTR,INTR30
*                                  Look for function descriptor
*      GETDC   XPTR,XPTR,DESCR     Get function descriptor
*      GETDC   YCL,XPTR,0          Get procedure descriptor
*      GETDC   XPTR,XPTR,DESCR     Get definition block
*      POP     (ZCL,ALCL)          Restore indicators
*      AEQL    YCL,ZCL,INTR30      Check procedure type
*      MULTC   XCL,XCL,DESCR       Convert number to address units
*      INCRA   XCL,2*DESCR         Skip prototype information
*      SETAV   YCL,YCL             Get argument count
*      MULTC   YCL,YCL,DESCR       Convert to address units
*      AEQLC   ALCL,0,,ARG4        Check funcion type
*      INCRA   YCL,2*DESCR         Increment for heading
*      MOVD    ZCL,YCL             Get working copy
*      BRANCH  ARG5                Branch to continue processing
                                                             SPACE
ARG2     L     15,FNCPL                  . 00B108 58F0 A2F8
         L     5,4(15)                   . 00B10C 585F 0004
         LA    5,0(5,15)                 . 00B110 4155 F000
         LR    4,8                       . 00B114 1848
         SR    5,4                       . 00B116 1B54
         AR    4,8                       . 00B118 1A48
S4$0B11A CLC   16(8,15),XPTR             . 00B11A D507 F010 A410
         BE    S4$0B12C                  . 00B120 4780 B13A
         BXLE  15,4,S4$0B11A             . 00B124 87F4 B128
         B     INTR30                    . 00B128 47F0 9624
S4$0B12C LM    1,2,8(15)                 . 00B12C 9812 F008
         STM   1,2,XPTR                  . 00B130 9012 A410
         LD    0,0(1)                    . 00B134 6801 0000
         STD   0,YCL                     . 00B138 6000 A420
         LD    0,8(1)                    . 00B13C 6801 0008
         STD   0,XPTR                    . 00B140 6000 A410
         LD    0,96(12)                  . 00B144 680C 0060
         STD   0,ZCL                     . 00B148 6000 A438
         LD    0,88(12)                  . 00B14C 680C 0058
         STD   0,ALCL                    . 00B150 6000 9B98
         SR    12,8                      . 00B154 1BC8
         SR    12,8                      . 00B156 1BC8
         L     1,YCL                     . 00B158 5810 A420
         C     1,ZCL                     . 00B15C 5910 A438
         BNE   INTR30                    . 00B160 4770 9624
         L     15,XCL                    . 00B164 58F0 A408
         SLA   15,3                      . 00B168 8BF0 0003
         LA    15,16(15)                 . 00B16C 41FF 0010
         STM   15,0,XCL                  . 00B170 90F0 A408
         L     15,YCL$4                  . 00B174 58F0 A424
         LA    15,0(15)                  . 00B178 41FF 0000
         SLA   15,3                      . 00B17C 8BF0 0003
         STM   15,0,YCL                  . 00B180 90F0 A420
         C     0,ALCL                    . 00B184 5900 9B98
         BE    ARG4                      . 00B188 4780 B1B0
         LR    1,15                      . 00B18C 181F
         LA    1,16(1)                   . 00B18E 4111 0010
         ST    1,YCL                     . 00B192 5010 A420
         LD    0,YCL                     . 00B196 6800 A420
         STD   0,ZCL                     . 00B19A 6000 A438
         B     ARG5                      . 00B19E 47F0 B1DE
                                                             SPACE
* ARG4 GETSIZ  ZCL,XPTR            Get size of block
*      POP     ALCL                Restore entry indicator
*      AEQLC   ALCL,0,,ARG5        Check entry type
*      SUM     XCL,XCL,YCL         Skip formal arguments
                                                             SPACE
ARG4     L     15,XPTR                   . 00B1A2 58F0 A410
         L     15,4(15)                  . 00B1A6 58FF 0004
         LA    15,0(15)                  . 00B1AA 41FF 0000
         STM   15,0,ZCL                  . 00B1AE 90F0 A438
         LD    0,96(12)                  . 00B1B2 680C 0060
         STD   0,ALCL                    . 00B1B6 6000 9B98
         SR    12,8                      . 00B1BA 1BC8
         C     0,ALCL                    . 00B1BC 5900 9B98
         BE    ARG5                      . 00B1C0 4780 B1DE
         L     1,XCL                     . 00B1C4 5810 A408
         A     1,YCL                     . 00B1C8 5A10 A420
         ST    1,XCL                     . 00B1CC 5010 A408
                                                             SPACE
* ARG5 ACOMP   XCL,ZCL,FAIL        Check number in bounds
*      GETD    ZPTR,XPTR,XCL       Get the desired name
*      BRANCH  RTZPTR              Return name as value
ARG5     L     1,XCL                     . 00B1D0 5810 A408
         C     1,ZCL                     . 00B1D4 5910 A438
         BH    FAIL                      . 00B1D8 4720 9010
         L     2,XPTR                    . 00B1DC 5820 A410
         LD    0,0(1,2)                  . 00B1E0 6801 2000
         STD   0,ZPTR                    . 00B1E4 6000 A440
         B     RTZPTR                    . 00B1E8 47F0 9074
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      CLEAR()
*
                                                             SPACE
* CLEAR PROC   ,                   CLEAR()
*      RCALL   ,ARGVAL,,FAIL       Get rid of argument
*      SETAC   DMPPTR,OBLIST-DESCR Initialize bin pointer
                                                             SPACE
         USING CLEAR,11                  .
CLEAR    LA    14,S4$0B208               . 00B1EC 41E0 B01C
         STM   11,14,104(12)             . 00B1F0 90BE C068
         LR    13,12                     . 00B1F4 18DC
         LA    12,16(12)                 . 00B1F6 41CC 0010
         C     12,@@STACKT               . 00B1FA 59C0 A828
         BH    OVER                      . 00B1FE 4720 9664
         L     11,@@ARGVAL               . 00B202 58B0 A914
         BR    11                        . 00B206 07FB
S4$0B208 SR    0,0                       . 00B208 1B00
         SR    0,0                       . 00B20A 1B00
         B     FAIL                      . 00B20C 47F0 9010
         L     1,@@OBLOCK                . 00B210 5810 A898
         ST    1,DMPPTR                  . 00B214 5010 9E38
                                                             SPACE
* CLEAR1 ACOMP DMPPTR,OBEND,RETNUL Check for end
*      INCRA   DMPPTR,DESCR        Update for next bin
*      MOVD    YPTR,DMPPTR         Get working copy
                                                             SPACE
CLEAR1   L     1,DMPPTR                  . 00B218 5810 9E38
         C     1,OBEND                   . 00B21C 5910 9C58
         BH    RETNUL                    . 00B220 4720 9018
         L     1,DMPPTR                  . 00B224 5810 9E38
         AR    1,8                       . 00B228 1A18
         ST    1,DMPPTR                  . 00B22A 5010 9E38
         LD    0,DMPPTR                  . 00B22E 6800 9E38
         STD   0,YPTR                    . 00B232 6000 A428
                                                             SPACE
* CLEAR2 GETAC YPTR,YPTR,LNKFLD    Get next variable
*      AEQLC   YPTR,0,,CLEAR1      Check for end of chain
*      PUTDC   YPTR,DESCR,NULVCL   Assign null value
*      BRANCH  CLEAR2              Continue
CLEAR2   L     1,YPTR                    . 00B236 5810 A428
         L     1,24(1)                   . 00B23A 5811 0018
         ST    1,YPTR                    . 00B23E 5010 A428
         CR    0,1                       . 00B242 1901
         BE    CLEAR1                    . 00B244 4780 B02C
         LD    0,NULVCL                  . 00B248 6800 9ED0
         STD   0,8(1)                    . 00B24C 6001 0008
         B     CLEAR2                    . 00B250 47F0 B04A
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      COLLECT(N)
*
                                                             SPACE
* COLECT PROC  ,                   COLLECT(N)
*      RCALL   XPTR,INTVAL,,FAIL   Get number of address units required
*      ACOMPC  XPTR,0,,,LENERR     Verify positive integer
*      RCALL   ZPTR,GC,(XPTR),FAIL Call for storage regeneration
*      SETVC   ZPTR,I              Set INTEGER data type
*      BRANCH  RTZPTR              Return amount collected
         USING COLECT,11                 .
COLECT   LA    14,S4$0B270               . 00B254 41E0 B01C
         STM   11,14,104(12)             . 00B258 90BE C068
         LR    13,12                     . 00B25C 18DC
         LA    12,16(12)                 . 00B25E 41CC 0010
         C     12,@@STACKT               . 00B262 59C0 A828
         BH    OVER                      . 00B266 4720 9664
         L     11,@@INTVAL               . 00B26A 58B0 A9E8
         BR    11                        . 00B26E 07FB
S4$0B270 STD   0,XPTR                    . 00B270 6000 A410
         B     FAIL                      . 00B274 47F0 9010
         C     0,XPTR                    . 00B278 5900 A410
         BH    LENERR                    . 00B27C 4720 963C
         LA    14,S4$0B2A4               . 00B280 41E0 B050
         STM   11,14,104(12)             . 00B284 90BE C068
         LR    13,12                     . 00B288 18DC
         LD    0,XPTR                    . 00B28A 6800 A410
         STD   0,120(12)                 . 00B28E 600C 0078
         LA    12,24(12)                 . 00B292 41CC 0018
         C     12,@@STACKT               . 00B296 59C0 A828
         BH    OVER                      . 00B29A 4720 9664
         L     11,@@GC                   . 00B29E 58B0 A880
         BR    11                        . 00B2A2 07FB
S4$0B2A4 STD   0,ZPTR                    . 00B2A4 6000 A440
         B     FAIL                      . 00B2A8 47F0 9010
         MVC   ZPTR$5(3),@@I             . 00B2AC D202 A445 AA84
         B     RTZPTR                    . 00B2B2 47F0 9074
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      COPY(X)
*
                                                             SPACE
* COPY PROC    ,                   COPY(X)
*      RCALL   XPTR,ARGVAL,,FAIL   Get object to copy
*      VEQLC   XPTR,S,,INTR1       STRING cannot be copied
*      VEQLC   XPTR,I,,INTR1       INTEGER cannot be copied
*      VEQLC   XPTR,R,,INTR1       REAL cannot be copied
*      VEQLC   XPTR,N,,INTR1       NAME cannot be copied
*      VEQLC   XPTR,K,,INTR1       KEYWORD (NAME) cannot be copied
*      VEQLC   XPTR,E,,INTR1       EXPRESSION cannot be copied
*      VEQLC   XPTR,T,,INTR1       TABLE cannot be copied
*      GETSIZ  XCL,XPTR            Get size of object to copy
*      MOVV    XCL,XPTR            Insert data type
*      RCALL   ZPTR,BLOCK,XCL      Allocate block for copy
*      MOVBLK  ZPTR,XPTR,XCL       Copy contents
*      BRANCH  RTZPTR              Return the copy
         USING COPY,11                   .
COPY     LA    14,S4$0B2D2               . 00B2B6 41E0 B01C
         STM   11,14,104(12)             . 00B2BA 90BE C068
         LR    13,12                     . 00B2BE 18DC
         LA    12,16(12)                 . 00B2C0 41CC 0010
         C     12,@@STACKT               . 00B2C4 59C0 A828
         BH    OVER                      . 00B2C8 4720 9664
         L     11,@@ARGVAL               . 00B2CC 58B0 A914
         BR    11                        . 00B2D0 07FB
S4$0B2D2 STD   0,XPTR                    . 00B2D2 6000 A410
         B     FAIL                      . 00B2D6 47F0 9010
         CLC   XPTR$5(3),@@S             . 00B2DA D502 A415 AA7B
         BE    INTR1                     . 00B2E0 4780 95FC
         CLC   XPTR$5(3),@@I             . 00B2E4 D502 A415 AA84
         BE    INTR1                     . 00B2EA 4780 95FC
         CLC   XPTR$5(3),@@R             . 00B2EE D502 A415 AA75
         BE    INTR1                     . 00B2F4 4780 95FC
         CLC   XPTR$5(3),@@N             . 00B2F8 D502 A415 AA8D
         BE    INTR1                     . 00B2FE 4780 95FC
         CLC   XPTR$5(3),@@K             . 00B302 D502 A415 AA8A
         BE    INTR1                     . 00B308 4780 95FC
         CLC   XPTR$5(3),@@E             . 00B30C D502 A415 AA81
         BE    INTR1                     . 00B312 4780 95FC
         CLC   XPTR$5(3),@@T             . 00B316 D502 A415 AA72
         BE    INTR1                     . 00B31C 4780 95FC
         L     15,XPTR                   . 00B320 58F0 A410
         L     15,4(15)                  . 00B324 58FF 0004
         LA    15,0(15)                  . 00B328 41FF 0000
         STM   15,0,XCL                  . 00B32C 90F0 A408
         MVC   XCL$5(3),XPTR$5           . 00B330 D202 A40D A415
         LA    14,S4$0B35A               . 00B336 41E0 B0A4
         STM   11,14,104(12)             . 00B33A 90BE C068
         LR    13,12                     . 00B33E 18DC
         LD    0,XCL                     . 00B340 6800 A408
         STD   0,120(12)                 . 00B344 600C 0078
         LA    12,24(12)                 . 00B348 41CC 0018
         C     12,@@STACKT               . 00B34C 59C0 A828
         BH    OVER                      . 00B350 4720 9664
         L     11,@@BLOCK                . 00B354 58B0 A82C
         BR    11                        . 00B358 07FB
S4$0B35A STD   0,ZPTR                    . 00B35A 6000 A440
         L     6,ZPTR                    . 00B35E 5860 A440
         L     4,XPTR                    . 00B362 5840 A410
         AR    4,8                       . 00B366 1A48
         AR    6,8                       . 00B368 1A68
         L     3,XCL                     . 00B36A 5830 A408
         L     15,@@MOVTST               . 00B36E 58F0 A864
         BALR  14,15                          CALL                     *
                                         . 00B372 05EF
         B     RTZPTR                    . 00B374 47F0 9074
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      CONVERT(X,T)
*
                                                             SPACE
* CNVRT PROC   ,                   CONVERT(X,T)
*      RCALL   ZPTR,ARGVAL,,FAIL   Get object to be converted
*      PUSH    ZPTR                Save object
*      RCALL   YPTR,VARVAL,,FAIL   Get data type target
*      POP     ZPTR                Restore object
*      LOCAPV  XPTR,DTATL,YPTR,INTR1
*                                  Look for data type code
*      GETDC   XPTR,XPTR,DESCR     Get code
*      SETAV   DTCL,ZPTR           Insert object data type
*      MOVV    DTCL,XPTR           Insert target data type
*      DEQL    DTCL,IVDTP,,CNVIV   Check for INTEGER-STRING
*      DEQL    DTCL,VCDTP,,RECOMP  Check for STRING-CODE
*      DEQL    DTCL,VEDTP,,CONVE
*      DEQL    DTCL,VRDTP,,CONVR   Check for STRING-REAL
*      DEQL    DTCL,RIDTP,,CONRI   Check for REAL-INTEGER
*      DEQL    DTCL,IRDTP,,CONIR   Check for INTEGER-REAL
*      DEQL    DTCL,VIDTP,,CNVVI   CHeck for STRING-INTEGER
*      DEQL    DTCL,ATDTP,,CNVAT   Check for ARRAY-TABLE
*      DEQL    DTCL,TADTP,,CNVTA   Check for TABLE-ARRAY
*      VEQL    ZPTR,XPTR,,RTZPTR                                E3.0.4
*      VEQLC   XPTR,S,FAIL,CNVRTS  Check for idem-conversion    E3.0.4
                                                             SPACE
         USING CNVRT,11                  .
CNVRT    LA    14,S4$0B394               . 00B378 41E0 B01C
         STM   11,14,104(12)             . 00B37C 90BE C068
         LR    13,12                     . 00B380 18DC
         LA    12,16(12)                 . 00B382 41CC 0010
         C     12,@@STACKT               . 00B386 59C0 A828
         BH    OVER                      . 00B38A 4720 9664
         L     11,@@ARGVAL               . 00B38E 58B0 A914
         BR    11                        . 00B392 07FB
S4$0B394 STD   0,ZPTR                    . 00B394 6000 A440
         B     FAIL                      . 00B398 47F0 9010
         LD    0,ZPTR                    . 00B39C 6800 A440
         STD   0,104(12)                 . 00B3A0 600C 0068
         AR    12,8                      . 00B3A4 1AC8
         C     12,@@STACKT               . 00B3A6 59C0 A828
         BH    OVER                      . 00B3AA 4720 9664
         LA    14,S4$0B3CA               . 00B3AE 41E0 B052
         STM   11,14,104(12)             . 00B3B2 90BE C068
         LR    13,12                     . 00B3B6 18DC
         LA    12,16(12)                 . 00B3B8 41CC 0010
         C     12,@@STACKT               . 00B3BC 59C0 A828
         BH    OVER                      . 00B3C0 4720 9664
         L     11,@@VARVAL               . 00B3C4 58B0 A9C0
         BR    11                        . 00B3C8 07FB
S4$0B3CA STD   0,YPTR                    . 00B3CA 6000 A428
         B     FAIL                      . 00B3CE 47F0 9010
         LD    0,96(12)                  . 00B3D2 680C 0060
         STD   0,ZPTR                    . 00B3D6 6000 A440
         SR    12,8                      . 00B3DA 1BC8
         L     15,DTATL                  . 00B3DC 58F0 A2F0
         L     5,4(15)                   . 00B3E0 585F 0004
         LA    5,0(5,15)                 . 00B3E4 4155 F000
         LR    4,8                       . 00B3E8 1848
         SR    5,4                       . 00B3EA 1B54
         AR    4,8                       . 00B3EC 1A48
S4$0B3EE CLC   16(8,15),YPTR             . 00B3EE D507 F010 A428
         BE    S4$0B400                  . 00B3F4 4780 B088
         BXLE  15,4,S4$0B3EE             . 00B3F8 87F4 B076
         B     INTR1                     . 00B3FC 47F0 95FC
S4$0B400 STM   15,0,XPTR                 . 00B400 90F0 A410
         LR    1,15                      . 00B404 181F
         LD    0,8(1)                    . 00B406 6801 0008
         STD   0,XPTR                    . 00B40A 6000 A410
         L     15,ZPTR$4                 . 00B40E 58F0 A444
         LA    15,0(15)                  . 00B412 41FF 0000
         STM   15,0,DTCL                 . 00B416 90F0 9E40
         MVC   DTCL$5(3),XPTR$5          . 00B41A D202 9E45 A415
         CLC   DTCL(8),IVDTP             . 00B420 D507 9E40 9AF0
         BE    CNVIV                     . 00B426 4780 B412
         CLC   DTCL(8),VCDTP             . 00B42A D507 9E40 9B38
         BE    RECOMP                    . 00B430 4780 B11A
         CLC   DTCL(8),VEDTP             . 00B434 D507 9E40 9B40
         BE    CONVE                     . 00B43A 4780 B2CE
         CLC   DTCL(8),VRDTP             . 00B43E D507 9E40 9B58
         BE    CONVR                     . 00B444 4780 B34E
         CLC   DTCL(8),RIDTP             . 00B448 D507 9E40 9B10
         BE    CONRI                     . 00B44E 4780 B3C8
         CLC   DTCL(8),IRDTP             . 00B452 D507 9E40 9AE8
         BE    CONIR                     . 00B458 4780 B3A4
         CLC   DTCL(8),VIDTP             . 00B45C D507 9E40 9B48
         BE    CNVVI                     . 00B462 4780 B43E
         CLC   DTCL(8),ATDTP             . 00B466 D507 9E40 9AD0
         BE    CNVAT                     . 00B46C 4780 B6C0
         CLC   DTCL(8),TADTP             . 00B470 D507 9E40 9B30
         BE    CNVTA                     . 00B476 4780 B4CC
         CLC   ZPTR$5(3),XPTR$5          . 00B47A D502 A445 A415
         BE    RTZPTR                    . 00B480 4780 9074
         CLC   XPTR$5(3),@@S             . 00B484 D502 A415 AA7B
         BNE   FAIL                      . 00B48A 4770 9010
         BE    CNVRTS                    . 00B48E 4780 B494
                                                             SPACE
* RECOMP SETAC SCL,1               Note STRING-CODE conversion
                                                             SPACE
RECOMP   LA    1,1                       . 00B492 4110 0001
         ST    1,SCL                     . 00B496 5010 9EF8
                                                             SPACE
* RECOMJ LOCSP TEXTSP,ZPTR         Set up global specifier
                                                             SPACE
RECOMJ   LM    3,4,ZPTR                  . 00B49A 9834 A440
         CR    0,3                       . 00B49E 1903
         BNE   S4$0B4AC                  . 00B4A0 4770 B134
         LM    1,4,BLSP                  . 00B4A4 9814 A0C8
         B     RECOMT                    . 00B4A8 47F0 B140
S4$0B4AC L     1,4(3)                    . 00B4AC 5813 0004
         LA    1,0(1)                    . 00B4B0 4111 0000
         LA    2,32                      . 00B4B4 4120 0020
                                                             SPACE
* RECOMT GETLG OCALIM,TEXTSP                                    E3.1.5
*      AEQLC   OCALIM,0,,RECOMN                                 E3.1.5
*      MULTC   OCALIM,OCALIM,DESCR Convert to address units
*      INCRA   OCALIM,6*DESCR      Leave room for safety
*      SETVC   OCALIM,C            Insert CODE data type
*      RCALL   CMBSCL,BLOCK,OCALIM Allocate block for object code
*      SUM     OCLIM,CMBSCL,OCALIM Compute end
*      DECRA   OCLIM,6*DESCR
*      SETAC   CMOFCL,0            Zero offset
*      SETAC   ESAICL,0            Zero error count
*      PUSH    CMBSCL              Save block pointer
*      SELBRA  SCL,(,CONVEX)       Select correct procedure
                                                             SPACE
RECOMT   STM   1,4,TEXTSP                . 00B4B8 9014 A590
         L     15,TEXTSP                 . 00B4BC 58F0 A590
         STM   15,0,OCALIM               . 00B4C0 90F0 9C60
         C     0,OCALIM                  . 00B4C4 5900 9C60
         BE    NONAME                    . 00B4C8 4780 9654
         LR    15,8                      . 00B4CC 18F8
         M     14,OCALIM                 . 00B4CE 5CE0 9C60
         LA    15,48(15)                 . 00B4D2 41FF 0030
         STM   15,0,OCALIM               . 00B4D6 90F0 9C60
         MVC   OCALIM$5(3),@@C           . 00B4DA D202 9C65 AA7E
         LA    14,S4$0B504               . 00B4E0 41E0 B18C
         STM   11,14,104(12)             . 00B4E4 90BE C068
         LR    13,12                     . 00B4E8 18DC
         LD    0,OCALIM                  . 00B4EA 6800 9C60
         STD   0,120(12)                 . 00B4EE 600C 0078
         LA    12,24(12)                 . 00B4F2 41CC 0018
         C     12,@@STACKT               . 00B4F6 59C0 A828
         BH    OVER                      . 00B4FA 4720 9664
         L     11,@@BLOCK                . 00B4FE 58B0 A82C
         BR    11                        . 00B502 07FB
S4$0B504 STD   0,CMBSCL                  . 00B504 6000 A458
         LM    1,2,CMBSCL                . 00B508 9812 A458
         A     1,OCALIM                  . 00B50C 5A10 9C60
         STM   1,2,OCLIM                 . 00B510 9012 A478
         S     1,@@6MDESC                . 00B514 5B10 A990
         ST    1,OCLIM                   . 00B518 5010 A478
         ST    0,CMOFCL                  . 00B51C 5000 9E28
         ST    0,ESAICL                  . 00B520 5000 9E60
         STD   0,104(12)                 . 00B524 600C 0068
         AR    12,8                      . 00B528 1AC8
         C     12,@@STACKT               . 00B52A 59C0 A828
         BH    OVER                      . 00B52E 4720 9664
         L     1,SCL                     . 00B532 5810 9EF8
         SLA   1,2                       . 00B536 8B10 0002
S4$0B53A B     S4$0B53A(1)               . 00B53A 47F1 B1C2
         B     RECOM1                    . 00B53E 47F0 B1CE
         B     CONVEX                    . 00B542 47F0 B2DE
                                                             SPACE
* RECOM1 LEQLC TEXTSP,0,,RECOM2    Is string exhausted?
*      RCALL   ,CMPILE,,(RECOMF,,RECOM1)
*                                  Compile statement
                                                             SPACE
RECOM1   C     0,TEXTSP                  . 00B546 5900 A590
         BE    RECOM2                    . 00B54A 4780 B202
         LA    14,S4$0B56A               . 00B54E 41E0 B1F2
         STM   11,14,104(12)             . 00B552 90BE C068
         LR    13,12                     . 00B556 18DC
         LA    12,16(12)                 . 00B558 41CC 0010
         C     12,@@STACKT               . 00B55C 59C0 A828
         BH    OVER                      . 00B560 4720 9664
         L     11,@@CMPILE               . 00B564 58B0 A84C
         BR    11                        . 00B568 07FB
S4$0B56A SR    0,0                       . 00B56A 1B00
         SR    0,0                       . 00B56C 1B00
         B     RECOMF                    . 00B56E 47F0 B296
         B     RECOM2                    . 00B572 47F0 B202
         B     RECOM1                    . 00B576 47F0 B1CE
                                                             SPACE
* RECOM2 SETAC SCL,3               Set return switch
                                                             SPACE
RECOM2   LA    1,3                       . 00B57A 4110 0003
         ST    1,SCL                     . 00B57E 5010 9EF8
                                                             SPACE
* RECOMQ INCRA CMOFCL,DESCR        Increment offset
*      PUTD    CMBSCL,CMOFCL,ENDCL Insert END function
*      POP     ZPTR                Restore pointer to code block
                                                             SPACE
RECOMQ   L     1,CMOFCL                  . 00B582 5810 9E28
         AR    1,8                       . 00B586 1A18
         ST    1,CMOFCL                  . 00B588 5010 9E28
         L     2,CMBSCL                  . 00B58C 5820 A458
         LD    0,ENDCL                   . 00B590 6800 9D20
         STD   0,0(1,2)                  . 00B594 6001 2000
         LD    0,96(12)                  . 00B598 680C 0060
         STD   0,ZPTR                    . 00B59C 6000 A440
         SR    12,8                      . 00B5A0 1BC8
                                                             SPACE
* RECOMZ SUM   CMBSCL,CMBSCL,CMOFCL
*                                  Compute used portion of block
*      RCALL   ,SPLIT,(CMBSCL)     Split off remainder
*      SETAC   OCLIM,0             Clear limit pointer
*      SETAC   LPTR,0              Clear label pointer
*      ZERBLK  COMREG,COMDCT       Zero compiler descriptors
*      SELBRA  SCL,(FAIL,INTR10,RTZPTR)
*                                  Select return
                                                             SPACE
RECOMZ   L     1,CMBSCL                  . 00B5A2 5810 A458
         A     1,CMOFCL                  . 00B5A6 5A10 9E28
         ST    1,CMBSCL                  . 00B5AA 5010 A458
         LA    14,S4$0B5D2               . 00B5AE 41E0 B25A
         STM   11,14,104(12)             . 00B5B2 90BE C068
         LR    13,12                     . 00B5B6 18DC
         LD    0,CMBSCL                  . 00B5B8 6800 A458
         STD   0,120(12)                 . 00B5BC 600C 0078
         LA    12,24(12)                 . 00B5C0 41CC 0018
         C     12,@@STACKT               . 00B5C4 59C0 A828
         BH    OVER                      . 00B5C8 4720 9664
         L     11,@@SPLIT                . 00B5CC 58B0 A858
         BR    11                        . 00B5D0 07FB
S4$0B5D2 SR    0,0                       . 00B5D2 1B00
         SR    0,0                       . 00B5D4 1B00
         ST    0,OCLIM                   . 00B5D6 5000 A478
         ST    0,LPTR                    . 00B5DA 5000 A3A0
         L     1,COMREG                  . 00B5DE 5810 9CA8
         L     5,COMDCT                  . 00B5E2 5850 9CA0
         LR    4,8                       . 00B5E6 1848
         LR    3,0                       . 00B5E8 1830
         LD    0,@@D0                    . 00B5EA 6800 A808
S4$0B5EE STD   0,0(3,1)                  . 00B5EE 6003 1000
         BXLE  3,4,S4$0B5EE              . 00B5F2 8734 B276
         L     1,SCL                     . 00B5F6 5810 9EF8
         SLA   1,2                       . 00B5FA 8B10 0002
S4$0B5FE B     S4$0B5FE(1)               . 00B5FE 47F1 B286
         B     FAIL                      . 00B602 47F0 9010
         B     S4$010                    . 00B606 47F0 95AC
         B     RTZPTR                    . 00B60A 47F0 9074
                                                             SPACE
* RECOMF SETAC SCL,1               Set failure return
*      BRANCH  RECOMQ              Rejoin processing
                                                             SPACE
* RECOMN SETSP TEXTSP,BLSP                                      E3.1.5
*      BRANCH  RECOMT                                           E3.1.5
                                                             SPACE
RECOMF   LA    1,1                       . 00B60E 4110 0001
         ST    1,SCL                     . 00B612 5010 9EF8
         B     RECOMQ                    . 00B616 47F0 B20A
                                                             SPACE
* CODER PROC   CNVRT               CODE(S)
*      RCALL   ZPTR,VARVAL,,(FAIL,RECOMP)
*                                  Get argument
                                                             SPACE
CODER    L     11,@@CNVRT                . 00B61A 58B0 AA3C
         LA    14,S4$0B63A               . 00B61E 41E0 B2C2
         STM   11,14,104(12)             . 00B622 90BE C068
         LR    13,12                     . 00B626 18DC
         LA    12,16(12)                 . 00B628 41CC 0010
         C     12,@@STACKT               . 00B62C 59C0 A828
         BH    OVER                      . 00B630 4720 9664
         L     11,@@VARVAL               . 00B634 58B0 A9C0
         BR    11                        . 00B638 07FB
S4$0B63A STD   0,ZPTR                    . 00B63A 6000 A440
         B     FAIL                      . 00B63E 47F0 9010
         B     RECOMP                    . 00B642 47F0 B11A
                                                             SPACE
* CONVE PROC   CNVRT               Convert to EXPRESSION
*      SETAC   SCL,2               Set switch
*      BRANCH  RECOMJ              Join common program
                                                             SPACE
CONVE    L     11,@@CNVRT                . 00B646 58B0 AA3C
         LA    1,2                       . 00B64A 4110 0002
         ST    1,SCL                     . 00B64E 5010 9EF8
         B     RECOMJ                    . 00B652 47F0 B122
                                                             SPACE
* CONVEX RCALL FORMND,EXPR,,FAIL   Compile expression
*      LEQLC   TEXTSP,0,FAIL       Verify complete compilation
*      RCALL   ,TREPUB,FORMND      Publish code tree
*      MOVD    ZPTR,CMBSCL                                      E3.1.6
*      SETVC   ZPTR,E              Insert EXPRESSION data type
*      SETAC   SCL,3               Set return branch
*      BRANCH  RECOMZ              Join common program
                                                             SPACE
CONVEX   LA    14,S4$0B672               . 00B656 41E0 B2FA
         STM   11,14,104(12)             . 00B65A 90BE C068
         LR    13,12                     . 00B65E 18DC
         LA    12,16(12)                 . 00B660 41CC 0010
         C     12,@@STACKT               . 00B664 59C0 A828
         BH    OVER                      . 00B668 4720 9664
         L     11,@@EXPR                 . 00B66C 58B0 A8BC
         BR    11                        . 00B670 07FB
S4$0B672 STD   0,FORMND                  . 00B672 6000 A4E8
         B     FAIL                      . 00B676 47F0 9010
         C     0,TEXTSP                  . 00B67A 5900 A590
         BNE   FAIL                      . 00B67E 4770 9010
         LA    14,S4$0B6A6               . 00B682 41E0 B32E
         STM   11,14,104(12)             . 00B686 90BE C068
         LR    13,12                     . 00B68A 18DC
         LD    0,FORMND                  . 00B68C 6800 A4E8
         STD   0,120(12)                 . 00B690 600C 0078
         LA    12,24(12)                 . 00B694 41CC 0018
         C     12,@@STACKT               . 00B698 59C0 A828
         BH    OVER                      . 00B69C 4720 9664
         L     11,@@TREPUB               . 00B6A0 58B0 A8B8
         BR    11                        . 00B6A4 07FB
S4$0B6A6 SR    0,0                       . 00B6A6 1B00
         SR    0,0                       . 00B6A8 1B00
         LD    0,CMBSCL                  . 00B6AA 6800 A458
         STD   0,ZPTR                    . 00B6AE 6000 A440
         SR    0,0                       . 00B6B2 1B00
         MVC   ZPTR$5(3),@@E             . 00B6B4 D202 A445 AA81
         LA    1,3                       . 00B6BA 4110 0003
         ST    1,SCL                     . 00B6BE 5010 9EF8
         B     RECOMZ                    . 00B6C2 47F0 B22A
                                                             SPACE
* CONVR LOCSP  ZSP,ZPTR            Get specifier
*      SPCINT  ZPTR,ZSP,,CONIR     Try conversion to INTEGER first
*      SPREAL  ZPTR,ZSP,FAIL,RTZPTR
*                                  Convert to REAL
                                                             SPACE
CONVR    LM    3,4,ZPTR                  . 00B6C6 9834 A440
         CR    0,3                       . 00B6CA 1903
         BNE   S4$0B6D8                  . 00B6CC 4770 B360
         ST    0,ZSP                     . 00B6D0 5000 A5F0
         B     S4$0B6E8                  . 00B6D4 47F0 B370
S4$0B6D8 L     1,4(3)                    . 00B6D8 5813 0004
         LA    1,0(1)                    . 00B6DC 4111 0000
         LA    2,32                      . 00B6E0 4120 0020
         STM   1,4,ZSP                   . 00B6E4 9014 A5F0
S4$0B6E8 L     15,@@DECBIN               . 00B6E8 58F0 A8EC
         LA    1,ZPTR                    . 00B6EC 4110 A440
         LA    2,ZSP                     . 00B6F0 4120 A5F0
         BALR  14,15                          CALL                     *
                                         . 00B6F4 05EF
         B     S4$0B6FE                  . 00B6F6 47F0 B386
         B     CONIR                     . 00B6FA 47F0 B3A4
S4$0B6FE L     15,@@SPREAL               . 00B6FE 58F0 A8F0
         LA    1,ZPTR                    . 00B702 4110 A440
         LM    2,4,ZSP                   . 00B706 9824 A5F0
         BALR  14,15                          CALL                     *
                                         . 00B70A 05EF
         B     FAIL                      . 00B70C 47F0 9010
         LA    2,7                       . 00B710 4120 0007
         ST    2,ZPTR$4                  . 00B714 5020 A444
         B     RTZPTR                    . 00B718 47F0 9074
                                                             SPACE
* CONIR INTRL  ZPTR,ZPTR           Convert INTEGER to REAL
*      BRANCH  RTZPTR              Return value
                                                             SPACE
CONIR    L     2,ZPTR                    . 00B71C 5820 A440
         AL    2,BIG2$4                  . 00B720 5E20 A79C
         ST    2,REALBB$4                . 00B724 5020 A794
         LD    2,REALBB                  . 00B728 6820 A790
         SD    2,BIG2                    . 00B72C 6B20 A798
         STE   2,ZPTR                    . 00B730 7020 A440
         LA    2,7                       . 00B734 4120 0007
         ST    2,ZPTR$4                  . 00B738 5020 A444
         B     RTZPTR                    . 00B73C 47F0 9074
                                                             SPACE
* CONRI RLINT  ZPTR,ZPTR,FAIL,RTZPTR
*                                  Convert REAL to INTEGER
                                                             SPACE
CONRI    SDR   2,2                       . 00B740 2B22
         LE    2,ZPTR                    . 00B742 7820 A440
         TM    ZPTR,X'40'                . 00B746 9140 A440
         BNO   S4$0B754                  . 00B74A 47E0 B3DC
         LTDR  2,2                       . 00B74E 2222
         BNZ   S4$0B75C                  . 00B750 4770 B3E4
S4$0B754 ST    0,ZPTR                    . 00B754 5000 A440
         B     S4$0B77E                  . 00B758 47F0 B406
S4$0B75C CE    2,MAXINT                  . 00B75C 7920 A7A8
         BH    FAIL                      . 00B760 4720 9010
         LPDR  4,2                       . 00B764 2042
         AW    4,BIGZIP                  . 00B766 6E40 A7A0
         STD   4,REALB                   . 00B76A 6040 A788
         L     2,REALB$4                 . 00B76E 5820 A78C
         LTDR  2,2                       . 00B772 2222
         BNM   S4$0B77A                  . 00B774 47B0 B402
         LNR   2,2                       . 00B778 1122
S4$0B77A ST    2,ZPTR                    . 00B77A 5020 A440
S4$0B77E LA    2,6                       . 00B77E 4120 0006
         ST    2,ZPTR$4                  . 00B782 5020 A444
         B     RTZPTR                    . 00B786 47F0 9074
                                                             SPACE
* CNVIV RCALL  ZPTR,GNVARI,ZPTR,RTZPTR
*                                  Convert INTEGER to STRING
                                                             SPACE
CNVIV    LA    14,S4$0B7AE               . 00B78A 41E0 B436
         STM   11,14,104(12)             . 00B78E 90BE C068
         LR    13,12                     . 00B792 18DC
         LD    0,ZPTR                    . 00B794 6800 A440
         STD   0,120(12)                 . 00B798 600C 0078
         LA    12,24(12)                 . 00B79C 41CC 0018
         C     12,@@STACKT               . 00B7A0 59C0 A828
         BH    OVER                      . 00B7A4 4720 9664
         L     11,@@GNVARI               . 00B7A8 58B0 A94C
         BR    11                        . 00B7AC 07FB
S4$0B7AE STD   0,ZPTR                    . 00B7AE 6000 A440
         B     RTZPTR                    . 00B7B2 47F0 9074
                                                             SPACE
* CNVVI LOCSP  ZSP,ZPTR            Get specifier
*      SPCINT  ZPTR,ZSP,,RTZPTR    Convert STRING to INTEGER
*      SPREAL  ZPTR,ZSP,FAIL,CONRI Try conversion to REAL
                                                             SPACE
CNVVI    LM    3,4,ZPTR                  . 00B7B6 9834 A440
         CR    0,3                       . 00B7BA 1903
         BNE   S4$0B7C8                  . 00B7BC 4770 B450
         ST    0,ZSP                     . 00B7C0 5000 A5F0
         B     S4$0B7D8                  . 00B7C4 47F0 B460
S4$0B7C8 L     1,4(3)                    . 00B7C8 5813 0004
         LA    1,0(1)                    . 00B7CC 4111 0000
         LA    2,32                      . 00B7D0 4120 0020
         STM   1,4,ZSP                   . 00B7D4 9014 A5F0
S4$0B7D8 L     15,@@DECBIN               . 00B7D8 58F0 A8EC
         LA    1,ZPTR                    . 00B7DC 4110 A440
         LA    2,ZSP                     . 00B7E0 4120 A5F0
         BALR  14,15                          CALL                     *
                                         . 00B7E4 05EF
         B     S4$0B7EE                  . 00B7E6 47F0 B476
         B     RTZPTR                    . 00B7EA 47F0 9074
S4$0B7EE L     15,@@SPREAL               . 00B7EE 58F0 A8F0
         LA    1,ZPTR                    . 00B7F2 4110 A440
         LM    2,4,ZSP                   . 00B7F6 9824 A5F0
         BALR  14,15                          CALL                     *
                                         . 00B7FA 05EF
         B     FAIL                      . 00B7FC 47F0 9010
         LA    2,7                       . 00B800 4120 0007
         ST    2,ZPTR$4                  . 00B804 5020 A444
         B     CONRI                     . 00B808 47F0 B3C8
                                                             SPACE
* CNVRTS RCALL XPTR,DTREP,ZPTR     Get data type representation
*      GETSPC  ZSP,XPTR,0          Get specifier
*      BRANCH  GENVRZ              Go generate variable
                                                             SPACE
CNVRTS   LA    14,S4$0B830               . 00B80C 41E0 B4B8
         STM   11,14,104(12)             . 00B810 90BE C068
         LR    13,12                     . 00B814 18DC
         LD    0,ZPTR                    . 00B816 6800 A440
         STD   0,120(12)                 . 00B81A 600C 0078
         LA    12,24(12)                 . 00B81E 41CC 0018
         C     12,@@STACKT               . 00B822 59C0 A828
         BH    OVER                      . 00B826 4720 9664
         L     11,@@DTREP                . 00B82A 58B0 AA00
         BR    11                        . 00B82E 07FB
S4$0B830 STD   0,XPTR                    . 00B830 6000 A410
         L     1,XPTR                    . 00B834 5810 A410
         LM    1,4,0(1)                  . 00B838 9814 1000
         STM   1,4,ZSP                   . 00B83C 9014 A5F0
         B     GENVRZ                    . 00B840 47F0 90D2
                                                             SPACE
* CNVTA MOVD   YPTR,ZPTR                                        E3.2.3
*      MOVD    YCL,ZEROCL                                       E3.2.3
                                                             SPACE
CNVTA    MVC   YPTR(8),ZPTR              . 00B844 D207 A428 A440
         MVC   YCL(8),ZEROCL             . 00B84A D207 A420 9C90
                                                             SPACE
* CNVTA7 GETSIZ XCL,YPTR                                        E3.2.3
*      MOVD    WPTR,YPTR                                        E3.2.3
*      MOVD    ZCL,XCL                                          E3.2.3
*      DECRA   XCL,3*DESCR                                      E3.2.3
                                                             SPACE
CNVTA7   L     15,YPTR                   . 00B850 58F0 A428
         L     15,4(15)                  . 00B854 58FF 0004
         LA    15,0(15)                  . 00B858 41FF 0000
         STM   15,0,XCL                  . 00B85C 90F0 A408
         MVC   WPTR(8),YPTR              . 00B860 D207 A400 A428
         STM   15,0,ZCL                  . 00B866 90F0 A438
         LR    1,15                      . 00B86A 181F
         S     1,@@3YDESC                . 00B86C 5B10 A89C
                                                             SPACE
* CNVTA1 GETD  WCL,WPTR,XCL        Get item value
*      DEQL    WCL,NULVCL,,CNVTA2  Check for null value
*      INCRA   YCL,1               Otherwise count item
                                                             SPACE
CNVTA1   ST    1,XCL                     . 00B870 5010 A408
         L     2,WPTR                    . 00B874 5820 A400
         LD    0,0(1,2)                  . 00B878 6801 2000
         STD   0,WCL                     . 00B87C 6000 A3F8
         CLC   WCL(8),NULVCL             . 00B880 D507 A3F8 9ED0
         BE    CNVTA2                    . 00B886 4780 B51E
         L     2,YCL                     . 00B88A 5820 A420
         LA    2,1(2)                    . 00B88E 4122 0001
         ST    2,YCL                     . 00B892 5020 A420
                                                             SPACE
* CNVTA2 AEQLC XCL,DESCR,,CNVTA6                                E3.2.3
*      DECRA   XCL,2*DESCR         Count down
*      BRANCH  CNVTA1              Process next item
                                                             SPACE
CNVTA2   CR    8,1                       . 00B896 1981
         BE    CNVTA6                    . 00B898 4780 B52C
         SR    1,8                       . 00B89C 1B18
         SR    1,8                       . 00B89E 1B18
         B     CNVTA1                    . 00B8A0 47F0 B4F8
                                                             SPACE
* CNVTA6 GETD  YPTR,YPTR,ZCL                                    E3.2.3
*      AEQLC   YPTR,1,CNVTA7                                    E3.2.3
                                                             SPACE
CNVTA6   L     1,ZCL                     . 00B8A4 5810 A438
         L     2,YPTR                    . 00B8A8 5820 A428
         LD    0,0(1,2)                  . 00B8AC 6801 2000
         STD   0,YPTR                    . 00B8B0 6000 A428
         LA    1,1                       . 00B8B4 4110 0001
         C     1,YPTR                    . 00B8B8 5910 A428
         BNE   CNVTA7                    . 00B8BC 4770 B4D8
                                                             SPACE
* CNVTA4 AEQLC YCL,0,,FAIL         Fail on empty table
*      MOVD    WPTR,ZPTR                                        E3.2.3
*      MULTC   XCL,YCL,2*DESCR     Convert count to address units
*      INTSPC  YSP,YCL             Get prototype for size
*      SETLC   PROTSP,0            Clear specifier
*      APDSP   PROTSP,YSP          Append length
*      APDSP   PROTSP,CMASP        Append comma
*      MOVD    WCL,ZEROCL                                       E3.1.1
*      SETAC   WCL,2               Set up 2 for second dimension
*      INTSPC  XSP,WCL             Convert to string
*      APDSP   PROTSP,XSP          Append 2
*      SETSP   XSP,PROTSP          Move specifier
*      RCALL   TPTR,GENVAR,XSPPTR  Generate variable for protot E3.5.2
*      MOVD    ZCL,XCL             Save size
*      INCRA   XCL,4*DESCR         Increment for heading
*      RCALL   ZPTR,BLOCK,XCL      Get block for array
*      SETVC   ZPTR,A              Insert ARRAY data type
*      MOVD    ATPRCL,TPTR                                      E3.5.2
*      SETVA   ATEXCL,YCL          Insert First dimension in head
*      MOVBLK  ZPTR,ATRHD,FRDSCL   Copy heading information
*      MOVD    YPTR,ZPTR           Save copy of block pointer
*      MULTC   YCL,YCL,DESCR       Convert item count to address units
*      INCRA   YPTR,5*DESCR        Skip heading
*      SUM     TPTR,YPTR,YCL       Compute second half position
                                                             SPACE
CNVTA4   C     0,YCL                     . 00B8C0 5900 A420
         BE    FAIL                      . 00B8C4 4780 9010
         MVC   WPTR(8),ZPTR              . 00B8C8 D207 A400 A440
         LA    15,16                     . 00B8CE 41F0 0010
         M     14,YCL                    . 00B8D2 5CE0 A420
         STM   15,0,XCL                  . 00B8D6 90F0 A408
         L     15,@@BDSPEC               . 00B8DA 58F0 A874
         LA    1,YSP                     . 00B8DE 4110 A5E0
         LA    2,YCL                     . 00B8E2 4120 A420
         BALR  14,15                          CALL                     *
                                         . 00B8E6 05EF
         ST    0,PROTSP                  . 00B8E8 5000 A068
         L     15,@@APDSP                . 00B8EC 58F0 A870
         LA    2,PROTSP                  . 00B8F0 4120 A068
         LM    3,5,YSP                   . 00B8F4 9835 A5E0
         BALR  14,15                          CALL                     *
                                         . 00B8F8 05EF
         LA    2,PROTSP                  . 00B8FA 4120 A068
         LM    3,5,CMASP                 . 00B8FE 9835 A0E8
         BALR  14,15                          CALL                     *
                                         . 00B902 05EF
         L     15,@@BDSPEC               . 00B904 58F0 A874
         LA    1,XSP                     . 00B908 4110 A5D0
         LA    2,@@@2                    . 00B90C 4120 AA40
P@2D     BALR  14,15                          CALL                     *
                                         . 00B910 05EF
         L     15,@@APDSP                . 00B912 58F0 A870
         LA    2,PROTSP                  . 00B916 4120 A068
         LM    3,5,XSP                   . 00B91A 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 00B91E 05EF
         MVC   XSP(16),PROTSP            . 00B920 D20F A5D0 A068
         LA    14,S4$0B948               . 00B926 41E0 B5D0
         STM   11,14,104(12)             . 00B92A 90BE C068
         LR    13,12                     . 00B92E 18DC
         MVC   120(8,12),XSPPTR          . 00B930 D207 C078 9F60
         LA    12,24(12)                 . 00B936 41CC 0018
         C     12,@@STACKT               . 00B93A 59C0 A828
         BH    OVER                      . 00B93E 4720 9664
         L     11,@@GENVAR               . 00B942 58B0 A830
         BR    11                        . 00B946 07FB
S4$0B948 STD   0,ATPRCL                  . 00B948 6000 9AB0
         LM    1,2,XCL                   . 00B94C 9812 A408
         STM   1,2,ZCL                   . 00B950 9012 A438
         LA    1,32(1)                   . 00B954 4111 0020
         ST    1,XCL                     . 00B958 5010 A408
         LA    14,S4$0B978               . 00B95C 41E0 B600
         STM   11,14,104(12)             . 00B960 90BE C068
         LR    13,12                     . 00B964 18DC
         STM   1,2,120(12)               . 00B966 9012 C078
         LA    12,24(12)                 . 00B96A 41CC 0018
         BH    OVER                      . 00B96E 4720 9664
         L     11,@@BLOCK                . 00B972 58B0 A82C
         BR    11                        . 00B976 07FB
S4$0B978 STD   0,ZPTR                    . 00B978 6000 A440
         MVC   ZPTR$5(3),@@A             . 00B97C D202 A445 AA6F
         MVC   ATEXCL$5(3),YCL$1         . 00B982 D202 9ACD A421
         L     6,ZPTR                    . 00B988 5860 A440
         L     4,ATRHD                   . 00B98C 5840 9AA8
         AR    4,8                       . 00B990 1A48
         AR    6,8                       . 00B992 1A68
         L     3,FRDSCL                  . 00B994 5830 A690
         L     15,@@MOVTST               . 00B998 58F0 A864
         BALR  14,15                          CALL                     *
                                         . 00B99C 05EF
         LM    1,2,ZPTR                  . 00B99E 9812 A440
         LR    15,8                      . 00B9A2 18F8
         M     14,YCL                    . 00B9A4 5CE0 A420
         STM   15,0,YCL                  . 00B9A8 90F0 A420
         LA    1,40(1)                   . 00B9AC 4111 0028
         STM   1,2,YPTR                  . 00B9B0 9012 A428
         A     1,YCL                     . 00B9B4 5A10 A420
         STM   1,2,TPTR                  . 00B9B8 9012 A3D0
                                                             SPACE
* CNVTA8 GETSIZ WCL,WPTR                                        E3.2.3
*      DECRA   WCL,2*DESCR                                      E3.2.3
*      SUM     WCL,WPTR,WCL                                     E3.2.3
                                                             SPACE
CNVTA8   L     15,WPTR                   . 00B9BC 58F0 A400
         L     15,4(15)                  . 00B9C0 58FF 0004
         LA    15,0(15)                  . 00B9C4 41FF 0000
         SR    15,8                      . 00B9C8 1BF8
         SR    15,8                      . 00B9CA 1BF8
         LM    1,2,WPTR                  . 00B9CC 9812 A400
         AR    1,15                      . 00B9D0 1A1F
         STM   1,2,WCL                   . 00B9D2 9012 A3F8
                                                             SPACE
* CNVTA3 GETDC TCL,WPTR,DESCR                                   E3.2.3
*      DEQL    TCL,NULVCL,,CNVTA5                               E3.2.3
*      PUTDC   TPTR,0,TCL                                       E3.2.3
*      MOVDIC  YPTR,0,WPTR,2*DESCR
*      INCRA   YPTR,DESCR          Increment upper pointer
*      INCRA   TPTR,DESCR          Increment lower pointer
                                                             SPACE
CNVTA3   L     1,WPTR                    . 00B9D6 5810 A400
         MVC   TCL(8),8(1)               . 00B9DA D207 A3D8 1008
         CLC   TCL(8),NULVCL             . 00B9E0 D507 A3D8 9ED0
         BE    CNVTA5                    . 00B9E6 4780 B696
         L     3,TPTR                    . 00B9EA 5830 A3D0
         MVC   0(8,3),TCL                . 00B9EE D207 3000 A3D8
         L     1,YPTR                    . 00B9F4 5810 A428
         L     2,WPTR                    . 00B9F8 5820 A400
         MVC   0(8,1),16(2)              . 00B9FC D207 1000 2010
         AR    1,8                       . 00BA02 1A18
         ST    1,YPTR                    . 00BA04 5010 A428
         AR    3,8                       . 00BA08 1A38
         ST    3,TPTR                    . 00BA0A 5030 A3D0
                                                             SPACE
* CNVTA5 INCRA WPTR,2*DESCR
*      AEQL    WCL,WPTR,CNVTA3                                  E3.2.3
*      GETDC   WPTR,WCL,2*DESCR                                 E3.2.3
*      AEQLC   WPTR,1,CNVTA8                                    E3.8.1
*      SETAC   TPTR,0                                           E3.8.1
*      BRANCH  RTZPTR                                           E3.8.1
                                                             SPACE
CNVTA5   L     1,WPTR                    . 00BA0E 5810 A400
         LA    1,16(1)                   . 00BA12 4111 0010
         ST    1,WPTR                    . 00BA16 5010 A400
         L     2,WCL                     . 00BA1A 5820 A3F8
         CR    2,1                       . 00BA1E 1921
         BNE   CNVTA3                    . 00BA20 4770 B65E
         LM    1,2,16(2)                 . 00BA24 9812 2010
         STM   1,2,WPTR                  . 00BA28 9012 A400
         C     1,@@F1                    . 00BA2C 5910 A940
         BNE   CNVTA8                    . 00BA30 4770 B644
         BE    RTZPTR                    . 00BA34 4780 9074
                                                             SPACE
* CNVAT GETDC  XCL,ZPTR,2*DESCR    Get array dimensionality
*      MOVD    YPTR,ZPTR           Save copy of array pointer
*      AEQLC   XCL,2,FAIL          Verify rectangular array
*      GETDC   XCL,ZPTR,3*DESCR    Get second dimension
*      VEQLC   XCL,2,FAIL          Verify extent of 2
*      GETSIZ  XCL,ZPTR            Get size of array block
*      DECRA   XCL,2*DESCR                                      E3.2.3
*      RCALL   XPTR,BLOCK,XCL      Allocate block for pair list
*      SETVC   XPTR,T                                           E3.2.3
*      GETDC   YCL,ZPTR,4*DESCR                                 E3.2.3
*      MOVD    ZPTR,XPTR                                        E3.2.3
*      PUTD    XPTR,XCL,ONECL                                   E3.2.3
*      DECRA   XCL,DESCR                                        E3.2.3
*      MOVD    TCL,EXTVAL                                       E3.2.3
*      INCRA   TCL,2*DESCR                                      E3.2.3
*      PUTD    XPTR,XCL,TCL                                     E3.2.3
*      SETAV   YCL,YCL                                          E3.2.3
*      MULTC   YCL,YCL,DESCR                                    E3.2.3
*      INCRA   YPTR,5*DESCR                                     E3.2.3
*      SUM     WPTR,YPTR,YCL                                    E3.2.3
                                                             SPACE
CNVAT    L     1,ZPTR                    . 00BA38 5810 A440
         MVC   XCL(8),16(1)              . 00BA3C D207 A408 1010
         MVC   YPTR(8),ZPTR              . 00BA42 D207 A428 A440
         LA    6,2                       . 00BA48 4160 0002
         C     6,XCL                     . 00BA4C 5960 A408
         BNE   FAIL                      . 00BA50 4770 9010
         MVC   XCL(8),24(1)              . 00BA54 D207 A408 1018
         CLC   XCL$5(3),@@B              . 00BA5A D502 A40D AA6C
         BNE   FAIL                      . 00BA60 4770 9010
         L     15,4(1)                   . 00BA64 58F1 0004
         LA    15,0(15)                  . 00BA68 41FF 0000
         SR    15,8                      . 00BA6C 1BF8
         SR    15,8                      . 00BA6E 1BF8
         STM   15,0,XCL                  . 00BA70 90F0 A408
         LA    14,S4$0BA94               . 00BA74 41E0 B71C
         STM   11,14,104(12)             . 00BA78 90BE C068
         LR    13,12                     . 00BA7C 18DC
         STM   15,0,120(12)              . 00BA7E 90F0 C078
         LA    12,24(12)                 . 00BA82 41CC 0018
         C     12,@@STACKT               . 00BA86 59C0 A828
         BH    OVER                      . 00BA8A 4720 9664
         L     11,@@BLOCK                . 00BA8E 58B0 A82C
         BR    11                        . 00BA92 07FB
S4$0BA94 STD   0,XPTR                    . 00BA94 6000 A410
         MVC   XPTR$5(3),@@T             . 00BA98 D202 A415 AA72
         L     1,ZPTR                    . 00BA9E 5810 A440
         MVC   YCL(8),32(1)              . 00BAA2 D207 A420 1020
         MVC   ZPTR(8),XPTR              . 00BAA8 D207 A440 A410
         L     1,XCL                     . 00BAAE 5810 A408
         L     2,XPTR                    . 00BAB2 5820 A410
         LD    0,ONECL                   . 00BAB6 6800 9C68
         STD   0,0(1,2)                  . 00BABA 6001 2000
         SR    1,8                       . 00BABE 1B18
         ST    1,XCL                     . 00BAC0 5010 A408
         LM    1,2,EXTVAL                . 00BAC4 9812 9C20
         LA    1,16(1)                   . 00BAC8 4111 0010
         STM   1,2,TCL                   . 00BACC 9012 A3D8
         L     1,XCL                     . 00BAD0 5810 A408
         L     2,XPTR                    . 00BAD4 5820 A410
         LD    0,TCL                     . 00BAD8 6800 A3D8
         STD   0,0(1,2)                  . 00BADC 6001 2000
         L     15,YCL$4                  . 00BAE0 58F0 A424
         LA    15,0(15)                  . 00BAE4 41FF 0000
         STM   15,0,YCL                  . 00BAE8 90F0 A420
         LR    15,8                      . 00BAEC 18F8
         M     14,YCL                    . 00BAEE 5CE0 A420
         STM   15,0,YCL                  . 00BAF2 90F0 A420
         L     1,YPTR                    . 00BAF6 5810 A428
         LA    1,40(1)                   . 00BAFA 4111 0028
         ST    1,YPTR                    . 00BAFE 5010 A428
         LM    1,2,YPTR                  . 00BB02 9812 A428
         A     1,YCL                     . 00BB06 5A10 A420
         STM   1,2,WPTR                  . 00BB0A 9012 A400
                                                             SPACE
* CNVAT2 MOVDIC XPTR,DESCR,WPTR,0                               E3.2.3
*      MOVDIC  XPTR,2*DESCR,YPTR,0                              E3.2.3
*      DECRA   YCL,DESCR                                        E3.2.3
*      AEQLC   YCL,0,,RTZPTR                                    E3.2.3
*      INCRA   XPTR,2*DESCR        Increment pair list pointer
*      INCRA   WPTR,DESCR          Increment lower array pointer
*      INCRA   YPTR,DESCR          Increment upper array pointer
*      BRANCH  CNVAT2              Continue
CNVAT2   L     1,XPTR                    . 00BB0E 5810 A410
         L     2,WPTR                    . 00BB12 5820 A400
         MVC   8(8,1),0(2)               . 00BB16 D207 1008 2000
         L     2,YPTR                    . 00BB1C 5820 A428
         MVC   16(8,1),0(2)              . 00BB20 D207 1010 2000
         L     1,YCL                     . 00BB26 5810 A420
         SR    1,8                       . 00BB2A 1B18
         ST    1,YCL                     . 00BB2C 5010 A420
         CR    0,1                       . 00BB30 1901
         BE    RTZPTR                    . 00BB32 4780 9074
         L     1,XPTR                    . 00BB36 5810 A410
         LA    1,16(1)                   . 00BB3A 4111 0010
         ST    1,XPTR                    . 00BB3E 5010 A410
         L     1,WPTR                    . 00BB42 5810 A400
         AR    1,8                       . 00BB46 1A18
         ST    1,WPTR                    . 00BB48 5010 A400
         L     1,YPTR                    . 00BB4C 5810 A428
         AR    1,8                       . 00BB50 1A18
         ST    1,YPTR                    . 00BB52 5010 A428
         B     CNVAT2                    . 00BB56 47F0 B796
         B     CNVAT2+2                  . 00BB5A 47F0 B798
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      DATE()
*
                                                             SPACE
* DATE PROC    ,                   DATE()
*      RCALL   ,ARGVAL,,FAIL       Get rid of argument
*      DATE    ZSP                 Get the date
*      BRANCH  GENVRZ              Go generate the variable
         USING DATE,11                   .
DATE     LA    14,S4$0BB7A               . 00BB5E 41E0 B01C
         STM   11,14,104(12)             . 00BB62 90BE C068
         LR    13,12                     . 00BB66 18DC
         LA    12,16(12)                 . 00BB68 41CC 0010
         C     12,@@STACKT               . 00BB6C 59C0 A828
         BH    OVER                      . 00BB70 4720 9664
         L     11,@@ARGVAL               . 00BB74 58B0 A914
         BR    11                        . 00BB78 07FB
S4$0BB7A SR    0,0                       . 00BB7A 1B00
         SR    0,0                       . 00BB7C 1B00
         B     FAIL                      . 00BB7E 47F0 9010
         LA    1,ZSP                     . 00BB82 4110 A5F0
         L     15,@@DATER                . 00BB86 58F0 AA48
         BALR  14,15                          CALL                     *
                                         . 00BB8A 05EF
         B     GENVRZ                    . 00BB8C 47F0 90D2
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      DATATYPE(X)
*
                                                             SPACE
* DT   PROC    ,                   DATATYPE(X)
*      RCALL   A2PTR,ARGVAL,,FAIL  Get object
*      MOVV    DT1CL,A2PTR         Insert data type
*      LOCAPT  A3PTR,DTATL,DT1CL,DTEXTN
*                                  Look for data type
*      GETDC   A3PTR,A3PTR,2*DESCR Get data type name
                                                             SPACE
         USING DT,11                     .
DT       LA    14,S4$0BBAC               . 00BB90 41E0 B01C
         STM   11,14,104(12)             . 00BB94 90BE C068
         LR    13,12                     . 00BB98 18DC
         LA    12,16(12)                 . 00BB9A 41CC 0010
         C     12,@@STACKT               . 00BB9E 59C0 A828
         BH    OVER                      . 00BBA2 4720 9664
         L     11,@@ARGVAL               . 00BBA6 58B0 A914
         BR    11                        . 00BBAA 07FB
S4$0BBAC STD   0,A2PTR                   . 00BBAC 6000 A368
         B     FAIL                      . 00BBB0 47F0 9010
         MVC   DT1CL$5(3),A2PTR$5        . 00BBB4 D202 9E4D A36D
         L     15,DTATL                  . 00BBBA 58F0 A2F0
         L     5,4(15)                   . 00BBBE 585F 0004
         LA    5,0(5,15)                 . 00BBC2 4155 F000
         LR    4,8                       . 00BBC6 1848
         SR    5,4                       . 00BBC8 1B54
         AR    4,8                       . 00BBCA 1A48
S4$0BBCC CLC   8(8,15),DT1CL             . 00BBCC D507 F008 9E48
         BE    S4$0BBDE                  . 00BBD2 4780 B04E
         BXLE  15,4,S4$0BBCC             . 00BBD6 87F4 B03C
         B     DTEXTN                    . 00BBDA 47F0 B06C
S4$0BBDE STM   15,0,A3PTR                . 00BBDE 90F0 A370
         LR    1,15                      . 00BBE2 181F
         LD    0,16(1)                   . 00BBE4 6801 0010
         STD   0,A3PTR                   . 00BBE8 6000 A370
                                                             SPACE
* DTRTN RRTURN A3PTR,3             Return name
                                                             SPACE
DTRTN    LD    0,A3PTR                   . 00BBEC 6800 A370
         LM    11,14,104(13)             . 00BBF0 98BE D068
         EX    0,0(14)                   . 00BBF4 440E 0000
         B     12(14)                    . 00BBF8 47FE 000C
                                                             SPACE
* DTEXTN MOVD  A3PTR,EXTPTR        Set up EXTERNAL data type
*      BRANCH  DTRTN               Return
DTEXTN   LD    0,EXTPTR                  . 00BBFC 6800 A528
         STD   0,A3PTR                   . 00BC00 6000 A370
         B     DTRTN                     . 00BC04 47F0 B05C
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      DUMP(N)
*
                                                             SPACE
* DMP  PROC    ,                   DUMP(N)
*      RCALL   XPTR,INTVAL,,FAIL   Evaluate argument
*      AEQLC   XPTR,0,,RETNUL      No dump if zero
                                                             SPACE
         USING DMP,11                    .
DMP      LA    14,S4$0BC24               . 00BC08 41E0 B01C
         STM   11,14,104(12)             . 00BC0C 90BE C068
         LR    13,12                     . 00BC10 18DC
         LA    12,16(12)                 . 00BC12 41CC 0010
         C     12,@@STACKT               . 00BC16 59C0 A828
         BH    OVER                      . 00BC1A 4720 9664
         L     11,@@INTVAL               . 00BC1E 58B0 A9E8
         BR    11                        . 00BC22 07FB
S4$0BC24 STD   0,XPTR                    . 00BC24 6000 A410
         B     FAIL                      . 00BC28 47F0 9010
         C     0,XPTR                    . 00BC2C 5900 A410
         BE    RETNUL                    . 00BC30 4780 9018
                                                             SPACE
* DUMP PROC    DMP                 End game dump procedure
*      SETAC   WPTR,OBLIST-DESCR   Initialize bin list pointer
                                                             SPACE
DUMP     L     11,@@DMP                  . 00BC34 58B0 AA4C
         L     1,@@OBLOCK                . 00BC38 5810 A898
         ST    1,WPTR                    . 00BC3C 5010 A400
                                                             SPACE
* DMPB ACOMP   WPTR,OBEND,RETNUL   Check for end
*      INCRA   WPTR,DESCR          Increment pointer
*      MOVD    YPTR,WPTR           Save working copy
                                                             SPACE
DMPB     LM    1,2,WPTR                  . 00BC40 9812 A400
         C     1,OBEND                   . 00BC44 5910 9C58
         BH    RETNUL                    . 00BC48 4720 9018
         AR    1,8                       . 00BC4C 1A18
         ST    1,WPTR                    . 00BC4E 5010 A400
         STM   1,2,YPTR                  . 00BC52 9012 A428
                                                             SPACE
* DMPA GETAC   YPTR,YPTR,LNKFLD    Get string structure
*      AEQLC   YPTR,0,,DMPB        Check for end of chain
*      GETDC   XPTR,YPTR,DESCR     Get value
*      DEQL    XPTR,NULVCL,,DMPA   Skip null string values
*      SETLC   DMPSP,0             Clear specifier
*      LOCSP   YSP,YPTR            Get specifier for variable
*      GETLG   YCL,YSP             Get length
*      ACOMPC  YCL,BUFLEN,DMPOVR,DMPOVR
*                                  Check for excessive length
*      APDSP   DMPSP,YSP           Append variable
*      APDSP   DMPSP,BLEQSP        Append ' = '
*      VEQLC   XPTR,S,,DMPV        STRING is alright
*      VEQLC   XPTR,I,,DMPI        Convert INTEGER
*      RCALL   A1PTR,DTREP,XPTR    Else get representation
*      GETSPC  YSP,A1PTR,0         Get specifier
                                                             SPACE
DMPA     L     1,YPTR                    . 00BC56 5810 A428
         L     1,24(1)                   . 00BC5A 5811 0018
         ST    1,YPTR                    . 00BC5E 5010 A428
         CR    0,1                       . 00BC62 1901
         BE    DMPB                      . 00BC64 4780 B038
         LD    0,8(1)                    . 00BC68 6801 0008
         STD   0,XPTR                    . 00BC6C 6000 A410
         CLC   XPTR(8),NULVCL            . 00BC70 D507 A410 9ED0
         BE    DMPA                      . 00BC76 4780 B04E
         ST    0,DMPSP                   . 00BC7A 5000 A048
         LM    3,4,YPTR                  . 00BC7E 9834 A428
         CR    0,3                       . 00BC82 1903
         BNE   S4$0BC90                  . 00BC84 4770 B088
         ST    0,YSP                     . 00BC88 5000 A5E0
         B     S4$0BCA0                  . 00BC8C 47F0 B098
S4$0BC90 L     1,4(3)                    . 00BC90 5813 0004
         LA    1,0(1)                    . 00BC94 4111 0000
         LA    2,32                      . 00BC98 4120 0020
         STM   1,4,YSP                   . 00BC9C 9014 A5E0
S4$0BCA0 L     15,YSP                    . 00BCA0 58F0 A5E0
         STM   15,0,YCL                  . 00BCA4 90F0 A420
         LA    1,1544                    . 00BCA8 4110 0608
         CR    1,15                      . 00BCAC 191F
         BNH   DMPOVR                    . 00BCAE 47D0 B1C0
         L     15,@@APDSP                . 00BCB2 58F0 A870
         LA    2,DMPSP                   . 00BCB6 4120 A048
         LM    3,5,YSP                   . 00BCBA 9835 A5E0
         BALR  14,15                          CALL                     *
                                         . 00BCBE 05EF
         LA    2,DMPSP                   . 00BCC0 4120 A048
         LM    3,5,BLEQSP                . 00BCC4 9835 A0D8
         BALR  14,15                          CALL                     *
                                         . 00BCC8 05EF
         CLC   XPTR$5(3),@@S             . 00BCCA D502 A415 AA7B
         BE    S4$0BD40                  . 00BCD0 4780 B138
         CLC   XPTR$5(3),@@I             . 00BCD4 D502 A415 AA84
         BE    DMPI                      . 00BCDA 4780 B1AE
         LA    14,S4$0BD02               . 00BCDE 41E0 B0FA
         STM   11,14,104(12)             . 00BCE2 90BE C068
         LR    13,12                     . 00BCE6 18DC
         LD    0,XPTR                    . 00BCE8 6800 A410
         STD   0,120(12)                 . 00BCEC 600C 0078
         LA    12,24(12)                 . 00BCF0 41CC 0018
         C     12,@@STACKT               . 00BCF4 59C0 A828
         BH    OVER                      . 00BCF8 4720 9664
         L     11,@@DTREP                . 00BCFC 58B0 AA00
         BR    11                        . 00BD00 07FB
S4$0BD02 STD   0,A1PTR                   . 00BD02 6000 A360
         L     1,A1PTR                   . 00BD06 5810 A360
         LM    1,4,0(1)                  . 00BD0A 9814 1000
         STM   1,4,YSP                   . 00BD0E 9014 A5E0
                                                             SPACE
* DMPX GETLG   XCL,YSP             Get length
*      SUM     YCL,YCL,XCL         Get total
*      ACOMPC  YCL,BUFLEN,DMPOVR   Check for excessive length
*      APDSP   DMPSP,YSP           Append value
*      BRANCH  DMPRT               Go print it
                                                             SPACE
DMPX     L     15,YSP                    . 00BD12 58F0 A5E0
         STM   15,0,XCL                  . 00BD16 90F0 A408
         L     1,YCL                     . 00BD1A 5810 A420
         AR    1,15                      . 00BD1E 1A1F
         ST    1,YCL                     . 00BD20 5010 A420
         LA    2,1544                    . 00BD24 4120 0608
         CR    2,1                       . 00BD28 1921
         BL    DMPOVR                    . 00BD2A 4740 B1C0
         L     15,@@APDSP                . 00BD2E 58F0 A870
         LA    2,DMPSP                   . 00BD32 4120 A048
         LM    3,5,YSP                   . 00BD36 9835 A5E0
         BALR  14,15                          CALL                     *
                                         . 00BD3A 05EF
         B     DMPRT                     . 00BD3C 47F0 B198
S4$0BD40 LM    3,4,XPTR                  . 00BD40 9834 A410
         CR    0,3                       . 00BD44 1903
         BNE   S4$0BD52                  . 00BD46 4770 B14A
         ST    0,YSP                     . 00BD4A 5000 A5E0
         B     DMPV                      . 00BD4E 47F0 B15A
S4$0BD52 L     1,4(3)                    . 00BD52 5813 0004
         LA    1,0(1)                    . 00BD56 4111 0000
         LA    2,32                      . 00BD5A 4120 0020
         STM   1,4,YSP                   . 00BD5E 9014 A5E0
                                                             SPACE
* DMPV LOCSP   YSP,XPTR            Get specifier
*      GETLG   XCL,YSP             Get length
*      SUM     YCL,YCL,XCL         Total length
*      ACOMPC  YCL,BUFLEN,DMPOVR   Check for excessive length
*      APDSP   DMPSP,QTSP          Append quote
*      APDSP   DMPSP,YSP           Append value
*      APDSP   DMPSP,QTSP          Append quote
                                                             SPACE
DMPV     L     15,YSP                    . 00BD62 58F0 A5E0
         STM   15,0,XCL                  . 00BD66 90F0 A408
         L     1,YCL                     . 00BD6A 5810 A420
         AR    1,15                      . 00BD6E 1A1F
         ST    1,YCL                     . 00BD70 5010 A420
         LA    2,1544                    . 00BD74 4120 0608
         CR    2,1                       . 00BD78 1921
         BL    DMPOVR                    . 00BD7A 4740 B1C0
         L     15,@@APDSP                . 00BD7E 58F0 A870
         LA    2,DMPSP                   . 00BD82 4120 A048
         LM    3,5,QTSP                  . 00BD86 9835 A078
         BALR  14,15                          CALL                     *
                                         . 00BD8A 05EF
         LA    2,DMPSP                   . 00BD8C 4120 A048
         LM    3,5,YSP                   . 00BD90 9835 A5E0
         BALR  14,15                          CALL                     *
                                         . 00BD94 05EF
         LA    2,DMPSP                   . 00BD96 4120 A048
         LM    3,5,QTSP                  . 00BD9A 9835 A078
         BALR  14,15                          CALL                     *
                                         . 00BD9E 05EF
                                                             SPACE
* DMPRT STPRNT IOKEY,OUTBLK,DMPSP  Print line
*      BRANCH  DMPA                Continue
                                                             SPACE
DMPRT    L     15,@@STPRNT               . 00BDA0 58F0 A838
         LA    1,IOKEY                   . 00BDA4 4110 9EA0
         LA    2,OUTBLK                  . 00BDA8 4120 9C70
         LA    3,DMPSP                   . 00BDAC 4130 A048
         BALR  14,15                          CALL                     *
                                         . 00BDB0 05EF
         B     DMPA                      . 00BDB2 47F0 B04E
                                                             SPACE
* DMPI INTSPC  YSP,XPTR            Convert integer
*      BRANCH  DMPX                Rejoin processing
                                                             SPACE
DMPI     L     15,@@BDSPEC               . 00BDB6 58F0 A874
         LA    1,YSP                     . 00BDBA 4110 A5E0
         LA    2,XPTR                    . 00BDBE 4120 A410
         BALR  14,15                          CALL                     *
                                         . 00BDC2 05EF
         B     DMPX                      . 00BDC4 47F0 B10A
                                                             SPACE
* DMPOVR OUTPUT OUTPUT,PRTOVF      Print error message
*      BRANCH  DMPA                Continue
                                                             SPACE
DMPOVR   STM   13,1,AISAVE               . 00BDC8 90D1 A770
         L     13,@@SAVSAV               . 00BDCC 58D0 A810
         L     15,@@IBCOM#               . 00BDD0 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00BDD4 45EF 0004
         DC    X'01'                     . 00BDD8 01
         DC    AL3(OUTPUT)               . 00BDD9 00D068
         DC    X'01'                     . 00BDDC 01
         DC    AL3(PRTOVF)               . 00BDDD 0142AF
         BAL   14,16(15)                      CALL                     *
                                         . 00BDE0 45EF 0010
         LM    13,1,AISAVE               . 00BDE4 98D1 A770
         B     DMPA                      . 00BDE8 47F0 B04E
                                                             SPACE
* DMK  PROC    ,                   Procedure to dump keywords
*      OUTPUT  OUTPUT,PKEYF        Print caption
*      GETSIZ  XCL,KNLIST          Get size of pair list
                                                             SPACE
         USING DMK,11                    .
DMK      STM   13,1,AISAVE               . 00BDEC 90D1 A770
         L     13,@@SAVSAV               . 00BDF0 58D0 A810
         L     15,@@IBCOM#               . 00BDF4 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00BDF8 45EF 0004
         DC    X'01'                     . 00BDFC 01
         DC    AL3(OUTPUT)               . 00BDFD 00D068
         DC    X'01'                     . 00BE00 01
         DC    AL3(PKEYF)                . 00BE01 014291
         BAL   14,16(15)                      CALL                     *
                                         . 00BE04 45EF 0010
         LM    13,1,AISAVE               . 00BE08 98D1 A770
         L     15,KNLIST                 . 00BE0C 58F0 9800
         L     15,4(15)                  . 00BE10 58FF 0004
         LA    15,0(15)                  . 00BE14 41FF 0000
         STM   15,0,XCL                  . 00BE18 90F0 A408
                                                             SPACE
* DMPK1 GETD   XPTR,KNLIST,XCL     Get name of keyword
*      DECRA   XCL,DESCR           Adjust offset
*      GETD    YPTR,KNLIST,XCL     Get value of keyword
*      INTSPC  YSP,YPTR            Convert integer to string
*      LOCSP   XSP,XPTR            Get specifier
*      SETLC   DMPSP,0             Clear specifier
*      APDSP   DMPSP,AMPSP         Append ampersand
*      APDSP   DMPSP,XSP           Append name
*      APDSP   DMPSP,BLEQSP        Append ' = '
*      APDSP   DMPSP,YSP           Append value
*      STPRNT  IOKEY,OUTBLK,DMPSP  Print line
*      DECRA   XCL,DESCR           Adjust offset
*      AEQLC   XCL,0,DMPK1,RTN1    Check for end
DMPK1    L     1,XCL                     . 00BE1C 5810 A408
         L     2,KNLIST                  . 00BE20 5820 9800
         LD    0,0(1,2)                  . 00BE24 6801 2000
         STD   0,XPTR                    . 00BE28 6000 A410
         SR    1,8                       . 00BE2C 1B18
         ST    1,XCL                     . 00BE2E 5010 A408
         L     2,KNLIST                  . 00BE32 5820 9800
         LD    0,0(1,2)                  . 00BE36 6801 2000
         STD   0,YPTR                    . 00BE3A 6000 A428
         L     15,@@BDSPEC               . 00BE3E 58F0 A874
         LA    1,YSP                     . 00BE42 4110 A5E0
         LA    2,YPTR                    . 00BE46 4120 A428
         BALR  14,15                          CALL                     *
                                         . 00BE4A 05EF
         LM    3,4,XPTR                  . 00BE4C 9834 A410
         CR    0,3                       . 00BE50 1903
         BNE   S4$0BE5E                  . 00BE52 4770 B072
         ST    0,XSP                     . 00BE56 5000 A5D0
         B     S4$0BE6E                  . 00BE5A 47F0 B082
S4$0BE5E L     1,4(3)                    . 00BE5E 5813 0004
         LA    1,0(1)                    . 00BE62 4111 0000
         LA    2,32                      . 00BE66 4120 0020
         STM   1,4,XSP                   . 00BE6A 9014 A5D0
S4$0BE6E ST    0,DMPSP                   . 00BE6E 5000 A048
         L     15,@@APDSP                . 00BE72 58F0 A870
         LA    2,DMPSP                   . 00BE76 4120 A048
         LM    3,5,AMPSP                 . 00BE7A 9835 A018
         BALR  14,15                          CALL                     *
                                         . 00BE7E 05EF
         LA    2,DMPSP                   . 00BE80 4120 A048
         LM    3,5,XSP                   . 00BE84 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 00BE88 05EF
         LA    2,DMPSP                   . 00BE8A 4120 A048
         LM    3,5,BLEQSP                . 00BE8E 9835 A0D8
         BALR  14,15                          CALL                     *
                                         . 00BE92 05EF
         LA    2,DMPSP                   . 00BE94 4120 A048
         LM    3,5,YSP                   . 00BE98 9835 A5E0
         BALR  14,15                          CALL                     *
                                         . 00BE9C 05EF
         L     15,@@STPRNT               . 00BE9E 58F0 A838
         LA    1,IOKEY                   . 00BEA2 4110 9EA0
         LA    2,OUTBLK                  . 00BEA6 4120 9C70
         LA    3,DMPSP                   . 00BEAA 4130 A048
         BALR  14,15                          CALL                     *
                                         . 00BEAE 05EF
         L     1,XCL                     . 00BEB0 5810 A408
         SR    1,8                       . 00BEB4 1B18
         ST    1,XCL                     . 00BEB6 5010 A408
         CR    0,1                       . 00BEBA 1901
         BNE   DMPK1                     . 00BEBC 4770 B030
         BE    FAIL                      . 00BEC0 4780 9010
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      DUPL(S,N)
*
                                                             SPACE
* DUPL PROC    ,                   DUPL(S,N)
*      RCALL   XPTR,VARVAL,,FAIL   Get string to duplicate
*      PUSH    XPTR                Save string
*      RCALL   YPTR,INTVAL,,FAIL   Get duplication factor
*      POP     XPTR                Restore string
*      ACOMPC  YPTR,0,,RETNUL,FAIL Return null for 0 duplications
*      LOCSP   XSP,XPTR            Get specifier
*      GETLG   XCL,XSP             Get length
*      MULT    XCL,XCL,YPTR,AERROR                              E3.9.3
*      ACOMP   XCL,MLENCL,INTR8    Check &MAXLNGTH
*      RCALL   ZPTR,CONVAR,XCL     Allocate space for string
*      LOCSP   TSP,ZPTR            Get specifier
*      SETLC   TSP,0               Zero length
                                                             SPACE
         USING DUPL,11                   .
DUPL     LA    14,S4$0BEE0               . 00BEC4 41E0 B01C
         STM   11,14,104(12)             . 00BEC8 90BE C068
         LR    13,12                     . 00BECC 18DC
         LA    12,16(12)                 . 00BECE 41CC 0010
         C     12,@@STACKT               . 00BED2 59C0 A828
         BH    OVER                      . 00BED6 4720 9664
         L     11,@@VARVAL               . 00BEDA 58B0 A9C0
         BR    11                        . 00BEDE 07FB
S4$0BEE0 STD   0,XPTR                    . 00BEE0 6000 A410
         B     FAIL                      . 00BEE4 47F0 9010
         LD    0,XPTR                    . 00BEE8 6800 A410
         STD   0,104(12)                 . 00BEEC 600C 0068
         AR    12,8                      . 00BEF0 1AC8
         C     12,@@STACKT               . 00BEF2 59C0 A828
         BH    OVER                      . 00BEF6 4720 9664
         LA    14,S4$0BF16               . 00BEFA 41E0 B052
         STM   11,14,104(12)             . 00BEFE 90BE C068
         LR    13,12                     . 00BF02 18DC
         LA    12,16(12)                 . 00BF04 41CC 0010
         C     12,@@STACKT               . 00BF08 59C0 A828
         BH    OVER                      . 00BF0C 4720 9664
         L     11,@@INTVAL               . 00BF10 58B0 A9E8
         BR    11                        . 00BF14 07FB
S4$0BF16 STD   0,YPTR                    . 00BF16 6000 A428
         B     FAIL                      . 00BF1A 47F0 9010
         LD    0,96(12)                  . 00BF1E 680C 0060
         STD   0,XPTR                    . 00BF22 6000 A410
         SR    12,8                      . 00BF26 1BC8
         C     0,YPTR                    . 00BF28 5900 A428
         BE    RETNUL                    . 00BF2C 4780 9018
         BH    FAIL                      . 00BF30 4720 9010
         LM    3,4,XPTR                  . 00BF34 9834 A410
         CR    0,3                       . 00BF38 1903
         BNE   S4$0BF46                  . 00BF3A 4770 B082
         ST    0,XSP                     . 00BF3E 5000 A5D0
         B     S4$0BF56                  . 00BF42 47F0 B092
S4$0BF46 L     1,4(3)                    . 00BF46 5813 0004
         LA    1,0(1)                    . 00BF4A 4111 0000
         LA    2,32                      . 00BF4E 4120 0020
         STM   1,4,XSP                   . 00BF52 9014 A5D0
S4$0BF56 L     15,XSP                    . 00BF56 58F0 A5D0
         M     14,YPTR                   . 00BF5A 5CE0 A428
         STM   15,0,XCL                  . 00BF5E 90F0 A408
         C     15,MLENCL                 . 00BF62 59F0 9848
         BH    INTR8                     . 00BF66 4720 9614
         SLDA  14,32                     . 00BF6A 8FE0 0020
         BO    INTR8                     . 00BF6E 4710 9614
         LA    14,S4$0BF96               . 00BF72 41E0 B0D2
         STM   11,14,104(12)             . 00BF76 90BE C068
         LR    13,12                     . 00BF7A 18DC
         LD    0,XCL                     . 00BF7C 6800 A408
         STD   0,120(12)                 . 00BF80 600C 0078
         LA    12,24(12)                 . 00BF84 41CC 0018
         C     12,@@STACKT               . 00BF88 59C0 A828
         BH    OVER                      . 00BF8C 4720 9664
         L     11,@@CONVAR               . 00BF90 58B0 A96C
         BR    11                        . 00BF94 07FB
S4$0BF96 STD   0,ZPTR                    . 00BF96 6000 A440
         LM    3,4,ZPTR                  . 00BF9A 9834 A440
         CR    0,3                       . 00BF9E 1903
         BNE   S4$0BFAC                  . 00BFA0 4770 B0E8
         ST    0,TSP                     . 00BFA4 5000 A5A0
         B     S4$0BFBC                  . 00BFA8 47F0 B0F8
S4$0BFAC L     1,4(3)                    . 00BFAC 5813 0004
         LA    1,0(1)                    . 00BFB0 4111 0000
         LA    2,32                      . 00BFB4 4120 0020
         STM   1,4,TSP                   . 00BFB8 9014 A5A0
S4$0BFBC ST    0,TSP                     . 00BFBC 5000 A5A0
                                                             SPACE
* DUPL1 APDSP  TSP,XSP             Append a copy
*      DECRA   YPTR,1              Count down
*      AEQLC   YPTR,0,DUPL1,GENVSZ Check for end
DUPL1    L     15,@@APDSP                . 00BFC0 58F0 A870
         LA    2,TSP                     . 00BFC4 4120 A5A0
         LM    3,5,XSP                   . 00BFC8 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 00BFCC 05EF
         L     1,YPTR                    . 00BFCE 5810 A428
         BCTR  1,0                            DECREMENT                *
                                         . 00BFD2 0610
         ST    1,YPTR                    . 00BFD4 5010 A428
         CR    0,1                       . 00BFD8 1901
         BNE   DUPL1                     . 00BFDA 4770 B0FC
         BE    GENVSZ                    . 00BFDE 4780 90A6
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      OPSYN(F1,F2,N)
*
                                                             SPACE
* OPSYN PROC   ,                   OPSYN(F,G,N)
*      RCALL   XPTR,VARVAL,,FAIL   Get object function
*      PUSH    XPTR                Save object function
*      RCALL   YPTR,VARVAL,,FAIL   Get image function
*      PUSH    YPTR                Save image function
*      RCALL   ZPTR,INTVAL,,FAIL   Get type indicator
*      POP     (YPTR,XPTR)         Restore image and object functions
*      AEQLC   XPTR,0,,NONAME      Object may not be null
*      AEQLC   ZPTR,1,,UNYOP       Check for unary definition
*      AEQLC   ZPTR,2,,BNYOP       Check for binary definition
*      AEQLC   ZPTR,0,INTR30       Check for function definition
*      RCALL   XPTR,FINDEX,XPTR    Get function descriptor for object
                                                             SPACE
         USING OPSYN,11                  .
OPSYN    LA    14,S4$0BFFE               . 00BFE2 41E0 B01C
         STM   11,14,104(12)             . 00BFE6 90BE C068
         LR    13,12                     . 00BFEA 18DC
         LA    12,16(12)                 . 00BFEC 41CC 0010
         C     12,@@STACKT               . 00BFF0 59C0 A828
         BH    OVER                      . 00BFF4 4720 9664
         L     11,@@VARVAL               . 00BFF8 58B0 A9C0
         BR    11                        . 00BFFC 07FB
S4$0BFFE STD   0,XPTR                    . 00BFFE 6000 A410
         B     FAIL                      . 00C002 47F0 9010
         LD    0,XPTR                    . 00C006 6800 A410
         STD   0,104(12)                 . 00C00A 600C 0068
         AR    12,8                      . 00C00E 1AC8
         C     12,@@STACKT               . 00C010 59C0 A828
         BH    OVER                      . 00C014 4720 9664
         LA    14,S4$0C034               . 00C018 41E0 B052
         STM   11,14,104(12)             . 00C01C 90BE C068
         LR    13,12                     . 00C020 18DC
         LA    12,16(12)                 . 00C022 41CC 0010
         C     12,@@STACKT               . 00C026 59C0 A828
         BH    OVER                      . 00C02A 4720 9664
         L     11,@@VARVAL               . 00C02E 58B0 A9C0
         BR    11                        . 00C032 07FB
S4$0C034 STD   0,YPTR                    . 00C034 6000 A428
         B     FAIL                      . 00C038 47F0 9010
         LD    0,YPTR                    . 00C03C 6800 A428
         STD   0,104(12)                 . 00C040 600C 0068
         AR    12,8                      . 00C044 1AC8
         C     12,@@STACKT               . 00C046 59C0 A828
         BH    OVER                      . 00C04A 4720 9664
         LA    14,S4$0C06A               . 00C04E 41E0 B088
         STM   11,14,104(12)             . 00C052 90BE C068
         LR    13,12                     . 00C056 18DC
         LA    12,16(12)                 . 00C058 41CC 0010
         C     12,@@STACKT               . 00C05C 59C0 A828
         BH    OVER                      . 00C060 4720 9664
         L     11,@@INTVAL               . 00C064 58B0 A9E8
         BR    11                        . 00C068 07FB
S4$0C06A STD   0,ZPTR                    . 00C06A 6000 A440
         B     FAIL                      . 00C06E 47F0 9010
         LD    0,96(12)                  . 00C072 680C 0060
         STD   0,YPTR                    . 00C076 6000 A428
         LD    0,88(12)                  . 00C07A 680C 0058
         STD   0,XPTR                    . 00C07E 6000 A410
         SR    12,8                      . 00C082 1BC8
         SR    12,8                      . 00C084 1BC8
         C     0,XPTR                    . 00C086 5900 A410
         BE    NONAME                    . 00C08A 4780 9654
         LA    6,1                       . 00C08E 4160 0001
         C     6,ZPTR                    . 00C092 5960 A440
         BE    UNYOP                     . 00C096 4780 B138
         LA    6,2                       . 00C09A 4160 0002
         C     6,ZPTR                    . 00C09E 5960 A440
         BE    BNYOP                     . 00C0A2 4780 B244
         C     0,ZPTR                    . 00C0A6 5900 A440
         BNE   INTR30                    . 00C0AA 4770 9624
         LA    14,S4$0C0CE               . 00C0AE 41E0 B0EC
         STM   11,14,104(12)             . 00C0B2 90BE C068
         LR    13,12                     . 00C0B6 18DC
         STD   0,120(12)                 . 00C0B8 600C 0078
         LA    12,24(12)                 . 00C0BC 41CC 0018
         C     12,@@STACKT               . 00C0C0 59C0 A828
         BH    OVER                      . 00C0C4 4720 9664
         L     11,@@FINDEX               . 00C0C8 58B0 A8F4
         BR    11                        . 00C0CC 07FB
S4$0C0CE STD   0,XPTR                    . 00C0CE 6000 A410
                                                             SPACE
* UNBF RCALL   YPTR,FINDEX,YPTR                                 E3.6.2
                                                             SPACE
UNBF     L     15,FNCPL                  . 00C0D2 58F0 A2F8
         L     5,4(15)                   . 00C0D6 585F 0004
         LA    5,0(5,15)                 . 00C0DA 4155 F000
         LR    4,8                       . 00C0DE 1848
         SR    5,4                       . 00C0E0 1B54
         AR    4,8                       . 00C0E2 1A48
S4$0C0E4 CLC   16(8,15),YPTR             . 00C0E4 D507 F010 A428
         BE    S4$0C0F6                  . 00C0EA 4780 B114
         BXLE  15,4,S4$0C0E4             . 00C0EE 87F4 B102
         B     RETNUL                    . 00C0F2 47F0 9018
S4$0C0F6 LD    0,8(15)                   . 00C0F6 680F 0008
         STD   0,YPTR                    . 00C0FA 6000 A428
                                                             SPACE
* OPPD MOVDIC  XPTR,0,YPTR,0       Move procedure descriptor pair
*      MOVDIC  XPTR,DESCR,YPTR,DESCR
*      BRANCH  RETNUL
                                                             SPACE
OPPD     L     1,XPTR                    . 00C0FE 5810 A410
         L     2,YPTR                    . 00C102 5820 A428
         LD    0,0(2)                    . 00C106 6802 0000
         STD   0,0(1)                    . 00C10A 6001 0000
         LD    0,8(2)                    . 00C10E 6802 0008
         STD   0,8(1)                    . 00C112 6001 0008
         B     RETNUL                    . 00C116 47F0 9018
                                                             SPACE
* UNYOP LOCSP  XSP,XPTR            Get specifier for image
*      LEQLC   XSP,1,UNAF          Length must be 1 for operator
*      SETSP   ZSP,PROTSP                                       E3.5.3
*      SETLC   ZSP,0                                            E3.5.3
*      APDSP   ZSP,XSP                                          E3.5.3
*      APDSP   ZSP,LPRNSP                                       E3.5.3
*      STREAM  TSP,ZSP,UNOPTB,UNAF,UNAF                         E3.5.3
*      MOVD    XPTR,STYPE          STYPE has function descriptor
                                                             SPACE
UNYOP    LM    3,4,XPTR                  . 00C11A 9834 A410
         CR    0,3                       . 00C11E 1903
         BNE   S4$0C12C                  . 00C120 4770 B14A
         ST    0,XSP                     . 00C124 5000 A5D0
         B     S4$0C13C                  . 00C128 47F0 B15A
S4$0C12C L     1,4(3)                    . 00C12C 5813 0004
         LA    1,0(1)                    . 00C130 4111 0000
         LA    2,32                      . 00C134 4120 0020
         STM   1,4,XSP                   . 00C138 9014 A5D0
S4$0C13C LA    6,1                       . 00C13C 4160 0001
         C     6,XSP                     . 00C140 5960 A5D0
         BNE   UNAF                      . 00C144 4770 B218
         ST    0,PROTSP                  . 00C148 5000 A068
         L     15,@@APDSP                . 00C14C 58F0 A870
         LA    2,PROTSP                  . 00C150 4120 A068
         LM    3,5,XSP                   . 00C154 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 00C158 05EF
         L     15,@@APDSP                . 00C15A 58F0 A870
         LA    2,PROTSP                  . 00C15E 4120 A068
         LM    3,5,LPRNSP                . 00C162 9835 A158
         BALR  14,15                          CALL                     *
                                         . 00C166 05EF
         L     15,@@STREAM               . 00C168 58F0 A840
         LA    1,TSP                     . 00C16C 4110 A5A0
         LA    2,PROTSP                  . 00C170 4120 A068
         L     3,@@UNOPTB                . 00C174 5830 A910
         BALR  14,15                          CALL                     *
                                         . 00C178 05EF
         B     UNAF                      . 00C17A 47F0 B218
         B     UNAF                      . 00C17E 47F0 B218
         LD    0,STYPE                   . 00C182 6800 9F08
         STD   0,XPTR                    . 00C186 6000 A410
                                                             SPACE
* UNCF LOCSP   YSP,YPTR            Get specifier for image
*      LEQLC   YSP,1,UNBF          Length must be 1 for operator
*      SETSP   ZSP,PROTSP                                       E3.5.3
*      SETLC   ZSP,0                                            E3.5.3
*      APDSP   ZSP,YSP                                          E3.5.3
*      APDSP   ZSP,LPRNSP                                       E3.5.3
*      STREAM  TSP,ZSP,UNOPTB,UNBF,UNBF                         E3.5.3
*      MOVD    YPTR,STYPE          STYPE has function descriptor
*      BRANCH  OPPD                Join to copy descriptors
                                                             SPACE
UNCF     LM    3,4,YPTR                  . 00C18A 9834 A428
         CR    0,3                       . 00C18E 1903
         BNE   S4$0C19C                  . 00C190 4770 B1BA
         ST    0,YSP                     . 00C194 5000 A5E0
         B     S4$0C1AC                  . 00C198 47F0 B1CA
S4$0C19C L     1,4(3)                    . 00C19C 5813 0004
         LA    1,0(1)                    . 00C1A0 4111 0000
         LA    2,32                      . 00C1A4 4120 0020
         STM   1,4,YSP                   . 00C1A8 9014 A5E0
S4$0C1AC LA    6,1                       . 00C1AC 4160 0001
         C     6,YSP                     . 00C1B0 5960 A5E0
         BNE   UNBF                      . 00C1B4 4770 B0F0
         ST    0,PROTSP                  . 00C1B8 5000 A068
         L     15,@@APDSP                . 00C1BC 58F0 A870
         LA    2,PROTSP                  . 00C1C0 4120 A068
         LM    3,5,YSP                   . 00C1C4 9835 A5E0
         BALR  14,15                          CALL                     *
                                         . 00C1C8 05EF
         LA    2,PROTSP                  . 00C1CA 4120 A068
         LM    3,5,LPRNSP                . 00C1CE 9835 A158
         BALR  14,15                          CALL                     *
                                         . 00C1D2 05EF
         L     15,@@STREAM               . 00C1D4 58F0 A840
         LA    1,TSP                     . 00C1D8 4110 A5A0
         LA    2,PROTSP                  . 00C1DC 4120 A068
         L     3,@@UNOPTB                . 00C1E0 5830 A910
         BALR  14,15                          CALL                     *
                                         . 00C1E4 05EF
         B     UNBF                      . 00C1E6 47F0 B0F0
         B     UNBF                      . 00C1EA 47F0 B0F0
         LD    0,STYPE                   . 00C1EE 6800 9F08
         STD   0,YPTR                    . 00C1F2 6000 A428
         B     OPPD                      . 00C1F6 47F0 B11C
                                                             SPACE
* UNAF RCALL   XPTR,FINDEX,XPTR    Find definition of image
*      BRANCH  UNCF                Join search for object
                                                             SPACE
UNAF     LA    14,S4$0C21E               . 00C1FA 41E0 B23C
         STM   11,14,104(12)             . 00C1FE 90BE C068
         LR    13,12                     . 00C202 18DC
         LD    0,XPTR                    . 00C204 6800 A410
         STD   0,120(12)                 . 00C208 600C 0078
         LA    12,24(12)                 . 00C20C 41CC 0018
         C     12,@@STACKT               . 00C210 59C0 A828
         BH    OVER                      . 00C214 4720 9664
         L     11,@@FINDEX               . 00C218 58B0 A8F4
         BR    11                        . 00C21C 07FB
S4$0C21E STD   0,XPTR                    . 00C21E 6000 A410
         B     UNCF                      . 00C222 47F0 B1A8
                                                             SPACE
* BNYOP LOCSP  XSP,XPTR            Get specifier for image
*      LCOMP   XSP,EQLSP,BNAF      Length must be 2 or less
*      SETSP   ZSP,PROTSP                                       E3.5.3
*      SETLC   ZSP,0                                            E3.5.3
*      APDSP   ZSP,XSP                                          E3.5.3
*      APDSP   ZSP,BLSP                                         E3.5.3
*      STREAM  TSP,ZSP,BIOPTB,BNAF,BNAF                         E3.5.3
*      LEQLC   ZSP,0,BNAF                                       E3.5.3
*      MOVD    XPTR,STYPE          STYPE has function descriptor
                                                             SPACE
BNYOP    LM    3,4,XPTR                  . 00C226 9834 A410
         CR    0,3                       . 00C22A 1903
         BNE   S4$0C238                  . 00C22C 4770 B256
         ST    0,XSP                     . 00C230 5000 A5D0
         B     S4$0C248                  . 00C234 47F0 B266
S4$0C238 L     1,4(3)                    . 00C238 5813 0004
         LA    1,0(1)                    . 00C23C 4111 0000
         LA    2,32                      . 00C240 4120 0020
         STM   1,4,XSP                   . 00C244 9014 A5D0
S4$0C248 L     1,XSP                     . 00C248 5810 A5D0
         C     1,EQLSP                   . 00C24C 5910 A108
         BH    BNAF                      . 00C250 4720 B330
         ST    0,PROTSP                  . 00C254 5000 A068
         L     15,@@APDSP                . 00C258 58F0 A870
         LA    2,PROTSP                  . 00C25C 4120 A068
         LM    3,5,XSP                   . 00C260 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 00C264 05EF
         LA    2,PROTSP                  . 00C266 4120 A068
         LM    3,5,BLSP                  . 00C26A 9835 A0C8
         BALR  14,15                          CALL                     *
                                         . 00C26E 05EF
         L     15,@@STREAM               . 00C270 58F0 A840
         LA    1,TSP                     . 00C274 4110 A5A0
         LA    2,PROTSP                  . 00C278 4120 A068
         L     3,@@BIOPTB                . 00C27C 5830 A8A4
         BALR  14,15                          CALL                     *
                                         . 00C280 05EF
         B     BNAF                      . 00C282 47F0 B330
         B     BNAF                      . 00C286 47F0 B330
         C     0,PROTSP                  . 00C28A 5900 A068
         BNE   BNAF                      . 00C28E 4770 B330
         LD    0,STYPE                   . 00C292 6800 9F08
         STD   0,XPTR                    . 00C296 6000 A410
                                                             SPACE
* BNCF LOCSP   YSP,YPTR            Get specifier for object
*      LCOMP   YSP,EQLSP,BNBF      Length must be 2 or less
*      SETSP   ZSP,PROTSP                                       E3.5.3
*      SETLC   ZSP,0                                            E3.5.3
*      APDSP   ZSP,YSP                                          E3.5.3
*      APDSP   ZSP,BLSP                                         E3.5.3
*      STREAM  TSP,ZSP,BIOPTB,BNBF,BNBF                         E3.5.3
*      LEQLC   ZSP,0,BNBF                                       E3.5.3
*      MOVD    YPTR,STYPE          STYPE has function descriptor
*      BRANCH  OPPD                Join to copy descriptors
                                                             SPACE
BNCF     LM    3,4,YPTR                  . 00C29A 9834 A428
         CR    0,3                       . 00C29E 1903
         BNE   S4$0C2AC                  . 00C2A0 4770 B2CA
         ST    0,YSP                     . 00C2A4 5000 A5E0
         B     S4$0C2BC                  . 00C2A8 47F0 B2DA
S4$0C2AC L     1,4(3)                    . 00C2AC 5813 0004
         LA    1,0(1)                    . 00C2B0 4111 0000
         LA    2,32                      . 00C2B4 4120 0020
         STM   1,4,YSP                   . 00C2B8 9014 A5E0
S4$0C2BC L     1,YSP                     . 00C2BC 5810 A5E0
         C     1,EQLSP                   . 00C2C0 5910 A108
         BH    BNBF                      . 00C2C4 4720 B384
         ST    0,PROTSP                  . 00C2C8 5000 A068
         L     15,@@APDSP                . 00C2CC 58F0 A870
         LA    2,PROTSP                  . 00C2D0 4120 A068
         LM    3,5,YSP                   . 00C2D4 9835 A5E0
         BALR  14,15                          CALL                     *
                                         . 00C2D8 05EF
         LA    2,PROTSP                  . 00C2DA 4120 A068
         LM    3,5,BLSP                  . 00C2DE 9835 A0C8
         BALR  14,15                          CALL                     *
                                         . 00C2E2 05EF
         L     15,@@STREAM               . 00C2E4 58F0 A840
         LA    1,TSP                     . 00C2E8 4110 A5A0
         LA    2,PROTSP                  . 00C2EC 4120 A068
         L     3,@@BIOPTB                . 00C2F0 5830 A8A4
         BALR  14,15                          CALL                     *
                                         . 00C2F4 05EF
         B     BNBF                      . 00C2F6 47F0 B384
         B     BNBF                      . 00C2FA 47F0 B384
         C     0,PROTSP                  . 00C2FE 5900 A068
         BNE   BNBF                      . 00C302 4770 B384
         LD    0,STYPE                   . 00C306 6800 9F08
         STD   0,YPTR                    . 00C30A 6000 A428
         B     OPPD                      . 00C30E 47F0 B11C
                                                             SPACE
* BNAF LEXCMP  XSP,BLSP,,BNCN      Check for concatenation
*      RCALL   XPTR,FINDEX,XPTR    Find definition of image
*      BRANCH  BNCF                Join search for object
                                                             SPACE
BNAF     LM    2,4,XSP                   . 00C312 9824 A5D0
         LM    5,7,BLSP                  . 00C316 9857 A0C8
         CR    2,5                       . 00C31A 1925
         BNE   S4$0C32E                  . 00C31C 4770 B34C
         L     15,@@SPECEQ               . 00C320 58F0 A890
         BALR  14,15                          CALL                     *
                                         . 00C324 05EF
         B     S4$0C32E                  . 00C326 47F0 B34C
         B     BNCN                      . 00C32A 47F0 B378
S4$0C32E LA    14,S4$0C352               . 00C32E 41E0 B370
         STM   11,14,104(12)             . 00C332 90BE C068
         LR    13,12                     . 00C336 18DC
         LD    0,XPTR                    . 00C338 6800 A410
         STD   0,120(12)                 . 00C33C 600C 0078
         LA    12,24(12)                 . 00C340 41CC 0018
         C     12,@@STACKT               . 00C344 59C0 A828
         BH    OVER                      . 00C348 4720 9664
         L     11,@@FINDEX               . 00C34C 58B0 A8F4
         BR    11                        . 00C350 07FB
S4$0C352 STD   0,XPTR                    . 00C352 6000 A410
         B     BNCF                      . 00C356 47F0 B2B8
                                                             SPACE
* BNCN MOVD    XPTR,CONCL          CONCL represents concatenation
*      BRANCH  BNCF                Join search for object
                                                             SPACE
BNCN     LD    0,CONCL                   . 00C35A 6800 9D00
         STD   0,XPTR                    . 00C35E 6000 A410
         B     BNCF                      . 00C362 47F0 B2B8
                                                             SPACE
* BNBF LEXCMP  YSP,BLSP,UNBF,,UNBF Check for concatenation
*      MOVD    YPTR,CONCL          CONCL represents concatenation
*      BRANCH  OPPD                Join to copy descriptors
BNBF     LM    2,4,YSP                   . 00C366 9824 A5E0
         LM    5,7,BLSP                  . 00C36A 9857 A0C8
         CR    2,5                       . 00C36E 1925
         BNE   UNBF                      . 00C370 4770 B0F0
         L     15,@@SPECEQ               . 00C374 58F0 A890
         BALR  14,15                          CALL                     *
                                         . 00C378 05EF
         B     UNBF                      . 00C37A 47F0 B0F0
         LD    0,CONCL                   . 00C37E 6800 9D00
         STD   0,YPTR                    . 00C382 6000 A428
         B     OPPD                      . 00C386 47F0 B11C
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      REPLACE(S1,S2,S3)
*
                                                             SPACE
* RPLACE PROC  ,                   REPLACE(S1,S2,S3)
*      RCALL   XPTR,VARVAL,,FAIL   Get first argument
*      PUSH    XPTR                Save first argument
*      RCALL   YPTR,VARVAL,,FAIL   Get second argument
*      PUSH    YPTR                Save second argument
*      RCALL   ZPTR,VARVAL,,FAIL   Get third argument
*      POP     (YPTR,XPTR)         Restore first and second
*      AEQLC   XPTR,0,,RTXPTR      Ignore replacement on null
*      LOCSP   YSP,YPTR            Get specifier for second
*      LOCSP   ZSP,ZPTR            Get specifier for third
*      LCOMP   ZSP,YSP,FAIL,,FAIL  Verify same lengths
*      AEQLC   YPTR,0,,FAIL        Ignore null replacement
*      LOCSP   XSP,XPTR            Get specifier for first
*      GETLG   XCL,XSP             Get length
*      RCALL   ZPTR,CONVAR,XCL     Allocate space for result
*      LOCSP   TSP,ZPTR            Get specifier
*      SETLC   TSP,0               Clear specifier
*      APDSP   TSP,XSP             Append first argument
*      RPLACE  TSP,YSP,ZSP         Perform replacement
*      BRANCH  GENVSZ              Got generate variable
         USING RPLACE,11                 .
RPLACE   LA    14,S4$0C3A6               . 00C38A 41E0 B01C
         STM   11,14,104(12)             . 00C38E 90BE C068
         LR    13,12                     . 00C392 18DC
         LA    12,16(12)                 . 00C394 41CC 0010
         C     12,@@STACKT               . 00C398 59C0 A828
         BH    OVER                      . 00C39C 4720 9664
         L     11,@@VARVAL               . 00C3A0 58B0 A9C0
         BR    11                        . 00C3A4 07FB
S4$0C3A6 STD   0,XPTR                    . 00C3A6 6000 A410
         B     FAIL                      . 00C3AA 47F0 9010
         LD    0,XPTR                    . 00C3AE 6800 A410
         STD   0,104(12)                 . 00C3B2 600C 0068
         AR    12,8                      . 00C3B6 1AC8
         C     12,@@STACKT               . 00C3B8 59C0 A828
         BH    OVER                      . 00C3BC 4720 9664
         LA    14,S4$0C3DC               . 00C3C0 41E0 B052
         STM   11,14,104(12)             . 00C3C4 90BE C068
         LR    13,12                     . 00C3C8 18DC
         LA    12,16(12)                 . 00C3CA 41CC 0010
         C     12,@@STACKT               . 00C3CE 59C0 A828
         BH    OVER                      . 00C3D2 4720 9664
         L     11,@@VARVAL               . 00C3D6 58B0 A9C0
         BR    11                        . 00C3DA 07FB
S4$0C3DC STD   0,YPTR                    . 00C3DC 6000 A428
         B     FAIL                      . 00C3E0 47F0 9010
         LD    0,YPTR                    . 00C3E4 6800 A428
         STD   0,104(12)                 . 00C3E8 600C 0068
         AR    12,8                      . 00C3EC 1AC8
         C     12,@@STACKT               . 00C3EE 59C0 A828
         BH    OVER                      . 00C3F2 4720 9664
         LA    14,S4$0C412               . 00C3F6 41E0 B088
         STM   11,14,104(12)             . 00C3FA 90BE C068
         LR    13,12                     . 00C3FE 18DC
         LA    12,16(12)                 . 00C400 41CC 0010
         C     12,@@STACKT               . 00C404 59C0 A828
         BH    OVER                      . 00C408 4720 9664
         L     11,@@VARVAL               . 00C40C 58B0 A9C0
         BR    11                        . 00C410 07FB
S4$0C412 STD   0,ZPTR                    . 00C412 6000 A440
         B     FAIL                      . 00C416 47F0 9010
         LD    0,96(12)                  . 00C41A 680C 0060
         STD   0,YPTR                    . 00C41E 6000 A428
         LD    0,88(12)                  . 00C422 680C 0058
         STD   0,XPTR                    . 00C426 6000 A410
         SR    12,8                      . 00C42A 1BC8
         SR    12,8                      . 00C42C 1BC8
         C     0,XPTR                    . 00C42E 5900 A410
         BE    RTXPTR                    . 00C432 4780 9048
         LM    3,4,YPTR                  . 00C436 9834 A428
         CR    0,3                       . 00C43A 1903
         BNE   S4$0C448                  . 00C43C 4770 B0BE
         ST    0,YSP                     . 00C440 5000 A5E0
         B     S4$0C458                  . 00C444 47F0 B0CE
S4$0C448 L     1,4(3)                    . 00C448 5813 0004
         LA    1,0(1)                    . 00C44C 4111 0000
         LA    2,32                      . 00C450 4120 0020
         STM   1,4,YSP                   . 00C454 9014 A5E0
S4$0C458 LM    3,4,ZPTR                  . 00C458 9834 A440
         CR    0,3                       . 00C45C 1903
         BNE   S4$0C46A                  . 00C45E 4770 B0E0
         ST    0,ZSP                     . 00C462 5000 A5F0
         B     S4$0C47A                  . 00C466 47F0 B0F0
S4$0C46A L     1,4(3)                    . 00C46A 5813 0004
         LA    1,0(1)                    . 00C46E 4111 0000
         LA    2,32                      . 00C472 4120 0020
         STM   1,4,ZSP                   . 00C476 9014 A5F0
S4$0C47A L     1,ZSP                     . 00C47A 5810 A5F0
         C     1,YSP                     . 00C47E 5910 A5E0
         BNE   FAIL                      . 00C482 4770 9010
         C     0,YPTR                    . 00C486 5900 A428
         BE    FAIL                      . 00C48A 4780 9010
         LM    3,4,XPTR                  . 00C48E 9834 A410
         CR    0,3                       . 00C492 1903
         BNE   S4$0C4A0                  . 00C494 4770 B116
         ST    0,XSP                     . 00C498 5000 A5D0
         B     S4$0C4B0                  . 00C49C 47F0 B126
S4$0C4A0 L     1,4(3)                    . 00C4A0 5813 0004
         LA    1,0(1)                    . 00C4A4 4111 0000
         LA    2,32                      . 00C4A8 4120 0020
         STM   1,4,XSP                   . 00C4AC 9014 A5D0
S4$0C4B0 L     15,XSP                    . 00C4B0 58F0 A5D0
         STM   15,0,XCL                  . 00C4B4 90F0 A408
         LA    14,S4$0C4DC               . 00C4B8 41E0 B152
         STM   11,14,104(12)             . 00C4BC 90BE C068
         LR    13,12                     . 00C4C0 18DC
         LD    0,XCL                     . 00C4C2 6800 A408
         STD   0,120(12)                 . 00C4C6 600C 0078
         LA    12,24(12)                 . 00C4CA 41CC 0018
         C     12,@@STACKT               . 00C4CE 59C0 A828
         BH    OVER                      . 00C4D2 4720 9664
         L     11,@@CONVAR               . 00C4D6 58B0 A96C
         BR    11                        . 00C4DA 07FB
S4$0C4DC STD   0,ZPTR                    . 00C4DC 6000 A440
         LM    3,4,ZPTR                  . 00C4E0 9834 A440
         CR    0,3                       . 00C4E4 1903
         BNE   S4$0C4F2                  . 00C4E6 4770 B168
         ST    0,TSP                     . 00C4EA 5000 A5A0
         B     S4$0C502                  . 00C4EE 47F0 B178
S4$0C4F2 L     1,4(3)                    . 00C4F2 5813 0004
         LA    1,0(1)                    . 00C4F6 4111 0000
         LA    2,32                      . 00C4FA 4120 0020
         STM   1,4,TSP                   . 00C4FE 9014 A5A0
S4$0C502 ST    0,TSP                     . 00C502 5000 A5A0
         L     15,@@APDSP                . 00C506 58F0 A870
         LA    2,TSP                     . 00C50A 4120 A5A0
         LM    3,5,XSP                   . 00C50E 9835 A5D0
         BALR  14,15                          CALL                     *
                                         . 00C512 05EF
         L     15,@@RPLCE                . 00C514 58F0 AA50
         LA    1,TSP                     . 00C518 4110 A5A0
         LA    2,YSP                     . 00C51C 4120 A5E0
         LM    3,5,ZSP                   . 00C520 9835 A5F0
         BALR  14,15                          CALL                     *
                                         . 00C524 05EF
         B     GENVSZ                    . 00C526 47F0 90A6
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      SIZE(S)
*
                                                             SPACE
* SIZE PROC    ,                   SIZE(S)
*      RCALL   XPTR,VARVAL,,FAIL   Get argument
*      LOCSP   XSP,XPTR            Get specifier
*      GETLG   ZPTR,XSP            Get length
*      SETVC   ZPTR,I              Insert INTEGER data type
*      BRANCH  RTZPTR              Return length
         USING SIZE,11                   .
SIZE     LA    14,S4$0C546               . 00C52A 41E0 B01C
         STM   11,14,104(12)             . 00C52E 90BE C068
         LR    13,12                     . 00C532 18DC
         LA    12,16(12)                 . 00C534 41CC 0010
         C     12,@@STACKT               . 00C538 59C0 A828
         BH    OVER                      . 00C53C 4720 9664
         L     11,@@VARVAL               . 00C540 58B0 A9C0
         BR    11                        . 00C544 07FB
S4$0C546 STD   0,XPTR                    . 00C546 6000 A410
         B     FAIL                      . 00C54A 47F0 9010
         LM    3,4,XPTR                  . 00C54E 9834 A410
         CR    0,3                       . 00C552 1903
         BNE   S4$0C560                  . 00C554 4770 B036
         ST    0,XSP                     . 00C558 5000 A5D0
         B     S4$0C570                  . 00C55C 47F0 B046
S4$0C560 L     1,4(3)                    . 00C560 5813 0004
         LA    1,0(1)                    . 00C564 4111 0000
         LA    2,32                      . 00C568 4120 0020
         STM   1,4,XSP                   . 00C56C 9014 A5D0
S4$0C570 L     15,XSP                    . 00C570 58F0 A5D0
         STM   15,0,ZPTR                 . 00C574 90F0 A440
         MVC   ZPTR$5(3),@@I             . 00C578 D202 A445 AA84
         B     RTZPTR                    . 00C57E 47F0 9074
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      TIME()
*
                                                             SPACE
* TIME PROC    ,                   TIME()
*      RCALL   ,ARGVAL,,FAIL       Get rid of argument
*      MSTIME  ZPTR                Get elapsed time
*      SUBTRT  ZPTR,ZPTR,ETMCL     Compute time in interpreter
*      SETVC   ZPTR,I              Insert INTEGER data type
*      BRANCH  RTZPTR              Return time
         USING TIME,11                   .
TIME     LA    14,S4$0C59E               . 00C582 41E0 B01C
         STM   11,14,104(12)             . 00C586 90BE C068
         LR    13,12                     . 00C58A 18DC
         LA    12,16(12)                 . 00C58C 41CC 0010
         C     12,@@STACKT               . 00C590 59C0 A828
         BH    OVER                      . 00C594 4720 9664
         L     11,@@ARGVAL               . 00C598 58B0 A914
         BR    11                        . 00C59C 07FB
S4$0C59E SR    0,0                       . 00C59E 1B00
         SR    0,0                       . 00C5A0 1B00
         B     FAIL                      . 00C5A2 47F0 9010
         STM   13,1,AISAVE               . 00C5A6 90D1 A770
         L     13,@@SAVSAV               . 00C5AA 58D0 A810
         SR    1,1                       . 00C5AE 1B11
         SVC   46                             TIMER                    *
                                         . 00C5B0 0A2E
         L     3,MAXTIM                  . 00C5B2 5830 A750
         SR    3,0                       . 00C5B6 1B30
         M     2,@@F26                   . 00C5B8 5C20 A820
         D     2,@@F1000                 . 00C5BC 5D20 A824
         ST    3,ZPTR                    . 00C5C0 5030 A440
         LM    13,1,AISAVE               . 00C5C4 98D1 A770
         ST    0,ZPTR$4                  . 00C5C8 5000 A444
         LR    1,3                       . 00C5CC 1813
         S     1,ETMCL                   . 00C5CE 5B10 9E68
         ST    1,ZPTR                    . 00C5D2 5010 A440
         MVC   ZPTR$5(3),@@I             . 00C5D6 D202 A445 AA84
         B     RTZPTR                    . 00C5DC 47F0 9074
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
*
*      TRIM(S)
*
                                                             SPACE
* TRIM PROC    ,                   TRIM(S)
*      RCALL   XPTR,VARVAL,,FAIL   Get string
*      LOCSP   ZSP,XPTR            Get specifier
*      TRIMSP  ZSP,ZSP             Trim string
*      BRANCH  GENVRZ              Generate new variable
         USING TRIM,11                   .
TRIM     LA    14,S4$0C5FC               . 00C5E0 41E0 B01C
         STM   11,14,104(12)             . 00C5E4 90BE C068
         LR    13,12                     . 00C5E8 18DC
         LA    12,16(12)                 . 00C5EA 41CC 0010
         C     12,@@STACKT               . 00C5EE 59C0 A828
         BH    OVER                      . 00C5F2 4720 9664
         L     11,@@VARVAL               . 00C5F6 58B0 A9C0
         BR    11                        . 00C5FA 07FB
S4$0C5FC STD   0,XPTR                    . 00C5FC 6000 A410
         B     FAIL                      . 00C600 47F0 9010
         LM    3,4,XPTR                  . 00C604 9834 A410
         CR    0,3                       . 00C608 1903
         BNE   S4$0C616                  . 00C60A 4770 B036
         ST    0,ZSP                     . 00C60E 5000 A5F0
         B     S4$0C626                  . 00C612 47F0 B046
S4$0C616 L     1,4(3)                    . 00C616 5813 0004
         LA    1,0(1)                    . 00C61A 4111 0000
         LA    2,32                      . 00C61E 4120 0020
         STM   1,4,ZSP                   . 00C622 9014 A5F0
S4$0C626 LM    1,4,ZSP                   . 00C626 9814 A5F0
         LA    5,0(2,3)                  . 00C62A 4152 3000
         LA    6,0(1,5)                  . 00C62E 4161 5000
S4$0C632 BCTR  6,0                            DECREMENT                *
                                         . 00C632 0660
         CR    6,5                       . 00C634 1965
         BL    S4$0C642                  . 00C636 4740 B062
         CLI   0(6),X'40'                . 00C63A 9540 6000
         BE    S4$0C632                  . 00C63E 4780 B052
S4$0C642 SR    6,5                       . 00C642 1B65
         LA    1,1(6)                    . 00C644 4116 0001
         DROP  11                        .
         STM   1,4,ZSP                   . 00C648 9014 A5F0
         B     GENVRZ                    . 00C64C 47F0 90D2
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Common Code'
* COMMON LHERE ,
*S4$0                                                       SPACE
S4$0     LD    0,NULVCL                  . 00C650 6800 9ED0
         LM    11,14,104(13)             . 00C654 98BE D068
         EX    0,0(14)                   . 00C658 440E 0000
         B     4(14)                     . 00C65C 47FE 0004
* RT1NUL RRTURN NULVCL,1           Return null string by exit 1
                                                             SPACE
*RT1NUL
                                                             SPACE
* RTN1 LHERE   ,
                                                             SPACE
*RTN1
                                                             SPACE
* FAIL RRTURN  ,1                  Return by exit 1
                                                             SPACE
FAIL     LM    11,14,104(13)             . 00C660 98BE D068
         B     4(14)                     . 00C664 47FE 0004
                                                             SPACE
* RETNUL RRTURN NULVCL,3           Return null string by exit 3
                                                             SPACE
RETNUL   LD    0,NULVCL                  . 00C668 6800 9ED0
         LM    11,14,104(13)             . 00C66C 98BE D068
         EX    0,0(14)                   . 00C670 440E 0000
         B     12(14)                    . 00C674 47FE 000C
                                                             SPACE
* RTN2 RRTURN  ,2                  Return by exit 2
                                                             SPACE
RTN2     LM    11,14,104(13)             . 00C678 98BE D068
         B     8(14)                     . 00C67C 47FE 0008
                                                             SPACE
* RTN3 LHERE   ,
*                                                            SPACE
*RTN3
                                                             SPACE
* RTNUL3 RRTURN ,3                 Return by exit 3
                                                             SPACE
RTNUL3   LM    11,14,104(13)             . 00C680 98BE D068
         B     12(14)                    . 00C684 47FE 000C
                                                             SPACE
* RTXNAM RRTURN XPTR,2             Return XPTR by exit 2
                                                             SPACE
RTXNAM   LD    0,XPTR                    . 00C688 6800 A410
         LM    11,14,104(13)             . 00C68C 98BE D068
         EX    0,0(14)                   . 00C690 440E 0000
         B     8(14)                     . 00C694 47FE 0008
                                                             SPACE
* RTXPTR RRTURN XPTR,3             Return XPTR by exit 3
                                                             SPACE
RTXPTR   LD    0,XPTR                    . 00C698 6800 A410
         LM    11,14,104(13)             . 00C69C 98BE D068
         EX    0,0(14)                   . 00C6A0 440E 0000
         B     12(14)                    . 00C6A4 47FE 000C
                                                             SPACE
* RTYPTR RRTURN YPTR,3             Return YPTR by exit 3
                                                             SPACE
RTYPTR   LD    0,YPTR                    . 00C6A8 6800 A428
         LM    11,14,104(13)             . 00C6AC 98BE D068
         EX    0,0(14)                   . 00C6B0 440E 0000
         B     12(14)                    . 00C6B4 47FE 000C
                                                             SPACE
* ARTN INCRA   ARTHCL,1            Increment count of arithmetic
                                                             SPACE
ARTN     L     1,ARTHCL                  . 00C6B8 5810 9B68
         LA    1,1(1)                    . 00C6BC 4111 0001
         ST    1,ARTHCL                  . 00C6C0 5010 9B68
                                                             SPACE
* RTZPTR RRTURN ZPTR,3             Return ZPTR by exit 3
                                                             SPACE
RTZPTR   LD    0,ZPTR                    . 00C6C4 6800 A440
         LM    11,14,104(13)             . 00C6C8 98BE D068
         EX    0,0(14)                   . 00C6CC 440E 0000
         B     12(14)                    . 00C6D0 47FE 000C
                                                             SPACE
* A5RTN RRTURN A5PTR,1             Return A5PTR by exit 1
                                                             SPACE
A5RTN    LD    0,A5PTR                   . 00C6D4 6800 9E08
         LM    11,14,104(13)             . 00C6D8 98BE D068
         EX    0,0(14)                   . 00C6DC 440E 0000
         B     4(14)                     . 00C6E0 47FE 0004
                                                             SPACE
* TSALF BRANCH SALF,SCNR           Branch to SALF in scanner
                                                             SPACE
TSALF    L     11,@@SALF                 . 00C6E4 58B0 A994
         BR    11                        . 00C6E8 07FB
                                                             SPACE
* TSALT BRANCH SALT,SCNR           Branch to SALT in scanner
                                                             SPACE
TSALT    L     11,@@SALT                 . 00C6EA 58B0 A984
         BR    11                        . 00C6EE 07FB
                                                             SPACE
* TSCOK BRANCH SCOK,SCNR           Branch to SCOK in scanner
                                                             SPACE
TSCOK    L     11,@@SCOK                 . 00C6F0 58B0 A97C
         BR    11                        . 00C6F4 07FB
                                                             SPACE
* GENVSZ RCALL ZPTR,GNVARS,XCL,RTZPTR
*                                  Generate variable from storage
                                                             SPACE
GENVSZ   LA    14,S4$0C71A               . 00C6F6 41E0 90CA
         STM   11,14,104(12)             . 00C6FA 90BE C068
         LR    13,12                     . 00C6FE 18DC
         LD    0,XCL                     . 00C700 6800 A408
         STD   0,120(12)                 . 00C704 600C 0078
         LA    12,24(12)                 . 00C708 41CC 0018
         C     12,@@STACKT               . 00C70C 59C0 A828
         BH    OVER                      . 00C710 4720 9664
         L     11,@@GNVARS               . 00C714 58B0 A970
         BR    11                        . 00C718 07FB
S4$0C71A STD   0,ZPTR                    . 00C71A 6000 A440
         B     RTZPTR                    . 00C71E 47F0 9074
                                                             SPACE
* GENVRZ RCALL ZPTR,GENVAR,ZSPPTR,RTZPTR
*                                  Generate variable
                                                             SPACE
GENVRZ   LA    14,S4$0C746               . 00C722 41E0 90F6
         STM   11,14,104(12)             . 00C726 90BE C068
         LR    13,12                     . 00C72A 18DC
         LD    0,ZSPPTR                  . 00C72C 6800 9F70
         STD   0,120(12)                 . 00C730 600C 0078
         LA    12,24(12)                 . 00C734 41CC 0018
         C     12,@@STACKT               . 00C738 59C0 A828
         BH    OVER                      . 00C73C 4720 9664
         L     11,@@GENVAR               . 00C740 58B0 A830
         BR    11                        . 00C744 07FB
S4$0C746 STD   0,ZPTR                    . 00C746 6000 A440
         B     RTZPTR                    . 00C74A 47F0 9074
                                                             SPACE
* GENVIX RCALL XPTR,GNVARI,XPTR,RTXNAM
*                                  Generate variable from integer
GENVIX   LA    14,S4$0C772               . 00C74E 41E0 9122
         STM   11,14,104(12)             . 00C752 90BE C068
         LR    13,12                     . 00C756 18DC
         LD    0,XPTR                    . 00C758 6800 A410
         STD   0,120(12)                 . 00C75C 600C 0078
         LA    12,24(12)                 . 00C760 41CC 0018
         C     12,@@STACKT               . 00C764 59C0 A828
         BH    OVER                      . 00C768 4720 9664
         L     11,@@GNVARI               . 00C76C 58B0 A94C
         BR    11                        . 00C770 07FB
S4$0C772 STD   0,XPTR                    . 00C772 6000 A410
         B     RTXNAM                    . 00C776 47F0 9038
                                                             SPACE
       TITLE   'Termination'
* END  OUTPUT  OUTPUT,NRMEND,(LVLCL)
*                                  End procedure
*      OUTPUT  OUTPUT,LASTSF,(STNOCL)
*                                  Print status
*      BRANCH  FTLEN2              Join termination procedure
                                                             SPACE
END      STM   13,1,AISAVE               . 00C77A 90D1 A770
         L     13,@@SAVSAV               . 00C77E 58D0 A810
         L     15,@@IBCOM#               . 00C782 58F0 A814
         NOPR  0                         . 00C786 0700
         BAL   14,4(15)                       CALL                     *
                                         . 00C788 45EF 0004
         DC    X'01'                     . 00C78C 01
         DC    AL3(OUTPUT)               . 00C78D 00D068
         DC    X'01'                     . 00C790 01
         DC    AL3(NRMEND)               . 00C791 014251
         BAL   14,8(15)                       CALL                     *
                                         . 00C794 45EF 0008
         DC    X'045099C0'               . 00C798 045099C0
         BAL   14,16(15)                      CALL                     *
                                         . 00C79C 45EF 0010
         LM    13,1,AISAVE               . 00C7A0 98D1 A770
         L     13,@@SAVSAV               . 00C7A4 58D0 A810
         L     15,@@IBCOM#               . 00C7A8 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00C7AC 45EF 0004
         DC    X'01'                     . 00C7B0 01
         DC    AL3(OUTPUT)               . 00C7B1 00D068
         DC    X'01'                     . 00C7B4 01
         DC    AL3(LASTSF)               . 00C7B5 01420C
         BAL   14,8(15)                       CALL                     *
                                         . 00C7B8 45EF 0008
         DC    X'04509990'               . 00C7BC 04509990
S4$0C7C0 BAL   14,16(15)                      CALL                     *
                                         . 00C7C0 45EF 0010
         LM    13,1,AISAVE               . 00C7C4 98D1 A770
         B     FTLEN2                    . 00C7C8 47F0 91F0
                                                             SPACE
* FTLEND SETAC FATLCL,1            Error termination
*      OUTPUT  OUTPUT,FTLCF,(ERRTYP,STNOCL,LVLCL)
*      MULTC   YCL,ERRTYP,DESCR    Convert error type to address units
*      GETD    YCL,MSGNO,YCL       Get message pointer
*      GETSPC  TSP,YCL,0           Get message specifier
*      STPRNT  IOKEY,OUTBLK,TSP    Print error message
                                                             SPACE
FTLEND   ST    1,ERRTYP                  . 00C7CC 5010 98E0
         LA    1,1                       . 00C7D0 4110 0001
         ST    1,FATLCL                  . 00C7D4 5010 9E70
         STM   13,1,AISAVE               . 00C7D8 90D1 A770
         L     13,@@SAVSAV               . 00C7DC 58D0 A810
         L     15,@@IBCOM#               . 00C7E0 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00C7E4 45EF 0004
         DC    X'01'                     . 00C7E8 01
         DC    AL3(OUTPUT)               . 00C7E9 00D068
         DC    X'01'                     . 00C7EC 01
         DC    AL3(FTLCF)                . 00C7ED 014196
         BAL   14,8(15)                       CALL                     *
                                         . 00C7F0 45EF 0008
         SPM   5                         . 00C7F4 0450
         DC    X'98E0'                   . 00C7F6 98E0
         BAL   14,8(15)                       CALL                     *
                                         . 00C7F8 45EF 0008
         DC    X'04509990'               . 00C7FC 04509990
         BAL   14,8(15)                       CALL                     *
                                         . 00C800 45EF 0008
         DC    X'045099C0'               . 00C804 045099C0
         BAL   14,16(15)                      CALL                     *
                                         . 00C808 45EF 0010
         LM    13,1,AISAVE               . 00C80C 98D1 A770
         L     15,ERRTYP                 . 00C810 58F0 98E0
         SLA   15,2                      . 00C814 8BF0 0002
         STM   15,0,YCL                  . 00C818 90F0 A420
         LR    1,15                      . 00C81C 181F
         A     1,MSGNO                   . 00C81E 5A10 9EB0
         L     1,0(1)                    . 00C822 5811 0000
         LM    1,4,0(1)                  . 00C826 9814 1000
         STM   1,4,TSP                   . 00C82A 9014 A5A0
         L     15,@@STPRNT               . 00C82E 58F0 A838
         LA    1,IOKEY                   . 00C832 4110 9EA0
         LA    2,OUTBLK                  . 00C836 4120 9C70
         LA    3,TSP                     . 00C83A 4130 A5A0
         BALR  14,15                          CALL                     *
                                         . 00C83E 05EF
                                                             SPACE
* FTLEN2 ISTACK ,                  Reset system stack
*      AEQLC   ETMCL,0,FTLEN4      Was compiler done?
*      MSTIME  ETMCL               Time out compiler
*      SUBTRT  TIMECL,ETMCL,TIMECL Compute time in compiler
*      SETAC   ETMCL,0             Set interpreter time to 0
*      BRANCH  FTLEN1              Join end game
                                                             SPACE
FTLEN2   L     12,@@STACKB               . 00C840 58C0 A81C
         LR    13,0                      . 00C844 18D0
         C     0,ETMCL                   . 00C846 5900 9E68
         BNE   FTLEN4                    . 00C84A 4770 9238
         STM   13,1,AISAVE               . 00C84E 90D1 A770
         L     13,@@SAVSAV               . 00C852 58D0 A810
         SR    1,1                       . 00C856 1B11
         SVC   46                             TIMER                    *
                                         . 00C858 0A2E
         L     3,MAXTIM                  . 00C85A 5830 A750
         SR    3,0                       . 00C85E 1B30
         M     2,@@F26                   . 00C860 5C20 A820
         D     2,@@F1000                 . 00C864 5D20 A824
         ST    3,ETMCL                   . 00C868 5030 9E68
         LM    13,1,AISAVE               . 00C86C 98D1 A770
         ST    0,ETMCL$4                 . 00C870 5000 9E6C
         LM    1,2,ETMCL                 . 00C874 9812 9E68
         S     1,TIMECL                  . 00C878 5B10 9B90
         STM   1,2,TIMECL                . 00C87C 9012 9B90
         ST    0,ETMCL                   . 00C880 5000 9E68
         B     FTLEN1                    . 00C884 47F0 926A
                                                             SPACE
* FTLEN4 MSTIME XCL                Time out interpreter
*      SUBTRT  ETMCL,XCL,ETMCL     Compute time in interpreter
                                                             SPACE
FTLEN4   STM   13,1,AISAVE               . 00C888 90D1 A770
         L     13,@@SAVSAV               . 00C88C 58D0 A810
         SR    1,1                       . 00C890 1B11
         SVC   46                             TIMER                    *
                                         . 00C892 0A2E
         L     3,MAXTIM                  . 00C894 5830 A750
         SR    3,0                       . 00C898 1B30
         M     2,@@F26                   . 00C89A 5C20 A820
         D     2,@@F1000                 . 00C89E 5D20 A824
         ST    3,XCL                     . 00C8A2 5030 A408
         LM    13,1,AISAVE               . 00C8A6 98D1 A770
         ST    0,XCL$4                   . 00C8AA 5000 A40C
         LM    1,2,XCL                   . 00C8AE 9812 A408
         S     1,ETMCL                   . 00C8B2 5B10 9E68
         STM   1,2,ETMCL                 . 00C8B6 9012 9E68
                                                             SPACE
* FTLEN1 AEQLC DMPCL,0,,END1       Check &DUMP
*      AEQLC   NODPCL,0,DMPNO      Check storage condition
*      ORDVST  ,                   Order string structures
*      OUTPUT  OUTPUT,STDMP        Print dump title
*      OUTPUT  OUTPUT,NVARF        Print subtitle
*      RCALL   ,DUMP,,(INTR10,INTR10,DMPK)
*                                  Dump natural variables
                                                             SPACE
FTLEN1   C     0,DMPCL                   . 00C8BA 5900 9898
         BE    END1                      . 00C8BE 4780 9348
         C     0,NODPCL                  . 00C8C2 5900 A6D0
         BNE   DMPNO                     . 00C8C6 4770 92E8
         L     15,@@LSTDMP               . 00C8CA 58F0 AA54
         BALR  14,15                          CALL                     *
                                         . 00C8CE 05EF
         STM   13,1,AISAVE               . 00C8D0 90D1 A770
         L     13,@@SAVSAV               . 00C8D4 58D0 A810
         L     15,@@IBCOM#               . 00C8D8 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00C8DC 45EF 0004
         DC    X'01'                     . 00C8E0 01
         DC    AL3(OUTPUT)               . 00C8E1 00D068
         DC    X'01'                     . 00C8E4 01
         DC    AL3(STDMP)                . 00C8E5 01436A
         BAL   14,16(15)                      CALL                     *
                                         . 00C8E8 45EF 0010
         LM    13,1,AISAVE               . 00C8EC 98D1 A770
         L     13,@@SAVSAV               . 00C8F0 58D0 A810
         L     15,@@IBCOM#               . 00C8F4 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00C8F8 45EF 0004
         DC    X'01'                     . 00C8FC 01
         DC    AL3(OUTPUT)               . 00C8FD 00D068
         DC    X'01'                     . 00C900 01
         DC    AL3(NVARF)                . 00C901 014275
         BAL   14,16(15)                      CALL                     *
                                         . 00C904 45EF 0010
         LM    13,1,AISAVE               . 00C908 98D1 A770
         LA    14,S4$0C928               . 00C90C 41E0 92D8
         STM   11,14,104(12)             . 00C910 90BE C068
         LR    13,12                     . 00C914 18DC
         LA    12,16(12)                 . 00C916 41CC 0010
         C     12,@@STACKT               . 00C91A 59C0 A828
         BH    OVER                      . 00C91E 4720 9664
         L     11,@@DUMP                 . 00C922 58B0 AA58
         BR    11                        . 00C926 07FB
S4$0C928 SR    0,0                       . 00C928 1B00
         SR    0,0                       . 00C92A 1B00
         B     S4$010                    . 00C92C 47F0 95AC
         B     S4$010                    . 00C930 47F0 95AC
         B     DMPK                      . 00C934 47F0 9328
                                                             SPACE
* DMPNO OUTPUT OUTPUT,INCGCF       Print disclaimer
*      OUTPUT  OUTPUT,NODMPF       Print reason
*      BRANCH  END1                Join end game
                                                             SPACE
DMPNO    STM   13,1,AISAVE               . 00C938 90D1 A770
         L     13,@@SAVSAV               . 00C93C 58D0 A810
         L     15,@@IBCOM#               . 00C940 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00C944 45EF 0004
         DC    X'01'                     . 00C948 01
         DC    AL3(OUTPUT)               . 00C949 00D068
         DC    X'01'                     . 00C94C 01
         DC    AL3(INCGCF)               . 00C94D 0141C6
         BAL   14,16(15)                      CALL                     *
                                         . 00C950 45EF 0010
         LM    13,1,AISAVE               . 00C954 98D1 A770
         L     13,@@SAVSAV               . 00C958 58D0 A810
         L     15,@@IBCOM#               . 00C95C 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00C960 45EF 0004
         DC    X'01'                     . 00C964 01
         DC    AL3(OUTPUT)               . 00C965 00D068
         DC    X'01'                     . 00C968 01
         DC    AL3(NODMPF)               . 00C969 014230
         BAL   14,16(15)                      CALL                     *
                                         . 00C96C 45EF 0010
         LM    13,1,AISAVE               . 00C970 98D1 A770
         B     END1                      . 00C974 47F0 9348
                                                             SPACE
* DMPK RCALL   ,DMK                Dump keywords
                                                             SPACE
DMPK     LA    14,S4$0C994               . 00C978 41E0 9344
         STM   11,14,104(12)             . 00C97C 90BE C068
         LR    13,12                     . 00C980 18DC
         LA    12,16(12)                 . 00C982 41CC 0010
         C     12,@@STACKT               . 00C986 59C0 A828
         BH    OVER                      . 00C98A 4720 9664
         L     11,@@DMK                  . 00C98E 58B0 AA5C
         BR    11                        . 00C992 07FB
S4$0C994 SR    0,0                       . 00C994 1B00
         SR    0,0                       . 00C996 1B00
                                                             SPACE
* END1 OUTPUT  OUTPUT,STATHD       Print statistics title
*      OUTPUT  OUTPUT,CMTIME,(TIMECL)
*                                  Print compilation time
*      OUTPUT  OUTPUT,INTIME,(ETMCL)
*                                  Print interpretation time
*      OUTPUT  OUTPUT,EXNO,(EXNOCL,FALCL)
*                                  Print execution stats
*      OUTPUT  OUTPUT,ARTHNO,(ARTHCL)
*                                  Print arithmetic stats
*      OUTPUT  OUTPUT,SCANNO,(SCNCL)
*                                  Print scanner stats
*      OUTPUT  OUTPUT,STGENO,(GCNO)
*                                  Print regeneration stats
*      OUTPUT  OUTPUT,READNO,(RSTAT)
*                                  Print read stats
*      OUTPUT  OUTPUT,WRITNO,(WSTAT)
*                                  Print write stats
*      AEQLC   EXNOCL,0,END2       Check for no interpretation
*      INTRL   FCL,ZEROCL
*      BRANCH  AVTIME              Join end game
                                                             SPACE
END1     STM   13,1,AISAVE               . 00C998 90D1 A770
         L     13,@@SAVSAV               . 00C99C 58D0 A810
         L     15,@@IBCOM#               . 00C9A0 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00C9A4 45EF 0004
         DC    X'01'                     . 00C9A8 01
         DC    AL3(OUTPUT)               . 00C9A9 00D068
         DC    X'01'                     . 00C9AC 01
         DC    AL3(STATHD)               . 00C9AD 014349
         BAL   14,16(15)                      CALL                     *
                                         . 00C9B0 45EF 0010
         L     13,@@SAVSAV               . 00C9B4 58D0 A810
         L     15,@@IBCOM#               . 00C9B8 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00C9BC 45EF 0004
         DC    X'01'                     . 00C9C0 01
         DC    AL3(OUTPUT)               . 00C9C1 00D068
         DC    X'01'                     . 00C9C4 01
         DC    AL3(CMTIME)               . 00C9C5 014115
         BAL   14,8(15)                       CALL                     *
                                         . 00C9C8 45EF 0008
         DC    X'04509B90'               . 00C9CC 04509B90
         BAL   14,16(15)                      CALL                     *
                                         . 00C9D0 45EF 0010
         L     13,@@SAVSAV               . 00C9D4 58D0 A810
         L     15,@@IBCOM#               . 00C9D8 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00C9DC 45EF 0004
         DC    X'01'                     . 00C9E0 01
         DC    AL3(OUTPUT)               . 00C9E1 00D068
         DC    X'01'                     . 00C9E4 01
         DC    AL3(INTIME)               . 00C9E5 0141EC
         BAL   14,8(15)                       CALL                     *
                                         . 00C9E8 45EF 0008
         DC    X'04509E68'               . 00C9EC 04509E68
         BAL   14,16(15)                      CALL                     *
                                         . 00C9F0 45EF 0010
         L     13,@@SAVSAV               . 00C9F4 58D0 A810
         L     15,@@IBCOM#               . 00C9F8 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00C9FC 45EF 0004
         DC    X'01'                     . 00CA00 01
         DC    AL3(OUTPUT)               . 00CA01 00D068
         DC    X'01'                     . 00CA04 01
         DC    AL3(EXNO)                 . 00CA05 014167
         BAL   14,8(15)                       CALL                     *
                                         . 00CA08 45EF 0008
         DC    X'045099B0'               . 00CA0C 045099B0
         BAL   14,8(15)                       CALL                     *
                                         . 00CA10 45EF 0008
         DC    X'04509960'               . 00CA14 04509960
         BAL   14,16(15)                      CALL                     *
                                         . 00CA18 45EF 0010
         L     13,@@SAVSAV               . 00CA1C 58D0 A810
         L     15,@@IBCOM#               . 00CA20 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00CA24 45EF 0004
         DC    X'01'                     . 00CA28 01
         DC    AL3(OUTPUT)               . 00CA29 00D068
         DC    X'01'                     . 00CA2C 01
         DC    AL3(ARTHNO)               . 00CA2D 0140E8
         BAL   14,8(15)                       CALL                     *
                                         . 00CA30 45EF 0008
         DC    X'04509B68'               . 00CA34 04509B68
         BAL   14,16(15)                      CALL                     *
                                         . 00CA38 45EF 0010
         L     13,@@SAVSAV               . 00CA3C 58D0 A810
         L     15,@@IBCOM#               . 00CA40 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00CA44 45EF 0004
         DC    X'01'                     . 00CA48 01
         DC    AL3(OUTPUT)               . 00CA49 00D068
         DC    X'01'                     . 00CA4C 01
         DC    AL3(SCANNO)               . 00CA4D 0142EE
         BAL   14,8(15)                       CALL                     *
                                         . 00CA50 45EF 0008
         DC    X'04509B80'               . 00CA54 04509B80
         BAL   14,16(15)                      CALL                     *
                                         . 00CA58 45EF 0010
         L     13,@@SAVSAV               . 00CA5C 58D0 A810
         L     15,@@IBCOM#               . 00CA60 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00CA64 45EF 0004
         DC    X'01'                     . 00CA68 01
         DC    AL3(OUTPUT)               . 00CA69 00D068
         DC    X'01'                     . 00CA6C 01
         DC    AL3(STGENO)               . 00CA6D 014394
         BAL   14,8(15)                       CALL                     *
                                         . 00CA70 45EF 0008
         DC    X'0450A6A0'               . 00CA74 0450A6A0
         BAL   14,16(15)                      CALL                     *
                                         . 00CA78 45EF 0010
         L     13,@@SAVSAV               . 00CA7C 58D0 A810
         L     15,@@IBCOM#               . 00CA80 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00CA84 45EF 0004
         DC    X'01'                     . 00CA88 01
         DC    AL3(OUTPUT)               . 00CA89 00D068
         DC    X'01'                     . 00CA8C 01
         DC    AL3(READNO)               . 00CA8D 0142D1
         BAL   14,8(15)                       CALL                     *
                                         . 00CA90 45EF 0008
         DC    X'04509B78'               . 00CA94 04509B78
         BAL   14,16(15)                      CALL                     *
                                         . 00CA98 45EF 0010
         L     13,@@SAVSAV               . 00CA9C 58D0 A810
         L     15,@@IBCOM#               . 00CAA0 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00CAA4 45EF 0004
         DC    X'01'                     . 00CAA8 01
         DC    AL3(OUTPUT)               . 00CAA9 00D068
         DC    X'01'                     . 00CAAC 01
         DC    AL3(WRITNO)               . 00CAAD 01448D
         BAL   14,8(15)                       CALL                     *
                                         . 00CAB0 45EF 0008
         DC    X'04509B88'               . 00CAB4 04509B88
         BAL   14,16(15)                      CALL                     *
                                         . 00CAB8 45EF 0010
         LM    13,1,AISAVE               . 00CABC 98D1 A770
         C     0,EXNOCL                  . 00CAC0 5900 99B0
         BNE   END2                      . 00CAC4 4770 949A
         LR    2,0                       . 00CAC8 1820
         AL    2,BIG2$4                  . 00CACA 5E20 A79C
         ST    2,REALBB$4                . 00CACE 5020 A794
         LD    2,REALBB                  . 00CAD2 6820 A790
         SD    2,BIG2                    . 00CAD6 6B20 A798
         STE   2,FCL                     . 00CADA 7020 9E78
         LA    2,7                       . 00CADE 4120 0007
         ST    2,FCL$4                   . 00CAE2 5020 9E7C
         B     AVTIME                    . 00CAE6 47F0 94F0
                                                             SPACE
*
* END2  INTRL  EXNOCL,EXNOCL       Convert execution total tn REAL
*      INTRL   XCL,ETMCL           Convert execution time to REAL
*      DVREAL  FCL,XCL,EXNOCL      Compute average time
                                                             SPACE
END2     L     2,EXNOCL                  . 00CAEA 5820 99B0
         AL    2,BIG2$4                  . 00CAEE 5E20 A79C
         ST    2,REALBB$4                . 00CAF2 5020 A794
         LD    2,REALBB                  . 00CAF6 6820 A790
         SD    2,BIG2                    . 00CAFA 6B20 A798
         STE   2,EXNOCL                  . 00CAFE 7020 99B0
         LA    2,7                       . 00CB02 4120 0007
         ST    2,EXNOCL$4                . 00CB06 5020 99B4
         L     2,ETMCL                   . 00CB0A 5820 9E68
         AL    2,BIG2$4                  . 00CB0E 5E20 A79C
         ST    2,REALBB$4                . 00CB12 5020 A794
         LD    2,REALBB                  . 00CB16 6820 A790
         SD    2,BIG2                    . 00CB1A 6B20 A798
         STE   2,XCL                     . 00CB1E 7020 A408
         LA    2,7                       . 00CB22 4120 0007
         ST    2,XCL$4                   . 00CB26 5020 A40C
         LE    4,EXNOCL                  . 00CB2A 7840 99B0
         CE    4,ZEROCL                  . 00CB2E 7940 9C90
         BE    AVTIME                    . 00CB32 4780 94F0
         LD    2,XCL                     . 00CB36 6820 A408
         DER   2,4                       . 00CB3A 3D24
         STD   2,FCL                     . 00CB3C 6020 9E78
                                                             SPACE
* AVTIME OUTPUT OUTPUT,TIMEPS,(FCL) Print average time
                                                             SPACE
AVTIME   STM   13,1,AISAVE               . 00CB40 90D1 A770
         L     13,@@SAVSAV               . 00CB44 58D0 A810
         L     15,@@IBCOM#               . 00CB48 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00CB4C 45EF 0004
         DC    X'01'                     . 00CB50 01
         DC    AL3(OUTPUT)               . 00CB51 00D068
         DC    X'01'                     . 00CB54 01
         DC    AL3(TIMEPS)               . 00CB55 014422
         BAL   14,8(15)                       CALL                     *
                                         . 00CB58 45EF 0008
         DC    X'04709E78'               . 00CB5C 04709E78
         BAL   14,16(15)                      CALL                     *
                                         . 00CB60 45EF 0010
         LM    13,1,AISAVE               . 00CB64 98D1 A770
                                                             SPACE
* ENDALL ENDEX ABNDCL                                           E3.2.2
                                                             SPACE
ENDALL   L     1,@@SPICTF                . 00CB68 5810 AA60
         C     0,0(1)                    . 00CB6C 5901 0000
         BE    S4$0CB7C                  . 00CB70 4780 952C
         LA    1,16                      . 00CB74 4110 0010
         ST    1,RETCOD                  . 00CB78 5010 98A8
S4$0CB7C C     0,ABNDCL                  . 00CB7C 5900 98C8
         BE    S4$0CB9E                  . 00CB80 4780 954E
         NC    ABNDCL(4),@@XFFF          . 00CB84 D403 98C8 AA64
         MVC   DATACB96(2),ABNDCL$2      . 00CB8A D201 9546 98CA
         B     S4$0CB98                  . 00CB90 47F0 9548
DATACB94 DC    X'8000'                   . 00CB94 8000
DATACB96 DC    X'0000'                   . 00CB96 0000
S4$0CB98 L     1,DATACB94                . 00CB98 5810 9544
         SVC   13                             ABEND                    *
                                         . 00CB9C 0A0D
S4$0CB9E L     15,@@FINIS                . 00CB9E 58F0 AA68
         BR    15                        . 00CBA2 07FF
S4$0UT   EQU   S4+52132                  . 00CBA4
                                                             SPACE
* SYSCUT OUTPUT OUTPUT,SYSCMT,(STNOCL,LVLCL)
*                                  System cut exit
*      AEQLC   CUTNO,0,ENDALL                                   E3.2.2
*      SETAC   CUTNO,1                                          E3.2.2
*      BRANCH  FTLEN2              Join end game
SYSCUT   STM   13,1,AISAVE               . 00CBA4 90D1 A770
         L     13,@@SAVSAV               . 00CBA8 58D0 A810
         L     15,@@IBCOM#               . 00CBAC 58F0 A814
         BAL   14,4(15)                       CALL                     *
                                         . 00CBB0 45EF 0004
         DC    X'01'                     . 00CBB4 01
         DC    AL3(OUTPUT)               . 00CBB5 00D068
         DC    X'01'                     . 00CBB8 01
         DC    AL3(SYSCMT)               . 00CBB9 0143F0
         BAL   14,8(15)                       CALL                     *
                                         . 00CBBC 45EF 0008
         DC    X'04509990'               . 00CBC0 04509990
         BAL   14,8(15)                       CALL                     *
                                         . 00CBC4 45EF 0008
         DC    X'045099C0'               . 00CBC8 045099C0
         MVC   S4$0UT(4),NODPCL$4        . 00CBCC D203 9554 A6D4
         B     S4$0C7C0                  . 00CBD2 47F0 9170
         DC    X'91F0'                   . 00CBD6 91F0
                                                             SPACE
*---------------------------------------------------------------------*
                                                             SPACE
       TITLE   'Error Handling'
*
*  The follwong attempt to use "adapted" macros axtually doesn't
*  make the source more readable. (letf in as demo).
*
AERROR SETAC   ERRTYP,2            Arithmetic error
       BRANCH  FTLTST
                                                                SPACE
ALOC2  SETAC   ERRTYP,20           Storage exhausted
       BRANCH  FTLEND
                                                                SPACE
ARGNER SETAC   ERRTYP,25           Incorrect number of arguments
       BRANCH  FTLEND
                                                                SPACE
* Add some labels to circumvent DISASM's label prefixing issues.
INTR10 LHERE   ,
S4$010 LHERE   ,
INTR13 LHERE   ,
COMP3  SETAC   ERRTYP,17           Program error
       BRANCH  FTLEND
                                                                SPACE
COMP5  SETAC   ERRTYP,11           Reading error
       BRANCH  FTLTST
                                                                SPACE
COMP7  SETAC   ERRTYP,27           Erroneous end statement
       BRANCH  FTLEND
                                                                SPACE
COMP9  SETAC   ERRTYP,26           Compilation error limit
       DECRA   ESAICL,DESCR        Decrement error count
       BRANCH  FTLEND
                                                                SPACE
EROR   INCRA   OCICL,DESCR         Increment offset
       GETD    STNOCL,OCBSCL OCICL Get statement number
       SETAC   ERRTYP,28           Erroneous statement
       BRANCH  FTLEND
                                                                SPACE
EXEX   SETAC   ERRTYP,22           Exceeded &STLIMIT
       BRANCH  FTLEND
                                                                SPACE
INTR1  SETAC   ERRTYP,1            Illegal data type
       BRANCH  FTLTST
                                                                SPACE
INTR4  SETAC   ERRTYP,24           Erroneous goto
       BRANCH  FTLEND
                                                                SPACE
INTR5  SETAC   ERRTYP,19           Failure in goto
       BRANCH  FTLEND
                                                                SPACE
INTR8  SETAC   ERRTYP,15           Exceeded &MAXLNGTH
       BRANCH  FTLTST
                                                                SPACE
INTR27 SETAC   ERRTYP,13           Excessive data types
       BRANCH  FTLTST
                                                                SPACE
INTR30 SETAC   ERRTYP,10           Illegal argument
       BRANCH  FTLTST
                                                                SPACE
INTR31 SETAC   SCERCL,3            Overflow in pattern matching
       SETAC   ERRTYP,16           Overflow in pattern matching
       BRANCH  FTERST
                                                                SPACE
LENERR SETAC   ERRTYP,14           Negative number
       BRANCH  FTLTST
                                                                SPACE
MAIN1  SETAC   ERRTYP,18           Return from level zero
       BRANCH  FTLEND
                                                                SPACE
NEMO   SETAC   ERRTYP,8            Variable not present
       BRANCH  FTLTST
                                                                SPACE
NONAME SETAC   ERRTYP,4            Null string
       BRANCH  FTLTST
                                                                SPACE
NONARY SETAC   ERRTYP,3            Erroneous array or table reference
       BRANCH  FTLTST
                                                                SPACE
OVER   SETAC   ERRTYP,21           Stack overflow
       BRANCH  FTLEND
                                                                SPACE
PROTER SETAC   ERRTYP,6            Erroneous prototype
       BRANCH  FTLTST
                                                                SPACE
SCDTER SETAC   ERRTYP,1            Illegal data type
       BRANCH  SCERST
                                                                SPACE
SCLENR SETAC   ERRTYP,14           Negative number
       BRANCH  SCERST
                                                                SPACE
SCLNOR SETAC   ERRTYP,15           String overflow
       BRANCH  SCERST
                                                                SPACE
SCNAME SETAC   ERRTYP,4            Null string
       BRANCH  SCERST
                                                                SPACE
SIZERR SETAC   ERRTYP,23           Object too large
       BRANCH  FTLEND
                                                                SPACE
UNDF   SETAC   ERRTYP,5            Undefined function
       BRANCH  FTLTST
                                                                SPACE
UNDFFE SETAC   ERRTYP,9            Function entry point not label
       BRANCH  FTLTST
                                                                SPACE
UNKNKW SETAC   ERRTYP,7            Unknown keyword
       BRANCH  FTLTST
                                                                SPACE
UNTERR SETAC   ERRTYP,12           Illegal I/O unit
       BRANCH  FTLTST
                                                                SPACE
SCERST SETAC   SCERCL,1            Note failure during pattern matching
       BRANCH  FTERST
                                                                SPACE
FTLTST SETAC   SCERCL,2            Note failure out of pattern matching
FTERST ACOMPC  ERRLCL,0,,FTLEND,FTLEND                                 *
                                   Check &ERRLIMIT
       DECRA   ERRLCL,1            Decrement &ERRLIMIT
       ACOMPC  TRAPCL,0,,FTERBR,FTERBR                                 *
                                   Check &TRACE
       LOCAPT  ATPTR,TKEYL,ERRTKY,FTERBR                               *
                                   Look for KEYWORD trace
       ORG     *-4
       PUSH    SCERCL                                           E3.1.3
*      RCALL   ,TRPHND,ATPTR       Perform trace                E3.3.1
S4$0CD64 LA    14,S4$0CD84               . 00CD64 41E0 9734
         STM   11,14,104(12)             . 00CD68 90BE C068
         LR    13,12                     . 00CD6C 18DC
         STM   15,0,120(12)              . 00CD6E 90F0 C078
         LA    12,24(12)                 . 00CD72 41CC 0018
         C     12,@@STACKT               . 00CD76 59C0 A828
         BH    OVER                      . 00CD7A 4720 9664
         L     11,@@TRPHND               . 00CD7E 58B0 A918
         BR    11                        . 00CD82 07FB
                                                                SPACE
S4$0CD84 SR    0,0                       . 00CD84 1B00
         SR    0,0                       . 00CD86 1B00
       POP     SCERCL                                           E3.1.3
FTERBR SELBRA  SCERCL,(TSALF,FAIL,RTNUL3)
                                                                SPACE
       ORG     S4+X'CDA4'
*---------------------------------------------------------------------*
       TITLE   'Data'
DATA   EQU    S4$0
DATAD650 EQU  DATA+4096
       NOPR  0                           Align and avoid HLASM logic
       NOPR  0                           HLASM : BC 0,X'700'
                                                               SPACE
DTLIST DESCR   DTLIST,TTL+MARK,DTLEND-DTLIST-DESCR
       DESCR   0,0,S
       DESCR   VARSP,0,0           STRING
       DESCR   0,0,I
       DESCR   INTGSP,0,0          INTEGER
       DESCR   0,0,P
       DESCR   PATSP,0,0           PATTERN
       DESCR   0,0,A
       DESCR   ARRSP,0,0           ARRAY
       DESCR   0,0,R
       DESCR   RLSP,0,0            REAL
       DESCR   0,0,C
       DESCR   CODESP,0,0          CODE
       DESCR   0,0,N
       DESCR   NAMESP,0,0          NAME
       DESCR   0,0,K
       DESCR   NAMESP,0,0          NAME (FOR KEYWORD)
       DESCR   0,0,E
       DESCR   EXPSP,0,0           EXPRESSION
       DESCR   0,0,T
       DESCR   ASSCSP,0,0          TABLE
DTLEND LHERE   ,
*
KNLIST DESCR   KNLIST,TTL+MARK,KNEND-KNLIST-DESCR
TRIMCL DESCR   0,0,I               &TRIM
       DESCR   TRMSP,0,0
TRAPCL DESCR   0,0,I               &TRACE
       DESCR   TRCESP,0,0
EXLMCL DESCR   50000,0,I           &STLIMIT
       DESCR   STLMSP,0,0
OUTSW  DESCR   1,0,I               &OUTPUT
       DESCR   OUTSP,0,0
MLENCL DESCR   5000,0,I            &MAXLNGTH
       DESCR   MAXLSP,0,0
INSW   DESCR   1,0,I               &INPUT
       DESCR   INSP,0,0
FULLCL DESCR   0,0,I               &FULLSCAN
       DESCR   FULLSP,0,0
TRACL  DESCR   0,0,I               &FTRACE
       DESCR   FTRCSP,0,0
ERRLCL DESCR   0,0,I               &ERRLIMIT
       DESCR   ERRLSP,0,0
DMPCL  DESCR   0,0,I               &DUMP
       DESCR   DUMPSP,0,0
RETCOD DESCR   0,0,I               &CODE
       DESCR   CODESP,0,0
ANCCL  DESCR   0,0,I               &ANCHOR
       DESCR   ANCHSP,0,0
ABNDCL DESCR   0,0,I               &ABEND
ABNDCL$2 EQU   ABNDCL+2                                   ISREDIT
       DESCR   ABNDSP,0,0
KNEND  LHERE   ,
*
KVLIST DESCR   KVLIST,TTL+MARK,KVEND-KVLIST-DESCR
ERRTYP DESCR   0,0,I               &ERRTYPE
ERRTKY DESCR   ERRTSP,0,0
ARBPAT DESCR   ARBPT,0,P           &ARB
ARBKY  DESCR   ARBSP,0,0
BALPAT DESCR   BALPT,0,P           &BAL
BALKY  DESCR   BALSP,0,0
FNCPAT DESCR   FNCEPT,0,P          &FENCE
FNCEKY DESCR   FNCESP,0,0
ABOPAT DESCR   ABORPT,0,P          &ABORT
ABRTKY DESCR   ABORSP,0,0
FALPAT DESCR   FAILPT,0,P          &FAIL
FAILKY DESCR   FAILSP,0,0
REMPAT DESCR   REMPT,0,P           &REM
REMKY  DESCR   REMSP,0,0
SUCPAT DESCR   SUCCPT,0,P          &SUCCEED
SUCCKY DESCR   SUCCSP,0,0
FALCL  DESCR   0,0,I               &STFCOUNT
FALKY  DESCR   STFCSP,0,0
LSTNCL DESCR   0,0,I               &LASTNO
       DESCR   LSTNSP,0,0
RETPCL DESCR   0,0,S               &RTNTYPE
       DESCR   RTYPSP,0,0
STNOCL DESCR   0,0,I               &STNO
       DESCR   STNOSP,0,0
ALPHVL DESCR   0,0,0               &ALPHABET
       DESCR   ALNMSP,0,0
EXNOCL DESCR   0,0,I               &STCOUNT
EXNOCL$4 EQU   EXNOCL+4                                   ISREDIT
STCTKY DESCR   STCTSP,0,0
LVLCL  DESCR   0,0,I               &FNCLEVEL
FNCLKY DESCR   FNCLSP,0,0
KVEND  LHERE   ,
*
INLIST DESCR   INLIST,TTL+MARK,2*DESCR
       DESCR   INPUT-DESCR,0,0     INPUT BLOCK
       DESCR   INSP,0,0
OTLIST DESCR   OTLIST,TTL+MARK,4*DESCR
       DESCR   OUTPUT-DESCR,0,0    OUTPUT BLOCK
       DESCR   OUTSP,0,0
       DESCR   PUNCH-DESCR,0,0     PUNCH BLOCK
       DESCR   PNCHSP,0,0
OTSATL DESCR   OTSATL,TTL+MARK,4*DESCR
OUTPUT DESCR   UNITO,0,I           OUTPUT UNIT
       DESCR   OUTPSP,0,0          OUTPUT FORMAT
PUNCH  DESCR   UNITP,0,I           PUNCH UNIT
PCHFST DESCR   CRDFSP,0,0          PUNCH FORMAT
INSATL DESCR   INSATL,TTL+MARK,2*DESCR
INPUT  DESCR   UNITI,0,I           INPUT UNIT
DFLSIZ DESCR   80,0,I              INPUT LENGTH
*
TRLIST DESCR   TRLIST,TTL+MARK,10*DESCR
       DESCR   TVALL,0,0           VALUE TRACE
VALTRS DESCR   VALSP,0,0
       DESCR   TLABL,0,0           LABEL TRACE
       DESCR   TRLASP,0,0
TFNCLP DESCR   TFENTL,0,0          CALL TRACE
       DESCR   TRFRSP,0,0
TFNRLP DESCR   TFEXTL,0,0          RETURN TRACE
       DESCR   RETSP,0,0
       DESCR   TKEYL,0,0           KEYWORD TRACE
       DESCR   TRKYSP,0,0
*
ATRHD  DESCR   ATPRCL-DESCR,0,0    ARRAY HEADER CONVERTING FROM TABLE
ATPRCL DESCR   0,0,0               PROTOTYPE
       DESCR   2,0,0               DIMENSIONALITY
       DESCR   1,0,2               1:2 SECOND DIMENSION
ATEXCL DESCR   1,0,0               1:N FIRST DIMENSION
ATEXCL$5 EQU   ATEXCL+5                                   ISREDIT
*
*      Data type pairs
*
ATDTP  DESCR   A,0,T               ARRAY-TABLE
IIDTP  DESCR   I,0,I               INTEGER-INTEGER
IPDTP  DESCR   I,0,P               INTEGER-PATTERN
IRDTP  DESCR   I,0,R               INTEGER-REAL
IVDTP  DESCR   I,0,S               INTEGER-STRING
PIDTP  DESCR   P,0,I               PATTERN-INTEGER
PPDTP  DESCR   P,0,P               PATTERN-PATTERN
PVDTP  DESCR   P,0,S               PATTERN-STRING
RIDTP  DESCR   R,0,I               REAL-INTEGER
RPDTP  DESCR   R,0,P               REAL-PATTERN
RRDTP  DESCR   R,0,R               REAL-REAL
RVDTP  DESCR   R,0,S               REAL-STRING
TADTP  DESCR   T,0,A               TABLE-ARRAY
VCDTP  DESCR   S,0,C               STRING-CODE
VEDTP  DESCR   S,0,E               STRING-EXPRESSION
VIDTP  DESCR   S,0,I               STRING-INTEGER
VPDTP  DESCR   S,0,P               STRING-PATTERN
VRDTP  DESCR   S,0,R               STRING-REAL
VVDTP  DESCR   S,0,S               STRING-STRING
*
ARTHCL DESCR   0,0,0               Number of arithmetic operations
CSTNCL DESCR   0,0,I               Compiler statement number
CSTNCL$5 EQU   CSTNCL+5                                   ISREDIT
RSTAT  DESCR   0,0,0               Number of reads
SCNCL  DESCR   0,0,0               Number of scanner entrances
WSTAT  DESCR   0,0,0               Number of writes
TIMECL DESCR   0,0,0               Millisecond time
TIMECL$4 EQU   TIMECL+4                                   ISREDIT
TIMECL$5 EQU   TIMECL+5                                   ISREDIT
*
*      SWITCHES
*
ALCL   DESCR   0,0,0               ENTRY POINT SWITCH FOR ARG(F,N)
ARRMRK DESCR   0,0,0               PROTOTYPE END SWITCH FOR ARRAY(P,V)
CUTNO  DESCR   0,0,0                                            E3.2.2
CNSLCL DESCR   0,0,0               LABEL REDEFINITION SWITCH
XXXXCL DESCR   0,0,0    aka DATACL PROTOTYPE END SWITCH FOR DATA(P)
FNVLCL DESCR   0,0,0               FUNCTION-VALUE SWITCH FOR TRACE
*ENFCL DESCR   0,0,0               LENGTH FAILURE SWITCH
LISTCL DESCR   1,0,0               COMPILER LISTING SWITCH
LLIST  DESCR   0,0,0               LEFT LISTING SWITCH
NAMGCL DESCR   0,0,0               NAMING SWITCH FOR SJSR
SCERCL DESCR   0,0,0               ERROR BRANCH SWITCH
*
*      CONSTANTS
*
ARBSIZ DESCR   8*NODESZ,0,0        NODE SIZE FOR ARBNO(P)
CHARCL DESCR   1,0,0               LENGTH CONSTANT 1
CNDSIZ DESCR   CNODSZ,0,B          COMPILER NODE SIZE
CODELT DESCR   200*DESCR,0,C       OBJECT CODE EXCESS
DSCRTW DESCR   2*DESCR,0,0         CONSTANT 2*DESCR
EOSCL  DESCR   EOSTYP,0,0          END OF STATEMENT SWITCH
ESALIM DESCR   ESASIZ*DESCR,0,0    BOUND ON COMPILATION ERRORS
EXTVAL DESCR   EXTSIZ*2*DESCR,0,I  DEFAULT M FOR TABLE(N,M)
FBLKRQ DESCR   FBLKSZ,0,B          QUANTUM ON ALLOCATED FUNCTION BLOCKS
GOBRCL DESCR   0,0,0               GOTO BREAK CHARACTER SWITCH
GTOCL  DESCR   FGOTYP,0,0          GOTO DECISION SWITCH
IOBLSZ DESCR   2*DESCR,0,B         SIZE OF I/O BLOCKS
LNODSZ DESCR   NODESZ+DESCR,0,P    SIZE OF LONG PATTERN NODE
NODSIZ DESCR   NODESZ,0,P          SIZE OF SHORT PATTERN NODE
OBEND  DESCR   OBLIST+DESCR*OBOFF,0,0
*                                  END ON BIN LIST
OCALIM DESCR   OCASIZ*DESCR,0,C    SIZE OF OBJECT CODE BLOCK
OCALIM$5 EQU   OCALIM+5                                   ISREDIT
ONECL  DESCR   1,0,0               CONSTANT 1
OUTBLK DESCR   OUTPUT-DESCR,0,0    POINTER TO OUTPUT BLOCK
SIZLMT DESCR   SIZLIM,0,0          LIMIT ON SIZE OF DATA OBJECT
SNODSZ DESCR   NODESZ,0,P          SMALL PATTERN NODE SIZE
STARSZ DESCR   11*DESCR,0,P        SIZE OF EXPRESSION PATTERN
ZEROCL DESCR   0,0,0               CONSTANT ZERO
TRSKEL DESCR   TRCBLK,0,0
COMDCT DESCR   14*DESCR,0,0
COMREG DESCR   ELEMND,0,0          POINTER TO COMPILER DESCRIPTORS
*
*
*
*      POINTERS TO ASSEMBLED DATA PATTERNS
*
ARBACK DESCR   ARBAK,0,P
ARHEAD DESCR   ARHED,0,P
ARTAIL DESCR   ARTAL,0,P
STRPAT DESCR   STARPT,0,P
*
*      FUNCTION DESCRIPTORS
*
ANYCCL DESCR   ANYCFN,FNC,3
ASGNCL DESCR   ASGNFN,FNC,2
ATOPCL DESCR   ATOPFN,FNC,3
BASECL DESCR   BASEFN,FNC,0
BRKCCL DESCR   BRKCFN,FNC,3
CHRCL  DESCR   CHRFN,FNC,3
CONCL  DESCR   CONFN,FNC,0         ARGUMENT COUNT IS INCREMENTED
DNMECL DESCR   DNMEFN,FNC,2
DNMICL DESCR   DNMIFN,FNC,2
DOTCL  DESCR   DOTFN,FNC,1
ENDCL  DESCR   ENDFN,FNC,0
ENMECL DESCR   ENMEFN,FNC,3
ENMICL DESCR   ENMIFN,FNC,3
ERORCL DESCR   ERORFN,FNC,1
FNCFCL DESCR   FNCFFN,FNC,2
FNMECL DESCR   FNMEFN,FNC,2
GOTGCL DESCR   GOTGFN,FNC,1
GOTLCL DESCR   GOTLFN,FNC,1
GOTOCL DESCR   GOTOFN,FNC,1
INITCL DESCR   INITFN,FNC,1
ITEMCL DESCR   AREFN,FNC,0
LITCL  DESCR   LITFN,FNC,0         ARGUMENT COUNT IS INCREMENTED
LNTHCL DESCR   LNTHFN,FNC,3
NMECL  DESCR   NMEFN,FNC,2
NNYCCL DESCR   NNYCFN,FNC,3
POSICL DESCR   POSIFN,FNC,3
RPSICL DESCR   RPSIFN,FNC,3
RTBCL  DESCR   RTBFN,FNC,3
SCANCL DESCR   SCANFN,FNC,2
SCFLCL DESCR   SCFLFN,FNC,2
SCOKCL DESCR   SCOKFN,FNC,2
SCONCL DESCR   SCONFN,FNC,2
SJSRCL DESCR   SJSRFN,FNC,3
SPNCCL DESCR   SPNCFN,FNC,3
SUCFCL DESCR   SUCFFN,FNC,2
TBCL   DESCR   TBFN,FNC,3
INITB  DESCR   ABNDB,0,0
INITE  DESCR   DTEND+DESCR,0,0
*
*      MISCELLANEOUS DATA CELLS
*
A4PTR  DESCR   0,0,0               SCRATCH DESCRIPTOR
A4PTR$5  EQU   A4PTR+5                                    ISREDIT
A5PTR  DESCR   0,0,0               SCRATCH DESCRIPTOR
A6PTR  DESCR   0,0,0               SCRATCH DESCRIPTOR
A6PTR$1  EQU   A6PTR+1                                    ISREDIT
A7PTR  DESCR   0,0,0               SCRATCH DESCRIPTOR
A7PTR$1  EQU   A7PTR+1                                    ISREDIT
BRTYPE DESCR   0,0,0               BREAK TYPE RETURNED BY FORWRD
CMOFCL DESCR   0,0,0               COMPILER OFFSET
CMOFCL$1 EQU   CMOFCL+1                                   ISREDIT
DATSEG DESCR   0,0,100             BEGINNING OF DEFINED DATA TYPES
DATSEG$4 EQU   DATSEG+4                                   ISREDIT
DATSEG$5 EQU   DATSEG+5                                   ISREDIT
DATSEG$6 EQU   DATSEG+6                                   ISREDIT
DMPPTR DESCR   0,0,0               BIN POINTER FOR DUMP
DTCL   DESCR   0,0,0               DATA TYPE DESCRIPTOR
DTCL$5   EQU   DTCL+5                                     ISREDIT
DT1CL  DESCR   0,0,0               DATA TYPE DESCRIPTOR
DT1CL$5  EQU   DT1CL+5                                    ISREDIT
EMSGCL DESCR   0,0,0               PRESENT ERROR MESSAGE ADDRESS
ERRBAS DESCR   CARDSZ+STNOSZ-SEQSIZ,0,0
ESAICL DESCR   0,0,0               COUNT OF COMPILER ERRORS
ETMCL  DESCR   0,0,0               TIME DESCRIPTOR
ETMCL$4  EQU   ETMCL+4                                    ISREDIT
*
* Binary patch V.3.5
*FATLCL DESCR   0,0,0               FATAL ERROR SWITCH
FATLCL LA      12,8(12)
       B       FCL
*FCL    DESCR   0,0,0               REAL NUMBER DESCRIPTOR
FCL    LA      1,8
FCL$4  B       SCERST
* end of patch
NEXFCL DESCR   FBLKSZ,0,0          OFFSET IN FUNCTION BLOCK
FRTNCL DESCR   0,0,0               FAILURE RETURN
GOGOCL DESCR   0,0,0               GOTO DESCRIPTOR
INCL   DESCR   0,0,0               GLOBAL FUNCTION DESCRIPTOR
INCL$4   EQU   INCL+4                                     ISREDIT
INCL$5   EQU   INCL+5                                     ISREDIT
IOKEY  DESCR   0,0,0               I/O INDICATOR
MAXLEN DESCR   0,0,0               MAXIMUM LENGTH FOR MATCHING
MSGNO  DESCR   MSGLST,0,0          POINTER TO ERROR MESSAGE LIST
NAMICL DESCR   0,0,0               OFFSET ON NAMING LIST
NHEDCL DESCR   0,0,0               NAME LIST HEAD OFFSET
NMOVER DESCR   NAMLSZ*SPDR,0,B     NAME LIST END OFFSET
NULVCL DESCR   0,0,S               mULL STRING VALUE
OCICL  DESCR   0,0,0               OBJECT CODE OFFSET
PATICL DESCR   0,0,0               PATTERN CODE OFFSET
PATICL$4 EQU   PATICL+4                                   ISREDIT
PDLEND DESCR   PDLBLK+SPDLDR-NODESZ,0,0
*                                  PATTERN HISTORY LIST END
PDLPTR DESCR   PDLBLK,0,0          PATTERN HISTORY LIST BEGINNING
SCL    DESCR   0,0,0               SWITCH DESCRIPTOR
STKPTR DESCR   STACK,0,0           POINTER TO STACK
STYPE  DESCR   0,FNC,0             DESCRIPTOR RETURN BY STREAM
TBLFNC DESCR   0,0,0               POINTER TO LAST PATTERN TABLE
UNIT   DESCR   0,0,0               INPUT UNIT SWITCH
VARSYM DESCR   0,0,0
VARSYM$4 EQU   VARSYM+4                                   ISREDIT
*
*      PROGRAM POINTERS
*
DATCL  DESCR   DEFDAT,FNC,0        DEFINED DATA OBJECTS
DATCL$5  EQU   DATCL+5                                    ISREDIT
DEFCL  DESCR   DEFFNC,FNC,0        DEFINED FUNCTIONS
DEFCL$5  EQU   DEFCL+5                                    ISREDIT
FLDCL  DESCR   FIELD,0,1           FIELD OF DEFINED DATA OBJECTS
LODCL  DESCR   LNKFNC,FNC,0        EXTERNAL FUNCTIONS
LODCL$5  EQU   LODCL+5                                    ISREDIT
PDLHED DESCR   PDLBLK,0,0          HISTORY LIST HEAD
UNDFCL DESCR   UNDF,FNC,0          UNDEFINED FUNCTIONS
*
*      POINTERS TO SPECIFIERS
*
DPSPTR DESCR   DPSP,0,0
XSPPTR DESCR   XSP,0,0
YSPPTR DESCR   YSP,0,0
ZSPPTR DESCR   ZSP,0,0
TSPPTR DESCR   TSP,0,0
*
*      PERMANENT ATTRIBUTE LIST POINTERS
*
KNATL  DESCR   KNLIST,0,0          UNPROTECTED KEYWORD LIST
KVATL  DESCR   KVLIST,0,0          PROTECTED KEYWORD LIST
TRATL  DESCR   TRLIST,0,0          TRACE LIST
*
*      SPECIFIERS FOR COMPILATION LISTING
*
BLNSP  SPEC    BLNBUF,0,0,0,STNOSZ
ERRSP  SPEC    ERRBUF,0,0,0,CARDSZ+STNOSZ-SEQSIZ+1
INBFSP SPEC    INBUF,0,0,STNOSZ,CARDSZ
LNBFSP SPEC    INBUF,0,0,0,CARDSZ+DSTSZ+1
NEXTSP SPEC    INBUF,0,0,STNOSZ,CARDSZ-SEQSIZ
LNOSP  SPEC    INBUF,0,0,0,STNOSZ
RNOSP  SPEC    INBUF,0,0,CARDSZ+STNOSZ+1,STNOSZ
*
*      STRINGS AND SPECIFIERS
*
ALPHSP SPEC    ALPHA,0,0,0,ALPHSZ  ALPHABET
AMPSP  SPEC    AMPST,0,0,0,1       AMPERSAND
CERRSP SPEC    ANYSP,0,0,0,0       BUFFER SPECIFIER
COLSP  SPEC    COLSTR,0,0,0,2      COLON FOR TRACE MESSAGES
DMPSP  SPEC    ANYSP,0,0,0,0       BUFFER SPECIFIER
DTARSP SPEC    DTARBF,0,0,0,ARRLEN+9
*                                  ARRAY REPRESENTATION SPECIFIER
PROTSP SPEC    ANYSP,0,0,0,0       BUFFER SPECIFIER
QTSP   SPEC    QTSTR,0,0,0,1       QUOTE FOR MESSAGES
REALSP SPEC    REALBF,0,0,0,10     SPECIFIER FOR REAL CONVERSION
TRACSP SPEC    ANYSP,0,0,0,0       BUFFER SPECIFIER
*
ARRSP  STRING  'ARRAY'
ASSCSP STRING  'TABLE'
BLSP   STRING  ' '
BLEQSP STRING  ' = '
CMASP  STRING  ','
EJCTSP STRING  'EJECT'
EQLSP  STRING  '= '
ETIMSP STRING  ',TIME = '
EXDTSP STRING  'EXTERNAL'
LEFTSP STRING  'LEFT'
LISTSP STRING  'LIST'
LPRNSP STRING  '('
OFSP   STRING  ' OF '
RPRNSP STRING  ')'
STARSP STRING  '*** '
TRCLSP STRING  ' CALL OF '
TRLVSP STRING  'LEVEL '
TRSTSP STRING  '    STATEMENT '
UNLSP  STRING  'UNLIST'
XFERSP STRING  'TRANSFER TO'
*
*      Character buffers
*
BLNBUF BUFFER  STNOSZ              BLANKS FOR STATMENT NUMBER FIELD
DTARBF BUFFER  ARRLEN+7            ARRAY REPRESENTATION BUFFER
ERRBUF BUFFER  CARDSZ+STNOSZ-SEQSIZ+1
INBUF  BUFFER  CARDSZ+DSTSZ+1      CARD INPUT BUFFER
REALBF BUFFER  36                  BUFFER FOR REAL NUMBER CONVERSION
          NOPR    0
          NOPR    0
ICLBLK DESCR   ICLBLK,TTL+MARK,ICLEND-ICLBLK-DESCR
*
*      Pointers to Attribute Lists
*
DTATL  DESCR   DTLIST,0,0          Data type pair list
FNCPL  DESCR   FNLIST,0,0          Function pair list
INATL  DESCR   INLIST,0,0          Input association pair list
OUTATL DESCR   OTLIST,0,0          Output association pair list
TVALL  DESCR   TVALPL,0,0          Value trace pair list
       DESCR   VLTRFN,FNC,2        Default value trace procedure
TLABL  DESCR   TLABPL,0,0          Label trace pair list
       DESCR   LABTFN,FNC,1        Default label trace procedure
TFENTL DESCR   TFENPL,0,0          Call trace pair list
       DESCR   FNTRFN,FNC,2        Default call trace procedure
TFEXTL DESCR   TFEXPL,0,0          Return trace pair list
       DESCR   FXTRFN,FNC,2        Default return trace procedure
TKEYL  DESCR   TKEYPL,0,0          Keyword trace pair list
       DESCR   KEYTFN,FNC,1        Default keyword trace procedure
*
*
*      Scratch Descriptors
*
A1PTR  DESCR   0,0,0
A2PTR  DESCR   0,0,0
A2PTR$5  EQU   A2PTR+5                                    ISREDIT
A3PTR  DESCR   0,0,0
ATPTR  DESCR   0,0,0
F1PTR  DESCR   0,0,0
F2PTR  DESCR   0,0,0
IO2PTR DESCR   0,0,0
IO2PTR$5 EQU   IO2PTR+5                                   ISREDIT
IO1PTR DESCR   0,0,0
LPTR   DESCR   0,0,0               Last label pointer
NVAL   DESCR   0,0,0
NVAL$1   EQU   NVAL+1                                     ISREDIT
NVAL$4   EQU   NVAL+4                                     ISREDIT
NVAL$5   EQU   NVAL+5                                     ISREDIT
IO3PTR DESCR   0,0,0
IO4PTR DESCR   0,0,0
TBLCS  DESCR   0,0,0
TMVAL  DESCR   0,0,0
TMVAL$5  EQU   TMVAL+5                                    ISREDIT
TPTR   DESCR   0,0,0
TPTR$5   EQU   TPTR+5                                     ISREDIT
TCL    DESCR   0,0,0
TSIZ   DESCR   0,0,0
TSIZ$5   EQU   TSIZ+5                                     ISREDIT
TVAL   DESCR   0,0,0
TVAL$4   EQU   TVAL+4                                     ISREDIT
TVAL$5   EQU   TVAL+5                                     ISREDIT
VVAL   DESCR   0,0,0
WCL    DESCR   0,0,0
WCL$5    EQU   WCL+5                                      ISREDIT
WPTR   DESCR   0,0,0
WPTR$4   EQU   WPTR+4                                     ISREDIT
XCL    DESCR   0,0,0
XCL$1    EQU   XCL+1                                      ISREDIT
XCL$4    EQU   XCL+4                                      ISREDIT
XCL$5    EQU   XCL+5                                      ISREDIT
XPTR   DESCR   0,0,0
XPTR$4   EQU   XPTR+4                                     ISREDIT
XPTR$5   EQU   XPTR+5                                     ISREDIT
XSIZ   DESCR   0,0,0
XSIZ$5   EQU   XSIZ+5                                     ISREDIT
YCL    DESCR   0,0,0
YCL$1    EQU   YCL+1                                      ISREDIT
YCL$4    EQU   YCL+4                                      ISREDIT
YCL$5    EQU   YCL+5                                      ISREDIT
YPTR   DESCR   0,0,0
YPTR$4   EQU   YPTR+4                                     ISREDIT
YPTR$5   EQU   YPTR+5                                     ISREDIT
YSIZ   DESCR   0,0,0
ZCL    DESCR   0,0,0
ZCL$1    EQU   ZCL+1                                      ISREDIT
ZCL$5    EQU   ZCL+5                                      ISREDIT
ZPTR   DESCR   0,0,0
ZPTR$4   EQU   ZPTR+4                                     ISREDIT
ZPTR$5   EQU   ZPTR+5                                     ISREDIT
ZSIZ   DESCR   0,0,0
ZSIZ$5   EQU   ZSIZ+5                                     ISREDIT
*
*      System Descriptors
*
BOSCL  DESCR   0,0,0               Offset of beginning of statement
CMBSCL DESCR   0,0,0               Compiler code base descriptor
NBSPTR DESCR   0,0,0               Name list base pointer
FBLOCK DESCR   0,0,0               Function procedure descriptor block
FBLOCK$4 EQU   FBLOCK+4                                   ISREDIT
FBLOCK$5 EQU   FBLOCK+5                                   ISREDIT
OCBSCL DESCR   0,0,0               Interpreter code base descriptor
OCBSCL$5 EQU   OCBSCL+5                                   ISREDIT
OCLIM  DESCR   0,0,0               End of object code block
OCSVCL DESCR   0,0,0               Pointer to basic object code
PATBCL DESCR   0,0,0               Pattern code base descriptor
SCBSCL DESCR   0,0,0
SCBSCL$4 EQU   SCBSCL+4                                   ISREDIT
SRNCL  DESCR   0,0,0               Success return descriptor
*
*
*      Compiler Descriptors
*
ELEMND DESCR   0,0,0               Element node
ELEXND DESCR   0,0,0               Temporary node
ELEYND DESCR   0,0,0               Temporary node
EXELND DESCR   0,0,0               Temporary node
EXEXND DESCR   0,0,0               Temporary node
EXOPCL DESCR   0,0,0               Operator node
EXOPCL$4 EQU   EXOPCL+4                                   ISREDIT
EXOPND DESCR   0,0,0               Operator node
EXPRND DESCR   0,0,0               Expression node
FGOND  DESCR   0,0,0               Failure goto node
FORMND DESCR   0,0,0               Object node
FRNCL  DESCR   0,0,0               Failure return descriptor
GOTOND DESCR   0,0,0               Goto node
PATND  DESCR   0,0,0               Pattern node
SGOND  DESCR   0,0,0               Success goto node
SUBJND DESCR   0,0,0               Subject node
*
*
*      Data Pointers
*
DFLFST DESCR   0,0,0               Default output format
ENDPTR DESCR   0,0,0               'END'
EXTPTR DESCR   0,0,0               'EXTERNAL'
FRETCL DESCR   0,0,0               'FRETURN'
NRETCL DESCR   0,0,0               'NRETURN'
RETCL  DESCR   0,0,0               'RETURN'
FUNTCL DESCR   0,0,0               'FUNCTION'
*
*
*      Specifiers
*
DPSP   SPEC    0,0,0,0,0           Data type specifier
HEADSP SPEC    0,0,0,0,0           Matching head specifier
IOSP   SPEC    0,0,0,0,0           I/O specifier
TAILSP SPEC    0,0,0,0,0           Matching tail specifier
TEXTSP SPEC    0,0,0,0,0           Compiler statement specifier
TSP    SPEC    0,0,0,0,0           Scratch specifier
TXSP   SPEC    0,0,0,0,0           Scratch specifier
VSP    SPEC    0,0,0,0,0           Scratch specifier
XSP    SPEC    0,0,0,0,0           Scratch specifier
YSP    SPEC    0,0,0,0,0           Scratch specifier
YSP$4    EQU   YSP+4                                      ISREDIT
ZSP    SPEC    0,0,0,0,0           Scratch specifier
*
*      ALLOCATOR DATA
*
ARG1CL DESCR   0,0,0               SCRATCH DESCRIPTOR
ARG1CL$1 EQU   ARG1CL+1                                   ISREDIT
ARG1CL$5 EQU   ARG1CL+5                                   ISREDIT
BUKPTR DESCR   0,PTR,S             BIN POINTER
LSTPTR DESCR   0,PTR,S             POINTER TO LAST STRUCTURE
AXPTR  DESCR   0,0,0               ALLOCATION SIZE DESCRIPTOR
AXPTR$1  EQU   AXPTR+1                                    ISREDIT
SPECR1 SPEC    0,0,0,0,0           SCRATCH SPECIFIER
SPECR2 SPEC    0,0,0,0,0           SCRATCH SPECIFIER
ICLEND LHERE   ,                   END OF BASIC BLOCK
*
*      ALLOCATOR DATA
*
BK1CL  DESCR   0,0,0               POINTER TO BLOCK BEING MARKED
BK1CL$4  EQU   BK1CL+4                                    ISREDIT
BK1CL$5  EQU   BK1CL+5                                    ISREDIT
BKDX   DESCR   0,0,0               OFFSET IN BLOCK BEING MARKED
BKDX$1   EQU   BKDX+1                                     ISREDIT
BKDXU  DESCR   0,0,0               OFFSET IN BLOCK
BKLTCL DESCR   0,0,0
BKPTR  DESCR   0,PTR,S
BLOCL  DESCR   0,0,0
BLOCL$1  EQU   BLOCL+1                                    ISREDIT
BLOCL$5  EQU   BLOCL+5                                    ISREDIT
CONVSW DESCR   0,0,0               CONVAR-GENVAR ENTRY SWITCH
CPYCL  DESCR   0,0,0               REGENERATION BLOCK POINTER
DESCL  DESCR   0,0,0               REGENERATION SCRATCH DESCRIPTOR
DESCL$4  EQU   DESCL+4                                    ISREDIT
EQUVCL DESCR   0,0,0               VARIABLE IDENTIFICATION DESCRIPTOR
EQUVCL$4 EQU   EQUVCL+4                                   ISREDIT
FRDSCL DESCR   4*DESCR,0,0
GCBLK  DESCR   GCXTTL,0,0          POINTER TO MARKING BLOCK
GCNO   DESCR   0,0,0               COUNT OF REGENERATIONS
GCMPTR DESCR   0,0,0               POINTER TO BASIC BLOCKS
GCREQ  DESCR   0,0,0               SPACE REQUIRED FROM REGENERATION
GCGOT  DESCR   0,0,I               SPACE OBTAINED FROM REGENERATION
GCGOT$4  EQU   GCGOT+4                                    ISREDIT
LCPTR  DESCR   0,0,0               SCRATCH DESCRIPTOR
LCPTR$5  EQU   LCPTR+5                                   ISREDIT
MVSGPT DESCR   0,0,0               COMPRESSION BOUNDARY POINTER
NODPCL DESCR   0,0,0               REGENERATION SWITCH
NODPCL$4 EQU   NODPCL+4                                   ISREDIT
       ORG     NODPCL$4
       B       S4$0+X'518'
*      DC      X'47F09518'
OBPTR  DESCR   OBLIST,PTR,S        POINTER TO BINS
OFSET  DESCR   0,0,0               OFFSET IN BLOCK DURING REGENERATION
PRMDX  DESCR   PRMSIZ,0,0          SIZE OF BASIC BLOCK LIST
PRMPTR DESCR   PRMTBL,0,0          POINTER TO LIST OF BASIC BLOCKS
ST1PTR DESCR   0,PTR,S             REGENERATION LINK POINTER
ST2PTR DESCR   0,PTR,S             REGENERATION LINK POINTER
TEMPCL DESCR   0,PTR,0             SCRACTH DESCRIPTOR
TOPCL  DESCR   0,0,0               POINTER TO BLOCK TITLE
TTLCL  DESCR   0,0,0               POINTER TO BLOCK TITLE
TWOCL  DESCR   2*DESCR,0,B         SIZE OF STRING TO BE MARKED
*
*
FRSGPT DESCR   0,PTR,0             POSITION POINTER
FRSGPT$4 EQU   FRSGPT+4                                   ISREDIT
HDSGPT DESCR   0,PTR,0             HEAD OF ALLOCATED DATA REGION
TLSGP1 DESCR   0,PTR,0             END OF ALLOCATED DATA REGION
GCXTTL DESCR   GCXTTL,TTL+MARK,DESCR
*                                  BLOCK TO PRIME MARKING PROCEDURE
       DESCR   0,0,0               POINTER TO BLOCK TO MARK
*
*      Machine-dependent Data
*
*      COPY    MDATA               Segment of machine-dependent data
MAXTIM   DC    X'7FFFFFFF'               . 00DDA0 7FFFFFFF
SIGRESET DC    X'36000000'               . 00DDA4 36000000
HEX0C4   DC    X'0C0C0C0C'               . 00DDA8 0C0C0C0C
HEX044   DC    X'04040404'               . 00DDAC 04040404
HEX084   DC    X'08080808'               . 00DDB0 08080808
HEX04    DC    X'00000004'               . 00DDB4 00000004
HEX08    DC    X'00000008'               . 00DDB8 00000008
HEX0C    DC    X'0000000C'               . 00DDBC 0000000C
AISAVE   DC    X'0000000000000000'       . 00DDC0 0000000000000000
         DC    X'0000000000000000'       . 00DDC8 0000000000000000
         DC    X'00000000A440D202'       . 00DDD0 00000000A440D202
REALB    DC    X'4E000000'               . 00DDD8 4E000000
REALB$4  DC    X'00000000'               . 00DDDC 00000000
REALBB   DC    X'4E000000'               . 00DDE0 4E000000
REALBB$4 DC    X'00000000'               . 00DDE4 00000000
BIG2     DC    X'4E000000'               . 00DDE8 4E000000
BIG2$4   DC    X'80000000'               . 00DDEC 80000000
BIGZIP   DC    X'4E00000000000000'       . 00DDF0 4E00000000000000
MAXINT   DC    X'487FFFFFFF000000'       . 00DDF8 487FFFFFFF000000
AMPST    DC    X'50'                     . 00DE00 50
COLSTR   DC    C': '                     . 00DE01 7A40
QTSTR    DC    X'7D'                     . 00DE03 7D
SEMSTR   DC    X'5E000000'               . 00DE04 5E000000
SAVESAVE DC    XL72'0'                   . 00DE08 0000000000000000
SAVE13   DC    X'00000000'               . 00DE50 00000000
GARBAGE  DC    X'98BED068'               . 00DE54 98BED068
*
*
*     BEGIN CONDITINAL LTORG
      AGO   .NOLTORG      *** changeable via ISPF ***
.NOLTORG  ANOP
@@D0     DC    X'0000000000000000'       . 00DE58 0000000000000000
@@SAVSAV DC    A(SAVESAVE)               . 00DE60 0000DE08
@@IBCOM# DC    A(IBCOM#)                 . 00DE64 00000000
@@STINT  DC    A(STINT)                  . 00DE68 00000000
@@STACKB DC    A(STACK@B)                . 00DE6C 00011AF0
@@F26    DC    X'0000001A'               . 00DE70 0000001A
@@F1000  DC    X'000003E8'               . 00DE74 000003E8
@@STACKT DC    A(STACK@T)                . 00DE78 00013A30
@@BLOCK  DC    A(BLOCK)                  . 00DE7C 00000960
@@GENVAR DC    A(GENVAR)                 . 00DE80 00000A0E
@@5MDESC DC    X'00000028'               . 00DE84 00000028
@@STPRNT DC    A(STPRNT)                 . 00DE88 00000000
@@STREAD DC    A(STREAD)                 . 00DE8C 00000000
@@STREAM DC    A(STREAM)                 . 00DE90 00000000
@@CARDTB DC    A(CARDTB)                 . 00DE94 00000000
@@NEWCRD DC    A(NEWCRD)                 . 00DE98 00002ADE
@@CMPILE DC    A(CMPILE)                 . 00DE9C 00001496
@@IBLKTB DC    A(IBLKTB)                 . 00DEA0 00000000
@@LBLTB  DC    A(LBLTB)                  . 00DEA4 00000000
@@SPLIT  DC    A(SPLIT)                  . 00DEA8 00001352
@@INTERP DC    A(INTERP)                 . 00DEAC 00003136
@@3MDESC DC    X'00000018'               . 00DEB0 00000018
@@MOVTST DC    A(MOVTST)                 . 00DEB4 00000000
@@CODSKP DC    A(CODSKP)                 . 00DEB8 00000614
@@REALST DC    A(REALST)                 . 00DEBC 00000000
@@APDSP  DC    A(APDSP)                  . 00DEC0 00000000
@@BDSPEC DC    A(BDSPEC)                 . 00DEC4 00000000
@@AUGATL DC    A(AUGATL)                 . 00DEC8 00000532
@@DESCR  DC    X'00000008'               . 00DECC 00000008
@@GC     DC    A(GC)                     . 00DED0 00000D6C
@@F4     DC    X'00000004'               . 00DED4 00000004
@@8P1    DC    X'00000009'               . 00DED8 00000009
@@FRWDTB DC    A(FRWDTB)                 . 00DEDC 00000000
@@SPECEQ DC    A(SPECEQ)                 . 00DEE0 00000000
@@GCM    DC    A(GCM)                    . 00DEE4 00001262
@@OBLOCK DC    A(OBLOCK)                 . 00DEE8 0000F3E8
@@3YDESC DC    X'00000018'               . 00DEEC 00000018
@@FORBLK DC    A(FORBLK)                 . 00DEF0 00002ABC
@@BIOPTB DC    A(BIOPTB)                 . 00DEF4 00000000
@@FORWRD DC    A(FORWRD)                 . 00DEF8 00002A08
@@ILLBIN DC    A(ILLBIN)                 . 00DEFC 00014088
@@ILLEOS DC    A(ILLEOS)                 . 00DF00 000140B8
@@ELEMNT DC    A(ELEMNT)                 . 00DF04 00001F96
@@TREPUB DC    A(TREPUB)                 . 00DF08 00002D1C
@@EXPR   DC    A(EXPR)                   . 00DF0C 00002698
@@GOTOTB DC    A(GOTOTB)                 . 00DF10 00000000
@@F3     DC    X'00000003'               . 00DF14 00000003
@@F7     DC    X'00000007'               . 00DF18 00000007
@@EMSG1  DC    A(EMSG1)                  . 00DF1C 00014038
@@EMSG2  DC    A(EMSG2)                  . 00DF20 00014048
@@EMSG3  DC    A(EMSG3)                  . 00DF24 00014058
@@ILLBRK DC    A(ILLBRK)                 . 00DF28 00014098
@@EMSG14 DC    A(EMSG14)                 . 00DF2C 00014068
@@EOSTB  DC    A(EOSTB)                  . 00DF30 00000000
@@UNOP   DC    A(UNOP)                   . 00DF34 00002E68
@@ELEMTB DC    A(ELEMTB)                 . 00DF38 00000000
@@DECBIN DC    A(DECBIN)                 . 00DF3C 00000000
@@SPREAL DC    A(SPREAL)                 . 00DF40 00000000
@@FINDEX DC    A(FINDEX)                 . 00DF44 0000086C
@@ILCHAR DC    A(ILCHAR)                 . 00DF48 00014078
@@OPNLIT DC    A(OPNLIT)                 . 00DF4C 000140D8
@@ILLINT DC    A(ILLINT)                 . 00DF50 000140C8
@@ILLDEC DC    A(ILLDEC)                 . 00DF54 000140A8
@@BINOP  DC    A(BINOP)                  . 00DF58 000013D0
@@LBLXTB DC    A(LBLXTB)                 . 00DF5C 00000000
@@UNOPTB DC    A(UNOPTB)                 . 00DF60 00000000
@@ARGVAL DC    A(ARGVAL)                 . 00DF64 0000322A
@@TRPHND DC    A(TRPHND)                 . 00DF68 00009E1C
@@INVOKE DC    A(INVOKE)                 . 00DF6C 00003204
@@PUTIN  DC    A(PUTIN)                  . 00DF70 00009384
@@16M4   DC    X'00000040'               . 00DF74 00000040
@@6XDESC DC    X'00000030'               . 00DF78 00000030
@@4M16   DC    X'00000040'               . 00DF7C 00000040
@@EXPVAL DC    A(EXPVAL)                 . 00DF80 000032FA
@@CONVE  DC    A(CONVE)                  . 00DF84 0000B646
@@ADD    DC    A(ADD)                    . 00DF88 00003B4A
@@XYARGS DC    A(XYARGS)                 . 00DF8C 00003A1C
@@F1     DC    X'00000001'               . 00DF90 00000001
@@EXREAL DC    A(EXREAL)                 . 00DF94 00000000
@@ANY    DC    A(ANY)                    . 00DF98 000042FA
@@GNVARI DC    A(GNVARI)                 . 00DF9C 00000C48
@@PATVAL DC    A(PATVAL)                 . 00DFA0 000037B6
@@COPL   DC    A(COPL)                   . 00DFA4 00000000
@@NAM    DC    A(NAM)                    . 00DFA8 00004798
@@LVAL   DC    A(LVAL)                   . 00DFAC 00000000
@@SCNR   DC    A(SCNR)                   . 00DFB0 000057CE
@@NMD    DC    A(NMD)                    . 00DFB4 0000AB2C
@@16X2   DC    X'00000020'               . 00DFB8 00000020
@@CONVAR DC    A(CONVAR)                 . 00DFBC 00000C6C
@@GNVARS DC    A(GNVARS)                 . 00DFC0 00000D2C
@@PUTOUT DC    A(PUTOUT)                 . 00DFC4 00009490
@@SNABTB DC    A(SNABTB)                 . 00DFC8 00000000
@@SCOK   DC    A(SCOK)                   . 00DFCC 000059F2
@@ANYC   DC    A(ANYC)                   . 00DFD0 00005A68
@@SALT   DC    A(SALT)                   . 00DFD4 00005990
@@LNTH   DC    A(LNTH)                   . 00DFD8 00005E7E
@@ARBN   DC    A(ARBN)                   . 00DFDC 000060BC
@@6MDESC DC    X'00000030'               . 00DFE0 00000030
@@SALF   DC    A(SALF)                   . 00DFE4 00005984
@@5XDESC DC    X'00000028'               . 00DFE8 00000028
@@EXPEVL DC    A(EXPEVL)                 . 00DFEC 000035BA
@@GBAL   DC    A(GBAL)                   . 00DFF0 00000000
@@BAL    DC    A(BAL)                    . 00DFF4 00006458
@@CHR    DC    A(CHR)                    . 00DFF8 000064F4
@@SCIN   DC    A(SCIN)                   . 00DFFC 000058E8
@@UNSC   DC    A(UNSC)                   . 00E000 00005A58
@@NME    DC    A(NME)                    . 00E004 0000686E
@@3XDESC DC    X'00000018'               . 00E008 00000018
@@SUCE   DC    A(SUCE)                   . 00E00C 00006D2C
@@VARVAL DC    A(VARVAL)                 . 00E010 0000393E
@@VARATB DC    A(VARATB)                 . 00E014 00000000
@@2M16   DC    X'00000020'               . 00E018 00000020
@@FENTR2 DC    A(FENTR2)                 . 00E01C 00009C0E
@@FNEXT2 DC    A(FNEXT2)                 . 00E020 0000A284
@@LOADER DC    A(LOADER)                 . 00E024 00000000
@@UNLODR DC    A(UNLOADER)               . 00E028 00000000
@@TEN    DC    X'00000010'               . 00E02C 00000010
@@LINKER DC    A(LINKER)                 . 00E030 00000000
@@NUMBTB DC    A(NUMBTB)                 . 00E034 00000000
@@INTVAL DC    A(INTVAL)                 . 00E038 000036A4
@@EXTSIZ DC    X'0000000A'               . 00E03C 0000000A
@@IND    DC    A(IND)                    . 00E040 0000A9A2
@@UNITI  DC    X'00000005'               . 00E044 00000005
@@UNIT0  DC    X'00000006'               . 00E048 00000006
@@BKSPCE DC    A(BKSPCE)                 . 00E04C 0000923C
@@DTREP  DC    A(DTREP)                  . 00E050 000006A8
@@TRACE  DC    A(TRACE)                  . 00E054 00009542
@@DESCR7 DC    X'00000038'               . 00E058 00000038
@@TRACEP DC    A(TRACEP)                 . 00E05C 00009662
@@STOPTR DC    A(STOPTR)                 . 00E060 00009828
@@STOPTP DC    A(STOPTP)                 . 00E064 000098CA
@@ARGINT DC    A(ARGINT)                 . 00E068 0000B012
@@FENTR  DC    A(FENTR)                  . 00E06C 00009958
@@KEYT   DC    A(KEYT)                   . 00E070 0000AAB2
@@KEYTR  DC    A(KEYTR)                  . 00E074 00009C44
@@K7M8R  DC    X'00000038'               . 00E078 00000038
@@VALTR  DC    A(VALTR)                  . 00E07C 00009F44
@@KEYWRD DC    A(KEYWRD)                 . 00E080 0000A9FE
@@COMPLG DC    A(COMPLG)                 . 00E084 00000000
@@ARG    DC    A(ARG)                    . 00E088 0000AFF2
@@CNVRT  DC    A(CNVRT)                  . 00E08C 0000B378
@@@2     DC    X'00000002'               . 00E090 00000002
@@@SPEC  DC    X'00000020'               . 00E094 00000020
@@DATER  DC    A(DATER)                  . 00E098 00000000
@@DMP    DC    A(DMP)                    . 00E09C 0000BC08
@@RPLCE  DC    A(RPLCE)                  . 00E0A0 00000000
@@LSTDMP DC    V(LASTDUMP)               . 00E0A4 00000000
@@DUMP   DC    A(DUMP)                   . 00E0A8 0000BC34
@@DMK    DC    A(DMK)                    . 00E0AC 0000BDEC
@@SPICTF DC    A(SPIECUTF)               . 00E0B0 00000000
@@XFFF   DC    X'00000FFF'               . 00E0B4 00000FFF
@@FINIS  DC    A(FINIS)                  . 00E0B8 00000000
@@B      DC    X'000002'                 . 00E0BC 000002
@@A      DC    X'000004'                 . 00E0BF 000004
@@T      DC    X'000005'                 . 00E0C2 000005
@@R      DC    X'000007'                 . 00E0C5 000007
@@0      DC    X'000000'                 . 00E0C8 000000
@@S      DC    X'000001'                 . 00E0CB 000001
@@C      DC    X'000008'                 . 00E0CE 000008
@@E      DC    X'00000B'                 . 00E0D1 00000B
@@I      DC    X'000006'                 . 00E0D4 000006
@@P      DC    X'000003'                 . 00E0D7 000003
@@K      DC    X'00000A'                 . 00E0DA 00000A
@@N      DC    X'000009'                 . 00E0DD 000009
@@L      DC    X'00000C'                 . 00E0E0 00000C
@@DATSIZ DC    X'0003E8'                 . 00E0E3 0003E8
@@2      DC    X'00000200'               . 00E0E6 00000200
      AGO .LTORGX
.LTORG  ANOP
      LTORG
.LTORGX   ANOP
*     END CONDITIONAL LTORG
*
*      Function Table
*
       NOPR    0
       NOPR    0
       NOPR    0
FTABLE DESCR   FTABLE,TTL+MARK,FTBLND-FTABLE-DESCR
*
*      PRIMITIVE FUNCTIONS
*
ANYFN  DESCR   ANY,0,1
       DESCR   0,0,0
APLYFN DESCR   APPLY,FNC,1
       DESCR   0,0,0
ARBOFN DESCR   ARBNO,0,1
       DESCR   0,0,0
ARGFN  DESCR   ARG,0,2
       DESCR   0,0,0
ARRAFN DESCR   ARRAY,0,2
       DESCR   0,0,0
ASSCFN DESCR   ASSOC,0,2
       DESCR   0,0,0
BACKFN DESCR   BKSPCE,0,1
       DESCR   0,0,0
BREAFN DESCR   BREAK,0,1
       DESCR   0,0,0
CLEAFN DESCR   CLEAR,0,1
       DESCR   0,0,0
CODEFN DESCR   CODER,0,1
       DESCR   0,0,0
COLEFN DESCR   COLECT,0,1
       DESCR   0,0,0
CNVRFN DESCR   CNVRT,0,2
       DESCR   0,0,0
COPYFN DESCR   COPY,0,1
       DESCR   0,0,0
DATFN  DESCR   DATE,0,1
       DESCR   0,0,0
DATDFN DESCR   DATDEF,0,1
       DESCR   0,0,0
DEFIFN DESCR   DEFINE,0,2
       DESCR   0,0,0
DIFFFN DESCR   DIFFER,0,2
       DESCR   0,0,0
DTCHFN DESCR   DETACH,0,1
       DESCR   0,0,0
DTFN   DESCR   DT,0,1
       DESCR   0,0,0
DUMPFN DESCR   DMP,0,1
       DESCR   0,0,0
DUPLFN DESCR   DUPL,0,2
       DESCR   0,0,0
ENDFFN DESCR   ENFILE,0,1
       DESCR   0,0,0
EQFN   DESCR   EQ,0,2
       DESCR   0,0,0
EVALFN DESCR   EVAL,0,1
       DESCR   0,0,0
FLDSFN DESCR   FIELDS,0,2
       DESCR   0,0,0
GEFN   DESCR   GE,0,2
       DESCR   0,0,0
GTFN   DESCR   GT,0,2
       DESCR   0,0,0
IDENFN DESCR   IDENT,0,2
       DESCR   0,0,0
INTGFN DESCR   INTGER,0,1
       DESCR   0,0,0
ITEMFN DESCR   ITEM,FNC,1
       DESCR   0,0,0
LEFN   DESCR   LE,0,2
       DESCR   0,0,0
LENFN  DESCR   LEN,0,1
       DESCR   0,0,0
LGTFN  DESCR   LGT,0,2
       DESCR   0,0,0
LOADFN DESCR   LOAD,0,2
       DESCR   0,0,0
LOCFN  DESCR   LOCAL,0,2
       DESCR   0,0,0
LTFN   DESCR   LT,0,2
       DESCR   0,0,0
NEFN   DESCR   NE,0,2
       DESCR   0,0,0
NOTAFN DESCR   NOTANY,0,1
       DESCR   0,0,0
OPSYFN DESCR   OPSYN,0,3
       DESCR   0,0,0
POSFN  DESCR   POS,0,1
       DESCR   0,0,0
PRINFN DESCR   PRINT,0,3
       DESCR   0,0,0
PROTFN DESCR   PROTO,0,1
       DESCR   0,0,0
REMDFN DESCR   REMDR,0,2
       DESCR   0,0,0
RPLAFN DESCR   RPLACE,0,3
       DESCR   0,0,0
READFN DESCR   READ,0,3
       DESCR   0,0,0
REWNFN DESCR   REWIND,0,1
       DESCR   0,0,0
RPOSFN DESCR   RPOS,0,1
       DESCR   0,0,0
RTABFN DESCR   RTAB,0,1
       DESCR   0,0,0
SIZEFN DESCR   SIZE,0,1
       DESCR   0,0,0
SPANFN DESCR   SPAN,0,1
       DESCR   0,0,0
STPTFN DESCR   STOPTR,0,2
       DESCR   0,0,0
TABFN  DESCR   TAB,0,1
       DESCR   0,0,0
TIMFN  DESCR   TIME,0,1
       DESCR   0,0,0
TRCEFN DESCR   TRACE,0,4
       DESCR   0,0,0
TRIMFN DESCR   TRIM,0,1
       DESCR   0,0,0
UNLDFN DESCR   UNLOAD,0,1
       DESCR   0,0,0
VALFN  DESCR   FIELD,0,1
       DESCR   VALBLK,0,0
FTBLND LHERE   ,
*
INITLS DESCR   INITLS,TTL+MARK,8*DESCR
       DESCR   DTLIST,0,0
       DESCR   FNLIST,0,0
       DESCR   INLIST,0,0
       DESCR   KNLIST,0,0
       DESCR   KVLIST,0,0
       DESCR   OTLIST,0,0
       DESCR   OTSATL,0,0
       DESCR   TRLIST,0,0
*
*      FUNCTION PAIR LIST
*
FNLIST DESCR   FNLIST,TTL+MARK,FNCPLE-FNLIST-DESCR
       DESCR   ANYFN,FNC,0         ANY(CS)
       DESCR   ANYSP,0,0
       DESCR   APLYFN,FNC,0        APPLY(F,A1,...,AN)
       DESCR   APLYSP,0,0
       DESCR   ARBOFN,FNC,0        ARBNO(P)
       DESCR   ARBNSP,0,0
       DESCR   ARGFN,FNC,0         ARG(F,N)
       DESCR   ARGSP,0,0
       DESCR   ARRAFN,FNC,0        ARRAY(P,V)
       DESCR   ARRSP,0,0
       DESCR   BACKFN,FNC,0        BACKSPACE(N)
       DESCR   BACKSP,0,0
       DESCR   BREAFN,FNC,0        BREAK(CS)
       DESCR   BRKSP,0,0
       DESCR   CLEAFN,FNC,0        CLEAR()
       DESCR   CLERSP,0,0
       DESCR   CODEFN,FNC,0        CODE(S)
       DESCR   CODESP,0,0
       DESCR   COLEFN,FNC,0        COLLECT(N)
       DESCR   CLSP,0,0
       DESCR   CNVRFN,FNC,0        CONVERT(V,DT)
       DESCR   CNVTSP,0,0
       DESCR   COPYFN,FNC,0        COPY(V)
       DESCR   COPYSP,0,0
       DESCR   DATDFN,FNC,0        DATA(P)
       DESCR   DATASP,0,0
       DESCR   DATFN,FNC,0         DATE()                       E3.0.5
       DESCR   DATSP,0,0
       DESCR   DEFIFN,FNC,0        DEFINE(P,L)
       DESCR   DEFISP,0,0
       DESCR   DIFFFN,FNC,0        DIFFER(V1,V2)
       DESCR   DIFFSP,0,0
       DESCR   DTCHFN,FNC,0        DETACH(V)
       DESCR   DTCHSP,0,0
       DESCR   DTFN,FNC,0          DATATYPE(V)
       DESCR   DTSP,0,0
       DESCR   DUMPFN,FNC,0        DUMP()
       DESCR   DUMPSP,0,0
       DESCR   DUPLFN,FNC,0        DUPL(S,N)
       DESCR   DUPLSP,0,0
       DESCR   ENDFFN,FNC,0        ENDFILE(N)
       DESCR   ENDFSP,0,0
       DESCR   EQFN,FNC,0          EQ(I1,I2)
       DESCR   EQSP,0,0
       DESCR   EVALFN,FNC,0        EVAL(E)
       DESCR   EVALSP,0,0
       DESCR   FLDSFN,FNC,0        FIELD(V,N)
       DESCR   FLDSSP,0,0
       DESCR   GEFN,FNC,0          GE(I1,I2)
       DESCR   GESP,0,0
       DESCR   GTFN,FNC,0          GT(I1,I2)
       DESCR   GTSP,0,0
       DESCR   IDENFN,FNC,0        IDENT(V1,V2)
       DESCR   IDENSP,0,0
       DESCR   READFN,FNC,0        INPUT(V,N,L)
       DESCR   INSP,0,0
       DESCR   INTGFN,FNC,0        INTEGER(V)
       DESCR   INTGSP,0,0
       DESCR   ITEMFN,FNC,0        ITEM(A,I1,...,IN)
       DESCR   ITEMSP,0,0
       DESCR   LENFN,FNC,0         LEN(N)
       DESCR   LENSP,0,0
       DESCR   LEFN,FNC,0          LE(I1,I2)
       DESCR   LESP,0,0
       DESCR   LGTFN,FNC,0         LGT(S1,S2)
       DESCR   LGTSP,0,0
       DESCR   LOADFN,FNC,0        LOAD(P)
       DESCR   LOADSP,0,0
       DESCR   LOCFN,FNC,0         LOCAL(F,N)
       DESCR   LOCSP,0,0
       DESCR   LTFN,FNC,0          LT(I1,I2)
       DESCR   LTSP,0,0
       DESCR   NEFN,FNC,0          NE(I1,I2)
       DESCR   NESP,0,0
       DESCR   NOTAFN,FNC,0        NOTANY(CS)
       DESCR   NNYSP,0,0
       DESCR   OPSYFN,FNC,0        OPSYN(F1,F2,N)
       DESCR   OPSNSP,0,0
       DESCR   PRINFN,FNC,0        OUTPUT(V,N,F)
       DESCR   OUTSP,0,0
       DESCR   POSFN,FNC,0         POS(N)
       DESCR   POSSP,0,0
       DESCR   PROTFN,FNC,0        PROTOTYPE(A)
       DESCR   PRTSP,0,0
       DESCR   REMDFN,FNC,0        REMDR(N,M)
       DESCR   REMDSP,0,0
       DESCR   REWNFN,FNC,0        REWIND(N)
       DESCR   REWNSP,0,0
       DESCR   RPLAFN,FNC,0        REPLACE(S,CS1,CS2)
       DESCR   RPLCSP,0,0
       DESCR   RPOSFN,FNC,0        RPOS(N)
       DESCR   RPOSSP,0,0
       DESCR   RTABFN,FNC,0        RTAB(N)
       DESCR   RTABSP,0,0
       DESCR   SIZEFN,FNC,0        SIZE(S)
       DESCR   SIZESP,0,0
       DESCR   SPANFN,FNC,0        SPAN(CS)
       DESCR   SPANSP,0,0
       DESCR   STPTFN,FNC,0        STOPTR(V,R)
       DESCR   STPTSP,0,0
       DESCR   TABFN,FNC,0         TAB(N)
       DESCR   TABSP,0,0
       DESCR   ASSCFN,FNC,0        TABLE(N,M)
       DESCR   ASSCSP,0,0
       DESCR   TIMFN,FNC,0         TIME()
       DESCR   TIMSP,0,0
       DESCR   TRCEFN,FNC,0        TRACE(V,R,T,F)
       DESCR   TRCESP,0,0
       DESCR   TRIMFN,FNC,0        TRIM(S)
       DESCR   TRMSP,0,0
       DESCR   UNLDFN,FNC,0        UNLOAD(S)
       DESCR   UNLDSP,0,0
       DESCR   VALFN,FNC,0         VALUE(S)
       DESCR   VALSP,0,0
       ARRAY   10*2                SPACE FOR 10 MORE FUNCTIONS
FNCPLE LHERE   ,                   END OF FUNCTION PAIR LIST
OPTBL  DESCR   OPTBL,TTL+MARK,OPTBND-OPTBL-DESCR
ADDFN  DESCR   ADD,0,2             X + Y    ADDITION
       DESCR   0,0,0
       DESCR   30,0,29
BIAMFN DESCR   UNDF,FNC,0          X & Y    DEFINABLE
       DESCR   0,0,0
       DESCR   5,0,4
BIATFN DESCR   UNDF,FNC,0          X @ Y    DEFINABLE
       DESCR   0,0,0
       DESCR   25,0,24
BINGFN DESCR   UNDF,FNC,0          X ¬ Y    DEFINABLE
       DESCR   0,0,0
       DESCR   70,0,70
BIPDFN DESCR   UNDF,FNC,0          X # Y    DEFINABLE
       DESCR   0,0,0
       DESCR   35,0,34
BIPRFN DESCR   UNDF,FNC,0          X % Y    DEFINABLE
       DESCR   0,0,0
       DESCR   45,0,44
BIQSFN DESCR   UNDF,FNC,0          X ? Y    DEFINABLE
       DESCR   0,0,0
       DESCR   70,0,69
CONFN  DESCR   CON,0,2             X   Y    CONCATENATION
       DESCR   0,0,0
       DESCR   20,0,19
DIVFN  DESCR   DIV,0,2             X / Y    DIVISION
       DESCR   0,0,0
       DESCR   40,0,39
DOLFN  DESCR   DOL,0,2             X $ Y    IMMEDIATE NAMING
       DESCR   0,0,0
       DESCR   60,0,59
EXPFN  DESCR   EXP,0,2             X ** Y   EXPONENTIATION
       DESCR   0,0,0
       DESCR   50,0,50
MPYFN  DESCR   MPY,0,2             X * Y    MULTIPLICATION
       DESCR   0,0,0
       DESCR   42,0,41
NAMFN  DESCR   NAM,0,2             X . Y    NAMING
       DESCR   0,0,0
       DESCR   60,0,59
ORFN   DESCR   OR,0,2              X | Y    ALTERNATION
       DESCR   0,0,0
       DESCR   10,0,9
SUBFN  DESCR   SUB,0,2             X - Y    SUBTRACTION
       DESCR   0,0,0
       DESCR   30,0,29
AROWFN DESCR   UNDF,FNC,0          !X       DEFINABLE
       DESCR   0,0,0
ATFN   DESCR   ATOP,0,1            @X       SCANNER POSITION
       DESCR   0,0,0
BARFN  DESCR   UNDF,FNC,0          |X       DEFINABLE
       DESCR   0,0,0
DOTFN  DESCR   NAME,0,1            .X       NAME
       DESCR   0,0,0
INDFN  DESCR   IND,0,1             $X       INDIRECT REFERENCE
       DESCR   0,0,0
KEYFN  DESCR   KEYWRD,0,1          &X       KEYWORD
       DESCR   0,0,0
MNSFN  DESCR   MNS,0,1             -X       MINUS
       DESCR   0,0,0
NEGFN  DESCR   NEG,0,1             ¬X       NEGATION
       DESCR   0,0,0
PDFN   DESCR   UNDF,FNC,0          #X       DEFINABLE
       DESCR   0,0,0
PLSFN  DESCR   PLS,0,1             +X       PLUS
       DESCR   0,0,0
PRFN   DESCR   UNDF,FNC,0          %X       DEFINABLE
       DESCR   0,0,0
QUESFN DESCR   QUES,0,1            ?X       INTERROGATION
       DESCR   0,0,0
SLHFN  DESCR   UNDF,FNC,0          /X       DEFINABLE
       DESCR   0,0,0
STRFN  DESCR   STR,0,1             *X       UNEVALUATED EXPRESSION
       DESCR   0,0,0
OPTBND LHERE   ,                   END OF OPERATOR TABLE
*
*
AREFN  DESCR   ITEM,FNC,1          ARRAY OR TABLE REFERENCE
ASGNFN DESCR   ASGN,0,2            X = Y
BASEFN DESCR   BASE,0,0            BASE OBJECT CODE
ENDAFN DESCR   ARGNER,0,0          SAFETY EXIT ON TRACE PSUEDO-CODE
ENDFN  DESCR   END,0,0             END OF PROGRAM
ERORFN DESCR   EROR,0,1            ERRONEOUS STATEMENT
FNTRFN DESCR   FENTR,0,2           CALL TRACING
FXTRFN DESCR   FNEXTR,0,2          RETURN TRACING
GOTGFN DESCR   GOTG,0,1            :<X>
GOTLFN DESCR   GOTL,0,1            :(L)
GOTOFN DESCR   GOTO,0,1            INTERNAL GOTO
INITFN DESCR   INIT,0,1            STATEMENT INITIALIZATION
KEYTFN DESCR   KEYTR,0,2           KEYWORD TRACING
LABTFN DESCR   LABTR,0,2           LABEL TRACING
LITFN  DESCR   LIT,0,1             LITERAL EVALUATION
SCANFN DESCR   SCAN,0,2            PATTERN MATCHING
SJSRFN DESCR   SJSR,0,3            PATTERN MATCHING WITH REPLACEMENT
VLTRFN DESCR   VALTR,0,2           VALUE TRACING
ANYCFN DESCR   ANYC,0,3            MATCHING FOR ANY(S)
ARBFFN DESCR   ARBF,0,2            FAILURE FOR ARB
ARBNFN DESCR   ARBN,0,2            MATCHING FOR ARBNO(P)
ATOPFN DESCR   ATP,0,3             MATCHING FOR @X
CHRFN  DESCR   CHR,0,3             MATCHING FOR STRING
BALFN  DESCR   BAL,0,2             MATCHING FOR BAL
BALFFN DESCR   BALF,0,2            FAILURE FOR BAL
BRKCFN DESCR   BRKC,0,3            MATCHING FOR BREAK(S)
DNMEFN DESCR   DNME,0,2
DNMIFN DESCR   DNME1,0,2
EARBFN DESCR   EARB,0,2
DSARFN DESCR   DSAR,0,3
ENMEFN DESCR   ENME,0,3
ENMIFN DESCR   ENMI,0,3
FARBFN DESCR   FARB,0,2
FNMEFN DESCR   FNME,0,2
LNTHFN DESCR   LNTH,0,3            MATCHING FOR LEN(N)
NMEFN  DESCR   NME,0,2
NNYCFN DESCR   NNYC,0,3            MATCHING FOR NOTANY(S)
ONARFN DESCR   ONAR,0,2
ONRFFN DESCR   ONRF,0,2
POSIFN DESCR   POSI,0,3            MATCHING FOR POS(N)
RPSIFN DESCR   RPSI,0,3            MATCHING FOR RPOS(N)
RTBFN  DESCR   RTB,0,3             MATCHING FOR RTAB(N)
SALFFN DESCR   SALF,0,2
SCFLFN DESCR   FAIL,0,2
SCOKFN DESCR   SCOK,0,2            SUCCESSFUL MATCH PROCEDURE
SCONFN DESCR   SCON,0,2
SPNCFN DESCR   SPNC,0,3            MATCHING FOR SPAN(S)
STARFN DESCR   STAR,0,3            MATCHING FOR *X
TBFN   DESCR   TB,0,3              MATCHING FOR TAB(N)
ABORFN DESCR   RTNUL3,0,3          MATCHING FOR ABORT
FNCEFN DESCR   FNCE,0,2            MATCHING FOR FENCE
FNCFFN DESCR   RTNUL3,0,2          FAILURE FOR FENCE
SUCFFN DESCR   SUCF,0,2            MATCHING FOR SUCCEED
*
*      INITIALIZATION DATA FOR FUNCTIONS
*
ABNDSP STRING  'ABEND'
ABORSP STRING  'ABORT'
ALNMSP STRING  'ALPHABET'
ANCHSP STRING  'ANCHOR'
ANYSP  STRING  'ANY'
APLYSP STRING  'APPLY'
ARBSP  STRING  'ARB'
ARBNSP STRING  'ARBNO'
ARGSP  STRING  'ARG'
BACKSP STRING  'BACKSPACE'
BALSP  STRING  'BAL'
BRKSP  STRING  'BREAK'
TRFRSP STRING  'CALL'
CLERSP STRING  'CLEAR'
CODESP STRING  'CODE'
CLSP   STRING  'COLLECT'
CNVTSP STRING  'CONVERT'
COPYSP STRING  'COPY'
DATSP  STRING  'DATE'
DATASP STRING  'DATA'
DEFISP STRING  'DEFINE'
DIFFSP STRING  'DIFFER'
DTCHSP STRING  'DETACH'
DTSP   STRING  'DATATYPE'
DUMPSP STRING  'DUMP'
DUPLSP STRING  'DUPL'
ENDSP  STRING  'END'
ENDFSP STRING  'ENDFILE'
EQSP   STRING  'EQ'
ERRLSP STRING  'ERRLIMIT'
ERRTSP STRING  'ERRTYPE'
EVALSP STRING  'EVAL'
EXPSP  STRING  'EXPRESSION'
FAILSP STRING  'FAIL'
FNCESP STRING  'FENCE'
FLDSSP STRING  'FIELD'
FNCLSP STRING  'FNCLEVEL'
FRETSP STRING  'FRETURN'
FTRCSP STRING  'FTRACE'
FULLSP STRING  'FULLSCAN'
FUNTSP STRING  'FUNCTION'
GESP   STRING  'GE'
GTSP   STRING  'GT'
IDENSP STRING  'IDENT'
INSP   STRING  'INPUT'
INTGSP STRING  'INTEGER'
ITEMSP STRING  'ITEM'
TRKYSP STRING  'KEYWORD'
TRLASP STRING  'LABEL'
LSTNSP STRING  'LASTNO'
LENSP  STRING  'LEN'
LESP   STRING  'LE'
LGTSP  STRING  'LGT'
LOADSP STRING  'LOAD'
LOCSP  STRING  'LOCAL'
LTSP   STRING  'LT'
MAXLSP STRING  'MAXLNGTH'
NAMESP STRING  'NAME'
NESP   STRING  'NE'
NNYSP  STRING  'NOTANY'
NRETSP STRING  'NRETURN'
OPSNSP STRING  'OPSYN'
OUTSP  STRING  'OUTPUT'
PATSP  STRING  'PATTERN'
POSSP  STRING  'POS'
PRTSP  STRING  'PROTOTYPE'
PNCHSP STRING  'PUNCH'
RLSP   STRING  'REAL'
REMSP  STRING  'REM'
REMDSP STRING  'REMDR'
RETSP  STRING  'RETURN'
REWNSP STRING  'REWIND'
RPLCSP STRING  'REPLACE'
RPOSSP STRING  'RPOS'
RTABSP STRING  'RTAB'
RTYPSP STRING  'RTNTYPE'
SIZESP STRING  'SIZE'
SPANSP STRING  'SPAN'
STCTSP STRING  'STCOUNT'
STFCSP STRING  'STFCOUNT'
STLMSP STRING  'STLIMIT'
STPTSP STRING  'STOPTR'
STNOSP STRING  'STNO'
VARSP  STRING  'STRING'
SUCCSP STRING  'SUCCEED'
TABSP  STRING  'TAB'
TIMSP  STRING  'TIME'
TRCESP STRING  'TRACE'
TRMSP  STRING  'TRIM'
UNLDSP STRING  'UNLOAD'
VALSP  STRING  'VALUE'
*
CRDFSP STRING  '(80A1)'            DEFAULT OUTPUT FORMAT
OUTPSP STRING  '(1X,132A1)'        STANDARD PRINT FORMAT
*
*      POINTERS TO OTHER INITIALIZATION
*
ABNDB  LHERE   ,
       DESCR   ALPHSP,0,0          &ALPHABET
       DESCR   ALPHVL,0,0
       DESCR   CRDFSP,0,0          DEFAULT OUTPUT FORMAT
       DESCR   DFLFST,0,0
       DESCR   EXDTSP,0,0          'EXTERNAL'
       DESCR   EXTPTR,0,0
       DESCR   ENDSP,0,0           'END'
       DESCR   ENDPTR,0,0
       DESCR   FRETSP,0,0          'FRETURN'
       DESCR   FRETCL,0,0
       DESCR   FUNTSP,0,0          'FUNCTION'
       DESCR   FUNTCL,0,0
       DESCR   NRETSP,0,0          'NRETURN'
       DESCR   NRETCL,0,0
       DESCR   RETSP,0,0           'RETURN'
DTEND  DESCR   RETCL,0,0
BUFEXT EQU     DTEND-ANYSP
BUFLEN EQU     BUFEXT*CPA
*
*      SYSTEM ARRAYS
*
PRMTBL DESCR   PRMTBL,TTL+MARK,PRMSIZ
       DESCR   DTLIST,0,0          DATA TYPE PAIR LIST
       DESCR   FNLIST,0,0          FUNCTION PAIR LIST
       DESCR   FTABLE,0,0          PROCEDURE DESCRIPTOR TABLE
       DESCR   ICLBLK,0,0          MISCELLANEOUS DATA
       DESCR   KNLIST,0,0          UNPROTECTED KEYWORD PAIR LIST
       DESCR   KVLIST,0,0          PROTECTED KEYWORD PAIR LIST
       DESCR   OPTBL,0,0           OPERATOR PROCEDURE DESCRIPTORS
       DESCR   STACK,0,0           INTERPRETER STACK
       DESCR   INLIST,0,0          INPUT ASSOCIATION PAIR LIST
       DESCR   OTLIST,0,0          OUTPUT ASSOCIATION PAIR LIST
       DESCR   INSATL,0,0          INPUT BLOCK LIST
       DESCR   OTSATL,0,0          OUTPUT BLOCK LIST
       DESCR   TFENPL,0,0          CALL TRACE PAIR LIST
       DESCR   TFEXPL,0,0          RETURN TRACE PAIR LIST
       DESCR   TKEYPL,0,0          KEYWORD TRACE PAIR LIST
       DESCR   TLABPL,0,0          LABEL TRACE PAIR LIST
       DESCR   TRLIST,0,0          TRACE PAIR LIST
       DESCR   TVALPL,0,0          VALUE TRACE PAIR LIST
PRMTRM LHERE   ,                   END OF BASIC BLOCK LIST
PRMSIZ EQU     PRMTRM-PRMTBL-DESCR SIZE OF BASIC BLOCK LIST
*
*      STRING STORAGE BIN LIST
*
OBLOCK DESCR   OBLOCK,TTL+MARK,OBARY*DESCR
       ARRAY   3                   PSEUDO HEADING
OBSTRT ARRAY   OBSIZ               BIN LIST
OBLIST EQU     OBSTRT-LNKFLD       PSEUDO LINK POINTER
*
*      PATTERN MATCHING HISTORY LIST
*
PDLBLK DESCR   PDLBLK,TTL+MARK,SPDLSZ*DESCR
       ARRAY   SPDLSZ              PATTERN HISTORY LIST
*
*      SYSTEM  STACK
*
STACK  DESCR   STACK,TTL+MARK,STSIZE*DESCR
       ARRAY   STSIZE              INTERPRETER STACK
STACK@B   EQU     STACK-12*DESCR
STACK@T   EQU     STACK-12*DESCR+STSIZE*DESCR
*
*      PRIMITIVE PATTERNS
*
ABORPT DESCR   ABORPT,TTL+MARK,3*DESCR
       DESCR   ABORFN,FNC,2        ABORT
       DESCR   0,0,0
       DESCR   0,0,0
*
ARBAK  DESCR   ARBAK,TTL+MARK,6*DESCR
       DESCR   ONARFN,FNC,2
       DESCR   3*DESCR,0,0
       DESCR   0,0,0
       DESCR   ONRFFN,FNC,2
       DESCR   0,0,0
       DESCR   0,0,0
*
ARBPT  DESCR   ARBPT,TTL+MARK,9*DESCR
       DESCR   SCOKFN,FNC,2        ARB
       DESCR   0,0,3*DESCR
       DESCR   0,0,0
       DESCR   SCOKFN,FNC,2
       DESCR   6*DESCR,0,0
       DESCR   0,0,0
       DESCR   FARBFN,FNC,2
       DESCR   6*DESCR,0,0
       DESCR   0,0,0
*
ARHED  DESCR   ARHED,TTL+MARK,12*DESCR
       DESCR   SCOKFN,FNC,2
       DESCR   0,0,3*DESCR
       DESCR   0,0,0
       DESCR   SCOKFN,FNC,2
       DESCR   6*DESCR,0,0
       DESCR   0,0,0
       DESCR   ARBNFN,FNC,2
       DESCR   9*DESCR,0,12*DESCR
       DESCR   0,0,0
       DESCR   ARBFFN,FNC,2
       DESCR   0,0,0
       DESCR   0,0,0
*
ARTAL  DESCR   ARTAL,TTL+MARK,6*DESCR
       DESCR   EARBFN,FNC,2
       DESCR   0,0,3*DESCR
       DESCR   0,0,0
       DESCR   SCOKFN,FNC,2
       DESCR   6*DESCR,0,0
       DESCR   0,0,0
*
BALPT  DESCR   BALPT,TTL+MARK,9*DESCR
       DESCR   SCOKFN,FNC,2        BAL
       DESCR   0,0,3*DESCR
       DESCR   0,0,0
       DESCR   BALFN,FNC,2
       DESCR   6*DESCR,0,0
       DESCR   0,0,0
       DESCR   BALFFN,FNC,2
       DESCR   6*DESCR,0,0
       DESCR   0,0,0
*
FAILPT DESCR   FAILPT,TTL+MARK,3*DESCR
       DESCR   SALFFN,FNC,2        FAIL
       DESCR   0,0,0
       DESCR   0,0,0
*
FNCEPT DESCR   FNCEPT,TTL+MARK,3*DESCR
       DESCR   FNCEFN,FNC,2        FENCE
       DESCR   0,0,0
       DESCR   0,0,0
*
REMPT  DESCR   REMPT,TTL+MARK,4*DESCR
       DESCR   RTBFN,FNC,3         REM
       DESCR   0,0,0
       DESCR   0,0,0
       DESCR   0,0,I
*
STARPT DESCR   STARPT,TTL+MARK,11*DESCR
       DESCR   STARFN,FNC,3
       DESCR   0,0,4*DESCR
       DESCR   1,0,0
       DESCR   0,0,0
       DESCR   SCOKFN,FNC,2
       DESCR   7*DESCR,0,0
       DESCR   0,0,0
       DESCR   DSARFN,FNC,3
       DESCR   0,0,4*DESCR
       DESCR   0,0,0
       DESCR   0,0,0
*
SUCCPT DESCR   SUCCPT,TTL+MARK,3*DESCR
       DESCR   SUCFFN,FNC,2        SUCCEED
       DESCR   0,0,0
       DESCR   0,0,0
*
*      CODE SKELETON FOR TRACE
*
TRCBLK DESCR   TRCBLK,TTL+MARK,6*DESCR
       DESCR   0,FNC,2             TRACE FUNCTION DESCRIPTOR
       DESCR   DOTFN,FNC,1         LITERAL FUNCTION DESCRIPTOR
       DESCR   0,0,0               VARIABLE TO BE TRACED
       DESCR   DOTFN,FNC,1         LITERAL FUNCTION DESCRIPTOR
       DESCR   0,0,0               TAG SUPPLIED FOR TRACE
       DESCR   ENDAFN,FNC,0        ERROR FUNCTION FOR SAFETY
*
TVALPL DESCR   TVALPL,TTL+MARK,2*DESCR
       DESCR   0,0,0               VALUE TRACE
       DESCR   0,0,0
TLABPL DESCR   TLABPL,TTL+MARK,2*DESCR
       DESCR   0,0,0               LABEL TRACE
       DESCR   0,0,0
TFENPL DESCR   TFENPL,TTL+MARK,2*DESCR
       DESCR   0,0,0               CALL TRACE
       DESCR   0,0,0
TFEXPL DESCR   TFEXPL,TTL+MARK,2*DESCR
       DESCR   0,0,0               RETURN TRACE
       DESCR   0,0,0
TKEYPL DESCR   TKEYPL,TTL+MARK,2*DESCR
       DESCR   0,0,0               KEYWORD TRACE
       DESCR   0,0,0
*
VALBLK DESCR   VALBLK,TTL+MARK,6*DESCR
       DESCR   0,0,S               STRING
       DESCR   0,0,0               0 OFFSET
       DESCR   0,0,N               NAME
       DESCR   0,0,0               0 OFFSET
       DESCR   0,0,K               KEYWORD (NAME)
       DESCR   0,0,0               0 OFFSET
*
*      Fatal Error messages
*
MSGLST  DC     X'00000000'               . 013E00 00000000
          DC   A(MSG1)                   . 013E04 00013E78
          DC   A(MSG2)                   . 013E08 00013E88
          DC   A(MSG3)                   . 013E0C 00013E98
          DC   A(MSG4)                   . 013E10 00013EA8
          DC   A(MSG5)                   . 013E14 00013EB8
          DC   A(MSG6)                   . 013E18 00013EC8
          DC   A(MSG7)                   . 013E1C 00013ED8
          DC   A(MSG8)                   . 013E20 00013EE8
          DC   A(MSG9)                   . 013E24 00013EF8
          DC   A(MSG10)                  . 013E28 00013F08
          DC   A(MSG11)                  . 013E2C 00013F18
          DC   A(MSG12)                  . 013E30 00013F28
          DC   A(MSG13)                  . 013E34 00013F38
          DC   A(MSG14)                  . 013E38 00013F48
          DC   A(MSG15)                  . 013E3C 00013F58
          DC   A(MSG16)                  . 013E40 00013F68
          DC   A(MSG17)                  . 013E44 00013F78
          DC   A(MSG18)                  . 013E48 00013F88
          DC   A(MSG19)                  . 013E4C 00013F98
          DC   A(MSG20)                  . 013E50 00013FA8
          DC   A(MSG21)                  . 013E54 00013FB8
          DC   A(MSG22)                  . 013E58 00013FC8
          DC   A(MSG23)                  . 013E5C 00013FD8
          DC   A(MSG24)                  . 013E60 00013FE8
          DC   A(MSG25)                  . 013E64 00013FF8
          DC   A(MSG26)                  . 013E68 00014008
          DC   A(MSG27)                  . 013E6C 00014018
          DC   A(MSG28)                  . 013E70 00014028
          DC   X'07000700'               . 013E74 07000700
*
*      FATAL ERROR MESSAGES
*
MSG1   STRING  'ILLEGAL DATA TYPE'
MSG2   STRING  'ERROR IN ARITHMETIC OPERATION'
MSG3   STRING  'ERRONEOUS ARRAY OR TABLE REFERENCE'
MSG4   STRING  'NULL STRING IN ILLEGAL CONTEXT'
MSG5   STRING  'UNDEFINED FUNCTION OR OPERATION'
MSG6   STRING  'ERRONEOUS PROTOTYPE'
MSG7   STRING  'UNKNOWN KEYWORD'
MSG8   STRING  'VARIABLE NOT PRESENT WHERE REQUIRED'
MSG9   STRING  'ENTRY POINT OF FUNCTION NOT LABEL'
MSG10  STRING  'ILLEGAL ARGUMENT TO PRIMITIVE FUNCTION'
MSG11  STRING  'READING ERROR'
MSG12  STRING  'ILLEGAL I/O UNIT'
MSG13  STRING  'LIMIT ON DEFINED DATA TYPES EXCEEDED'
MSG14  STRING  'NEGATIVE NUMBER IN ILLEGAL CONTEXT'
MSG15  STRING  'STRING OVERFLOW'
MSG16  STRING  'OVERFLOW DURING PATTERN MATCHING'
MSG17  STRING  'ERROR IN SNOBOL4 SYSTEM'
MSG18  STRING  'RETURN FROM LEVEL ZERO'
MSG19  STRING  'FAILURE DURING GOTO EVALUATION'
MSG20  STRING  'INSUFFICIENT STORAGE TO CONTINUE'
MSG21  STRING  'STACK OVERFLOW'
MSG22  STRING  'LIMIT ON STATEMENT EXECUTION EXCEEDED'
MSG23  STRING  'OBJECT EXCEEDS SIZE LIMIT'
MSG24  STRING  'UNDEFINED OR ERRONEOUS GOTO'
MSG25  STRING  'INCORRECT NUMBER OF ARGUMENTS'
MSG26  STRING  'LIMIT ON COMPILATION ERRORS EXCEEDED'
MSG27  STRING  'ERRONEOUS END STATEMENT'
MSG28  STRING  'EXECUTION OF STATEMENT WITH COMPILATION ERROR'
*
*      COMPILER ERROR MESSAGES
*
EMSG1  STRING  'ERRONEOUS LABEL'
EMSG2  STRING  'PREVIOUSLY DEFINED LABEL'
EMSG3  STRING  'ERRONEOUS SUBJECT'
EMSG14 STRING  'ERROR IN GOTO'
ILCHAR STRING  'ILLEGAL CHARACTER IN ELEMENT'
ILLBIN STRING  'BINARY OPERATOR MISSING OR IN ERROR'
ILLBRK STRING  'ERRONEOUS OR MISSING BREAK CHARACTER'
ILLDEC STRING  'ERRONEOUS REAL NUMBER'
ILLEOS STRING  'IMPROPERLY TERMINATED STATEMENT'
ILLINT STRING  'ERRONEOUS INTEGER'
OPNLIT STRING  'UNCLOSED LITERAL'
*
*      Formats
*
ARTHNO FORMAT  '(1H0,I15,32H ARITHMETIC OPERATIONS PERFORMED)'
CMTIME FORMAT  '(1H0,I15,21H MS. COMPILATION TIME)'
EJECTF FORMAT  '(1H1)'
ERRCF  FORMAT  '(34H0ERRORS DETECTED IN SOURCE PROGRAM/1H1)'
EXNO   FORMAT  '(1H0,I15,21H STATEMENTS EXECUTED,,I8,7H FAILED)'
FTLCF  FORMAT  '(6H1ERROR,I3,13H IN STATEMENT,I5,9H AT LEVEL,I3)'      *
                                                                E3.4.1
INCGCF FORMAT  '(33H1INCOMPLETE STORAGE REGENERATION.)'
INTIME FORMAT  '(1H0,I15,19H MS. EXECUTION TIME)'
LASTSF FORMAT  '(28H LAST STATEMENT EXECUTED WAS,I5)'
NODMPF FORMAT  '(28H1TERMINAL DUMP NOT POSSIBLE.)'
NRMEND FORMAT  '(28H1NORMAL TERMINATION AT LEVEL,I3)'
NVARF  FORMAT  '(18H0NATURAL VARIABLES,/1H )'
PKEYF  FORMAT  '(21H0UNPROTECTED KEYWORDS/1H )'
PRTOVF FORMAT  '(29H ***PRINT REQUEST TOO LONG***)'
READNO FORMAT  '(1H0,I15,16H READS PERFORMED)'
SCANNO FORMAT  '(1H0,I15,26H PATTERN MATCHES PERFORMED)'
SOURCF FORMAT  '(42H0BELL TELEPHONE LABORATORIES, INCORPORATED,/1H1)'
STATHD FORMAT  '(28H1SNOBOL4 STATISTICS SUMMARY-)'
STDMP  FORMAT  '(33H1DUMP OF VARIABLES AT TERMINATION/1H )'
STGENO FORMAT  '(1H0,I15,33H REGENERATIONS OF DYNAMIC STORAGE)'
SUCCF  FORMAT  '(37H0NO ERRORS DETECTED IN SOURCE PROGRAM/1H1)'
SYSCMT FORMAT  '(27H0CUT BY SYSTEM IN STATEMENT,I5,9H AT LEVEL,I3)'    *
                                                                E3.4.1
TIMEPS FORMAT  '(1H0,F15.2,35H MS. AVERAGE PER STATEMENT EXECUTED/1H1)'
TITLEF FORMAT  '(37H1SNOBOL4 (VERSION 3.5, FEB. 10, 1971)/8H+_______)'
WRITNO FORMAT  '(1H0,I15,17H WRITES PERFORMED)'
ENDOFS4  EQU   S4+83115                  . 0144AB
         END   S4                        .
